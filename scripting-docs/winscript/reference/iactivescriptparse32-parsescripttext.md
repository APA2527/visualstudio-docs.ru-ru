---
title: IActiveScriptParse32::P Арсескрипттекст | Документация Майкрософт
ms.custom: ''
ms.date: 01/18/2017
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: reference
ms.assetid: f33e454c-69d8-4cab-9150-d1e7fd04786d
caps.latest.revision: 4
author: mikejo5000
ms.author: mikejo
ms.openlocfilehash: e26b5cb1790cab38a6544a04307b7e336a952519
ms.sourcegitcommit: 9a9c61ca115c22d33bb902153eb0853789c7be4c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85835372"
---
# <a name="iactivescriptparse32parsescripttext"></a>IActiveScriptParse32::ParseScriptText
Анализирует заданный код скриптлет, добавляя объявления в пространство имен и вычисляя код соответствующим образом.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp
HRESULT ParseScriptText(  
    LPCOLESTR pstrCode,              // address of scriptlet text  
    LPCOLESTR pstrItemName,          // address of item name  
    IUnknown *punkContext,           // address of debugging context  
    LPCOLESTR pstrDelimiter,         // address of end-of-scriptlet delimiter  
    DWORD_PTR dwSourceContextCookie, // cookie for debugging  
    ULONG ulStartingLineNumber,      // starting line of the script  
    DWORD dwFlags,                   // scriptlet flags  
    VARIANT *pvarResult,             // address of buffer for results  
    EXCEPINFO *pexcepinfo            // address of buffer for error data  
);  
```  
  
#### <a name="parameters"></a>Параметры  
  
|||  
|-|-|  
|`pstrCode`|окне Адрес выоцениваемого текста скриптлет. Интерпретация этой строки зависит от языка сценариев.|  
|`pstrItemName`|окне Адрес имени элемента, предоставляющего контекст, в котором вычисляется скриптлет. Если этот параметр имеет значение NULL, код вычисляется в глобальном контексте обработчика скриптов.|  
|`punkContext`|окне Адрес объекта контекста. Этот объект зарезервирован для использования в среде отладки, где такой контекст может быть предоставлен отладчиком для представления активного контекста времени выполнения. Если этот параметр имеет значение NULL, подсистема использует `pstrItemName` для обнаружения контекста.|  
|`pstrDelimiter`|окне Адрес разделителя конца скриптлет. Когда `pstrCode` анализируется из потока текста, хост обычно использует разделитель, например две одинарные кавычки (' '), для обнаружения конца скриптлет. Этот параметр задает разделитель, используемый узлом, позволяя обработчику скриптов предоставить некоторую условную предварительную обработку примитивов (например, заменить одинарную кавычку ['] двумя одинарными кавычками для использования в качестве разделителя). Точно то, как (и если) обработчик сценариев использует эти сведения, зависит от обработчика скриптов. Установите этот параметр в значение, `NULL` Если узел не использовал разделитель для обозначения конца скриптлет.|  
|`dwSourceContextCookie`|окне Файл cookie, используемый для отладки.|  
|`ulStartingLineNumber`|окне Отсчитываемое от нуля значение, которое указывает строку, с которой начнется анализ.|  
|`dwFlags`|окне Флаги, связанные с скриптлет. Может быть сочетанием следующих значений:|  
  
|Значение|Значение|  
|-----------|-------------|  
|SCRIPTTEXT_ISEXPRESSION|Если различие между вычислительным выражением и оператором важно, но синтаксически неоднозначно в языке скрипта, этот флаг указывает, что скриптлет интерпретируется как выражение, а не как оператор или список инструкций. По умолчанию используются инструкции, если только правильный вариант не может быть определен из синтаксиса текста скриптлет.|  
|SCRIPTTEXT_ISPERSISTENT|Указывает, что код, добавленный во время этого вызова, должен быть сохранен при сохранении обработчика скриптов (например, через вызов `IPersist*::Save` ) или при сбросе обработчика скриптов путем возврата к инициализированному состоянию.|  
|SCRIPTTEXT_ISVISIBLE|Указывает, что текст скрипта должен быть видимым (и, следовательно, вызываемым по имени) в качестве глобального метода в пространстве имен скрипта.|  
  
|||  
|-|-|  
|`pvarResult`|заполняет Адрес буфера, который получает результаты обработки скриптлет, или `NULL` Если вызывающий объект не ждет результата (то есть SCRIPTTEXT_ISEXPRESSION значение не задано).|  
|`pexcepinfo`|заполняет Адрес структуры, которая получает сведения об исключении. Эта структура заполняется, если `IActiveScriptParse::ParseScriptText` возвращает DISP_E_EXCEPTION.|  
  
## <a name="return-value"></a>Возвращаемое значение  
 Возвращает одно из следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|`S_OK`|Успешно.|  
|`DISP_E_EXCEPTION`|Произошло исключение при обработке скриптлет. `pexcepinfo`Параметр содержит сведения об исключении.|  
|`E_INVALIDARG`|Аргумент был недопустимым.|  
|`E_POINTER`|Указан недопустимый указатель.|  
|`E_NOTIMPL`|Этот метод не поддерживается. Обработчик скриптов не поддерживает вычисление выражений и инструкций во время выполнения.|  
|`E_UNEXPECTED`|Вызов не ожидался (например, обработчик скриптов находится в неинициализированном или закрытом состоянии, либо установлен флаг SCRIPTTEXT_ISEXPRESSION и обработчик скриптов находится в инициализированном состоянии).|  
|`OLESCRIPT_E_SYNTAX`|В скриптлет произошла неуказанная синтаксическая ошибка.|  
  
## <a name="remarks"></a>Комментарии  
 Если обработчик скриптов находится в инициализированном состоянии, код не будет вычисляться в ходе этого вызова. Вместо этого такой код помещается в очередь и выполняется при переходе обработчика сценариев в состояние запуска (или через). Поскольку выполнение не допускается в инициализированном состоянии, вызов этого метода с флагом SCRIPTTEXT_ISEXPRESSION в инициализированном состоянии является ошибкой.  
  
 Скриптлет может быть выражением, списком инструкций или любым объектом, разрешенным языком скрипта. Например, этот метод используется в вычислении HTML- \<SCRIPT> тега, который позволяет выполнять инструкции при создании HTML-страницы, а не просто компилировать их в состояние скрипта.  
  
 Код, переданный в этот метод, должен быть допустимой, полной частью кода. Например, в VBScript недопустимо вызывать этот метод один раз с подфункцией (x) и второй раз с `End Sub` . Синтаксический анализатор не должен ждать второго вызова, чтобы завершить выполнение подпрограммы, а должен создать ошибку синтаксического анализа, так как объявление подпрограммы было запущено, но не завершено.  
  
 Дополнительные сведения о состояниях сценариев см. в разделе состояния обработчика скриптов в [обработчиках сценариев Windows](../../winscript/windows-script-engines.md).  
  
## <a name="see-also"></a>Дополнительно  
 [IActiveScriptParse32](../../winscript/reference/iactivescriptparse32.md)