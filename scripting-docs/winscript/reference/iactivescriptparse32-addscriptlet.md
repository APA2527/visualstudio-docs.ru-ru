---
title: 'IActiveScriptParse32:: Аддскриптлет | Документация Майкрософт'
ms.custom: ''
ms.date: 01/18/2017
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: reference
ms.assetid: fcf11eb2-8e71-4cca-afda-a91791c243ff
caps.latest.revision: 5
author: mikejo5000
ms.author: mikejo
ms.openlocfilehash: 9ec8395f6c8f404a1d9010234da030c47594e087
ms.sourcegitcommit: 9a9c61ca115c22d33bb902153eb0853789c7be4c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85835749"
---
# <a name="iactivescriptparse32addscriptlet"></a>IActiveScriptParse32::AddScriptlet
Добавляет код скриптлет в скрипт. Этот метод используется в средах, где постоянное состояние сценария тесно переплетена с документом размещения, а узел отвечает за восстановление сценария, а не через `IPersist*` интерфейс. К основным примерам относятся языки сценариев HTML, позволяющие подключать сценарии кода, внедренного в HTML-документ, к внутренним событиям (например, OnClick = "Button1. Text =" Exit ").  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp
HRESULT AddScriptlet(  
    LPCOLESTR pstrDefaultName,       // address of default name of scriptlet  
    LPCOLESTR pstrCode,              // address of scriptlet text  
    LPCOLESTR pstrItemName,          // address of item name  
    LPCOLESTR pstrSubItemName,       // address of subitem name  
    LPCOLESTR pstrEventName,         // address of event name  
    LPCOLESTR pstrDelimiter,         // address of end-of-scriptlet delimiter  
    DWORD_PTR dwSourceContextCookie, // application-defined value for debugging  
    ULONG ulStartingLineNumber,      // starting line of the script  
    DWORD dwFlags,                   // scriptlet flags  
    BSTR *pbstrName,                 // address of actual name of scriptlet  
    EXCEPINFO *pexcepinfo            // address of exception information  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 `pstrDefaultName`  
 окне Адрес имени по умолчанию, связываемого с скриптлет. Если скриптлет не содержит сведений об именовании (как в примере OnClick выше), это имя будет использоваться для указания скриптлет. Если этот параметр имеет значение `NULL` , обработчик скриптов при необходимости создает уникальное имя.  
  
 `pstrCode`  
 окне Адрес добавляемого текста скриптлет. Интерпретация этой строки зависит от языка сценариев.  
  
 `pstrItemName`  
 окне Адрес буфера, содержащего имя элемента, связанное с этим скриптлет. Этот параметр в дополнение к `pstrSubItemName` определяет объект, для которого скриптлет является обработчиком событий.  
  
 `pstrSubItemName`  
 окне Адрес буфера, содержащего имя элемента с `subobject` именем, с которым связан этот скриптлет; это имя должно быть найдено в сведениях о типе именованного элемента. Этот параметр имеет значение NULL, если скриптлет должен быть связан с именованным элементом, а не с `subitem` . Этот параметр в дополнение к `pstrItemName` определяет конкретный объект, для которого скриптлет является обработчиком событий.  
  
 `pstrEventName`  
 окне Адрес буфера, который содержит имя события, для которого скриптлет является обработчиком событий.  
  
 `pstrDelimiter`  
 окне Адрес разделителя конца скриптлет. При `pstrCode` синтаксическом анализе параметра из потока текста хост обычно использует разделитель, например две одинарные кавычки (' '), для обнаружения конца скриптлет. Этот параметр задает разделитель, используемый узлом, позволяя обработчику скриптов предоставить некоторую условную предварительную обработку примитивов (например, заменить одинарную кавычку ['] двумя одинарными кавычками для использования в качестве разделителя). Точно то, как (и если) обработчик сценариев использует эти сведения, зависит от обработчика скриптов. Присвойте этому параметру значение NULL, если узел не использовал разделитель для обозначения конца скриптлет.  
  
 `dwSourceContextCookie`  
 окне Определяемое приложением значение, используемое в целях отладки.  
  
 `ulStartingLineNumber`  
 окне Отсчитываемое от нуля значение, которое указывает строку, с которой начнется анализ.  
  
 `dwFlags`  
 окне Флаги, связанные с скриптлет. Может быть сочетанием следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|SCRIPTTEXT_ISVISIBLE|Указывает, что текст скрипта должен быть видимым (и, следовательно, вызываемым по имени) в качестве глобального метода в пространстве имен скрипта.|  
|SCRIPTTEXT_ISPERSISTENT|Указывает, что код, добавленный во время этого вызова, должен быть сохранен при сохранении обработчика скриптов (например, через вызов `IPersist*::Save` ) или при сбросе обработчика скриптов путем возврата к инициализированному состоянию. Дополнительные сведения об этом состоянии см. в разделе о состояниях обработчика скриптов.|  
  
 `pbstrName` ,  
 заполняет Фактическое имя, используемое для обнаружения скриптлет. Это должно быть в порядке предпочтения: имя, явно указанное в тексте скриптлет, имя по умолчанию, указанное в `pstrDefaultName` , или уникальное имя, синтезированное обработчиком скриптов.  
  
 `pexcepinfo` ,  
 заполняет Адрес структуры, содержащей сведения об исключении. Эта структура должна быть заполнена, если возвращается DISP_E_EXCEPTION.  
  
## <a name="return-value"></a>Возвращаемое значение  
 Возвращает одно из следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|`S_OK`|Успешно.|  
|`DISP_E_EXCEPTION`|Произошло исключение при синтаксическом анализе скриптлет. `pexcepinfo`Параметр содержит сведения об исключении.|  
|`E_INVALIDARG`|Аргумент был недопустимым.|  
|`E_NOTIMPL`|Этот метод не поддерживается; обработчик скриптов не поддерживает добавление сценариев приемника событий.|  
|`E_POINTER`|Указан недопустимый указатель.|  
|`E_UNEXPECTED`|Вызов не ожидался (например, обработчик скриптов еще не загружен или не инициализирован) и поэтому завершился ошибкой.|  
|`OLESCRIPT_E_INVALIDNAME`|Имя, заданное по умолчанию, недопустимо в этом языке сценариев.|  
|`OLESCRIPT_E_SYNTAX`|В скриптлет произошла неуказанная синтаксическая ошибка.|  
  
## <a name="see-also"></a>Дополнительно  
 [IActiveScriptParse32](../../winscript/reference/iactivescriptparse32.md)