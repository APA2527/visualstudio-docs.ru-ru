---
title: 'IActiveScriptParse:: Аддскриптлет | Документация Майкрософт'
ms.custom: ''
ms.date: 01/18/2017
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: reference
apiname:
- IActiveScriptParse.AddScriptlet
apilocation:
- scrobj.dll
helpviewer_keywords:
- IActiveScriptParse_AddScriptlet
ms.assetid: 824929f4-4dd3-473a-92d9-0b96acea2f14
caps.latest.revision: 7
author: mikejo5000
ms.author: mikejo
manager: ghogen
ms.openlocfilehash: c1b4ac460afea1efd538c64224d84afef49d1a67
ms.sourcegitcommit: 184e2ff0ff514fb980724fa4b51e0cda753d4c6e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/18/2019
ms.locfileid: "72573537"
---
# <a name="iactivescriptparseaddscriptlet"></a>IActiveScriptParse::AddScriptlet
Добавляет код скриптлет в скрипт. Этот метод используется в средах, где постоянное состояние сценария тесно переплетена с документом размещения, а узел отвечает за восстановление сценария, а не через интерфейс `IPersist*`. К основным примерам относятся языки сценариев HTML, позволяющие подключать сценарии кода, внедренного в HTML-документ, к внутренним событиям (например, OnClick = "Button1. Text =" Exit ").  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp
HRESULT AddScriptlet(  
    LPCOLESTR pstrDefaultName,       // address of default name of scriptlet  
    LPCOLESTR pstrCode,              // address of scriptlet text  
    LPCOLESTR pstrItemName,          // address of item name  
    LPCOLESTR pstrSubItemName,       // address of subitem name  
    LPCOLESTR pstrEventName,         // address of event name  
    LPCOLESTR pstrDelimiter,         // address of end-of-scriptlet delimiter  
    DWORD_PTR dwSourceContextCookie, // application-defined value for debugging  
    ULONG ulStartingLineNumber,      // starting line of the script  
    DWORD dwFlags,                   // scriptlet flags  
    BSTR *pbstrName,                 // address of actual name of scriptlet  
    EXCEPINFO *pexcepinfo            // address of exception information  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 `pstrDefaultName`  
 окне Адрес имени по умолчанию, связываемого с скриптлет. Если скриптлет не содержит сведений об именовании (как в примере OnClick выше), это имя будет использоваться для указания скриптлет. Если этот параметр имеет значение `NULL`, обработчик скриптов при необходимости создает уникальное имя.  
  
 `pstrCode`  
 окне Адрес добавляемого текста скриптлет. Интерпретация этой строки зависит от языка сценариев.  
  
 `pstrItemName`  
 окне Адрес буфера, содержащего имя элемента, связанное с этим скриптлет. Этот параметр в дополнение к `pstrSubItemName` определяет объект, для которого скриптлет является обработчиком событий.  
  
 `pstrSubItemName`  
 окне Адрес буфера, который содержит имя `subobject` именованного элемента, с которым связан этот скриптлет; Это имя должно быть найдено в сведениях о типе именованного элемента. Этот параметр имеет значение NULL, если скриптлет должен быть связан с именованным элементом вместо `subitem`. Этот параметр в дополнение к `pstrItemName` определяет конкретный объект, для которого скриптлет является обработчиком событий.  
  
 `pstrEventName`  
 окне Адрес буфера, который содержит имя события, для которого скриптлет является обработчиком событий.  
  
 `pstrDelimiter`  
 окне Адрес разделителя конца скриптлет. Когда параметр `pstrCode` анализируется из потока текста, узел обычно использует разделитель, например две одинарные кавычки (' '), для обнаружения конца скриптлет. Этот параметр задает разделитель, используемый узлом, позволяя обработчику скриптов предоставить некоторую условную предварительную обработку примитивов (например, заменить одинарную кавычку ['] двумя одинарными кавычками для использования в качестве разделителя). Точно то, как (и если) обработчик сценариев использует эти сведения, зависит от обработчика скриптов. Присвойте этому параметру значение NULL, если узел не использовал разделитель для обозначения конца скриптлет.  
  
 `dwSourceContextCookie`  
 окне Определяемое приложением значение, используемое в целях отладки.  
  
 `ulStartingLineNumber`  
 окне Отсчитываемое от нуля значение, которое указывает строку, с которой начнется анализ.  
  
 `dwFlags`  
 окне Флаги, связанные с скриптлет. Может быть сочетанием следующих значений:  
  
|Возвращаемое значение|Смысл|  
|------------------|-------------|  
|SCRIPTTEXT_ISVISIBLE|Указывает, что текст скрипта должен быть видимым (и, следовательно, вызываемым по имени) в качестве глобального метода в пространстве имен скрипта.|  
|SCRIPTTEXT_ISPERSISTENT|Указывает, что код, добавленный во время этого вызова, должен быть сохранен при сохранении обработчика скриптов (например, с помощью вызова `IPersist*::Save`) или при сбросе обработчика скриптов путем возврата к инициализированному состоянию. Дополнительные сведения об этом состоянии см. в разделе о состояниях обработчика скриптов.|  
  
 `pbstrName` ,  
 заполняет Фактическое имя, используемое для обнаружения скриптлет. Это должно быть в порядке предпочтения: имя, явно заданное в тексте скриптлет, имя по умолчанию, указанное в `pstrDefaultName`, или уникальное имя, синтезированное обработчиком скриптов.  
  
 `pexcepinfo` ,  
 заполняет Адрес структуры, содержащей сведения об исключении. Эта структура должна быть заполнена, если возвращается DISP_E_EXCEPTION.  
  
## <a name="return-value"></a>Возвращаемое значение  
 Возвращает одно из следующих значений:  
  
|Возвращаемое значение|Смысл|  
|------------------|-------------|  
|`S_OK`|Выполнено.|  
|`DISP_E_EXCEPTION`|Произошло исключение при синтаксическом анализе скриптлет. Параметр `pexcepinfo` содержит сведения об исключении.|  
|`E_INVALIDARG`|Недопустимый аргумент.|  
|`E_NOTIMPL`|Этот метод не поддерживается; обработчик скриптов не поддерживает добавление сценариев приемника событий.|  
|`E_POINTER`|Указан недопустимый указатель.|  
|`E_UNEXPECTED`|Вызов не ожидался (например, обработчик скриптов еще не загружен или не инициализирован) и поэтому завершился ошибкой.|  
|`OLESCRIPT_E_INVALIDNAME`|Имя, заданное по умолчанию, недопустимо в этом языке сценариев.|  
|`OLESCRIPT_E_SYNTAX`|В скриптлет произошла неуказанная синтаксическая ошибка.|  
  
## <a name="see-also"></a>См. также  
 [IActiveScriptParse](../../winscript/reference/iactivescriptparse.md)