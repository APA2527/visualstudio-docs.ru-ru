---
title: Использование инструментов Visual Studio для Unity | Документация Майкрософт
ms.custom: ''
ms.date: 07/03/2018
ms.technology: vs-unity-tools
ms.topic: conceptual
ms.assetid: e67ec9a2-a449-413e-8930-9a471bd43a06
author: therealjohn
ms.author: johmil
manager: crdun
ms.workload:
- unity
ms.openlocfilehash: d1bca9bed18de822de71ca441387adeaefc65ec3
ms.sourcegitcommit: ade07bd1cf69b8b494d171ae648cfdd54f7800d3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81649399"
---
# <a name="use-visual-studio-tools-for-unity"></a>Использование инструментов Visual Studio для Unity

В этом разделе мы рассмотрим, как использовать возможности интеграции и повышения производительности набора средств Visual Studio для Unity, а также как использовать отладчик Visual Studio для разработки Unity.

## <a name="open-unity-scripts-in-visual-studio"></a>Открытие скриптов Unity в Visual Studio

После настройки Visual Studio [в качестве внешнего редактора скриптов для Unity](getting-started-with-visual-studio-tools-for-unity.md#configure-unity-for-use-with-visual-studio) открытие любого скрипта в редакторе Unity приводит к автоматическому запуску Visual Studio с выбранным скриптом. Просто дважды щелкните сценарий в проекте Unity.

Кроме того, можно запустить Visual Studio без открытия скрипта в редакторе исходного кода, выбрав элемент **Открыть проект C#** в меню Unity **Активы**.

![Открытие проекта C#](media/vstu_open-csharp-project.png)

## <a name="unity-documentation-access"></a>Доступ к документации по Unity

Доступ к документации по созданию скриптов Unity можно быстро получать из Visual Studio. Если набор средств Visual Studio для Unity не находит документацию по API в локальном режиме, он попытается найти ее через Интернет.

- В Visual Studio выделите API Unity, с которым хотите ознакомиться (или наведите на него курсор), а затем нажмите клавиши **CTRL**+**ALT**+**M**, **CTRL**+**H**.

## <a name="intellisense-for-unity-api-messages"></a>IntelliSense для сообщений API Unity

Средство автозавершения кода IntelliSense позволяет легко реализовать сообщения API Unity в скриптах MonoBehaviour и помогает в изучении API Unity. Чтобы использовать IntelliSense для сообщений Unity, сделайте следующее:

1. Поместите курсор на новую строку внутри тела класса, производного от `MonoBehaviour`.

2. Начните вводить имя сообщения Unity, например `OnTriggerEnter`.

3. После ввода букв "**ontri**" отображается список предложений IntelliSense.

   ![Using IntelliSense](media/vstu_intellisense1.png)

4. Выбранный элемент в списке можно изменить тремя способами:

    - с помощью клавиш со стрелками **ВВЕРХ** и **ВНИЗ**;

    - щелкая нужный элемент;

    - продолжив ввод имени нужного элемента.

5. IntelliSense может вставить выбранное сообщение Unity, включая все необходимые параметры:

    - при нажатии клавиши **TAB**;

    - при нажатии клавиши **ВВОД**;

    - при двойном щелчке выбранного элемента.

   ![Вставка сообщения Unity из IntelliSense](media/vstu_intellisense2.png)

## <a name="unity-monobehavior-scripting-wizard"></a>Мастер создания скриптов Unity MonoBehavior

Мастер MonoBehavior можно использовать для просмотра списка всех методов API Unity и быстрого выполнения пустого определения. Эта функция, особенно со включенным параметром **Создать комментарии для метода**, полезна при изучении того, что доступно в Unity API.

Создание определений пустых методов MonoBehavior с помощью мастера MonoBehavior.

1. В Visual Studio поместите курсор туда, где необходимо вставить методы, а затем нажмите клавиши **CTRL**+**SHIFT**+**M** для запуска мастера MonoBehavior.

2. В окне **Создание методов скрипта** установите флажок рядом с именем каждого метода, который нужно добавить.

3. Чтобы выбрать необходимую версию, используйте раскрывающийся список **Версия платформы**.

4. Методы по умолчанию вставляются в позицию курсора. В качестве альтернативы можно вставить их после любого метода, который уже реализован в классе. Для этого измените значение раскрывающегося списка **точка вставки** на нужное расположение.

5. Если вы хотите, чтобы мастер создавал комментарии для выбранных методов, установите флажок **Создать комментарии к методу**. Эти комментарии позволяют лучше понять, когда вызывается метод и каковы его общие функции.

6. Нажмите кнопку **ОК**, чтобы выйти из мастера и вставить методы в код.

   ![Диалоговое окно мастера MonoBehaviour.](../cross-platform/media/vstu_monobehavior_wizard_full.png "vstu_monobehavior_wizard_full")

## <a name="unity-project-explorer"></a>Обозреватель проектов Unity

![Окно обозревателя проектов Unity.](../cross-platform/media/vstu_unity_project_explorer.png "vstu_unity_project_explorer")

Обозреватель проектов Unity показывает все файлы и каталоги ваших проектов Unity в том же виде, что и редактор Unity. Это отличается от навигации по сценариям Unity с помощью обычного обозревателя решений Visual Studio, который организует их в проекты и решения, созданные Visual Studio.

- В главном меню Visual Studio выберите **Представление > Обозреватель проектов Unity**. Сочетание клавиш: **ALT**+**SHIFT**+**E**

   ![Откройте окно обозревателя проектов Unity.](../cross-platform/media/vstu_view_unity_project_explorer.png "vstu_view_unity_project_explorer")

## <a name="unity-debugging"></a>Отладка Unity

Набор средств Visual Studio для Unity позволяет отлаживать скрипты редакторов и игр для проекта Unity с помощью мощного отладчика Visual Studio.

### <a name="debug-in-the-unity-editor"></a>Отладка в редакторе Unity

#### <a name="start-debugging"></a>Начать отладку

1. Visual Studio можно подключить к Unity, нажав кнопку **Воспроизвести**, отмеченную меткой **Подключить к Unity**, или использовав клавишу **F5**.

   ![Нажатие кнопки "Воспроизвести" в Visual Studio](media/vstu_play-button.png)

2. Переключитесь в Unity и нажмите кнопку **Воспроизвести**, чтобы запустить игру в редакторе.

   ![Нажатие кнопки "Воспроизвести" в Unity](media/vstu_unity-play-button.png)

3. Когда игра запущена в редакторе Unity при подключении к Visual Studio, все проходимые точки останова будут приостанавливать выполнение игры и выводить соответствующую строку кода в Visual Studio.

#### <a name="stop-debugging"></a>Остановить отладку

- В Visual Studio нажмите кнопку **Стоп** или используйте сочетание клавиш **SHIFT + F5**.

  ![Нажатие кнопки "Остановить" в Visual Studio](media/vstu_stop-debugger.png)

Дополнительные сведения об отладчике Visual Studio см. в статье [First look at the Visual Studio Debugger](../debugger/debugger-feature-tour.md) (Первое знакомство с отладчиком Visual Studio).

#### <a name="attach-to-unity-and-play"></a>Подключение к Unity и воспроизведение

Для дополнительного удобства кнопку **Подключить к Unity** можно заменить на режим **Подключить к Unity и воспроизвести**.

1. Щелкните небольшую **стрелку вниз** рядом с кнопкой **Подключить к Unity**.

1. В раскрывшемся меню выберите **Подключить к Unity и воспроизвести**.

    ![Подключение и воспроизведение](media/vstu_attach-and-play.png)

Затем на кнопке "Воспроизведение" появляется метка **Подключение к Unity и воспроизведение**. Нажатие этой кнопки или использование клавиши **F5** приведет к автоматическому переключению на редактор Unity и запуску игры в редакторе, в дополнение к подключению отладчика Visual Studio.

Чтобы автоматически остановить игру в редакторе Unity, в Visual Studio нажмите кнопку **Стоп** или используйте сочетание клавиш **SHIFT**+**F5**.

### <a name="debug-unity-player-builds"></a>Отладка сборок проигрывателя Unity

С помощью Visual Studio можно отлаживать сборки для разработки различных проигрывателей Unity.

#### <a name="enable-script-debugging-in-a-unity-player"></a>Включение отладки скриптов в проигрывателе Unity

1. Чтобы открыть параметры сборки в Unity, выберите **Файл > Параметры сборки**.

2. В окне параметров сборки установите флажки **Сборка разработки** и **Отладка скриптов**.

   ![Настройте параметры сборки Unity для отладки.](../cross-platform/media/vstu_debugging_build_settings.png "vstu_debugging_build_settings")

#### <a name="select-a-unity-instance-to-attach-the-debugger-to"></a>Выбор экземпляр Unity для присоединения отладчика

- В главном меню Visual Studio выберите **Отладка > Присоединить отладчик Unity**.

   ![Подключите отладчик Unity.](../cross-platform/media/vstu_debugging_attach_unity_debugger.png "vstu_debugging_attach_unity_debugger")

   В диалоговом окне **Выбор экземпляра Unity** отображаются сведения о каждом экземпляре Unity, к которому можно подключиться.

   ![Выберите экземпляр Unity, к которому необходимо подключиться.](../cross-platform/media/vstu_attach-debugger.png "vstu_connection_to_unity")

   **Проект**

   Имя проекта Unity, который выполняется в этом экземпляре Unity.

   **Компьютер** Имя компьютера или устройства, на котором выполняется этот экземпляр Unity.

   **Тип** **Редактор** — если этот экземпляр Unity выполняется как часть редактора Unity; **Проигрыватель** — если этот экземпляр Unity является автономным проигрывателем.

   **Порт** Номер порта UDP-сокета, через который данный экземпляр Unity обменивается данными.

> [!IMPORTANT]
> Так как набор средств Visual Studio для Unity и экземпляр Unity взаимодействуют через сетевой UDP-сокет, ваш брандмауэр может об этом запросить. В данном случае соединение нужно авторизовать, чтобы VSTU и Unity могли обмениваться данными.

### <a name="debug-a-dll-in-your-unity-project"></a>Отладка библиотеки DLL в проекте Unity

Многие разработчики Unity создают компоненты кода в виде внешних библиотек DLL, чтобы разрабатываемые ими функции можно было легко совместно использовать с другими проектами. Набор средств Visual Studio для Unity упрощает отладку кода в этих библиотеках DLL без создания проблем для другого кода в проекте Unity.

> [!NOTE]
> В настоящее время набор средств Visual Studio для Unity поддерживает только управляемые библиотеки DLL. Он не поддерживает отладку библиотек DLL машинного кода, например библиотек, созданных на языке C++.

Обратите внимание, что описанный здесь сценарий предполагает, что у вас есть исходный код, то есть вы разрабатываете или повторно используете свой собственный код, или у вас есть исходный код для библиотеки стороннего разработчика и вы планируете его развернуть в проекте Unity как библиотеку DLL. Данный сценарий не описывает отладку библиотеки DLL, для которой у вас нет исходного кода.

#### <a name="to-debug-a-managed-dll-project-used-in-your-unity-project"></a>Отладка проекта с управляемой библиотекой DLL, используемой в проекте Unity

1. Добавьте существующий проект библиотеки DLL в решение Visual Studio, которое создается набором средств Visual Studio для Unity. В ряде случаев вы можете создать новый проект с управляемой библиотекой DLL, который будет содержать компоненты кода проекта Unity. В этом сценарии в решение Visual Studio можно добавить новый проект с управляемой библиотекой DLL. Дополнительные сведения о добавлении нового или существующего проекта в решение см. в разделе [Практическое руководство. Добавление проектов в решение](https://msdn.microsoft.com/library/ff460187.aspx).

   ![Добавьте существующий проект библиотеки DLL в решение.](../cross-platform/media/vstu_debugging_dll_add_existing.png "vstu_debugging_dll_add_existing")

   В любом случае набор средств Visual Studio для Unity сохраняет ссылку на проект, даже если он должен повторно создать файлы проекта и решения, поэтому эти действия нужно будет выполнить только один раз.

2. Создайте ссылку на нужный профиль платформы Unity в проекте DLL. В Visual Studio в свойствах проекта DLL для свойства **Целевая платформа** укажите версию платформы Unity, которую вы используете. Это библиотека базового класса Unity, соответствующая уровню совместимости API, на который ориентирован ваш проект, например библиотека базовых классов Unity full, micro или web. Благодаря этому ваша библиотека DLL не будет вызывать методы платформы, существующие на других платформах или уровнях совместимости, но которые могут отсутствовать в версии платформы Unity, которую вы используете.

> [!NOTE]
> Указанные ниже действия требуется выполнять, только если вы используете устаревшую среду выполнения Unity. В новой среде выполнения Unity такие выделенные профили версии 3.5 использовать не нужно. Выберите профиль .NET 4.x, совместимый с вашей версией Unity.

   ![Укажите платформу Unity в качестве целевой платформы библиотеки DLL.](../cross-platform/media/vstu_debugging_dll_target_framework.png "vstu_debugging_dll_target_framework")

3. Скопируйте библиотеку DLL в папку Asset (ресурсы) своего проекта Unity. В Unity ресурсы представляют собой файлы, которые упаковываются и развертываются вместе с вашим приложением Unity, чтобы их можно было загружать во время выполнения. Так как библиотеки DLL связываются во время выполнения, их необходимо развертывать как ресурсы. Для развертывания в виде ресурса редактору Unity требуется, чтобы библиотеки DLL были помещены в папку Assets вашего проекта Unity. Предусмотрены два способа выполнения этой задачи.

   - Измените параметры сборки проекта DLL, чтобы добавить выполняемую после сборки задачу, которая скопирует выходные файлы DLL и PDB из выходной папки в папку **Активы** проекта Unity.

   - Измените параметры сборки проекта DLL, чтобы сделать выходной папкой папку **Assets** проекта Unity. Теперь файлы DLL и PDB будут сразу помещаться в папку **Assets**.

   PDB-файлы необходимы для отладки, так как они содержат символы отладки библиотеки DLL и сопоставляют код DLL с формой его исходного кода. Если будет применяться устаревшая среда выполнения, Инструменты Visual Studio для Unity будут использовать сведения из файлов DLL и PDB для создания файла DLL.MDB. Это формат отладочных символов, применяемый устаревшим модулем обработки скрипов Unity. Если будет применяться новая среда выполнения и формат Portable-PDB, Инструменты Visual Studio для Unity не будут пытаться преобразовывать символы, так как новая среда выполнения Unity может самостоятельно обрабатывать файлы Portable-PDB.

   См. подробнее сведения о [создании PDB-файлов](../debugger/how-to-set-debug-and-release-configurations.md). Если будет применяться новая среда выполнения, убедитесь, что для параметра "Отладочная информация" задано значение "Переносимый" для корректного создания файла Portable PDB. Если будет применяться устаревшая среда выполнения, воспользуйтесь значением "Полный".

4. Выполните отладку своего кода. Теперь вы можете отлаживать свой исходный код DLL вместе с исходным кодом проекта Unity и использовать все доступные функции, например точки останова и пошаговое выполнение кода.

## <a name="keyboard-shortcuts"></a>сочетания клавиш

Для быстрого доступа средств Unity к функциям Visual Studio можно использовать соответствующие сочетания клавиш. Ниже приведен список таких сочетаний клавиш.

|Get-Help|Клавиша|Имя контекстной команды|
|-------------|--------------|---------------------------|
|Открыть мастер MonoBehavior|**CTRL**+**SHIFT**+**M**|**EditorContextMenus.CodeWindow.ImplementMonoBehaviours**|
|Открыть обозреватель проектов Unity|**ALT**+**SHIFT**+**E**|**View.UnityProjectExplorer**|
|Доступ к документации по Unity|**CTRL**+**ALT**+**M, CTRL**+**H**|**Help.UnityAPIReference**|
|Присоединиться к отладчику Unity (проигрыватель или редактор)|**_значение по умолчанию отсутствует_**|**Debug.AttachUnityDebugger**|

Если вас не устраивает сочетание клавиш по умолчанию, его можно изменить. Чтобы узнать, как это сделать, см. статью [Определение и настройка сочетаний клавиш в Visual Studio](../ide/identifying-and-customizing-keyboard-shortcuts-in-visual-studio.md).
