---
title: Отладка проектов Office
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- Excel projects [Office development in Visual Studio], debugging
- Word projects [Office development in Visual Studio], debugging
- Outlook [Office development in Visual Studio], debugging
- debugging [Office development in Visual Studio], Outlook projects
- Office projects [Office development in Visual Studio], debugging
- Outlook [Office development in Visual Studio], projects
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 8b48335ccaa8bd21cf9f6e108d043ecf706903bb
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63441886"
---
# <a name="debug-office-projects"></a>Отладка проектов Office
  Для отладки проектов Office можно использовать такие же инструменты Microsoft [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] , как и для других проектов [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] . Функциональные возможности отладчика[!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] , такие как возможность вставлять точки останова и просматривать переменные в окне **Локальные** , доступны и при отладке проектов Office. Дополнительные сведения о [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] средства отладки, см. в разделе [отладки в Visual Studio](../debugger/debugging-in-visual-studio.md).

> [!TIP]
> Чтобы упростить процесс отладки, перед выполнением сборки и отладки закройте все открытые экземпляры приложения Office.

 [!INCLUDE[appliesto_all](../vsto/includes/appliesto-all-md.md)]

> [!NOTE]
> Занимаетесь разработкой решений, расширяющих возможности Office по [нескольких платформ](https://dev.office.com/add-in-availability)? Ознакомьтесь с новой [модель надстроек Office](https://dev.office.com/docs/add-ins/overview/office-add-ins). Надстройки Office имеют небольшого размера, по сравнению с надстройками VSTO и решения, и вы можете создавать их с помощью почти любой технологии веб-программирования, таких как HTML5, JavaScript, CSS3 и XML.

## <a name="start-and-stop-the-debugger"></a>Запуск и остановка отладчика
 Вы можете начать отладку проекта Office, так же, как отладку любых других [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] проектов; например, можно нажать клавишу **F5** ключ. При запуске отладки проекта надстройки VSTO, запускается новый процесс для целевого приложения Office и загружается надстройка VSTO.

 Если отладка запускается для проекта уровня документа, документ или книга открывается в новом процессе Word или Excel.

 Если отладчик останавливается, он обрывает процесс приложения или отсоединяется (если отладчик настроен на отсоединение). Все остальные документы, открытые в прерываемом процессе приложения Office, также закрываются без предупреждения, а все несохраненные изменения теряются. Это относится ко всем документам или книгам, открытым во время работы отладчика.

 Как правило, лучше отсоединить отладчик от процесса перед его остановкой и выйти из приложения Office обычным способом. Предварительное отсоединение от процесса рекомендуется также в том случае, если вы хотите продолжить работу с открытым документом или книгой после остановки отладчика.

 При отладке настройки уровня документа для Word многократная остановка отладчика и связанное с ней непредвиденное завершение программы могут привести к повреждению шаблона Normal. В этом случае поврежденный шаблон Normal можно удалить — он будет создан автоматически, как только вы снова откроете приложение Word. При этом макросы, сохраненные в шаблоне Word, не воссоздаются.

### <a name="debug-office-2013-vsto-add-ins-by-using-either-office-2013-or-office-2016"></a>Отладка надстроек VSTO для Office 2013 с помощью Office 2013 или Office 2016
 Если вы используете Visual Studio 2015, и у вас есть обе версии Office установлен side-by-side, Visual Studio запускает Office 2016. Если вы используете Visual Studio 2013, Visual Studio запускает Office 2013.

 Если отладку надстройки VSTO необходимо выполнить с использованием другой версии Office (2013 или 2016), откройте **конструктор проектов**, перейдите на вкладку **Отладка** и установите переключатель **Запуск внешней программы** . Затем укажите расположение соответствующего исполняемого файла приложения Office.

## <a name="f10-and-f11-behavior"></a>Поведение клавиши F10 и F11
 При запуске отладки проекта Office, **F10** и **F11** не ведут себя так же как при запуске отладки других проектов Visual Basic или C#. В проектах Visual Basic или C# отладчик останавливается на основной функции, а в случае проектов Office Visual Studio не имеет контроля над основной функции приложения Office. Тем не менее, во время отладки **F10** и **F11** имеют те же функции, как и в проектах Visual Basic и C#.

## <a name="display-exceptions"></a>Отображение исключений
 В связи с особым взаимодействием между управляемым и неуправляемым кодом Visual Studio не отображает ошибки, которые выдают приложения Microsoft Office. Например если надстройка VSTO, созданные с помощью средств разработки Office в Visual Studio создает исключение, приложение Microsoft Office продолжает работу без отображения ошибки. Для просмотра этих ошибок настройте отладчик на прерывание в случае исключений среды выполнения. Дополнительные сведения см. в разделе [Управление исключениями с помощью отладчика](../debugger/managing-exceptions-with-the-debugger.md).

 Если отладчик настроен на прерывание в случае исключений среды выполнения, все исключения вызывают остановку отладчика, включая обработанные исключения и некоторые исключения первого шанса, которые возникли в самой среде выполнения и могут не иметь отношения к вашему проекту. Ошибки, связанные с невозможностью обнаружения файла msosec, возникают в любом проекте и не требуют внимания. Исключения msosec никак не влияют на ваше решение.

 Для перехвата исключений можно также использовать добавлять к методам операторы **Try...Catch** .

 По умолчанию Visual Studio не отображает ошибки JIT-отладки для проектов Office, но эту функцию можно включить, чтобы видеть возникающие ошибки. Дополнительные сведения см. в разделе [Just-In-Time отладки в Visual Studio](../debugger/just-in-time-debugging-in-visual-studio.md).

## <a name="command-line-arguments"></a>аргументов командной строки;
 Если **действие при запуске** на **Отладка** является страницей **запуск проекта**, Visual Studio не использует аргументы командной строки при отладке проекта, даже если у вас есть задать аргументы командной строки, как параметры запуска. Если вы хотите использовать аргументы командной строки при запуске отладки, необходимо выбрать **действие при запуске** отличное от **запуск проекта**.

## <a name="source-control"></a>Система управления версиями
 Отладка свойств не выполняется для всех пользователей, зарегистрированных в системе контроля версий, одновременно. Проекты Visual Basic и C# сохраняют свойства отладки в файлы конкретных пользователей (*имя_проекта*.vbproj.user или *имя_проекта*.csproj.user), не входящие в систему управления версиями. Если отладку выполняют сразу несколько пользователей, каждый из них вводит свойства отладки вручную.

## <a name="debug-cached-datasets-in-a-document-level-project"></a>Отладка кэшированных наборов данных в проекте уровня документа
 При каждой сборке проекта набор данных опустошается и создается заново. Чтобы отладить кэшированный набор данных, откройте документ вне Visual Studio, а затем присоедините отладчик.

## <a name="debug-word-document-projects-based-on-the-word-97-2003-document-doc-format"></a>Проектов документов Word отладки, на основе документа Word 97-2003 (* .doc) формата
 Для отладки проекта документа Word на основе документа Word 97-2003 ( */* .doc *) формат, необходимо добавить в папку проекта в список надежных папок. Дополнительные сведения о том, как это сделать, см. в разделе [предоставления доверия к документам](../vsto/granting-trust-to-documents.md).

## <a name="debug-disabled-add-ins"></a>Надстройки отладка отключена
 Приложения Microsoft Office могут отключать надстройки VSTO, которые ведут себя непредсказуемым образом. Это делается для того, чтобы предотвратить загрузку неисправного кода при каждом запуске приложения. В то же время, непредвиденное поведение может возникать и в процессе обычной отладки. Сведения о повторном включении надстроек VSTO, см. в разделе [как: Повторное включение надстройки VSTO, которая была отключена](../vsto/how-to-re-enable-a-vsto-add-in-that-has-been-disabled.md).

 В приложениях Microsoft Office используются два вида отключения надстроек VSTO: жесткое и мягкое.

### <a name="hard-disabling"></a>Жесткое отключение
 Жесткое отключение происходит, когда надстройки VSTO вызывает неожиданное прекращение работы приложения. На компьютере разработчика оно применяется также в случае остановки отладчика во время выполнения обработчика событий <xref:Microsoft.Office.Tools.AddIn.Startup> в надстройке VSTO. Когда надстройка VSTO, отключенная жестким, оно появится в **отключенные объекты** в приложении.

 Если приложение Office жестко отключает надстройку VSTO, созданные с помощью средств разработки Office в Visual Studio, отключается только надстройки VSTO, вызвавшее сбой. Другие надстройки VSTO, созданные с помощью средств разработки Office в Visual Studio для того же приложения Office, будут загружаться по-прежнему.

### <a name="soft-disabling"></a>Мягкое отключение
 Мягкое отключение применяется, если вызванная надстройкой VSTO ошибка не приводит к неожиданному завершению работы приложения. Надстройка VSTO отключается мягким способом, например, если выдает необработанное исключение во время выполнения обработчика событий <xref:Microsoft.Office.Tools.AddIn.Startup> . Надстройка VSTO мягко отключили, отображается в **неактивного приложения Add-ins** список в приложение и приложение изменяет значение **LoadBehavior** запись реестра для надстройки VSTO Чтобы указать, что ее выгрузке. Дополнительные сведения о **LoadBehavior** запись реестра, см. в разделе [записи реестра для надстроек VSTO](../vsto/registry-entries-for-vsto-add-ins.md).

## <a name="troubleshoot-installation-errors-by-using-the-event-viewer"></a>Устранение ошибок установки в окне просмотра событий
 Среда выполнения [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] записывает сообщения в средство просмотра событий в Windows для всех исключений, возникших при установке или удалении решений Office. Эти сообщения можно использовать для решения проблем развертывания и установки.

## <a name="troubleshoot-startup-errors-by-using-a-log-file-and-error-messages"></a>Устранение ошибок запуска с помощью журнала файла и сообщения об ошибках
 Среда выполнения [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] может записывать все возникающие при запуске ошибки в файл журнала или отображать каждую ошибку в окне сообщения. По умолчанию эти параметры отключены. Можно включить параметры, необходимо создать переменные среды.

 Чтобы каждая ошибка отображалась в окне сообщения, создайте переменную среды с именем `VSTO_SUPPRESSDISPLAYALERTS` и присвойте ей значение 0 (ноль). Чтобы отключить отображение сообщений, удалите эту переменную среды или присвойте ей значение 1 (один).

 Чтобы ошибки записывались в файл журнала, создайте переменную среды с именем `VSTO_LOGALERTS` и присвойте ей значение 1 (один). Среда выполнения [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] создает файл журнала в папке, содержащей манифест развертывания для надстройки VSTO, или в папке, содержащей документ или книгу, связанные с настройкой. В случае неудачи [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] создает файл журнала в локальной *% TEMP %* папки. Для надстроек VSTO уровня приложения файлу журнала по умолчанию присваивается имя *имя_надстройки*.vsto.log. Для проектов уровня документа файлу журнала присваивается имя *имя_документа*.*extension*.log, например ExcelWorkbook1.xlsx.log. Чтобы остановить ведение журнала ошибок, удалите переменную среды или присвойте ей значение 0 (ноль).

## <a name="see-also"></a>См. также

- [Создание решений Office](../vsto/building-office-solutions.md)
- [Практическое руководство. Повторное включение надстройки VSTO, которая была отключена](../vsto/how-to-re-enable-a-vsto-add-in-that-has-been-disabled.md)
- [Программирование надстроек VSTO](../vsto/programming-vsto-add-ins.md)