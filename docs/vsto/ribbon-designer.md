---
title: Конструктор лент
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- Designer_Microsoft.VisualStudio.Tools.Office.Ribbon.Design.RibbonDesigner
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- custom Ribbon, about Ribbon Designer
- controls [Office development in Visual Studio], Ribbon
- Ribbon [Office development in Visual Studio], controls
- customizing the Ribbon, about Ribbon Designer
- Ribbon [Office development in Visual Studio], visual designer
- customizing the Ribbon
- custom Ribbon
- designers [Office development in Visual Studio], Ribbon
- Ribbon [Office development in Visual Studio], customizing
- Ribbon [Office development in Visual Studio], common tasks
- Ribbon Designer [Office development in Visual Studio]
- read-only properties
- Ribbon [Office development in Visual Studio], shortcut keys
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: f417c077d2280b951f0d101d79876c01cb33789d
ms.sourcegitcommit: e98db44f3a33529b0ba188d24390efd09e548191
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2019
ms.locfileid: "71256036"
---
# <a name="ribbon-designer"></a>Конструктор лент
  Конструктор ленты является холстом визуального проектирования. Используйте конструктор ленты для добавления пользовательских вкладок, групп и элементов управления на ленту Microsoft Office приложения.

 [!INCLUDE[appliesto_ribbon](../vsto/includes/appliesto-ribbon-md.md)]

 Чтобы открыть конструктор ленты, добавьте в проект элемент **Лента (визуальный конструктор)** . Затем можно использовать средства проектирования для следующих задач:

- [Создание макета ленты](#DesigningRibbonLayout)

- [Обрабатывайте события и устанавливайте свойства элементов управления](#HandleEventsSetProperties)

- [Добавление элементов управления в представление Backstage](#CustomizingMicrosoftOfficeButton)

> [!NOTE]
> Существует ряд задач, которые невозможно выполнить с помощью конструктора ленты. Дополнительные сведения об этих задачах и о том, как их можно выполнить, см. в статье [Общие сведения о ленте](../vsto/ribbon-overview.md).

 ![ссылка на видео](../vsto/media/playvideo.gif "ссылка на видео") Связанные демонстрационные видеоролики см [. в разделе разделы справки: Как использовать конструктор ленты для настройки ленты в Outlook? ](http://go.microsoft.com/fwlink/?LinkID=130312).

## <a name="add-a-ribbon-visual-designer-item-to-a-project"></a>Добавление элемента «Лента (визуальный конструктор)» в проект
 Чтобы использовать конструктор ленты, добавьте в проект новый элемент **Лента (визуальный конструктор)** . Дополнительные сведения см. в разделе [Практическое руководство. Приступая к настройке ленты](../vsto/how-to-get-started-customizing-the-ribbon.md).

 При добавлении нового элемента **ленты (визуальный конструктор)** Visual Studio автоматически добавляет в проект следующие файлы:

- Файл кода ленты. Этот файл имеет имя, указанное для элемента " **Лента (визуальный конструктор)** " в диалоговом окне " **Добавление нового элемента** ". Добавьте код для управления событиями ленты в этот файл.

- Файл кода конструктора ленты. Этот файл содержит код, созданный конструктором ленты, и не должен редактироваться напрямую.

- Файл ресурсов. Этот файл содержит значения свойств каждого элемента управления на ленте.

  Если у вас уже есть элемент **Лента (визуальный конструктор)** из другого проекта, его можно повторно использовать в текущем проекте с помощью диалогового окна **Добавление существующего элемента** .

## <a name="DesigningRibbonLayout"></a>Создание ленты
 Существует три способа открыть конструктор ленты.

- В **Обозреватель решений**дважды щелкните файл кода ленты.

- В **Обозреватель решений**щелкните правой кнопкой мыши файл кода ленты и выберите пункт **Конструктор представлений**.

- В **Обозреватель решений**выберите файл кода ленты, а затем в меню **вид** выберите **конструктор** .

  Конструктор ленты содержит вкладку и группу по умолчанию. Вы можете удалить вкладку и группу по умолчанию из конструктора лент. Чтобы удалить группу по умолчанию, щелкните правой кнопкой мыши элемент **group1**и выберите пункт **Удалить**. Чтобы удалить вкладку по умолчанию, щелкните правой кнопкой мыши пустую область области конструктора и выберите пункт **Удалить вкладку ленты**.

  В конструктор ленты можно также добавить пользовательские вкладки, группы и элементы управления. Эти элементы управления можно найти на **панели элементов**в группе **элементы управления ленты Office** . Добавить элементы управления из группы " **элементы управления ленты Office** " в конструктор лент можно тремя способами:

- Перетащите элемент управления в соответствующую область конструктора ленты.

- Щелкните элемент управления и выберите соответствующую область в конструкторе ленты.

- Выберите соответствующую область в конструкторе, а затем дважды щелкните элемент управления на **панели элементов**.

### <a name="ribbon-design-workflow"></a>Рабочий процесс конструктора ленты
 Для создания макета ленты выполните следующие основные действия.

1. [Добавьте настраиваемую вкладку на ленту](#AddTabToRibbon).

2. [Добавьте группы на вкладку](#AddGroupsToTab).

3. [Добавьте элементы управления в группы](#AddControlsToGroups).

   Элементы управления могут быть удалены только для групп; нельзя перетащить элемент управления непосредственно на вкладку или на ленту. Группы можно удалять только на вкладках; нельзя перетащить группу непосредственно на ленту.

   Расположите элементы управления, перетаскивая их в нужные позиции. Свойства элемента управления можно задать с помощью окна **Свойства** .

   Вы не можете перетаскивать элементы управления с одной вкладки на другую на ленте. Если вы хотите переместить элемент управления на другую вкладку, необходимо использовать команду **Вырезать** , чтобы удалить элемент управления с одной вкладки, а затем вставить элемент управления на другую вкладку. Если вырезать элемент управления и вставить его, обработчик событий перестанет работать. Обработчик событий можно повторно подключить в окне " **Свойства** ". Дополнительные сведения см. в разделе [окно свойств](../ide/reference/properties-window.md).

### <a name="AddTabToRibbon"></a>Добавление пользовательских вкладок на ленту
 Существует три способа добавить настраиваемую вкладку на ленту.

- Добавление вкладки из **панели элементов**.

- Щелкните правой кнопкой мыши конструктор лент и выберите пункт **Добавить вкладку ленты**.

- Откройте **Редактор коллекции вкладок**и нажмите кнопку **Добавить**.

   Чтобы открыть **Редактор коллекции вкладок**, в окне " **свойства** " выберите свойство " **вкладки** " и нажмите кнопку с многоточием ![ASP.net Mobile Designer эллипс](../sharepoint/media/mwellipsis.gif "ASP.net Mobile Designer эллипс").

  После добавления вкладки можно добавить группы, содержащие элементы управления.

#### <a name="remove-custom-tabs-from-the-ribbon"></a>Удаление настраиваемых вкладок с ленты
 Существует три способа удалить настраиваемую вкладку с ленты:

- Щелкните правой кнопкой мыши конструктор и выберите пункт **Удалить вкладку ленты**.

- В области **команды** окна **Свойства** щелкните **Удалить вкладку ленты**.

- Откройте **Редактор коллекции вкладок**, выберите вкладку и нажмите кнопку **Удалить**.

#### <a name="change-the-position-of-a-tab-on-the-ribbon"></a>Изменение позиции вкладки на ленте
 Можно изменить порядок пользовательских вкладок на ленте. Можно также располагать пользовательские вкладки до или после встроенной вкладки на ленте. Дополнительные сведения см. в разделе [Практическое руководство. Изменение позиции вкладки на ленте](../vsto/how-to-change-the-position-of-a-tab-on-the-ribbon.md).

#### <a name="customize-built-in-tabs-on-the-ribbon"></a>Настройка встроенных вкладок на ленте
 Встроенная вкладка — это вкладка, которая уже находится на ленте Microsoft Office приложении. Например, вкладка « **данные** » является встроенной вкладкой Excel.

 На встроенную вкладку можно добавить группы и элементы управления. По умолчанию пользовательская группа отображается как последняя группа на встроенной вкладке, хотя ее можно переместить до или после любой встроенной группы на вкладке.

 Невозможно удалить встроенные группы.

 Дополнительные сведения о настройке встроенной вкладки см. в разделе [как Настройка встроенной вкладки](../vsto/how-to-customize-a-built-in-tab.md).

### <a name="AddGroupsToTab"></a>Добавление групп на вкладку
 Группы логически упорядочивают элементы управления на ленте. Добавление групп в вкладки. Добавьте все остальные элементы управления в группу.

### <a name="AddControlsToGroups"></a>Добавление элементов управления в группы
 Добавьте один или несколько элементов управления в группу. В следующей таблице описаны все элементы управления.

|Элемент управления|Описание|
|-------------|-----------------|
|**Box**|Контейнер, упорядочивающий элементы управления в группе. В поле можно добавить любой элемент управления, кроме разделителя, группы или вкладки. Поле может быть горизонтальным или вертикальным.|
|**Button**|Кнопка, которая запускает действие. Можно добавить кнопку в группу, группу кнопок, раскрывающийся список, коллекцию, меню или разворачивающуюся кнопку.|
|**ButtonGroup**|Группа, содержащая одну или несколько кнопок, переключателей, меню, разделенных кнопок и коллекций. Группу кнопок можно добавить в группу или меню.|
|**CheckBox**|Поле, выбранное или снятое для включения или выключения параметра.|
|**ComboBox**|Поле ввода с присоединенным полем со списком. Пользователи могут либо ввести, либо выбрать нужный вариант. В поле отображается текущее выделение. <xref:Microsoft.Office.Tools.Ribbon.RibbonComboBox.Items%2A> Используйте свойство, чтобы добавлять и удалять элементы во время выполнения до или после загрузки ленты в приложение Office.|
|**Крывающихся**|Список элементов, которые может выбрать пользователь. Пользователь не может ввести новый элемент в раскрывающемся списке.<br /><br /> <xref:Microsoft.Office.Tools.Ribbon.RibbonDropDown.Items%2A> Используйте свойство, чтобы добавить элементы в список. Элементы можно добавлять и удалять во время выполнения.<br /><br /> <xref:Microsoft.Office.Tools.Ribbon.RibbonDropDown.Buttons%2A> Используйте свойство, чтобы добавить кнопки в список. Однако нельзя добавлять и удалять кнопки во время выполнения после загрузки ленты в приложение Office.|
|**Поле**|Поле, в котором пользователь может ввести текст.|
|**Коллекция**|Меню, представляющее собой массив или сетку визуальных вариантов выбора, из которых пользователи могут выбирать. Можно управлять макетом выбора в меню. Используйте свойства <xref:Microsoft.Office.Tools.Ribbon.RibbonGallery.RowCount%2A> и, чтобы указать количество строк и столбцов, в которых будут отображаться элементы и кнопки коллекции. <xref:Microsoft.Office.Tools.Ribbon.RibbonGallery.ColumnCount%2A>|
|**Label**|Текст, который можно использовать для распознавания элементов управления на ленте.|
|**Menu**|Раскрывающийся список, который может содержать любой из следующих элементов управления:<br /><br /> Кнопка<br />-Флажок<br />-Gallery<br />-Меню<br />-Разворачивающаяся кнопка<br />— Выключатель<br />-Separator<br /><br /> Чтобы добавить элемент управления в меню в конструкторе ленты, щелкните стрелку вниз в меню, чтобы открыть область конструктора меню. Затем можно перетащить элементы управления ленты из **панели элементов** в меню. Чтобы расположить элементы управления, перетащите их в нужные позиции.<br /><br /> Чтобы добавить элементы управления <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu> на ленту после загрузки ленты в приложение Office, необходимо <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu.Dynamic%2A> установить свойство в **значение true** перед загрузкой ленты. Сведения о том, как это сделать, см. в разделе [Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md).|
|**Separator**|Тонкая полоса, используемая для разделения элементов в списке. При добавлении в группу полоса является вертикальной. При добавлении в меню полоса является горизонтальной.|
|**SplitButton**|Кнопка с присоединенным меню. Разворачивающаяся кнопка может содержать любой из следующих элементов управления:<br /><br /> Кнопка<br />-Флажок<br />-Gallery<br />-Меню<br />-Разворачивающаяся кнопка<br />— Выключатель<br />-Separator<br /><br /> Как и в меню, кнопка разбиения имеет собственную область конструктора. Однако, в отличие от меню, элементы можно обновлять только на разворачивающейся кнопке перед загрузкой ленты в приложение Office. Дополнительные сведения об обновлении элементов в разворачивающейся кнопке см. в разделе [Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md).|
|**ToggleButton**|Кнопка, которая отображается нажатой или не нажатой.|

## <a name="HandleEventsSetProperties"></a>Обрабатывайте события и устанавливайте свойства
 Конструктор ленты позволяет задавать свойства элементов управления во время разработки с помощью окна « **Свойства** ». Кроме того, лента предоставляет строго типизированную объектную модель, которую можно использовать для получения и задания свойств элементов управления ленты во время выполнения.

 Можно дважды щелкнуть любой элемент управления в конструкторе, чтобы открыть обработчик событий для события по умолчанию элемента управления. Обработчики событий для всех других событий элемента управления можно создать с помощью окна « **Свойства** ».

 События и свойства ленты находятся в <xref:Microsoft.Office.Tools.Ribbon> пространстве имен. Элемент **Лента (визуальный конструктор)** автоматически добавляет ссылку на эту сборку в проект и вставляет соответствующий оператор **using** или **Imports** в начало файла кода ленты.

 Сведения об обработке событий ленты и задании свойств элементов управления ленты во время выполнения см. в разделе [Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md).

## <a name="CustomizingMicrosoftOfficeButton"></a>Настройка представления Backstage
 Конструктор ленты можно использовать для добавления элементов управления в меню, которое открывается, если щелкнуть вкладку **файл** . Это меню называется представлением Backstage.

 Элементы управления нельзя размещать до или после встроенных элементов управления с помощью конструктора лент. Встроенный элемент управления — это элемент управления, который уже отображается в представлении Backstage. Если необходимо разместить элементы управления до или после встроенных элементов управления, необходимо использовать ленту XML. Дополнительные сведения о **ленте (XML)** см. в разделе [Ribbon XML](../vsto/ribbon-xml.md). Дополнительные сведения о настройке представления Backstage см. в статье [Введение в представление Backstage office 2010 для разработчиков](http://go.microsoft.com/fwlink/?LinkId=182189) и [Настройка представления Backstage для разработчиков Office 2010](http://go.microsoft.com/fwlink/?LinkId=182188).

 [!INCLUDE[appliesto_ribbon_2010](../vsto/includes/appliesto-ribbon-2010-md.md)]

 Дополнительные сведения о добавлении элементов управления в представление Backstage см. в разделе [как Добавьте элементы управления в представление](../vsto/how-to-add-controls-to-the-backstage-view.md)Backstage.

## <a name="Accessibility"></a>Специальные возможности в конструкторе ленты
 Для перемещения элементов управления в конструкторе лент можно использовать сочетания клавиш. Некоторые сочетания клавиш применяются ко всем элементам управления, и некоторые из них применяются только к элементам управления, имеющим меню.

 В следующей таблице показаны сочетания клавиш, применяемые ко всем элементам управления.

|Действие|Сочетание клавиш|
|------------|-----------------------|
|Перемещение элемента управления перед предыдущим элементом управления в списке.|**Ctrl +** +**стрелка вверх**<br /><br /> **Ctrl**слева+|
|Перемещение элемента управления после следующего элемента управления в списке.|**Ctrl**вниз+<br /><br /> **Ctrl**right+|
|Перемещение выделения из одного элемента управления в другой в той же группе. Для раскрывающейся панели перейдите между родительским элементом управления и элементами управления из раскрывающейся панели.|**Крывающемся**<br /><br /> **Крывающей**|
|Выполните итерацию вперед по всем элементам управления.|**TAB**|
|Выполните итерацию по всем элементам управления в противоположном порядке.|**SHIFT**+**TAB**|
|Удаление выбранного элемента управления или набора элементов управления.|**Удалить**|
|Копирование выбранных элементов управления.|**CTRL**+**C**|
|Вырезание выбранных элементов управления.|**CTRL**+**X**|
|Вставка элементов управления из буфера обмена.|**CTRL**+**V**|
|Выберите **область элементов**.|**Ctrl**+**ALT** X+|
|Выберите родительский компонент.|**ESC**|

 Сочетания клавиш, применяемые только к меню Microsoft Office, <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu>и <xref:Microsoft.Office.Tools.Ribbon.RibbonSplitButton> показаны в следующей таблице.

|Действие|Сочетание клавиш|
|------------|-----------------------|
|Выберите родительский элемент управления, если раскрывающийся список открыт и на раскрывающейся панели выбран элемент управления.|**Слева**|
|Закройте раскрывающийся список, если раскрывающаяся панель открыта и выбран родительский элемент управления.|**Слева**|
|Откройте раскрывающийся список.|**Right**|
|Выберите первый элемент управления на раскрывающейся панели, если раскрывающийся список открыт.|**Right**|
|Закрытие раскрывающейся панели.|**ESC**|

## <a name="see-also"></a>См. также

- [Общие сведения о ленте](../vsto/ribbon-overview.md)
- [Ribbon XML](../vsto/ribbon-xml.md)
- [Пошаговое руководство: Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)
- [Практическое руководство. Экспорт ленты из конструктора ленты в XML-ленту](../vsto/how-to-export-a-ribbon-from-the-ribbon-designer-to-ribbon-xml.md)
- [Практическое руководство. Приступая к настройке ленты](../vsto/how-to-get-started-customizing-the-ribbon.md)
- [Доступ к ленте во время выполнения](../vsto/accessing-the-ribbon-at-run-time.md)
