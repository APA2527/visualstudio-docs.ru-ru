---
title: Связывание области формы с классом сообщений Outlook
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- VSTO.NewFormRegionWizard.InvalidMessageClassName
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- FormRegionMessageClassAttribute
- form regions [Office development in Visual Studio], message classes
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 5c264048887d3a1ba77d498784dc3e6cc4384159
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63440368"
---
# <a name="associate-a-form-region-with-an-outlook-message-class"></a>Связывание области формы с классом сообщений Outlook
  Вы можете указать, какие элементы Microsoft Office Outlook отображать область формы путем связывания области формы с классом сообщений каждого элемента. Например, если вы хотите добавить в конец почтового элемента области формы, можно связать области формы с `IPM.Note` класс message.

 Связывание области формы с классом сообщений, укажите имя класса сообщений в **новая область формы Outlook** мастер или примените атрибут к классу фабрики области формы.

 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]

## <a name="understand-outlook-message-classes"></a>Понимание классов сообщений Outlook
 Классом сообщений Outlook определяет тип элемента Outlook. В следующей таблице перечислены восемь стандартных типов элементов и их именах классов сообщений.

|Тип элемента Outlook|Имя класса сообщений|
|-----------------------|------------------------|
|AppointmentItem|`IPM.Appointment`|
|ContactItem|`IPM.Contact`|
|DistListItem|`IPM.DistList`|
|JournalItem|`IPM.Activity`|
|MailItem|`IPM.Note`|
|PostItem|`IPM.Post` или `IPM.Post.RSS`|
|TaskItem|`IPM.Task`|

 Можно также указать имена пользовательских классов сообщений. Пользовательских классов сообщений идентифицируют настраиваемые формы, определенные в Outlook.

> [!NOTE]
> Для замещающих и заменяющих областей форм можно указать имя нового класса пользовательского сообщения. Необходимо использовать имя класса сообщений существующей пользовательские формы. Имя пользовательского класса должен быть уникальным. Один из способов, чтобы убедиться, что имя является уникальным является использование соглашения об именовании следующего вида: \<*StandardMessageClassName*>.\< *Компании*>.\< *MessageClassName*> (например: `IPM.Note.Contoso.MyMessageClass`).

## <a name="associate-a-form-region-with-an-outlook-message-class"></a>Связывание области формы с классом сообщений Outlook
 Связывание области формы с классом сообщений двумя способами:

- Используйте **новая область формы Outlook** мастера.

- Применение атрибутов классов.

### <a name="use-the-new-outlook-form-region-wizard"></a>Используйте мастер создания области формы Outlook
 На последней странице **новая область формы Outlook** мастера, можно выбрать стандартные классы сообщений и ввести имена пользовательских классов сообщений, которые вы хотите связать с областью формы.

 Стандартные классы сообщений недоступны, если область формы предназначена для замены всей формы или страницы формы по умолчанию. Можно указать имена стандартных классов сообщений только для форм, добавьте новую страницу в форму или, добавляются в нижнюю часть формы. Дополнительные сведения см. в разделе [Как Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).

 Чтобы включить один или несколько пользовательских классов сообщений, введите их имена в **каких классах пользовательских сообщений будет отображаться эта область формы?** поле.

 Имена, которые вы типа должны соответствовать приведенным ниже рекомендациям:

- Используйте полностью определенное имя класса сообщений (например: «НАЧАЛЬНИК. Note.Contoso»).

- Используйте точку с запятой для разделения нескольких имен классов сообщений.

- Не используйте стандартные классы сообщений Outlook, такие как «Начальник. Примечание» или «Начальник. "Contact». Включайте только пользовательских классов сообщений, таких как «Начальник. Note.Contoso».

- Сама по себе не указать класса сообщений (например: «НАЧАЛЬНИК»).

- Не превышает 256 символов для каждого имя класса сообщений.

  **Новая область формы Outlook** мастер проверяет формат входных данных, если щелкнуть **Готово**.

> [!NOTE]
> **Новая область формы Outlook** мастер не проверку имен классов сообщений, которые вы указываете правильный или допустимым.

 Когда вы завершите работу мастера, **новая область формы Outlook** мастер применяет атрибуты к классу области формы, содержащих имена классов указанное сообщение. Эти атрибуты можно применять вручную.

### <a name="apply-class-attributes"></a>Применение атрибутов классов
 Область формы можно связать с классом сообщений Outlook, после завершения **новая область формы Outlook** мастера. Чтобы сделать это, примените атрибуты к классу фабрики области формы.

 В следующем примере показаны два <xref:Microsoft.Office.Tools.Outlook.FormRegionMessageClassAttribute> атрибуты, которые были применены к класса фабрики области формы с именем `myFormRegion`. Первый атрибут связывает область формы с классом стандартное сообщение для формы сообщений. Второй атрибут связывает области формы с пользовательский класс сообщения с именем `IPM.Task.Contoso`.

 [!code-vb[Trin_Outlook_FR_Attributes#1](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Attributes/FormRegion1.vb#1)]
 [!code-csharp[Trin_Outlook_FR_Attributes#1](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Attributes/FormRegion1.cs#1)]

 Атрибуты должны соответствовать приведенным ниже рекомендациям:

- Для пользовательских классов сообщений, используйте полностью определенное имя класса сообщений (например: «НАЧАЛЬНИК. Note.Contoso»).

- Сама по себе не указать класса сообщений (например: «НАЧАЛЬНИК»).

- Не превышает 256 символов для каждого имя класса сообщений.

- Не включать имена стандартных классов сообщений, если область формы заменяет всю форму или на странице по умолчанию формы. Можно указать имена стандартных классов сообщений только для форм, добавьте новую страницу в форму или, добавляются в нижнюю часть формы. Дополнительные сведения см. в разделе [Как Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).

  Visual Studio проверяет формат имен классов сообщений при построении проекта.

> [!NOTE]
> Visual Studio не выполняет проверку правильности или допустимости имен классов сообщений, которые вы указываете.

## <a name="see-also"></a>См. также
- [Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)
- [Создание областей форм Outlook](../vsto/creating-outlook-form-regions.md)
- [Пошаговое руководство: Разработка области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md)
- [Рекомендации для создания областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)
- [Имя формы и классов сообщений Обзор](/office/vba/outlook/Concepts/Forms/form-name-and-message-class-overview)
- [О совместной работе форм Outlook и элементов](/office/vba/outlook/Concepts/Forms/how-outlook-forms-and-items-work-together)
