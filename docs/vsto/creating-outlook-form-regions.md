---
title: Создание областей форм Outlook
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- MICROSOFT.OFFICE.TOOLS.OUTLOOK.FORMREGION
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- form regions [Office development in Visual Studio]
- form regions [Office development in Visual Studio], creating
- Outlook [Office development in Visual Studio], form regions
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: dc0f56331c11c6c33561774d38ef79e286a4133a
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63445570"
---
# <a name="create-outlook-form-regions"></a>Создание областей форм Outlook
  Для настройки форм Microsoft Office Outlook можно использовать области формы. Visual Studio предоставляет расширенные средства, которые упрощают процесс проектирования, разработки и отладки областей формы.

 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]

 В данном разделе содержатся следующие сведения:

- [Преимущества использования областей формы](#Enhance)

- [Добавление области формы Outlook в проект](#Adding)

- [Использовать конструктор областей формы](#UsingFormRegionDesigner)

- [Использовать области формы, спроектированной в Outlook](#UsingFormRegionDesignedOutlook)

- [Добавление пользовательского кода в область формы](#AddingCustomCode)

- [Построение проекта](#Building)

- [Отладка области формы](#Debugging)

- [Развертывание области формы](#Deploying)

## <a name="Enhance"></a> Преимущества использования областей формы
 Области формы значительно расширяют традиционные возможности разработки форм Outlook.

- Настройка страницы по умолчанию любой стандартной формы.

- Добавление до 12 дополнительных страниц в любую стандартную форму.

- Замена или расширение любой стандартной формы.

- Отображение настраиваемого пользовательского интерфейса в области чтения и в инспекторах.

  Дополнительные сведения см. в разделе [настройка страниц формы и областей форм](/office/vba/outlook/Concepts/Forms/customizing-form-pages-and-form-regions).

## <a name="Adding"></a> Добавление области формы Outlook в проект
 Можно использовать **новая область формы Outlook** мастер позволяет создавать новую область формы или импортировать область формы, разработанной в Outlook. Кроме того, если у вас есть область формы, которую вы использовали в другом проекте надстройки Outlook VSTO, то эту область формы можно использовать повторно.

### <a name="CreatingFormRegion"></a> Создание новой области формы с помощью мастера
 Чтобы создать область формы, добавьте **область формы Outlook** элемента в проект надстройки Outlook VSTO. Запустится **новая область формы Outlook** мастера.

 Укажите в мастере, что необходимо сделать — создать новую область формы или импортировать область формы, спроектированную в Outlook. Дополнительные сведения о проектировании новой области формы см. в разделе [использовать конструктор областей формы](#UsingFormRegionDesigner). Дополнительные сведения об использовании области формы, спроектированной в Outlook см. в разделе [Импорт области формы, спроектированной в Outlook](#UsingFormRegionDesignedOutlook).

 Укажите в мастере тип области формы, которую требуется создать. В следующей таблице указаны все типы областей формы.

|Тип области|Описание|
|-----------------|-----------------|
|Отдельные|Добавляет область формы как новую страницу в форме Outlook.|
|Смежные|Добавляет область формы в нижнюю часть страницы по умолчанию формы Outlook.|
|Замена|Добавляет область формы как новую страницу, которая заменяет страницу по умолчанию формы Outlook.|
|Заменить все|Заменяет всю форму Outlook на область формы.|

 В мастере также можно указать условия отображения и выбрать тип формы для расширения. Дополнительные сведения см. в разделе [Как Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).

 Значения, выбираемые в мастере, влияют на параметры, доступные на других страницах мастера. Например, если вы выберите **прилегающая** или **отдельные** в **новая область формы Outlook** страницы, то **Title** и **Описание** поля недоступны в **введите текст описания и выберите параметры отображения** страницы. Это объясняется тем, что при отображении смежной или отдельной области формы Outlook не использует эти поля.

#### <a name="form-region-files"></a>Файлы области формы
 При заполнении **новая область формы Outlook** мастера, Visual Studio автоматически добавляет следующие файлы в проект:

- Файл кода области формы. Этот файл имеет имя, указанное для **область формы Outlook** элемент **Добавление нового элемента** диалоговое окно. Добавьте код для обработки событий области формы в этот файл.

- Файл кода конструктора областей формы. Этот файл содержит код, созданный конструктором областей формы (его не следует изменять прямо в файле).

- Хранилища форм Outlook (*.ofs*) файла.

    > [!NOTE]
    > Этот файл добавляется в проект только при импорте области формы, которая была спроектирована в Outlook.

#### <a name="form-region-factory-class"></a>Класс фабрики областей формы
 Файл кода области формы содержит разделяемый класс, реализующий интерфейс <xref:Microsoft.Office.Tools.Outlook.IFormRegionFactory>. Это класс фабрики областей формы. Класс фабрики областей формы отвечает за создание новых экземпляров области формы.

 Этот класс можно найти, развернув **фабрика областей формы** регион.

 **Новая область формы Outlook** мастер добавляет атрибуты этого класса, укажите внутреннее имя области формы и классы сообщений, отображающих области формы. Эти атрибуты можно изменять вручную после добавления файла в проект.

 Основная часть класса фабрики областей формы реализована в файле конструктора областей формы. Однако обработчик событий `FormRegionInitializing` предоставляется в файле кода области формы. Этот обработчик событий можно использовать, чтобы указать, должен ли Outlook отображать область формы. Дополнительные сведения см. в разделе [обработки событий области формы](#HandlingFormRegionEvents).

### <a name="AddingExistingFormRegion"></a> Добавление существующей области формы в проект
 Если у вас есть область формы Outlook, которую вы использовали в другом проекте Outlook, ее можно повторно использовать в текущем проекте надстройки Outlook VSTO с помощью диалогового окна **Добавление существующего элемента** .

 Существующая область формы должна иметь файл кода (*.vb* или *.cs*); не удается добавить Outlook Form Storage (*.ofs*) файлов с помощью **добавить существующий элемент** диалоговое окно. Тем не менее новую область формы можно создать путем импорта файла хранилища форм Outlook. Дополнительные сведения см. в разделе [Как Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).

## <a name="UsingFormRegionDesigner"></a> Использовать конструктор областей формы
 Конструктор областей формы позволяет спроектировать макет и внешний вид области формы. Перетащите управляемых элементов управления в область конструктора, дважды щелкните элементы управления, чтобы открыть обработчики событий и задание свойств в **свойства** окна.

> [!NOTE]
> Имеются свойства, влияющие на внешний вид области формы в Outlook под **манифеста** узел в **свойства** окна.

 Конструктор областей формы доступен только в том случае, если выбрать **создать новую область формы** в **выберите способ создания области формы** странице **новая область формы Outlook** мастер.

 Чтобы открыть конструктор областей формы, можно использовать три способа.

- В **обозревателе решений**, дважды щелкните файл кода области формы.

- В **обозревателе решений**, щелкните правой кнопкой мыши файл кода области формы и нажмите кнопку **конструктор представлений**.

- В **обозревателе решений**, выберите файл кода области формы, а затем на **представление** меню, щелкните **конструктор**.

  Конструктор областей формы поддерживает только управляемые элементы управления. Добавлять собственные элементы управления Outlook нельзя.

## <a name="UsingFormRegionDesignedOutlook"></a> Импорт области формы, спроектированной в Outlook
 В ходе проектирования в Outlook в область формы можно добавлять собственные элементы управления Outlook. Собственные элементы управления Outlook позволяют осуществлять привязку к данным Outlook во время разработки. Тем не менее для добавления управляемых элементов управления или изменения структуры области формы конструктор областей формы использовать нельзя.

 Можно импортировать областей формы в проект надстройки Outlook VSTO с помощью **новая область формы Outlook** мастера. На **выберите способ создания области формы** выберите **импортировать файл хранилища форм Outlook (OFS)**. Затем можно перейти к расположение файла хранилища форм Outlook (*.ofs*) файла. (Outlook сохраняет области формы как *.ofs* файлов.)

 **Новая область формы Outlook** мастер копирует *.ofs* файл в каталог проекта и добавляет ссылки на файл конструктора областей формы элементы управления. Затем события элементов управления можно обработать в файле кода области формы.

 Для обработки событий в проекте Visual Basic выберите событие в списке имен методов в верхней части редактора кода.

 Для обработки событий в проекте C# подпишитесь на события элементов управления в методе <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing>. Дополнительные сведения см. в разделе [Как Подписаться на и Отмена подписки на события &#40;C&#35; руководство по программированию&#41;](/dotnet/csharp/programming-guide/events/how-to-subscribe-to-and-unsubscribe-from-events).

 Свойства области формы можно изменить в методе `InitializeManifest` класса фабрики областей формы.

> [!NOTE]
> Для импорта области формы необходимо работать в проекте, ориентированном на ту же версию Outlook, которая установлена на компьютере разработчика. Например, если у вас установлен Outlook 2010, Импорт формы области будет работать только в проекте был создан с помощью **надстройка Outlook 2010** шаблона проекта.

### <a name="update-an-imported-form-regions-design"></a>Обновить импортированной области формы в разработки
 Элементы управления можно добавлять, удалять или изменять в области формы. Перед этим следует создать резервную копию любого кода, добавленного в файл кода области формы. Затем откройте *.ofs* в Outlook, измените область формы и затем сохраните изменения. Используйте **новая область формы Outlook** мастер для импорта измененного *.ofs* файл. Затем код можно вставить в файл кода новой области формы.

## <a name="AddingCustomCode"></a> Добавление пользовательского кода в область формы
 Пространство имен <xref:Microsoft.Office.Tools.Outlook> предоставляет доступ к классам, которые представляют область формы, элемент Outlook, отображающий область формы, и другие полезные элементы. **Область формы Outlook** автоматически добавляет в проект ссылку на эту сборку и вставляет соответствующий **с помощью** или **Imports** инструкция в верхней части файл кода области формы.

 Для выполнения большинства задач программирования для Outlook можно использовать классы, методы и свойства в пространстве имен `Microsoft.Office.Interop.Outlook`. Дополнительные сведения об объектной модели Outlook см. в разделе [обзор объектной модели Outlook](../vsto/outlook-object-model-overview.md). Примеры типичных задач, в которых используется объектная модель Outlook, см. в разделе [решения Outlook](../vsto/outlook-solutions.md).

### <a name="HandlingFormRegionEvents"></a> Обработка событий области формы
 **Область формы Outlook** автоматически добавляет три следующих обработчика событий в файле кода области формы.

|событие|Описание|
|-----------|-----------------|
|FormRegionInitializing|Возникает перед инициализацией области формы. В этом обработчике событий можно проверять условия, чтобы указать, должен ли Outlook отображать область формы. Дополнительные сведения см. в разделе [Как Запретить отображение области формы Outlook](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md).|
|FormRegionShowing|Возникает после создания экземпляра области формы, но перед отображением области формы.|
|FormRegionClosed|Возникает перед закрытием области формы.|

## <a name="Building"></a> Построение проекта
 При сборке проекта надстройки Outlook VSTO, содержащего область формы, Visual Studio добавляет в реестр следующую информацию.

- Раздел для каждого класса сообщений, связанного с одной или несколькими областями формы.

- Запись для каждой области формы и соответствующее значение, представляющее имя надстройки Outlook VSTO.

  Outlook использует эту информацию для загрузки областей формы.

## <a name="Debugging"></a> Отладка области формы
 Надстройку Outlook VSTO, содержащую область формы, можно отлаживать таким же образом, как и другие проекты [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]. При запуске отладчика [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Visual Studio автоматически запускает Outlook.

 Для просмотра области формы необходимо открыть соответствующий элемент Outlook. Например, если смежная область формы добавляется в конец почтового элемента, откройте почтовый элемент.

## <a name="Deploying"></a> Развертывание области формы
 Области формы автоматически развертываются вместе со связанной надстройкой Outlook VSTO. Таким образом, для развертывания области формы никакие специальные действия выполнять не нужно. Дополнительные сведения о развертывании надстроек VSTO см. в разделе [развертывание решения Office](../vsto/deploying-an-office-solution.md).

## <a name="related-topics"></a>См. также

|Заголовок|Описание|
|-----------|-----------------|
|[Рекомендации для создания областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)|Представлены сведения, которые могут помочь оптимизировать области формы и предотвратить потенциальные проблемы.|
|[Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)|Демонстрируется создание области формы для расширения стандартной или настраиваемой формы Microsoft Office Outlook с помощью **новая область формы Outlook** мастера.|
|[Связывание области формы с классом сообщений Outlook](../vsto/associating-a-form-region-with-an-outlook-message-class.md)|Объясняется, как указать элементы Microsoft Office Outlook, которые будут отображать область формы, путем связывания области формы с классом сообщений каждого элемента.|
|[Пошаговое руководство: Разработка области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md)|Показано, как проектировать настраиваемую область формы, которая отображается в виде новой страницы в окне инспектора элемента контактов.|
|[Пошаговое руководство: Импорт области формы, разработанной в Outlook](../vsto/walkthrough-importing-a-form-region-that-is-designed-in-outlook.md)|Демонстрируется создание области формы в Microsoft Office Outlook, а затем импорт области формы в проект надстройки Outlook VSTO с помощью **новая область формы Outlook** мастера.|
|[Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)|Описывается написание кода для отображения, скрытия или изменения элементов управления в области формы. Пользователям предоставляется возможность выполнить код из других областей проекта с помощью класса `Globals`.|
|[Практическое руководство. Запретить отображение области формы Outlook](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md)|Показано, как запретить в Microsoft Office Outlook отображение области формы для конкретного элемента.|
|Показано, как получить доступ к элементу Outlook, в котором отображается область формы.|
|[Пользовательские действия в областях формы Outlook](../vsto/custom-actions-in-outlook-form-regions.md)|Описывает, как предоставить пользователям возможность реагировать на элемент Outlook.|
