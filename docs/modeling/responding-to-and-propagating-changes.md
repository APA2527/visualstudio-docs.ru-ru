---
title: Реагирование на изменения и их распространение
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Domain-Specific Language, events
author: JoshuaPartlow
ms.author: joshuapa
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 96342abce736f18d79f89b9441d9b53c068cbecf
ms.sourcegitcommit: 9d2829dc30b6917e89762d602022915f1ca49089
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/30/2020
ms.locfileid: "91583896"
---
# <a name="respond-to-and-propagate-changes"></a>Реагирование и распространение изменений

При создании, удалении или обновлении элемента можно написать код, который распространяет изменения на другие части модели или на внешние ресурсы, такие как файлы, базы данных или другие компоненты.

## <a name="reference"></a>Справочник

В качестве рекомендации рассмотрите следующие методы в следующем порядке:

|Метод|Сценарии|Дополнительные сведения|
|-|-|-|
|Определите вычисляемое свойство домена.|Свойство домена, значение которого вычисляется на основе других свойств модели. Например, Цена, которая является суммой цен связанных элементов.|[Вычисляемые и пользовательские свойства хранилища](../modeling/calculated-and-custom-storage-properties.md)|
|Определите пользовательское свойство домена хранилища.|Свойство предметной области, хранящееся в других частях модели или извне. Например, можно выполнить синтаксический анализ строки выражения в дереве модели.|[Вычисляемые и пользовательские свойства хранилища](../modeling/calculated-and-custom-storage-properties.md)|
|Переопределение обработчиков изменений, таких как онвалуечангинг и reby|Обеспечьте синхронизацию различных элементов и Обеспечьте синхронизацию внешних значений с моделью.<br /><br /> Ограничьте значения до определенных диапазонов.<br /><br /> Вызывается непосредственно до и после значения свойства и других изменений. Можно завершить изменение, вызывая исключение.|[Обработчики изменений значений свойств доменов](../modeling/domain-property-value-change-handlers.md)|
|Правила|Можно определить правила, которые помещаются в очередь на выполнение непосредственно перед окончанием транзакции, в которой произошло изменение. Они не выполняются при отмене или повторе. Используйте их, чтобы синхронизировать одну часть магазина с другой.|[Правила распространяют изменения в пределах модели](../modeling/rules-propagate-changes-within-the-model.md)|
|Сохранить события|Хранилище моделирования предоставляет уведомления о событиях, таких как добавление или удаление элемента или ссылки, а также изменение значения свойства. Событие также выполняется для операций отмены и повтора. Используйте события магазина для обновления значений, отсутствующих в хранилище.|[Обработчики событий распространяют изменения за пределы модели](../modeling/event-handlers-propagate-changes-outside-the-model.md)|
|События .NET|Фигуры имеют обработчики событий, реагирующие на щелчки мыши и другие жесты. Необходимо зарегистрировать эти события для каждого объекта. Регистрация обычно выполняется в переопределении Инитиализеинстанцересаурцес и должна выполняться для каждого элемента.<br /><br /> Эти события обычно происходят за пределами транзакции.|[Практическое руководство. Перехват щелчка фигуры или декоратора](../modeling/how-to-intercept-a-click-on-a-shape-or-decorator.md)|
|Правила границ|Правило границ используется специально для ограничения границ фигуры.|[Класс BoundsRules ограничивает расположение и размеры фигур](../vs-2015/modeling/boundsrules-constrain-shape-location-and-size.md?view=vs-2015&preserve-view=true)|
|Правила выбора|Правила выбора специально ограничивают то, что может выбрать пользователь.|[Практическое руководство. Предоставление и ограничение доступа к текущему выделению](../modeling/how-to-access-and-constrain-the-current-selection.md)|
|онассокатедпропертичанжед|Указывает состояния элементов модели с помощью функций фигур и соединителей, таких как тень, стрелки, цвет и толщина линии и стиль.|[Обновление фигур и соединителей в соответствии с моделью](../modeling/updating-shapes-and-connectors-to-reflect-the-model.md)|

## <a name="compare-rules-and-store-events"></a>Сравнение правил и сохранение событий

Изменение уведомлений, правил и событий выполняется при внесении изменений в модель.

Правила обычно применяются к завершающей транзакции, в которой произошло изменение, а события применяются после фиксации изменений в транзакции.

Используйте события хранилища для синхронизации модели с объектами за пределами хранилища и правилами для поддержания согласованности в хранилище.

- **Создание настраиваемых правил** Пользовательское правило создается как производный класс от абстрактного правила. Кроме того, необходимо уведомить платформу о настраиваемом правиле. Дополнительные сведения см. [в разделе правила распространяют изменения в модели](../modeling/rules-propagate-changes-within-the-model.md).

- **Подписка на события** Прежде чем можно будет подписываться на событие, создайте обработчик событий и делегат. Затем используйте <xref:Microsoft.VisualStudio.Modeling.Store.EventManagerDirectory%2A> свойство для подписки на событие. Дополнительные сведения см. в разделе " [обработчики событий" распространяют изменения за пределы модели](../modeling/event-handlers-propagate-changes-outside-the-model.md).

- **Отмена изменений** При отмене транзакции создаются события, но правила не применяются. Если правило изменяет значение и отменяет это изменение, оно сбрасывается до исходного значения во время действия отмены. При возникновении события необходимо вручную восстановить исходное значение. Дополнительные сведения о транзакциях и их отмене см. в разделе [как использовать транзакции для обновления модели](../modeling/how-to-use-transactions-to-update-the-model.md).

- **Передача аргументов событий в правила и события** Событиям и правилам передается `EventArgs` параметр со сведениями о том, как изменилась модель.

## <a name="see-also"></a>См. также

- [Практическое руководство. Перехват щелчка фигуры или декоратора](../modeling/how-to-intercept-a-click-on-a-shape-or-decorator.md)
- [Написание кода для настройки предметно-ориентированного языка](../modeling/writing-code-to-customise-a-domain-specific-language.md)