---
title: Реагирование на изменения и их распространение
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Domain-Specific Language, events
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: a1d58ede1370976147b33cf1246f8b582adb3c5b
ms.sourcegitcommit: 6a19c5ece38a70731496a38f2ef20676ff18f8a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/09/2019
ms.locfileid: "65476603"
---
# <a name="respond-to-and-propagate-changes"></a>Обработка и распространение изменений

Когда элемент создания, удаления или обновления, можно написать код, который распространяет изменения на другие части модели, или на внешние ресурсы, такие как файлы, базы данных или других компонентов.

## <a name="reference"></a>Ссылка

Как правило рассмотрите следующие варианты в следующем порядке:

|Метод|Сценарии|Дополнительные сведения|
|-|-|-|
|Определите вычисляемое свойство домена.|Свойство домена, значение которого вычисляется на основе других свойств в модели. Например цена, которая является суммой цен связанных элементов.|[Вычисляемые и пользовательские свойства хранилища](../modeling/calculated-and-custom-storage-properties.md)|
|Определите свойство домена пользовательского хранилища.|Свойство домена, хранящиеся в других частей модели или внешнем доступе. Например можно проанализировать строку выражения в виде дерева в модели.|[Вычисляемые и пользовательские свойства хранилища](../modeling/calculated-and-custom-storage-properties.md)|
|Переопределить обработчики изменений, таких как OnValueChanging и методы OnDeleting|Синхронизировать различные элементы и синхронизировать внешних значений с моделью.<br /><br /> Ограничения значений для определенных диапазонов.<br /><br /> Вызывается непосредственно перед и после значения свойства и другие изменения. Изменения можно прервать путем создания исключения.|[Обработчики изменений значений свойств доменов](../modeling/domain-property-value-change-handlers.md)|
|Правила|Можно определить правила, которые поставлены в очередь для выполнения только до окончания транзакции, в котором произошло изменение. Они не выполняются на отмены или повтора. Их следует используйте для синхронизации одной из частей хранилище с другим.|[Правила распространяют изменения в пределах модели](../modeling/rules-propagate-changes-within-the-model.md)|
|События Store|Хранилище моделирования предоставляет уведомления о событиях, таких как добавление или удаление элемента или ссылки или изменение значения свойства. Это событие также выполняется на действия отмены и повтора. Используйте события хранилища для обновления значения, которые не находятся в хранилище.|[Обработчики событий распространяют изменения за пределы модели](../modeling/event-handlers-propagate-changes-outside-the-model.md)|
|События .NET|Фигуры имеют обработчики событий, которые отвечают на щелчки мышью и других жестов. Вам необходимо зарегистрировать для этих событий для каждого объекта. Регистрация это обычно делается в переопределение InitializeInstanceResources и должны выполняться для каждого элемента.<br /><br /> Эти события обычно происходят вне транзакции.|[Практическое руководство. Перехват щелчка фигуры или декоратора](../modeling/how-to-intercept-a-click-on-a-shape-or-decorator.md)|
|Правила границ|Правило границ используется специально для границы фигуры.|[Класс BoundsRules ограничивает расположение и размеры фигур](/visualstudio/modeling/boundsrules-constrain-shape-location-and-size?view=vs-2015)|
|Правила выбора|Правила выбора ограничить, пользователь может выбрать.|[Практическое руководство. Предоставление и ограничение доступа к текущему выделению](../modeling/how-to-access-and-constrain-the-current-selection.md)|
|OnAssocatedPropertyChanged|Показывают состояния с элементами модели, с помощью функции фигур и соединителей, таких как тени, стрелки, цвет и толщины и стиля.|[Обновление фигур и соединителей в соответствии с моделью](../modeling/updating-shapes-and-connectors-to-reflect-the-model.md)|

## <a name="compare-rules-and-store-events"></a>Сравнить правила и хранения событий

Изменение notifiers, правила и события, выполняются при внесении изменений в модели.

Правила обычно применяются на конечная транзакция, в котором произошло изменение, и события применяются после фиксации изменений в транзакции.

Используйте события хранилища для синхронизации модели с объектами за пределами Store и правила для поддержания согласованности в Store.

- **Создание настраиваемых правил** создайте настраиваемое правило как производный класс из абстрактного правила. Также необходимо уведомить framework о настраиваемое правило. Дополнительные сведения см. в разделе [распространение изменений в модели правил](../modeling/rules-propagate-changes-within-the-model.md).

- **Подписка на события** перед подпиской на событие, создайте обработчик события и делегата. Затем с помощью <xref:Microsoft.VisualStudio.Modeling.Store.EventManagerDirectory%2A>свойство подписаться на событие. Дополнительные сведения см. в разделе [обработчики распространения изменений за пределами модели событий](../modeling/event-handlers-propagate-changes-outside-the-model.md).

- **Отмена изменений** отмены транзакции, событий, однако не применяются. Если правило изменяет значение и отменить это изменение, то значение сбрасывается к исходному значению во время выполнения действия отмены. При возникновении события, необходимо вручную изменить значение обратно в исходное значение. Дополнительные сведения о транзакции и отката, см. в разделе [как: Использование транзакций для обновления модели](../modeling/how-to-use-transactions-to-update-the-model.md).

- **Передача аргументов событий для правила и события** обоих событий и передаются правила `EventArgs` параметр, который содержит сведения о том, как модель изменена.

## <a name="see-also"></a>См. также

- [Практическое руководство. Перехват щелчка фигуры или декоратора](../modeling/how-to-intercept-a-click-on-a-shape-or-decorator.md)
- [Написание кода для настройки доменного языка](../modeling/writing-code-to-customise-a-domain-specific-language.md)
