---
title: Обработка текстовых шаблонов с помощью пользовательского хост-класса
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, in application or VS extension
- text templates, custom directive hosts
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: f054bd91f16bb7621d4beebe7631a49cb406132e
ms.sourcegitcommit: 2da366ba9ad124366f6502927ecc720985fc2f9e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/09/2019
ms.locfileid: "68870475"
---
# <a name="process-text-templates-by-using-a-custom-host"></a>Обработка текстовых шаблонов с помощью пользовательского основного приложения

Процесс *преобразования текстовых шаблонов* принимает текстовый файл *шаблона* в качестве входных данных и создает текстовый файл в качестве выходных данных. Модуль преобразования текста можно вызвать из расширения Visual Studio или из автономного приложения, работающего на компьютере, на котором установлена программа Visual Studio. Однако необходимо предоставить *узел текстовых шаблонов*. Этот класс подключает шаблон к среде, находя ресурсы, такие как сборки и включаемые файлы, и работает с выводом и сообщениями об ошибках.

> [!TIP]
> Если вы пишете пакет или расширение, которое будет выполняться в Visual Studio, рассмотрите возможность использования службы текстовых шаблонов вместо написания собственного узла. Дополнительные сведения см. [в разделе вызов преобразования текста в расширении VS](../modeling/invoking-text-transformation-in-a-vs-extension.md).

> [!NOTE]
> Преобразования текстовых шаблонов не рекомендуется использовать в серверных приложениях. Преобразования текстовых шаблонов не рекомендуется использовать, когда выполняется более одного потока. Это объясняется тем, что модуль текстовых шаблонов многократно использует один домен приложения для преобразования, компиляции и выполнения шаблонов. Потокобезопасность преобразованного кода не предусмотрена. Механизм предназначен для обработки файлов последовательно, так как они находятся в проекте Visual Studio во время разработки.
>
> Для приложений времени выполнения рассмотрите возможность использования предварительно обработанных текстовых шаблонов: см. статью [Создание текста во время выполнения с помощью текстовых шаблонов T4](../modeling/run-time-text-generation-with-t4-text-templates.md).

Если приложение использует набор шаблонов, фиксированных во время выполнения, проще использовать предварительно преобразованные текстовые шаблоны. Этот подход также можно использовать, если приложение будет выполняться на компьютере, на котором не установлен Visual Studio. Дополнительные сведения см. [в разделе Создание текста во время выполнения с помощью текстовых шаблонов T4](../modeling/run-time-text-generation-with-t4-text-templates.md).

## <a name="execute-a-text-template-in-your-application"></a>Выполнение текстового шаблона в приложении

Для выполнения текстового шаблона следует вызвать метод ProcessTemplate класса <xref:Microsoft.VisualStudio.TextTemplating.Engine?displayProperty=fullName>:

```csharp
using Microsoft.VisualStudio.TextTemplating;
...
Engine engine = new Engine();
string output = engine.ProcessTemplate(templateString, host);
```

 Приложение должно найти и предоставить этот шаблон, а также принять вывод.

 В параметре `host` необходимо предоставить класс, реализующий [ITextTemplatingEngineHost](/previous-versions/visualstudio/visual-studio-2012/bb126505(v=vs.110)). Он вызывается процессором шаблонов.

 Основное приложение должно быть способно протоколировать ошибки, разрешать ссылки на сборки и включаемые файлы. предоставлять домен приложения, в котором может выполняться шаблон, и вызывать подходящий процессор для каждой директивы.

 <xref:Microsoft.VisualStudio.TextTemplating.Engine?displayProperty=fullName>определен в **Microsoft. VisualStudio.TextTemplating.\*. 0. dll**и [итексттемплатинженгинехост](/previous-versions/visualstudio/visual-studio-2012/bb126505(v=vs.110)) определены в **Microsoft. VisualStudio. TextTemplating. interfaces.\*. 0. dll**.

## <a name="in-this-section"></a>В этом разделе
 [Пошаговое руководство: Создание узла](../modeling/walkthrough-creating-a-custom-text-template-host.md) пользовательского текстового шаблона показывает, как создать пользовательский узел текстовых шаблонов, который делает функциональность текстового шаблона доступной за пределами Visual Studio.

## <a name="reference"></a>Ссылка
 [итексттемплатинженгинехост](/previous-versions/visualstudio/visual-studio-2012/bb126505(v=vs.110))

## <a name="related-sections"></a>Связанные разделы

- [Процесс преобразования текстовых шаблонов](../modeling/the-text-template-transformation-process.md) описывает, как работает преобразование текста и какие части можно настраивать.
- [Создание пользовательских обработчиков директив текстовых шаблонов T4](../modeling/creating-custom-t4-text-template-directive-processors.md) предоставляет общие сведения о процессорах директив текстовых шаблонов.