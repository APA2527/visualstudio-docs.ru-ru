---
title: Пошаговое руководство. Профилирование из командной строки с помощью выборки | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- profiling tools, walkthroughs
- performance tools, walkthroughs
- performance tools, command-line tools
author: mikejo5000
ms.author: mikejo
manager: jillfra
monikerRange: vs-2017
ms.workload:
- multiple
ms.openlocfilehash: 09272c8cf2dff02d3be024b9c3eeab8b51f56df7
ms.sourcegitcommit: 00b71889bd72b6a566586885bdb982cfe807cf54
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/03/2019
ms.locfileid: "74777976"
---
# <a name="walkthrough-command-line-profiling-using-sampling"></a>Пошаговое руководство. Профилирование из командной строки с помощью выборки

В этом пошаговом руководстве показано, как выполнить профилирование приложения с помощью программ командной строки и выборки для выявления проблем производительности.

В руководстве приводится пошаговое описание процесса профилирования управляемого приложения с помощью программ командной строки. Для поиска и определения проблем производительности приложения используется выборка.

В этом пошаговом руководстве выполняются следующие действия:

- профилирование приложения с помощью программ командной строки и выборки;
- анализ результатов профилирования с выборкой для выявления и исправления проблем производительности.

## <a name="prerequisites"></a>Предварительные требования

- Средний уровень знания [!INCLUDE[csharp_current_short](../misc/includes/csharp_current_short_md.md)].
- Средний уровень навыков работы с программами командной строки.
- Копия [примера PeopleTrax](performance-explorer.md).
- Для работы со сведениями, полученными при профилировании, рекомендуется включить отладочные символы.

## <a name="command-line-profiling-using-the-sampling-method"></a>Профилирование из командной строки с помощью метода выборки

Выборка — это метод профилирования, при котором конкретный процесс периодически опрашивается с целью определения активной функции. Полученные данные показывают, как часто функция находилась на вершине стека вызовов при выборочном опросе процесса.

> [!NOTE]
> Сведения о пути к Средствам профилирования см. в статье [Указание пути к программам командной строки средств профилирования](../profiling/specifying-the-path-to-profiling-tools-command-line-tools.md). На 64-разрядных компьютерах доступны 64- и 32-разрядные версии этих программ. Для использования программ командной строки профилировщика необходимо добавить путь к программам в переменную среды PATH окна командной строки или в саму команду.

### <a name="to-profile-the-peopletrax-application-by-using-the-sampling-method"></a>Профилирование приложения PeopleTrax с помощью метода выборки

1. Установите пример приложения PeopleTrax и выполните сборку окончательной версии приложения.

2. Откройте командную строку и добавьте каталог средств профилирования в локальную переменную среды Path.

3. Измените рабочую папку на каталог, содержащий двоичные файлы PeopleTrax.

4. Установите соответствующие переменные среды с помощью следующей команды:

    ```cmd
    VSPerfCLREnv /sampleon
    ```

5. Начните профилирование, запустив файл *VSPerfCmd.exe*, который является программой командной строки для управления профилировщиком. Запуск приложения и профилировщика в режиме выборки выполняется следующей командой:

    ```cmd
    VsPerfCmd /start:sample /output:PeopleTraxReport.vsp /launch:PeopleTrax.exe
    ```

     Процесс профилировщика запускается и присоединяется к процессу *PeopleTrax.exe*. Процесс профилировщика начинает запись собранных данных профилирования в файл отчета.

6. Щелкните **Get People** (Получить пользователей).

7. Щелкните **Export Data** (Экспорт данных).

     В Блокноте откроется новый файл, содержащий данные, экспортированные из приложения **PeopleTrax**.

8. Закройте Блокнот и приложение **PeopleTrax**.

9. Завершите работу профилировщика. Введите следующую команду:

    ```cmd
    VSPerfCmd /shutdown
    ```

10. Сбросьте переменные среды с помощью следующей команды:

    ```cmd
    VSPerfCLREnv /sampleoff
    ```

11. Данные профилирования хранятся в *VSP-файле*. Проанализировать результаты можно одним из указанных ниже способов.

    - Откройте *VSP*-файл в интегрированной среде разработки Visual Studio.

         Или...

    - Создайте файл значений, разделенных запятыми (*CSV*), с помощью программы командной строки *VSPerfReport.exe*. Для создания отчетов с целью использования вне интегрированной среды разработки [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] используйте следующую команду:

        ```cmd
        VSPerfReport <dir> PeopleTraxReport.vsp /output:<dir> /summary:all
        ```

## <a name="see-also"></a>См. также

[Общие сведения о сеансе анализа производительности](../profiling/performance-session-overview.md)
[Профиль из командной строки](../profiling/using-the-profiling-tools-from-the-command-line.md)
[VSPerfCmd](../profiling/vsperfcmd.md)
[Общие сведения о значениях выборочных данных](../profiling/understanding-sampling-data-values.md)
[Представления отчетов о производительности](../profiling/performance-report-views.md)
