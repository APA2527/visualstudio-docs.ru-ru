---
title: Устранение неполадок эмулятора для Android | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: tgt-pltfrm-cross-plat
ms.topic: troubleshooting
ms.assetid: f3fb5df4-3aae-40e4-9450-bbe15b0c5af5
caps.latest.revision: 25
ms.author: crdun
manager: crdun
ms.openlocfilehash: 27f69a3295deb8d3335878acc865314635af7c0e
ms.sourcegitcommit: a77158415da04e9bb8b33c332f6cca8f14c08f8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2020
ms.locfileid: "86387308"
---
# <a name="troubleshooting-the-visual-studio-emulator-for-android"></a>Troubleshooting the Visual Studio Emulator for Android
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

В этом разделе содержатся сведения об устранении проблем, которые могут возникать при использовании эмулятора Visual Studio для Android.

> [!WARNING]
> Когда эмулятор установлен, программа установки проверяет наличие необходимых компонентов для запуска программного обеспечения. Если необходимые компоненты не установлены, она отображает предупреждения, но он не требует их установки.

 Эта тема описана в следующих разделах.

- [Перед началом](#BeforeYouStart)

- [Не удается запустить эмулятор](#NoInstall)

- [Не удается подключиться к сетевым пунктам назначения в домене или в корпоративной сети](#DomainNetwork)

- [Не удается подключиться к сетевым пунктам назначения, если параметры сети необходимо настраивать вручную](#ManualNetworkConfig)

- [Эмулятор запускается медленно, не запускается из-за истечения времени ожидания, или развертывание приложения завершается с ошибкой](#SlowStart)

- [Не удается запустить эмулятор](#NoStart2)

- [Emulator fails to start (first use)](#NoStart)

- [Компьютер не загружается после установки эмулятора](#NoBoot)

- [Visual Studio зависает при попытке развернуть приложение в эмуляторе, или эмулятор не отображается как целевой объект отладки в других IDE](#ADB)

- [Эмулятор перестает отвечать, так как ему не удалось настроить UDP-порт](#XamarinPlayer)

- [Не удается подключить отладчик к проекту Xamarin](#Skylake)

- [Эмулятор не может запустить приложение, которое использует Сервисы Google Play](#GooglePlay)

- [Перетаскивание файла, APK или ZIP-файла с поддержкой флэш-памяти не работает](#DragAndDrop)

- [Неверное разрешение снимка экрана](#Resolution)

- [Эмулятор не может преобразовать контент OpenGL для просмотра](#OpenGL)

- [Эмулятор не реагирует на мультисенсорные жесты](#Multitouch)

- [Ресурсы поддержки](#Support)

## <a name="before-you-start"></a><a name="BeforeYouStart"></a> Перед началом
 Прежде чем приступить к устранению проблем, может оказаться полезным ознакомиться со следующими разделами:

- [Требования к системе для эмулятора Visual Studio для Android](../cross-platform/system-requirements-for-the-visual-studio-emulator-for-android.md)

## <a name="emulator-fails-to-install"></a><a name="NoInstall"></a> Не удается запустить эмулятор
 Если не установлен Hyper-V, появится следующее сообщение при попытке установить эмулятор. Необходимо иметь компьютер, поддерживающий Hyper-v, который должен быть включен.

 ![Android&#95;Emu&#95;Install&#95;Issue](../cross-platform/media/android-emu-install-issue.png "Android_Emu_Install_Issue")

> [!NOTE]
> Это сообщение относится к эмулятору Visual Studio для Android и к эмулятору Windows Phone. Windows 8.1 и Windows 10 поддерживают эмулятор.

 Если вы видите это сообщение, проверьте [требования к системе для эмулятора Visual Studio для Android](../cross-platform/system-requirements-for-the-visual-studio-emulator-for-android.md) , чтобы узнать, можно ли запустить эмулятор.

## <a name="cannot-connect-to-network-destinations-on-a-domain-or-corporate-network"></a><a name="DomainNetwork"></a> Не удается подключиться к сетевым пунктам назначения в домене или в корпоративной сети
 Эмулятор Visual Studio для Android отображается в сети как отдельное устройство с собственным IP-адресом. Он не присоединен к домену Windows и не использует учетные данные домена или рабочей группы совместно с главным компьютером.

 Если для сети требуется проверка подлинности домена или рабочей группы для базовой сети и подключения к Интернету, попросите ИТ-администратора сделать исключение. Такое исключение позволяет использовать компьютер разработчика в качестве граничного компьютера и принимать на нем подключения от сетевых устройств, не присоединенных к домену, например, от эмулятора.

 Эмулятор Visual Studio для Android также использует свой собственный набор MAC-адресов. Если из эмулятора нет доступа к сети или Интернет-ресурсам, обратитесь к ИТ-администратору, чтобы авторизовать MAC-адреса эмулятора сети.

#### <a name="to-view-the-emulators-mac-addresses"></a>Просмотр MAC-адресов эмулятора

1. Запустите эмулятор.

2. На панели инструментов эмулятора нажмите кнопку шеврона (>>), чтобы открыть окно «Дополнительные средства».

3. В этом окне перейдите на вкладку «Сеть».

4. На странице «Сеть» найдите физические адреса.

## <a name="cannot-connect-to-network-destinations-when-network-settings-require-manual-configuration"></a><a name="ManualNetworkConfig"></a> Не удается подключиться к сетевым пунктам назначения, если параметры сети необходимо настраивать вручную
 Чтобы подключаться к сетевым пунктам назначения из эмулятора, сеть должна отвечать следующим требованиям:

- DHCP. Эмулятору требуется DHCP, так как он настраивается сам как отдельное устройство в сети с собственным IP-адресом.

- Автоматически настраиваемые параметры DNS и шлюза. Вручную настраивать параметры DNS и шлюза для эмулятора нельзя.

  Если для сети требуется настроить параметры вручную, попросите своего ИТ-администратора уточнить способ включения подключения к сети для эмулятора.

## <a name="emulator-starts-slowly-fails-to-start-due-to-a-timeout-or-app-deployment-fails"></a><a name="SlowStart"></a> Эмулятор запускается медленно, не запускается из-за истечения времени ожидания, или развертывание приложения завершается с ошибкой
 При определенных условиях запуск эмулятора занимает несколько минут, либо при его запуске происходит сбой из-за истечения времени ожидания. Если запустить эмулятор не удается, появляется следующее сообщение: `App deployment failed. Please try again`. Эта ошибка может происходить по следующим причинам.

- Запуск эмулятора Visual Studio для Android с загрузочного виртуального жесткого диска. Эта конфигурация не поддерживается.

- Неисправный жесткий диск. Рекомендуется запустить программу chkdsk.

- Жесткий диск необходимо дефрагментировать. Рекомендуется выполнить дефрагментацию диска.

- Жесткий диск почти полностью заполнен. Проверьте объем свободного места на диске.

- Не хватает памяти из-за других работающих приложений. Сократите количество приложений, которые потребляют память, или увеличьте объем памяти.

- В целом, любой фактор, который приводит к снижению производительности системы. Начните устранение неполадок с компонента, имеющего наименьший показатель в индексе производительности Windows, который можно найти на странице «Счетчики и средства производительности» на панели управления.

## <a name="emulator-fails-to-start"></a><a name="NoStart2"></a> Не удается запустить эмулятор
 Если эмулятор ранее работал, но теперь не работает, выполните следующие действия. Если эмулятор используется впервые, см. раздел [Emulator fails to start (first use)](#NoStart) перед выполнением следующих действий.

- Удалите все прочие экземпляры Hyper-V эмулятора.

    1. Закройте Visual Studio.

    2. Откройте диспетчер и остановите все экземпляры Hyper-V эмулятора (виртуальные машины), которые уже работают и, возможно, находятся в поврежденном состоянии.

    3. В диспетчере Hyper-V удалите все другие виртуальные машины эмулятора.

    4. Перезагрузите компьютер.

- Убедитесь, что у вас есть системная память емкостью не менее 4 ГБ, и что она не используется другими ресурсоемкими приложениями и процессами (например, попробуйте закрыть окна браузера).

- В диспетчере Hyper-V откройте диспетчер виртуальных коммутаторов и проверьте наличие двух сетевых коммутаторов. Убедитесь, один из них является внутренним, а второй — внешним.

     ![Android&#95;Emu&#95;V&#95;Switch&#95;Man](../cross-platform/media/android-emu-v-switch-man.png "Android_Emu_V_Switch_Man")

     Если программа установки неправильна и вы используете Windows 10, попробуйте [переустановить сетевые устройства с помощью команды Netcfg – d](https://support.microsoft.com/help/10741/windows-fix-network-connection-issues) (раздел 6).

- Если эти шаги не решат проблему, см. раздел [Emulator fails to start (first use)](#NoStart) для получения сведений о программном обеспечении сторонних производителей, которое может мешать работе эмулятора.

## <a name="emulator-fails-to-start-first-use"></a><a name="NoStart"></a> Emulator fails to start (first use)
 Если не удается запустить эмулятор, выполните следующие задачи, чтобы определить проблему и устранить ее.

- Убедитесь, что соблюдены минимальные требования к оборудованию и применяются корректные параметры BIOS.

   Для эмулятора и Windows 8 Hyper-V требуется 64-разрядный процессор с преобразованием адресов второго уровня (SLAT). Для Intel вам потребуется, в частности, процессор Core i3, i5 или i7 (или один из многих вариантов Xeon). Список микросхем AMD см. [здесь](https://www.amd.com/en/support).

  1. Убедитесь, что ваш компьютер удовлетворяет [требованиям к системе](../cross-platform/system-requirements-for-the-visual-studio-emulator-for-android.md).

  2. Убедитесь, что [средство SLAT](https://slatstatuscheck.codeplex.com/) сообщает, что компьютер поддерживает SLAT.

  3. В области параметров BIOS компьютера убедитесь, что вся технология виртуализации включена. Производители оборудования могут использовать разное описание BIOS. Как правило, необходимо включить функции, связанные со следующими технологиями:

     - SLAT (преобразование адресов второго уровня)

     - EPT (таблицы Extended Page Tables) (Intel)

     - NPT (таблицы Nested Page Tables) (AMD)

     - RVI (Rapid Virtualization Indexing) (AMD)

     - VMX (сокращение компании Intel, указывающее на аппаратную поддержку виртуализации)

     - SVM (сокращение компании AMD, указывающее на аппаратную поддержку виртуализации)

     - XD (Execute Disable) (Intel); данный параметр необходимо включить

     - NX (No Execute)(AMD); данный параметр необходимо включить

  4. Если в BIOS имеются следующие параметры, отключите их.

     - Отключить Intel VT-d

     - Отключить Trusted Execution

       Дополнительные сведения см. в статье: Technet: Hyper-V: How to Fix BIOS Errors Enabling Hyper-V (Как исправлять ошибки BIOS с помощью Hyper-V)

  5. Убедитесь, что у вас есть системная память емкостью не менее 4 ГБ, и что она не используется другими ресурсоемкими приложениями и процессами.

  6. Убедитесь, что на вашем компьютере установлена ОС Windows 8 Профессиональная или более высокая версия (Windows Server 2008 не поддерживается). Windows Server 2012 поддерживается, но необходимо включить возможности рабочего стола.

     Чтобы определить наличие ошибок гипервизора, воспользуйтесь средством просмотра событий. Для этого откройте средство просмотра событий (нажмите клавишу START+R, затем введите `eventvwr`) и выберите **Журналы Windows**, **Система**. Затем выполните фильтрацию журнала по источнику события. Для этого для источника установите значение **Hyper-V-Hypervisor**. Проверьте наличие ошибок, чтобы попытаться установить основную причину.

     Если ваш процессор удовлетворяет минимальным требованиям, но гипервизор по-прежнему не работает, выясните, имеется ли обновление BIOS для вашего компьютера. Если такое обновление существует, и вы решили выполнить процедуру обновления, обязательно соблюдайте все меры предосторожности, предписанные производителем для обновления BIOS (например, необходимо исключить перебои электропитания в процессе обновления встроенного ПО BIOS, так как это может привести к повреждению BIOS).

- Убедитесь, что у вас есть системная память емкостью не менее 4 ГБ, и что она не используется другими ресурсоемкими приложениями и процессами.

- Удалите или отключите драйверы или программное обеспечение сторонних производителей, которое может мешать работе виртуальной сети.

   Применительно к ряду продуктов сторонних производителей, установленных в ОС Windows 8, существуют некоторые известные проблемы, например, с сетевыми драйверами и протоколами, которые не полностью совместимы с сетевым стеком Hyper-V.

   Как правило, именно разработчики этих продуктов должны обновить свое программное обеспечение, чтобы обеспечить совместимость с Windows 8 и Hyper-V.

   Обновление для обеспечения совместимости с Windows 8 может потребоваться для следующих продуктов: VirtualBox, Virtual PC 7, VMWare, некоторых клиентов VPN, программных брандмауэров, некоторых версий клиентов Cisco VPN и других систем виртуализации. Поддерживайте связь с разработчиками нестабильно работающего программного обеспечения виртуализации. Убеждайте их обновлять программное обеспечение, чтобы оно было полностью совместимым с Windows 8 и Hyper-V.

   В качестве **решения**можно отключить все драйверы и приложения сторонних производителей, которые могут мешать работе виртуальной сети, используемой эмулятором для взаимодействия с Visual Studio. К таким приложениям могут относиться:

  - Антивирусные приложения (которые взаимодействуют с сетевым стеком)

  - Инструменты мониторинга сети

  - Инструменты ведения сетевых журналов

  - Другое программное обеспечение мониторинга системы

    Данную проблему можно попытаться решить по-другому, не прибегая к удалению конкретного продукта (и не предлагая разработчику выпустить обновленную версию), если выполнить следующие действия.

  1. Запустите диспетчер сетевых подключений (на начальном экране введите `View Network Connections` и выберите этот параметр, чтобы просмотреть сетевые подключения).

  2. Для адаптера vEthernet (Внутренний порт Ethernet —  эмулятор Windows Phone, внутренний коммутатор) выберите **Свойства** в контекстном меню.

      ![Виртуальный адаптер, используемый клиентом Hyper&#45;V](../cross-platform/media/android-emu-virtual-adapter.png "Android_Emu_Virtual_Adapter")

      Здесь показаны свойства адаптера.

      ![Свойства виртуального адаптера](../cross-platform/media/android-emu-virtual-adapter-properties.png "Android_Emu_Virtual_Adapter_Properties")

  3. Для этого адаптера в списке **Это подключение использует следующие компоненты** необходимо выбрать только следующие элементы:

     - Клиент для сетей Microsoft

     - Планировщик пакетов QoS

     - Служба доступа к файлам и принтерам сетей Microsoft

     - Драйвер протокола LLDP (Майкрософт)

     - Драйвер в/в обнаружения топологии канального уровня

     - Отвечающее устройство обнаружения топологии канального уровня

     - Протокол Интернета версии 6 (TCP/IPv6)

     - Протокол Интернета версии 4 (TCP/IPv4)

  4. Снимите флажки у всех других элементов.

     Недостаток данного метода заключается в том, что указанную выше процедуру нужно будет повторять каждый раз, когда новый продукт стороннего производителя установит неподдерживаемые драйверы, или каждый раз, когда будет установлен эмулятор.

     После удаления продуктов сторонних производителей может потребоваться восстановление внутреннего коммутатора эмулятора Windows Phone. Для этого выполните указанные далее действия.

  - Откройте Hyper-V и перейдите в диспетчер виртуальных коммутаторов. Создайте виртуальный коммутатор с именем «Внутренний коммутатор эмулятора Windows Phone» и для типа соединения установите значение **Внутренняя сеть**.

     ![Диспетчер виртуальных коммутаторов](../cross-platform/media/android-emu-virtual-switch-manager.png "Android_Emu_Virtual_Switch_Manager")

    Теперь запустите эмулятор. Он должен работать.

## <a name="computer-fails-to-boot-after-installing-the-emulator"></a><a name="NoBoot"></a> Компьютер не загружается после установки эмулятора
 Эта проблема может возникнуть при следующих условиях:

- На компьютере установлена системная плата Gigabyte.

- На этой плате включен USB3.

  Чтобы решить эту проблему, отключите USB3 в настройках BIOS для системной платы и перезагрузите компьютер. Затем убедитесь, что компания Gigabyte выпустила обновление BIOS для своей системной платы.

  Дополнительные сведения см. в следующей статье базы знаний: [Boot failure after installation of Hyper-V role on Gigabyte systems (Сбой загрузки после установки роли Hyper-V в системах Gigabyte)](https://support.microsoft.com/kb/2693144).

## <a name="visual-studio-gets-stuck-trying-to-deploy-the-app-to-the-emulator-or-the-emulator-does-not-appear-as-a-debug-target-in-other-ides"></a><a name="ADB"></a> Visual Studio зависает при попытке развернуть приложение в эмуляторе, или эмулятор не отображается как целевой объект отладки в других IDE
 Если эмулятор работает, но не подключен к ADB (мост отладки Android) или не виден в средствах Android, которые используют ADB (например, Android Studio или Eclipse), возможно, вам потребуется изменить место поиска ADB эмулятором. Эмулятор использует раздел реестра для определения базового расположения пакета SDK для Android и выполняет поиск файла \platform-tools\adb.exe в этом каталоге. Чтобы изменить путь к пакету SDK для Android, используемому эмулятором, выполните следующие действия:

- Откройте редактор реестра: выберите **Запуск** в контекстном меню кнопки Пуск, введите `regedit` в диалоговом окне и нажмите кнопку **ОК**.

- Перейдите в раздел HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Android SDK Tools в дереве папок слева.

- Измените значение переменной реестра **Путь** (оно должно соответствовать пути к пакету SDK для Android).

  Перезапустите эмулятор. Теперь эмулятор должен быть подключен к ADB и связанным средствам Android.

## <a name="emulator-stops-responding-because-it-couldnt-set-up-the-udp-port"></a><a name="XamarinPlayer"></a>Эмулятор перестает отвечать, так как ему не удалось настроить UDP-порт
 Эта проблема может возникнуть из-за несовместимости с Xamarin Player. Если эмулятор перестает отвечать на запросы или появляется сообщение об ошибке "эмулятор не может подключиться к операционной системе устройства: не удалось настроить UDP-порт.  Некоторые функциональные возможности могут быть недоступны". Выполните следующие действия.

1. Удалите Xamarin Player.

2. Убедитесь в удалении виртуального окна (Xamarin Player работает на базе виртуального окна).

3. Перейдите в диспетчер устройств, выберите параметр отображения скрытых устройств и удалите все, кроме физических сетевых карт.

4. Можно попробовать удалить и повторно установить Hyper-V после удаления любого нефизического сетевого адаптера.

## <a name="cannot-attach-debugger-to-a-xamarin-project"></a><a name="Skylake"></a> Не удается подключить отладчик к проекту Xamarin
 При запуске Windows 10 на процессорах Intel Skylake приложений Xamarin могут завершаться со сбоем в эмуляторе либо к ним может не подключаться отладчик Visual Studio. Это вызвано проблемой, связанной с Hyper-V и процессорами Skylake. Чтобы избежать этого, выполните указанные ниже действия.

1. Откройте диспетчер Hyper-V и выберите виртуальную машину для профиля эмулятора, который вы используете.

2. Выберите **Удаление сохраненного состояния** (внизу справа).

3. Выберите **Параметры...**

4. Разверните узел процессора и выберите **Совместимость**.

5. Включите параметр **Выполнить перенос на физический компьютер с другой версией процессора**.

6. Перезапустите службу (в разделе **Действия**) и повторите попытку.

## <a name="emulator-fails-to-run-app-that-uses-google-play-services"></a><a name="GooglePlay"></a> Эмулятор не может запустить приложение, которое использует Сервисы Google Play
 Эмулятор не поставляется вместе с библиотеками для служб Google Play. Тем не менее, эмулятор поддерживает установку ZIP-файлов с поддержкой флэш-памяти в режиме перетаскивания.

## <a name="drag-and-drop-of-a-file-apk-or-flashable-zip-file-does-not-work"></a><a name="DragAndDrop"></a> Перетаскивание файла, APK или ZIP-файла с поддержкой флэш-памяти не работает
 Эмулятор использует файл ADB.exe для упрощения передачи файла при его перетаскивании на экран. При попытке перетащить файл возникает ошибка. Это указывает, что эмулятор, возможно, не подключен к ADB.exe. Чтобы решить, выполните действия в [Visual Studio зависает при попытке развернуть приложение в эмуляторе, или эмулятор не отображается как целевой объект отладки в других IDE](#ADB).

## <a name="resolution-of-screenshot-is-incorrect"></a><a name="Resolution"></a> Неверное разрешение снимка экрана
 Если вы делаете снимок экрана с помощью вкладки «Экран» в окне **Дополнительные средства** , но полученное изображение имеет непредвиденный размер, возможно, необходимо изменить уровень масштаба экрана перед нажатием кнопки **Захват**. Эмулятор получает снимки экрана с разрешением экрана, установленным на мониторе главного компьютера.

## <a name="emulator-fails-to-render-opengl-content"></a><a name="OpenGL"></a> Эмулятор не может преобразовать содержимое OpenGL для просмотра
 Эмулятор отображает контент OpenGL с помощью графического процессора главного компьютера и использует проект ANGLE для преобразования этих вызовов в DirectX и из него. Если приложение правильно отображается на устройстве, но неправильно на эмуляторе, то возможная проблема заключается в том, что устройство подавляет некорректный вызов OpenGL (например, с помощью переменных шейдера, которые не совпадают друг с другом).

## <a name="emulator-does-not-respond-to-multi-touch-gestures"></a><a name="Multitouch"></a> Эмулятор не реагирует на мультисенсорные жесты
 В некоторых случаях эмулятор может запускаться, но не отвечать на мультисенсорные жесты, выполняемые либо непосредственно на сенсорном экране, либо с помощью мультисенсорного средства на панели инструментов эмулятора. Если это так, нажмите кнопку **Поворот** на панели инструментов эмулятора и попытайтесь снова использовать мультисенсорное средство. Если проблема сохранится, читайте проблему [Эмулятор не может преобразовать контент OpenGL для просмотра](#OpenGL) .

## <a name="support-resources"></a><a name="Support"></a> Ресурсы поддержки
 Если главный компьютер отвечает требованиям к системе и возникают проблемы, не описанные в этом руководстве по устранению неполадок:

- Задать вопрос об использовании StackOverflow с помощью тегов [android-emulator](https://stackoverflow.com/questions/tagged/android-emulator) и visual-studio.

- сообщите о проблеме с помощью средства отправки одобрения в Visual Studio или в диспетчере эмуляторов.
