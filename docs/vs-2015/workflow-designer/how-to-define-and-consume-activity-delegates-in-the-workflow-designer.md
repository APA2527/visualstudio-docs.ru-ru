---
title: Руководство. Определение и использование делегатов действий в конструктор рабочих процессов | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-workflow-designer
ms.topic: reference
ms.assetid: c68e42ad-3ec0-4c2d-b104-fe36c6d83b5e
caps.latest.revision: 3
author: steved0x
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 26ba92a2ba7aa6eed471383c875104549e896804
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72603854"
---
# <a name="how-to-define-and-consume-activity-delegates-in-the-workflow-designer"></a>Как определить и использовать делегатов действий в конструкторе рабочих процессов
[!INCLUDE[net_v45](../includes/net-v45-md.md)] содержит новый готовый конструктор для действия <xref:System.Activities.Statements.InvokeDelegate>. Данный конструктор можно использовать в целях назначения делегатов для действия, производного от <xref:System.Activities.ActivityDelegate>, такого как <xref:System.Activities.ActivityAction> или <xref:System.Activities.ActivityFunc%601>.

### <a name="define-an-activity-delegate"></a>Укажите делегат действия

1. В [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)] выберите **файл**, **создать**, **проект**. Выберите узел **рабочего процесса** слева и шаблон **консольное приложение рабочего процесса** справа. Присвойте проекту имя (при необходимости) и нажмите кнопку **ОК**.

2. Щелкните правой кнопкой мыши проект в **Обозреватель решений** и выберите **Добавить**, **новый элемент...** . Выберите узел **рабочего процесса** слева и шаблон **действия** справа. Назовите новое действие **MyForEach. XAML** и нажмите кнопку **ОК**. Действие откроется в конструкторе рабочих процессов.

3. В конструкторе рабочих процессов перейдите на вкладку **аргументы** .

4. Нажмите кнопку **Создать аргумент**. Назовите новые **элементы**аргументов.

5. В столбце **тип аргумента** выберите **массив [T]** .

6. В браузере типов выберите **объект**. Нажмите кнопку **ОК**.

7. Нажмите кнопку **Создать аргумент** еще раз. Назовите новый **текст**аргумента. В столбце **направление** для нового аргумента выберите **свойство**.

8. В столбце Тип аргумента выберите **Обзор типов...**

9. В браузере типов введите **действия ActivityAction** в поле **имя типа** . Выберите **действия activityaction \<T >** в представлении в виде дерева. Выберите **объект** в раскрывающемся списке, в котором будет присвоено значение type **действия ActivityAction \<Object >** аргументу.

10. Перетащите действие <xref:System.Activities.Statements.While> из раздела **поток управления** области элементов в область конструктора.

11. Выберите действие <xref:System.Activities.Statements.While> и перейдите на вкладку **переменные** .

12. Выберите **создать переменную**. Назовите новый **индекс**переменной.

13. В столбце **тип переменной** выберите **Int32**. Оставьте **область** как **while**, а столбец **по умолчанию** — пустым.

14. Задайте для свойства **Condition** действия <xref:System.Activities.Statements.While> значение **индексировать < элементы. length;** .

15. Перетащите <xref:System.Activities.Statements.InvokeDelegate> действие из раздела **примитивы** области элементов в **тело** действия <xref:System.Activities.Statements.While>.

16. Выберите **текст** в раскрывающемся списке делегат.

17. В сетке **свойств** для действия <xref:System.Activities.Statements.InvokeDelegate> щелкните **...** в свойстве **аргументы делегата** .

18. В столбце **значение** аргумента именованный **аргумент**введите **элементы [index]** . Нажмите кнопку **ОК** , чтобы закрыть диалоговое окно **DelegateArguments** .

19. Перетащите действие <xref:System.Activities.Statements.Assign> на горизонтальную линию под действием <xref:System.Activities.Statements.InvokeDelegate>. Будет создано действие <xref:System.Activities.Statements.Assign>, и будет автоматически создано <xref:System.Activities.Statements.Sequence> действие, содержащее два действия в разделе **Body** действия **MyForEach** . Последовательность необходима, поскольку раздел **Body** может содержать только одно действие. Автоматическое создание нового действия <xref:System.Activities.Statements.Sequence> - это новая функция [!INCLUDE[net_v45](../includes/net-v45-md.md)].

20. Присвойте свойству **для** действия <xref:System.Activities.Statements.Assign> значение **index**. Установите свойство **value** действия **Assign** в значение **index + 1**.

    Настраиваемое действие **MyForEach** теперь будет вызывать произвольное действие по одному разу для каждого значения, переданного в него через коллекцию **Items** , со значениями в коллекции в качестве входных данных для действия.

### <a name="use-the-custom-activity-in-a-workflow"></a>Использование настраиваемого действия в рабочем процессе

1. Постройте проект, нажав клавиши **CTRL + SHIFT + B**.

2. В **Обозреватель решений**откройте в конструкторе **Workflow1. XAML** .

3. Перетащите действие **MyForEach** из области элементов в область конструктора. Действие находится в разделе области элементов с тем же именем, что и проект.

4. Задайте для свойства **Items** действия **MyForEach** значение **новый объект [] {1, "ABC"}** .

5. Перетащите <xref:System.Activities.Statements.WriteLine> действие из раздела **примитивы** области элементов в раздел **делегат: Body** действия **MyForEach** .

6. Задайте для свойства **Text** действия <xref:System.Activities.Statements.WriteLine> значение **Argument. ToString ()** .

   При выполнении рабочего процесса в консоли отобразится следующее:

   **1** 
   **ABC**