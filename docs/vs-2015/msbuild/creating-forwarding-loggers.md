---
title: Создание средства ведения журнала переадресации | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: msbuild
ms.topic: conceptual
helpviewer_keywords:
- MSBuild, forwarding loggers
- MSBuild, logging
ms.assetid: 3aebf9c8-b62c-4cb2-b2d6-8cdfcd369a24
caps.latest.revision: 12
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: ecc9bae7176c0d8c0f79452baff87a7a697db459
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MTE95
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "68184030"
---
# <a name="creating-forwarding-loggers"></a>Создание средства ведения журнала переадресации
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Средства ведения журнала переадресации повышают эффективность ведения журналов, позволяя выбрать события, которые требуется отслеживать при сборке проектов в многопроцессорной системе. Включив эти средства ведения журнала переадресации, можно предотвратить переполнение центрального средства ведения журнала нежелательными событиями, замедление сборки и загромождение журнала.  
  
 Чтобы создать средство ведения журнала переадресации, можно либо реализовать интерфейс <xref:Microsoft.Build.Framework.IForwardingLogger> и вручную реализовать его методы либо использовать класс <xref:Microsoft.Build.BuildEngine.ConfigurableForwardingLogger> и его предварительно настроенные методы. (Последний вариант подойдет для большинства приложений.)  
  
## <a name="register-events-and-respond-to-them"></a>Регистрация событий и реагирование на них  
 Средство ведения журнала переадресации собирает сведения о событиях сборки, о которых сообщает вторичный обработчик сборки, который представляет собой рабочий процесс, созданный основным процессом сборки во время сборки в многопроцессорной системе. Затем это средство выбирает события журнала, которые следует переадресовать в центральное средство ведения журнала в соответствии с заданными вами инструкциями.  
  
 Для обработки событий, которые требуется отслеживать, нужно зарегистрировать средство ведения журнала переадресации. Чтобы зарегистрироваться для событий, средства ведения журнала должны переопределить метод <xref:Microsoft.Build.Utilities.Logger.Initialize%2A>. Сейчас этот метод имеет необязательный параметр `nodecount`, в котором можно указать число процессоров в системе. (По умолчанию это значение равно 1.)  
  
 Примерами событий, которые вы можете отслеживать, являются <xref:Microsoft.Build.Framework.IEventSource.TargetStarted>, <xref:Microsoft.Build.Framework.IEventSource.ProjectStarted> и <xref:Microsoft.Build.Framework.IEventSource.ProjectFinished>.  
  
 В многопроцессорной среде сообщения о событиях часто принимаются в неправильном порядке. Поэтому нужно оценить события с помощью обработчика событий в средстве ведения журнала переадресации и запрограммировать его, чтобы определить, какие события нужно передавать в перенаправитель для переадресации на центральное средство ведения журнала. Для этого можно использовать класс <xref:Microsoft.Build.Framework.BuildEventContext>, прикрепленный к каждому сообщению, который поможет определить события для переадресации, после чего передайте имена событий в класс <xref:Microsoft.Build.BuildEngine.ConfigurableForwardingLogger> (или его подкласс). При использовании этого метода для переадресации событий не требуется писать специальный код.  
  
## <a name="specify-a-forwarding-logger"></a>Указание средства ведения журнала переадресации  
 Когда средство ведения журнала переадресации скомпилировано в сборку, нужно передать в [!INCLUDE[vstecmsbuild](../includes/vstecmsbuild-md.md)] информацию о том, что это средство ведения журнала следует использовать во время сборки. Для этого используйте параметры `/FileLogger`, `/FileLoggerParameters` и `/DistributedFileLogger` вместе с MSBuild.exe. Параметр `/FileLogger` сообщает MSBuild.exe, что средство ведения журнала подключен напрямую. Параметр `/DistributedFileLogger` означает, что файл журнала присутствует на каждом узле. Чтобы задать параметры средства ведения журнала переадресации, используйте параметр `/FileLoggerParameters`. Дополнительные сведения об этих и других параметрах MSBuild.exe см. в [справочнике по командной строке](../msbuild/msbuild-command-line-reference.md).  
  
## <a name="multi-processor-aware-loggers"></a>Средства ведения журнала с поддержкой многопроцессорности  
 При сборке проекта в многопроцессорной системе сообщения о сборке от каждого процессора не чередуются автоматически в определенной последовательности. Вместо этого нужно назначить приоритет группирования сообщений с помощью класса <xref:Microsoft.Build.Framework.BuildEventContext>, который присоединяется к каждому сообщению. Дополнительные сведения о сборке в многопроцессорной среде см. в разделе [Ведение журнала в многопроцессорной среде](../msbuild/logging-in-a-multi-processor-environment.md).  
  
## <a name="see-also"></a>См. также  
 [Получение журналов построения](../msbuild/obtaining-build-logs-with-msbuild.md)   
 [Средства ведения журнала сборки](../msbuild/build-loggers.md)   
 [Ведение журнала в многопроцессорной среде](../msbuild/logging-in-a-multi-processor-environment.md)
