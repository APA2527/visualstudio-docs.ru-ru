---
title: Работа с данными метрик кода | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-code-analysis
ms.topic: conceptual
f1_keywords:
- vs.codemetrics.output
helpviewer_keywords:
- code metrics results
- code metrics results window
- results window, code metrics
ms.assetid: 988193ec-b4a3-4e11-b5a1-7334979807d5
caps.latest.revision: 19
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 3c2460b4e8b9e0b9043178989fcf8825815471be
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "72645704"
---
# <a name="working-with-code-metrics-data"></a>Работа с данными метрик кода
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

В окне **Результаты метрик кода** отображаются данные, формируемые анализом метрик кода. Дополнительные сведения о значениях данных метрик кода см. в разделе [значения метрик кода](../code-quality/code-metrics-values.md).

 Этот раздел состоит из следующих подразделов.

- [Окно результатов метрик кода](../code-quality/working-with-code-metrics-data.md#BKMK_CodeMetricsResultsWindow)

- [Отображение результатов метрик кода](../code-quality/working-with-code-metrics-data.md#BKMK_DisplayingCodeMetricsResults)

- [Фильтрация результатов метрик кода](../code-quality/working-with-code-metrics-data.md#BKMK_FilteringCodeMetricsResults)

- [Добавление, удаление и изменение порядка столбцов данных](../code-quality/working-with-code-metrics-data.md#BKMK_AddingRemovingandRearrangingDataColumns)

- [Копирование данных в буфер обмена или Excel](../code-quality/working-with-code-metrics-data.md#BKMK_Copying_Data_to_the_Clipboard_or_Excel)

- [Создание рабочего элемента на основе результатов метрик кода](../code-quality/working-with-code-metrics-data.md#BKMK_Creating_a_Work_Item_Based_on_Code_Metric_Results)

## <a name="code-metrics-results-window"></a><a name="BKMK_CodeMetricsResultsWindow"></a> Code Metrics Results Window
 Окно **результатов метрик кода** содержит панель инструментов в верхней части и столбцы для вывода вычисляемых результатов.

|Столбец|Описание|
|------------|-----------------|
|**Иерархия**|Столбец **Иерархия** содержит дерево иерархии кода, которое можно развернуть или свернуть, чтобы просмотреть нужный уровень детализации. В остальных столбцах отображаются вычисляемые результаты. Столбцы результатов можно скрывать или упорядочивать по своему необходимости.|
|**Удобство обслуживания**|Столбец **сопровождаемости** содержит значок в дополнение к числовому результату. Зеленый значок обозначает относительно высокую степень сопровождаемости. Желтый значок указывает на умеренную степень сопровождаемости. Красный значок обозначает низкую сопровождаемость и потенциальные проблемы. Эти цветовые индикаторы соответствуют категориям серьезности, используемым правилом FxCop Авоидунмаинтаинаблекоде. Это правило выдает ошибку, если индекс удобства обслуживания меньше 10, предупреждение, если индекс находится в диапазоне от 10 до 20 и не является ни ошибкой, ни предупреждением, если индекс больше 20. Индекс удобства обслуживания — это синтез трех метрик: сложностью организации циклов сложность, строки кода и сложность вычислений. Его значения не выражаются в единицах.|

## <a name="displaying-code-metrics-results"></a><a name="BKMK_DisplayingCodeMetricsResults"></a> Отображение результатов метрик кода
 Окно результатов метрик кода отображается автоматически при формировании результатов метрик кода. Окно также можно отобразить в любое время.

#### <a name="to-display-the-code-metrics-results-window"></a>Отображение окна «Результаты метрик кода»

- В меню **анализ** выберите пункт **окна** и щелкните **Результаты метрик кода**.

     \- или -

- В меню **вид** укажите пункт **другие окна** и выберите пункт **Результаты метрик кода**.

     Окно Результаты метрик кода отображается даже в том случае, если оно не содержит результатов.

#### <a name="to-view-code-metrics-details"></a>Просмотр сведений о метриках кода

- Если результаты метрик кода были сформированы, разверните дерево в столбце **Иерархия** .

## <a name="filtering-code-metrics-results"></a><a name="BKMK_FilteringCodeMetricsResults"></a> Фильтрация результатов метрик кода
 Результаты, отображаемые в окне **результатов метрик кода** , можно отфильтровать с помощью панели инструментов в верхней части окна. Например, может потребоваться просмотреть только результаты с индексом обслуживания ниже 65.

 Раскрывающийся список **Фильтр** содержит имена столбцов результатов. При определении фильтра он добавляется в конец списка вместе с отступом. Список может содержать последние десять фильтров, которые были определены.

#### <a name="to-filter-the-code-metrics-results"></a>Фильтрация результатов метрик кода

1. В списке **Фильтр** выберите имя столбца.

2. В поле **min (минимум**) введите минимальное отображаемое значение.

3. В поле **Макс**введите максимальное отображаемое значение.

4. Нажмите кнопку **Применить фильтр** .

5. Чтобы просмотреть сведения о результатах, разверните дерево иерархии.

## <a name="adding-removing-and-rearranging-data-columns"></a><a name="BKMK_AddingRemovingandRearrangingDataColumns"></a> Добавление, удаление и изменение порядка столбцов данных
 Столбцы «результаты» можно добавлять и удалять из окна « **Результаты метрик кода** ». Кроме того, можно изменить порядок столбцов результатов так, чтобы они отображались в нужном порядке.

#### <a name="to-remove-a-column"></a>Удаление столбца

1. Нажмите кнопку **Добавить или удалить столбцы** .

     \- или -

     Щелкните правой кнопкой мыши заголовок любого столбца и выберите команду **Добавить или удалить столбцы**.

2. В диалоговом окне **Добавление или удаление столбцов** снимите флажок напротив столбца, который необходимо удалить, и нажмите кнопку **ОК**.

#### <a name="to-add-a-previously-removed-column"></a>Добавление ранее удаленного столбца

1. Нажмите кнопку **Добавить или удалить столбцы** .

     \- или -

     Щелкните правой кнопкой мыши заголовок любого столбца и выберите команду **Добавить или удалить столбцы**.

2. В диалоговом окне **Добавление или удаление столбцов** установите флажок напротив столбца, который необходимо добавить, а затем нажмите кнопку **ОК**.

#### <a name="to-rearrange-columns"></a>Изменение порядка столбцов

1. Нажмите кнопку **Добавить или удалить столбцы** .

     \- или -

     Щелкните правой кнопкой мыши заголовок любого столбца и выберите команду **Добавить или удалить столбцы**.

2. В диалоговом окне **Добавление или удаление столбцов** выберите столбец, который необходимо переместить, а затем щелкните стрелку вверх или стрелку вниз.

3. Если столбец расположен в нужном месте, нажмите кнопку **ОК**.

## <a name="copying-data-to-the-clipboard-or-excel"></a><a name="BKMK_Copying_Data_to_the_Clipboard_or_Excel"></a> Копирование данных в буфер обмена или Excel
 Вы можете выбрать и скопировать выбранную строку данных метрик кода в буфер обмена как текстовую строку, содержащую одну строку для имени и значения каждого столбца данных. Можно также нажать кнопку **Открыть список в Microsoft Excel** , чтобы экспортировать все результаты метрик кода в электронную таблицу Excel.

## <a name="creating-a-work-item-based-on-code-metric-results"></a><a name="BKMK_Creating_a_Work_Item_Based_on_Code_Metric_Results"></a> Создание рабочего элемента на основе результатов метрик кода
 Вы можете создать [!INCLUDE[esprfound](../includes/esprfound-md.md)] Рабочий элемент на основе результатов в окне **Результаты метрик кода** . При создании рабочего элемента [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] автоматически вводит заголовок в поле **заголовок** и данные метрик кода на вкладке **Журнал** .

 Дополнительные сведения о создании рабочих элементов см. в разделе [Создание рабочего элемента &#91;перенаправлено&#93;](https://msdn.microsoft.com/24b2e064-16ac-4bf0-8de4-98a1f48b8c4b).

#### <a name="to-create-a-work-item-based-on-a-result"></a>Создание рабочего элемента на основе результата

1. Щелкните результат правой кнопкой мыши.

2. Наведите указатель мыши на пункт **создать рабочий элемент**, а затем выберите тип рабочего элемента, который необходимо создать (**Ошибка**, **задача**и т. д.).

3. Заполните форму рабочего элемента, заполнив все обязательные поля.

4. В меню **файл** выберите команду **сохранить все** , чтобы сохранить рабочий элемент.

#### <a name="to-create-a-bug-based-on-a-result"></a>Создание ошибки на основе результата

1. Щелкните результат, чтобы выбрать его.

2. Нажмите кнопку **создать рабочий элемент** .

3. Заполните форму рабочего элемента, заполнив все обязательные поля.

4. В меню **файл** выберите команду **сохранить все** , чтобы сохранить рабочий элемент.

## <a name="see-also"></a>См. также:
 [Измерение сложности и удобства поддержки управляемого кода](../code-quality/measuring-complexity-and-maintainability-of-managed-code.md) создание [данных метрик кода](../code-quality/how-to-generate-code-metrics-data.md)
