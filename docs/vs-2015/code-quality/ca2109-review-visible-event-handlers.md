---
title: 'CA2109: Просмотр видимых обработчиков событий | Документация Майкрософт'
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-code-analysis
ms.topic: reference
f1_keywords:
- CA2109
- ReviewVisibleEventHandlers
helpviewer_keywords:
- ReviewVisibleEventHandlers
- CA2109
ms.assetid: 8f8fa0ee-e94e-400e-b516-24d8727725d7
caps.latest.revision: 20
author: jillre
ms.author: jillfra
manager: wpickett
ms.openlocfilehash: 3ddcab6e0f416837bcd7b01521a6d77ddce691b9
ms.sourcegitcommit: b885f26e015d03eafe7c885040644a52bb071fae
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/30/2020
ms.locfileid: "85520982"
---
# <a name="ca2109-review-visible-event-handlers"></a>CA2109. Проверьте видимые обработчики событий
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

|Item|Значение|
|-|-|
|TypeName|ReviewVisibleEventHandlers|
|CheckId|CA2109|
|Категория|Microsoft.Security|
|Критическое изменение|Критическое|

## <a name="cause"></a>Причина
 Обнаружен открытый или защищенный метод обработки событий.

## <a name="rule-description"></a>Описание правила
 Внешний видимый метод обработки событий представляет собой проблемы безопасности, требующие проверки.

 Методы обработки событий следует раскрывать только в тех случаях, когда это совершенно необходимо. Обработчик событий, тип делегата, который вызывает предоставленный метод, может быть добавлен к любому событию при условии, что сигнатуры обработчика и события совпадают. События потенциально могут вызываться любым кодом и часто вызываются в системном коде с высоким уровнем доверия в ответ на действия пользователя, такие как нажатие кнопки. Добавление проверки безопасности в метод обработки событий не мешает коду зарегистрировать обработчик событий, который вызывает метод.

 Запрос не может надежно защищать метод, вызываемый обработчиком событий. Требования безопасности помогают защитить код от ненадежных вызывающих объектов путем проверки вызывающих объектов в стеке вызовов. Код, который добавляет обработчик событий в событие, не всегда имеется в стеке вызовов при выполнении методов обработчика событий. Поэтому стек вызовов может иметь только высоко доверенные вызывающие объекты при вызове метода обработчика событий. Это приводит к выполнению запросов, выполненных методом обработчика событий. Кроме того, запрошенное разрешение может быть утверждено при вызове метода. По этим причинам риск отсутствия исправления этого правила можно оценить только после просмотра метода обработки событий. При проверке кода учитывайте следующие моменты.

- Выполняет ли обработчик событий любые операции, которые опасны или могут использовать злоумышленники, такие как утверждение разрешений или подавление разрешения на неуправляемый код?

- Каковы угрозы безопасности для кода и из него, так как они могут запускаться в любое время с очень надежными вызывающими объектами в стеке?

## <a name="how-to-fix-violations"></a>Устранение нарушений
 Чтобы устранить нарушение этого правила, изучите метод и проверьте следующее:

- Можно ли сделать метод обработки событий не открытым?

- Можно ли переместить все опасные функции из обработчика событий?

- Если вы накладываете требование безопасности, то можете ли это сделать другим способом?

## <a name="when-to-suppress-warnings"></a>Отключение предупреждений
 Подавлять предупреждение из этого правила только после тщательного анализа безопасности, чтобы убедиться в том, что код не создает угрозу безопасности.

## <a name="example"></a>Пример
 В следующем коде показан метод обработки событий, который может быть неправильно использован вредоносным кодом.

 [!code-csharp[FxCop.Security.EventSecLib#1](../snippets/csharp/VS_Snippets_CodeAnalysis/FxCop.Security.EventSecLib/cs/FxCop.Security.EventSecLib.cs#1)]

## <a name="see-also"></a>См. также
 <xref:System.Security.CodeAccessPermission.Demand%2A?displayProperty=fullName> <xref:System.EventArgs?displayProperty=fullName>
 [Требования безопасности](https://msdn.microsoft.com/324c14f8-54ff-494d-9fd1-bfd20962c8ba)
