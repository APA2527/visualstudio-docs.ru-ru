---
title: C6262 | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-code-analysis
ms.topic: reference
f1_keywords:
- C6262
helpviewer_keywords:
- C6262
ms.assetid: 3eddc74e-2b05-4159-a093-fd469fdcebbb
caps.latest.revision: 20
author: corob-msft
ms.author: corob
manager: jillfra
ms.openlocfilehash: 8d4e4323b848a70e24b85e37a6d822feda0df172
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "77275666"
---
# <a name="c6262"></a>C6262
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

предупреждение C6262: функция использует \<constant> байты стека: превышает/Analyze: STACKSIZE \<constant 2> . Рассмотрите возможность перемещения некоторых данных в кучу.  
  
 Это предупреждение означает, что использование стека, превышающее предопределенное пороговое значение (), было `constant 2` обнаружено в функции. Размер кадра стека по умолчанию для этого предупреждения составляет 16 КБ для пользовательского режима, 1 КБ для режима ядра. Stack — даже в пользовательском режиме — ограничено, и Сбой фиксации страницы стека вызывает исключение переполнения стека. Режим ядра имеет ограничение в 12 КБ размера стека, что не может быть увеличено; Поэтому код режима ядра должен жестко ограничивать использование стека.  
  
 Чтобы устранить проблему, связанную с этим предупреждением, можно либо переместить данные в кучу, либо в другую динамическую память.  В пользовательском режиме один большой кадр стека может не быть проблемой — и это предупреждение может быть подавлено, но большой кадр стека увеличивает риск переполнения стека. (Большой кадр стека может произойти, если функция использует стек сильно или является рекурсивной.) Общий размер стека в пользовательском режиме может быть увеличен, если переполнение стека действительно происходит, но только до ограничения системы.  Можно использовать параметр командной строки **/Analyze** , чтобы изменить значение для `<constant 2>` , но при увеличении он создает риск того, что сообщение об ошибке не будет выводиться.  
  
 Для кода режима ядра, например, в проектах Drivers — значение устанавливается равным `<constant 2>` 1 КБ. Хорошо написанные драйверы должны иметь очень мало функций, которые могут подходить к этому значению, а изменение ограничения вниз может быть желательным.  Те же общие методы, которые используются для кода пользовательского режима для уменьшения размера стека, можно адаптировать в код режима ядра.  
  
## <a name="example"></a>Пример  
 В следующем коде создается это предупреждение `char buffer` , поскольку выделяется 16 382 байт, а локальная целочисленная переменная `i` выделяет еще 4 байта, что в совокупности превышает предельный размер стека по умолчанию (16 КБ).  
  
```cpp  
// cl.exe /c /analyze /EHsc /W4  
#include <windows.h>  
#define MAX_SIZE 16382  
  
void f( )  
{  
    int i;  
    char buffer[MAX_SIZE];  
  
    i = 0;  
    buffer[0]='\0';  
  
    // code...  
}  
  
```  
  
 Следующий код устраняет это предупреждение, перемещая некоторые данные в кучу.  
  
```cpp  
// cl.exe /c /analyze /EHsc /W4  
#include <stdlib.h>     
#include <malloc.h>  
#define MAX_SIZE 16382  
  
void f( )  
{  
    int i;  
    char *buffer;  
  
    i = 0;  
    buffer = (char *) malloc( MAX_SIZE );  
    if (buffer != NULL)   
    {  
        buffer[0] = '\0';  
        // code...  
        free(buffer);  
    }  
}  
  
```  
  
 Использование функции malloc и Free имеет много ловушек с точки зрения утечек памяти и исключений. Чтобы избежать такого рода утечек и проблем с исключениями, используйте механизмы, предоставляемые библиотекой стандартных шаблонов C++ (STL). К ним относятся [shared_ptr](https://msdn.microsoft.com/library/1469fc51-c658-43f1-886c-f4530dd84860), [unique_ptr](https://msdn.microsoft.com/library/acdf046b-831e-4a4a-83aa-6d4ee467db9a)и [vector](https://msdn.microsoft.com/library/c1431ad8-c0b6-4dbb-89c4-5f651e432d7f). Дополнительные сведения см. в разделе [интеллектуальные указатели](https://msdn.microsoft.com/library/909ef870-904c-49b6-b8cd-e9d0b7dc9435) и [Стандартная библиотека C++](https://msdn.microsoft.com/library/a37d3ba3-58af-47c7-9ee2-441ccd7b77ee).  
  
 **Исправление этого предупреждения путем настройки размера стека**  
  
1. В строке меню выберите **проект**, **свойства**.  
  
     Откроется диалоговое окно **Страницы свойств**.  
  
2. Разверните узел **Свойства конфигурации**.  
  
3. Разверните раздел **C/C++**.  
  
4. Выберите свойства **командной строки** .  
  
5. В окне **Дополнительные параметры**добавьте **/Analyze: stacksize16388**.  
  
## <a name="see-also"></a>См. также:  
 [/STACK (выделения стека)](https://msdn.microsoft.com/library/73283660-e4bd-47cc-b5ca-04c5d739034c)   
 [_resetstkoflw](https://msdn.microsoft.com/library/319529cd-4306-4d22-810b-2063f3ad9e14)   
 [Практическое руководство. Настройка проверок во время выполнения машинного кода](../debugger/how-to-use-native-run-time-checks.md)
