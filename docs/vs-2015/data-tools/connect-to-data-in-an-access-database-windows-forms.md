---
title: Подключение к данным в базе данных Access (Windows Forms) | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- databases, connecting to
- databases, Access
- data [Visual Studio], connecting
- connecting to data, from Access databases
- Access databases, connecting
ms.assetid: 4159e815-d430-4ad0-a234-e4125fcbef18
caps.latest.revision: 32
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 8426e9fcaa29bef36b6701c78d622f6f42fd1171
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "72651133"
---
# <a name="connect-to-data-in-an-access-database-windows-forms"></a>Подключение к данным в базе данных Access (Windows Forms)
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Для подключения к базе данных Access (MDF-или ACCDB-файл) можно использовать Visual Studio. После того как определено подключение, источник данных отображается в окне **Источник данных**. Здесь можно перетаскивать таблицы и представления на формы.

## <a name="prerequisites"></a>Предварительные требования
 Чтобы использовать эти процедуры, необходим проект приложения Windows Forms и база данных Access (ACCDB-файл) или база данных Access 2000 – 2003 (MDB-файл). Выполните процедуру, соответствующую типу файла.

## <a name="creating-the-dataset-for-an-accdb-file"></a>Создание набора данных для ACCDB-файла
 Вы можете подключиться к базам данных, созданным с помощью Access 2013, Office 365, Access 2010 или Access 2007, с помощью следующей процедуры.

#### <a name="to-create-the-dataset"></a>Создание набора данных

1. Откройте приложение Windows Forms, к которому требуется подключить данные.

2. В меню **вид** выберите **другие**  >  **Источники данных**Windows.

     ![Просмотр других окон "Источники данных"](../data-tools/media/viewdatasources.png "виевдатасаурцес")

3. В окне **Источники данных** выберите **Добавить новый источник данных**.

     ![Добавить новый источник данных](../data-tools/media/dataaddnewdatasource.png "датааддневдатасаурце")

4. На странице **Выбор типа источника данных** выберите **база данных** , а затем нажмите кнопку **Далее**.

5. На странице **Выбор модели базы данных** выберите **набор данных** , а затем нажмите кнопку **Далее**.

6. На странице **Выбор подключения базы данных** выберите **Новое подключение** для настройки нового подключения к данным.

7. Измените **источник данных** на **.NET Framework поставщик данных для OLE DB**.

     ![Изменить поставщика данных на OLE DB](../data-tools/media/datachangedatasourceoledb.png "датачанжедатасаурцеоледб")

    > [!IMPORTANT]
    > Несмотря на то, что источник данных **файла базы данных Microsoft Access (OLE DB)** может показаться верным, этот тип источника данных используется только для файлов базы данных. mdb.

8. В **OLE DB поставщик**выберите **Microsoft Office 12,0 доступ ядро СУБД OLE DB поставщик**.

     ![Поставщик OLE DB Microsoft Office 12.0 Access](../data-tools/media/dataoledbprovideroffice12access.png "dataOLEDBProviderOffice12Access")

9. В поле **имя сервера или файла**укажите путь и имя ACCDB, к которому необходимо подключиться, а затем нажмите кнопку **ОК**.

    > [!NOTE]
    > Если в файле базы данных есть имя пользователя и пароль, укажите их, прежде чем нажать кнопку **ОК**.

10. На странице **Выбор подключения к данным** нажмите кнопку **Далее** .

11. Нажмите кнопку **Далее** в **строке сохранить подключение на странице файл конфигурации приложения** .

12. Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.

13. Выберите нужные таблицы или представления в наборе данных, а затем нажмите кнопку **Готово**.

     Объект DataSet добавляется в проект, и таблицы и представления отображаются в окне **Источники данных**.

## <a name="creating-the-dataset-for-an-mdb-file"></a>Создание набора данных для файла MDB
 Набор данных создается при помощи **Мастера настройки источника данных**.

#### <a name="to-create-the-dataset"></a>Создание набора данных

1. Откройте приложение Windows Forms, к которому требуется подключить данные.

2. В меню **вид** выберите **другие**  >  **Источники данных**Windows.

     ![Просмотр других окон "Источники данных"](../data-tools/media/viewdatasources.png "виевдатасаурцес")

3. В окне **Источники данных** выберите **Добавить новый источник данных**.

4. На странице **Выбор типа источника данных** выберите **база данных** , а затем нажмите кнопку **Далее**.

5. На странице **Выбор модели базы данных** выберите **набор данных** , а затем нажмите кнопку **Далее**.

6. На странице **Выбор подключения базы данных** выберите **Новое подключение** для настройки нового подключения к данным.

7. Если источник данных не является **файлом базы данных Microsoft Access (OLE DB)**, выберите **изменить** , чтобы открыть диалоговое окно **изменение источника данных** и выберите **файл базы данных Microsoft Access**, а затем нажмите кнопку **ОК**.

8. В поле **имя файла базы данных**укажите путь и имя файла MDB, к которому необходимо подключиться, а затем нажмите кнопку **ОК**.

     ![Добавление файла базы данных Access для подключения](../data-tools/media/dataaddconnectionaccessmdb.png "датааддконнектионакцессмдб")

9. На странице **Выбор подключения к данным** нажмите кнопку **Далее** .

10. Нажмите кнопку **Далее** в **строке сохранить подключение на странице файл конфигурации приложения** .

11. Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.

12. Выберите нужные таблицы или представления в наборе данных, а затем нажмите кнопку **Готово**.

     Объект DataSet добавляется в проект, и таблицы и представления отображаются в окне **Источники данных**.

## <a name="security"></a>Безопасность
 Хранение конфиденциальных сведений (например, пароля) может повлиять на безопасность приложений. Использование проверки подлинности Windows (также называемой встроенными средствами безопасности) — более безопасный способ управления доступом к базе данных. Дополнительные сведения см. в разделе [Защита сведений о подключении](https://msdn.microsoft.com/library/1471f580-bcd4-4046-bdaf-d2541ecda2f4).

## <a name="next-steps"></a>Next Steps
 Только что созданный набор данных теперь доступен в окне **Источники данных** . Теперь можно выполнить любую из следующих задач:

- Выберите элементы в окне **Источники данных** и перетащите их на форму (см. раздел [Привязка Windows Forms элементов управления к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)).

- Откройте источник данных в Конструкторе набора данных для добавления или изменения объектов, составляющих набор данных.

- Добавьте логику проверки в <xref:System.Data.DataTable.ColumnChanging> <xref:System.Data.DataTable.RowChanging> событие или таблиц данных в наборе данных (см. раздел [Проверка данных в наборах](../data-tools/validate-data-in-datasets.md)).

## <a name="see-also"></a>См. также:

 [Подготовка приложения для получения](https://msdn.microsoft.com/library/c17bdb7e-c234-4f2f-9582-5e55c27356ad) [элементов управления привязки данных к данным в](../data-tools/bind-controls-to-data-in-visual-studio.md) [Validating Data](https://msdn.microsoft.com/library/b3a9ee4e-5d4d-4411-9c56-c811f2b4ee7e) [пошаговых руководствах](https://msdn.microsoft.com/library/15a88fb8-3bee-4962-914d-7a1f8bd40ec4) по проверке данных в Visual Studio