---
title: Заполнение наборов данных с помощью адаптера таблицы | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- datasets [Visual Basic]
- datasets [Visual Basic], loading data
- data retrieval
- retrieving data
- datasets [Visual Basic], filling
- data [Visual Studio], retrieving
- data [Visual Studio], datasets
ms.assetid: 55f3bfbe-db78-4486-add3-c62f49e6b9a0
caps.latest.revision: 35
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: fb06c1d97c854aae05d993c086069e10e35518f5
ms.sourcegitcommit: 08fc78516f1107b83f46e2401888df4868bb1e40
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65704985"
---
# <a name="fill-datasets-by-using-tableadapters"></a>Заполнение наборов данных с помощью адаптеров таблицы
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Компонент адаптера таблицы заполняет набор данных данными из базы данных, на основе один или несколько запросов или хранимых процедур, которые можно указать. Адаптеры таблиц можно также выполнить добавляет, обновления и удаления в базе данных, чтобы сохранить изменения, внесенные в набор данных. Можно также выполнять глобальные команды, которые не связаны с любой конкретной таблицы.  
  
> [!NOTE]
> Адаптеры таблиц создаются конструкторами Visual Studio. Если вы создаете наборы данных программными средствами, используйте DataAdapter, который представляет собой класс .NET Framework.  
  
 Подробные сведения об операциях адаптера таблицы можно пропустить непосредственно к одному из следующих разделов:  
  
|Раздел|Описание|  
|-----------|-----------------|  
|[Создание и настройка адаптеров таблиц](../data-tools/create-and-configure-tableadapters.md)|Как использовать конструкторы для создания и настройки адаптеров таблиц|  
|[Создание параметризованных запросов адаптера таблицы](../data-tools/create-parameterized-tableadapter-queries.md)|Как разрешить пользователям аргументы для TableAdapter процедур или запросов|  
|[Непосредственный доступ к базе данных с помощью адаптера таблицы](../data-tools/directly-access-the-database-with-a-tableadapter.md)|Как использовать методы Dbdirect адаптеров таблиц|  
|[Отключение ограничений при заполнении набора данных](../data-tools/turn-off-constraints-while-filling-a-dataset.md)|Работа с ограничениями внешнего ключа, при обновлении данных|  
|[Практическое руководство. Расширение функциональных возможностей адаптера таблицы](../data-tools/fill-datasets-by-using-tableadapters.md)|Как добавить пользовательский код для объектов TableAdapter|  
|[Считывание XML-данных в набор данных](../data-tools/read-xml-data-into-a-dataset.md)|Как работать с XML|  
  
## <a name="tableadapters-overview"></a>Общие сведения об адаптере таблиц TableAdapter  
 Адаптеры таблиц — это автоматически созданный конструктором компонентов подключения к базе данных, выполнения запросов или хранимых процедур, которые заполнить их DataTable с возвращенными данными. Адаптеры таблиц также отправки обновленных данных из приложения в базе данных. Можно запустить столько запросов, сколько требуется в TableAdapter, до тех пор, пока они возвращают данные, которые соответствуют схеме таблицы, с которой связан TableAdapter. На следующей схеме показано, как адаптеры таблиц взаимодействуют с базами данных и другими объектами в памяти:  
  
 ![Поток данных в клиентском приложении](../data-tools/media/clientdatadiagram.gif "ClientDataDiagram")  
  
 Если адаптеры таблиц создаются с помощью **конструктор наборов данных**, классы адаптеров таблиц не создаются как вложенные классы <xref:System.Data.DataSet>. Они находятся в отдельных пространствах имен, характерные для каждого набора данных. Например, если у вас есть набор данных с именем `NorthwindDataSet`, адаптеры таблиц, связанные с <xref:System.Data.DataTable>s в `NorthwindDataSet` в `NorthwindDataSetTableAdapters` пространства имен. Для программного доступа к конкретному адаптеру таблиц, необходимо объявить новый экземпляр адаптера таблицы. Пример:  
  
 [!code-csharp[VbRaddataTableAdapters#7](../snippets/csharp/VS_Snippets_VBCSharp/VbRaddataTableAdapters/CS/Class1.cs#7)]
 [!code-vb[VbRaddataTableAdapters#7](../snippets/visualbasic/VS_Snippets_VBCSharp/VbRaddataTableAdapters/VB/Class1.vb#7)]  
  
## <a name="associated-datatable-schema"></a>Связанной схемы DataTable  
 При создании TableAdapter, начальный запрос или хранимую процедуру для определения схемы TableAdapter, связанного с <xref:System.Data.DataTable>. Выполнение этого начального запроса или хранимой процедуры путем вызова метода `Fill` метода (который заполняет TableAdapter, связанного с <xref:System.Data.DataTable>). Любые изменения, внесенные в основном запросе TableAdapter, отражаются в схему связанной таблицы данных. Например удаление столбца из основного запроса также удаляет столбец из связанной таблицы данных. Если любые дополнительные запросы адаптера таблицы с помощью инструкций SQL, которые возвращают столбцы, которые не являются в основном запросе, конструктор пытается синхронизировать изменения столбцов между основным и дополнительные запросы. Дополнительные сведения см. в разделе [Практическое руководство. Изменение объектов TableAdapter](https://msdn.microsoft.com/library/ca178745-e35a-45f1-a395-23cddfd8f855).  
  
## <a name="tableadapter-update-commands"></a>Команды обновления адаптера таблицы  
 Возможность обновления адаптера таблицы зависит от того, какая информация доступна в основном запросе в мастере адаптера таблицы. Например адаптеры таблиц, настроенные для получения значения из нескольких таблиц (JOIN), скалярные значения, представления или результаты агрегатных функций изначально создаются с возможностью отправки обновлений в основную базу данных. Тем не менее, можно настроить вручную в команды INSERT, UPDATE и DELETE **свойства** окна.  
  
## <a name="tableadapter-queries"></a>запросы TableAdapter  
 ![TableAdapter с несколькими запросами](../data-tools/media/tableadapter.gif "адаптера таблицы")  
  
 Адаптеры таблиц могут содержать несколько запросов для заполнения связанных таблиц. Можно определить столько запросов для TableAdapter вашему приложению до тех пор, пока каждый запрос возвращает данные, которые соответствуют той же схемы, как связанную таблицу данных. Эта возможность включает TableAdapter для загрузки разных результатов на основе различных критериев.  
  
 Например если приложение содержит таблицу с именами клиентов, можно создать запрос, который заполняет таблицу с каждые имя клиента, который начинается с определенной буквы, а вторая — который заполняет таблицу со всех клиентов, расположенных в том же состоянии. Для заполнения `Customers` таблицы с клиентами в заданном состоянии, можно создать `FillByState` запрос, который принимает параметр для значения состояния следующим образом: `SELECT * FROM Customers WHERE State = @State`. Выполните запрос, вызвав `FillByState` и передав в значении параметра следующим образом: `CustomerTableAdapter.FillByState("WA")`.  
  
 Помимо добавления запросы, возвращающие данные из той же схеме таблицы данных адаптера таблицы, можно добавить запросы, возвращающие скалярные значения (одно). Например, запрос, возвращающий число клиентов (`SELECT Count(*) From Customers`) является допустимым для `CustomersTableAdapter,` несмотря на то, что данные, возвращается не соответствуют схеме таблицы.  
  
## <a name="clearbeforefill-property"></a>Свойство ClearBeforeFill  
 По умолчанию каждый раз при запуске запроса для заполнения таблицы данных адаптера таблицы, существующие данные снят, а только результаты запроса будут загружены в таблице. Задайте `ClearBeforeFill` свойства `false` следует ли добавлять или объединять данные, возвращенные запросом к существующим данным в таблице данных. Независимо от того, снят ли данные необходимо явно отправлять обновления в базе данных, если вы хотите сохранить их. Поэтому не забудьте сохранить любые изменения данных в таблице перед выполнения другого запроса, который заполняет таблицу. Дополнительные сведения см. в разделе [обновления данных с помощью адаптера таблицы](../data-tools/update-data-by-using-a-tableadapter.md).  
  
## <a name="tableadapter-inheritance"></a>Наследование адаптера таблицы  
 Адаптеры таблиц расширить функциональные возможности стандартных адаптеров данных за счет инкапсуляции настроенного <xref:System.Data.Common.DataAdapter> класс? qualifyHint = False & autoUpgrade = True. По умолчанию TableAdapter наследует <xref:System.ComponentModel.Component> класса и не может быть приведен к <xref:System.Data.Common.DataAdapter> класса. Приведение TableAdapter для <xref:System.Data.Common.DataAdapter> класса приводит к <xref:System.InvalidCastException> ошибка? qualifyHint = False & autoUpgrade = True. Чтобы изменить базовый класс адаптера таблицы, можно ввести класс, производный от <xref:System.ComponentModel.Component> в **базового класса** свойство TableAdapter в **конструктор наборов данных**.  
  
## <a name="tableadapter-methods-and-properties"></a>Свойства и методы адаптера таблицы  
 Класс TableAdapter не является частью [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)]. Это означает, что вы не удается найти в документации или **обозреватель объектов**. Она создается во время разработки, при использовании одного из мастеров, упомянутых ранее. Имя, которое назначается адаптера таблицы при ее создании основан на имени таблицы, в которой вы работаете. Например, при создании TableAdapter, основанный на таблице в базе данных с именем `Orders`, называется TableAdapter `OrdersTableAdapter`. Имя класса адаптера таблицы можно изменить с помощью **имя** свойство в **конструктор наборов данных**.  
  
 Ниже приведены часто используемые методы и свойства TableAdapters.  
  
|Член|Описание|  
|------------|-----------------|  
|`TableAdapter.Fill`|Заполняет таблицу результатов команды SELECT адаптера таблицы TableAdapter связанные данные.|  
|`TableAdapter.Update`|Отправляет изменения обратно в базу данных и возвращает целое число, представляющее число строк, затронутых обновлением. Дополнительные сведения см. в разделе [обновления данных с помощью адаптера таблицы](../data-tools/update-data-by-using-a-tableadapter.md).|  
|`TableAdapter.GetData`|Возвращает новый <xref:System.Data.DataTable> заполняется данными.|  
|`TableAdapter.Insert`|Создает новую строку в таблице данных. Дополнительные сведения см. в разделе [вставки новых записей в базу данных](../data-tools/insert-new-records-into-a-database.md).|  
|`TableAdapter.ClearBeforeFill`|Определяет, очищается ли таблица данных перед вызовом одного из `Fill` методы.|  
  
## <a name="tableadapter-update-method"></a>Метод обновления адаптера таблицы  
 TableAdapters команды данных для чтения и записи из базы данных. TableAdapter начальной `Fill` (основной) запрос используется в качестве основы для создания схемы связанной таблицы данных, а также `InsertCommand`, `UpdateCommand`, и `DeleteCommand` команд, которые связаны с `TableAdapter.Update` метод. Вызов адаптера `Update` выполнения метода операторы, которые были созданы, когда адаптер таблицы был изначально настроен, ни один из дополнительных запросов, которые были дополнены **мастер настройки запроса TableAdapter**.  
  
 При использовании адаптера таблицы, она фактически выполняет те же операции, с помощью команд, которые обычно выполняются. Например, при вызове адаптера `Fill` метод, адаптер выполняет команду данных в его `SelectCommand` свойство и использует модуль чтения данных (например, <xref:System.Data.SqlClient.SqlDataReader>) для загрузки результирующего набора в таблице данных. Аналогично, при вызове адаптера `Update` метод, он выполняет соответствующую команду (в `UpdateCommand`, `InsertCommand`, и `DeleteCommand` свойства) для каждой измененной записи в таблице данных.  
  
> [!NOTE]
> Если имеется достаточно сведений в основном запросе `InsertCommand`, `UpdateCommand`, и `DeleteCommand` команды создаются по умолчанию при создании адаптера таблицы. Если основным запросом больше, чем инструкции SELECT для одной таблицы, это возможно, конструктор не сможет создать `InsertCommand`, `UpdateCommand`, и `DeleteCommand`. Если эти команды не создаются, может появиться ошибка при выполнении `TableAdapter.Update` метод.  
  
## <a name="tableadapter-generatedbdirectmethods"></a>GenerateDbDirectMethods адаптера таблицы  
 В дополнение к `InsertCommand`, `UpdateCommand`, и `DeleteCommand`, адаптеры таблиц создаются с помощью методов, которые могут выполняться непосредственно в базе данных. Эти методы (`TableAdapter.Insert`, `TableAdapter.Update`, и `TableAdapter.Delete`) можно вызывать непосредственно для управления данными в базе данных. Это означает, что эти отдельные методы можно вызывать из кода вместо вызова метода `TableAdapter.Update` для обработки операций вставки, обновления и удаления, которые ожидают для связанной таблицы данных.  
  
 Если вы не хотите создавать эти прямые методы, задайте **GenerateDbDirectMethods** свойства `false` (в **свойства** окна). Дополнительные запросы, которые добавляются в адаптер таблицы, являются автономными, они не создают эти методы.  
  
## <a name="tableadapter-support-for-nullable-types"></a>Поддержка TableAdapter обнуляемые типы  
 Адаптеры таблиц поддерживает типы nullable `Nullable(Of T)` и `T?`. Дополнительные сведения о типах, допускающих значение NULL, в Visual Basic см. в разделе [Типы значений, допускающие значение NULL](https://msdn.microsoft.com/library/9ac3b602-6f96-4e6d-96f7-cd4e81c468a6). Дополнительные сведения о допускающих значение NULL типов в C#, см. в разделе [обнуляемые типы, с помощью](https://msdn.microsoft.com/library/0bacbe72-ce15-4b14-83e1-9c14e6380c28).  
  
## <a name="security"></a>Безопасность  
 При использовании команды обработки данных с `CommandType` свойство значение <xref:System.Data.CommandType>, тщательно проверяйте информацию, отправляемые с клиента перед передачей его к базе данных. Злоумышленники могут попытаться отправить (внедрить) модифицированные или добавочные инструкции SQL и получить незаконный доступ к базе данных или повредить ее. Прежде чем передавать входные данные пользователя в базе данных, всегда проверяйте, что информация верна. Мы рекомендуем всегда использовать параметризованные запросы или хранимые процедуры, если это возможно.  
  
## <a name="see-also"></a>См. также  
 [Инструменты для работы с наборами данных в Visual Studio](../data-tools/dataset-tools-in-visual-studio.md)
