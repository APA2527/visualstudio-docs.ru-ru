---
title: Создание и настройка наборов данных
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- typed datasets, creating
- datasets [Visual Basic], creating
ms.assetid: 58f33b43-24e1-43b1-b08b-b74329960bd6
caps.latest.revision: 39
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 3c84105387c708fa16e0b1d5c3294ef909466524
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72631194"
---
# <a name="create-and-configure-datasets-in-visual-studio"></a>Создание и настройка наборов данных в Visual Studio
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

*Набор данных* — это набор объектов, которые хранят данные из базы данных в памяти и поддерживают отслеживание изменений, чтобы обеспечить выполнение операций создания, чтения, обновления и удаления (CRUD) с этими данными без необходимости постоянного подключения к базе данных. Наборы данных предназначены для простых *форм* бизнес-приложений. Для новых приложений рекомендуется использовать Entity Framework для хранения и моделирования данных в памяти. Для работы с наборами данных у вас должны быть базовые знания об основных понятиях.

 Типизированный <xref:System.Data.DataSet> класс создается в Visual Studio во время разработки с помощью **мастера настройки источника данных**. Дополнительные сведения о создании наборов данных программным способом см. в разделе [Создание DataSet](https://msdn.microsoft.com/library/57629d8f-393e-4677-8b83-29ffde27f5fc).

## <a name="create-a-new-dataset-by-using-the-data-source-configuration-wizard"></a>Создание нового набора данных с помощью мастера настройки источника данных

1. В меню **проект** выберите команду **Добавить новый источник данных** , чтобы запустить **Мастер настройки источника данных**.

2. Выберите тип источника данных, к которому будет осуществляться подключение.

     ![Мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png "мастер настройки источника данных")

3. Для баз данных выберите базу данных или базы данных, которые будут источником данных для набора данных.

     ![Выбор подключения в источнике данных](../data-tools/media/data-source-choose-a-connection.png "Выбор подключения в источнике данных")

4. Выберите таблицы (или отдельные столбцы), хранимые процедуры, функции и представления из базы данных, которые необходимо представить в наборе данных.

     ![Выбор объектов базы данных](../data-tools/media/raddata-chose-objects.png "раддата выбранные объекты")

5. Нажмите кнопку **Готово**.

6. Набор данных отображается как узел в **Обозреватель решений**:

     ![Набор данных в обозреватель решений](../data-tools/media/dataset-in-solution-explorer.png "Набор данных в обозреватель решений")

     Щелкните этот узел, и набор данных появится в **конструкторе наборов данных**. Обратите внимание, что каждая таблица в наборе данных имеет связанный объект TableAdapter, который представлен внизу. Адаптер таблицы используется для заполнения набора данных и, при необходимости, для отправки команд в базу данных.

     ![Конструктор наборов данных](../data-tools/media/dataset-designer.png "Конструктор наборов данных")

7. Линии связи, соединяющие таблицы, представляют связи между таблицами, как определено в базе данных. По умолчанию ограничения внешнего ключа в базе данных представлены только как отношение, а правила обновления и удаления имеют значение None. Обычно это именно то, что вам нужно. Однако можно щелкнуть строки, чтобы открыть диалоговое окно **связи** , в котором можно изменить поведение иерархических обновлений. Дополнительные сведения см. [в разделе связи в наборах данных](../data-tools/relationships-in-datasets.md) и [иерархическом обновлении](../data-tools/hierarchical-update.md).

     ![Диалоговое окно связи набора данных](../data-tools/media/raddata-relation-dialog.png "диалоговое окно связи раддата")

8. Щелкните таблицу, адаптер таблицы или имя столбца в таблице, чтобы просмотреть ее свойства в окне " **Свойства** ". Некоторые значения можно изменить. Просто помните, что вы изменяете набор данных, а не исходную базу данных.

     ![Свойства столбца набора данных](../data-tools/media/dataset-column-properties.png "Свойства столбца набора данных")

9. В набор данных можно добавлять новые таблицы или адаптеры таблиц, добавлять новые запросы для существующих адаптеров таблиц или указывать новые связи между таблицами, перетаскивая эти элементы с вкладки **область элементов** . Эта вкладка появляется, когда **Конструктор наборов данных** находится в фокусе.

     ![Панель элементов набора данных](../data-tools/media/raddata-dataset-toolbox.png "Панель элементов набора данных раддата")

10. Далее, возможно, потребуется указать способ заполнения набора данных данными. Для этого используется **Мастер настройки TableAdapter**. Дополнительные сведения см. в разделе [Заполнение наборов данных с помощью адаптеров таблиц](../data-tools/fill-datasets-by-using-tableadapters.md) .

## <a name="add-a-database-table-or-other-object-to-an-existing-dataset"></a>Добавление таблицы или другого объекта базы данных в существующий набор данных
 В этой процедуре показано, как добавить таблицу из той же базы данных, которая использовалась для первоначального создания набора данных.

1. Щелкните узел набора данных в **Обозреватель решений** , чтобы открыть конструктор набора данных.

2. Перейдите на вкладку **Источники данных** в левом поле Visual Studio или введите `Data Sources` на панели **быстрого запуска**.

3. Щелкните правой кнопкой мыши узел набор данных и выберите команду **настроить источник данных с помощью мастера** .

     ![Контекстное меню источника данных](../data-tools/media/data-source-context-menu.png "Контекстное меню источника данных")

4. Используйте мастер для указания дополнительных таблиц, хранимых процедур или других объектов базы данных, добавляемых в набор данных.

## <a name="add-a-stand-alone-data-table-to-a-dataset"></a>Добавление автономной таблицы данных в набор данных

1. Откройте свой набор данных в **Конструкторе наборов данных**.

2. Перетащите класс <xref:System.Data.DataTable> из вкладки **набор данных** **панели элементов** на **Конструктор наборов данных**.

3. Добавьте столбцы, чтобы определить таблицу данных. Дополнительные сведения см. [в разделе инструкции. Добавление столбцов в таблицу](https://msdn.microsoft.com/library/8ca21f77-b99a-47a7-a656-7cfd7a1bd9df)данных.

4. Изолированные таблицы должны реализовывать `Fill` логику в автономных таблицах, чтобы их можно было заполнить данными. Сведения о заполнении автономных таблиц данных см. в разделе [Заполнение набора данных из DataAdapter](https://msdn.microsoft.com/library/3fa0ac7d-e266-4954-bfac-3fbe2f913153).
