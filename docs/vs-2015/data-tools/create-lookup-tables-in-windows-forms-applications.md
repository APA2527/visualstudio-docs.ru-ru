---
title: Создание таблиц подстановок в Windows Forms приложениях | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- lookup tables
- lookup tables, creating
ms.assetid: 0edd5385-c381-4b17-9096-74e2778db9d5
caps.latest.revision: 17
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 3979d08757445e9df5fc159fe7642b04bf74b995
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72630937"
---
# <a name="create-lookup-tables-in-windows-forms-applications"></a>Создание таблиц подстановки в приложениях Windows Forms
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

*Таблица Уточняющий запрос* термина описывает элементы управления, привязанные к двум связанным таблицам данных. Эти элементы управления "Уточняющий запрос" отображают данные из первой таблицы на основе значения, выбранного во второй таблице.

 Таблицы подстановки можно создать, перетащив главный узел родительской таблицы (из [окна Источники данных](https://msdn.microsoft.com/library/0d20f699-cc95-45b3-8ecb-c7edf1f67992)) на элемент управления в форме, который уже привязан к столбцу в связанной дочерней таблице.

 Например, рассмотрим таблицу `Orders` в базе данных Sales. Каждая запись в `Orders` таблице содержит `CustomerID`, указывающий, какой клиент поместил заказ. @No__t_0 — это внешний ключ, указывающий на запись клиента в таблице `Customers`. В этом сценарии вы развернете таблицу `Orders` в окне **Источники данных** и установите для основного узла **сведения**. Затем установите `CustomerID` столбец, чтобы использовать <xref:System.Windows.Forms.ComboBox> (или любой другой элемент управления, поддерживающий привязку уточняющего запроса), и перетащите узел `Orders` на форму. Наконец, перетащите `Customers` узел на элемент управления, привязанный к связанному столбцу — в данном случае <xref:System.Windows.Forms.ComboBox>, привязанный к столбцу `CustomerID`.

## <a name="to-databind-a-lookup-control"></a>Привязка элемента управления "Уточняющий запрос"

1. Откройте окно **Источники данных**.

    > [!NOTE]
    > Для таблиц подстановки необходимо, чтобы в окне **Источники данных** были доступны две связанные таблицы или объекты.

2. Разверните узлы в окне **Источники данных** , пока не увидите родительскую таблицу и все ее столбцы, а также связанную дочернюю таблицу и все ее столбцы.

    > [!NOTE]
    > Узел дочерней таблицы — это узел, который отображается как развертываемый дочерний узел в родительской таблице.

3. Измените тип перетаскивания дочерней таблицы на **Details** , выбрав **сведения** из списка элементов управления в узле дочерней таблицы. Дополнительные сведения см. в разделе [Установка элемента управления, создаваемого при перетаскивании из окна Источники данных](../data-tools/set-the-control-to-be-created-when-dragging-from-the-data-sources-window.md).

4. Откройте узел, связывающий две таблицы (узел `CustomerID` в предыдущем примере). Измените тип перетаскивания на <xref:System.Windows.Forms.ComboBox>, выбрав **поле со списком** в списке элементов управления.

5. Перетащите главный узел дочерней таблицы из окна **Источники данных** на форму.

     Элементы управления с привязкой к данным (с описательными метками) и панель инструментов (<xref:System.Windows.Forms.BindingNavigator>) отображаются в форме. [Набор данных](../data-tools/dataset-tools-in-visual-studio.md), TableAdapter, <xref:System.Windows.Forms.BindingSource> и <xref:System.Windows.Forms.BindingNavigator> отображаются в области компонентов.

6. Теперь перетащите главный узел родительской таблицы из окна **Источники данных** непосредственно на элемент управления lookup (<xref:System.Windows.Forms.ComboBox>).

     Привязки подстановки теперь установлены. Конкретные свойства, заданные для элемента управления, см. в таблице ниже.

    |свойство;|Пояснение к параметру|
    |--------------|----------------------------|
    |**DataSource**|Visual Studio задает для этого свойства <xref:System.Windows.Forms.BindingSource>, созданный для перетаскиваемой на элемент управления таблицы (сравните с созданием <xref:System.Windows.Forms.BindingSource> при создании элемента управления).<br /><br /> Если необходимо выполнить корректировку, задайте для этого параметра значение <xref:System.Windows.Forms.BindingSource> таблицы со столбцом, который необходимо отобразить.|
    |**DisplayMember**|Visual Studio задает для данного свойства первый столбец после первичного ключа, содержащий тип строковых данных для таблицы, которую вы перетаскиваете на элемент управления.<br /><br /> Если необходимо выполнить корректировку, задайте для этого параметра имя столбца, который требуется отобразить.|
    |**ValueMember**|Visual Studio задает для данного свойства первый столбец, участвующий в первичном ключе, или первый столбец в таблице, если ключ не задан.<br /><br /> Если необходимо выполнить корректировку, установите для этого параметра значение первичный ключ в таблице со столбцом, который необходимо отобразить.|
    |**SelectedValue**|Visual Studio устанавливает это свойство в исходный столбец, удаленный из окна **Источники данных** .<br /><br /> Если необходимо выполнить корректировку, задайте значение для столбца внешнего ключа в связанной таблице.|

## <a name="see-also"></a>См. также раздел
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)
