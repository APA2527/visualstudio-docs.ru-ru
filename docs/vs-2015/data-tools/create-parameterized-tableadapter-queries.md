---
title: Создание параметризованных запросов адаптера таблицы TableAdapter
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
helpviewer_keywords:
- data [Visual Studio], TableAdapters
- TableAdapters, parameterized queries
- data [Visual Studio], searching data
- queries [Visual Studio], creating
- TableAdapters, searching data
- queries [Visual Studio], TableAdapters
ms.assetid: 104d1d19-b5a9-4071-b81e-1b3af08e9c7b
caps.latest.revision: 24
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: 1da058cbbdda71758e9a158cfd6778a044797093
ms.sourcegitcommit: 08fc78516f1107b83f46e2401888df4868bb1e40
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65703817"
---
# <a name="create-parameterized-tableadapter-queries"></a>Создание параметризованных запросов адаптера таблицы TableAdapter
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Параметризированный запрос возвращает данные, удовлетворяющие условиям предложения WHERE в запросе. Например, можно параметризировать список клиентов, чтобы отображать только клиентов из определенного города, добавив `WHERE City = @City` в конец инструкции SQL, возвращающей список клиентов.  
  
Создание параметризованных запросов адаптера таблицы в конструкторе наборов данных. Их также можно создать в приложении Windows с **параметризация источника данных** команды **данных** меню. **Параметризация источника данных** команда создает элементы управления формы, где можно вводить значения параметров и выполните запрос.  
  
> [!NOTE]
> При создании параметризованного запроса, используйте нотацию параметров, относящиеся к базе данных, разработки по. Например, источники данных Access и OleDb используют вопросительный знак "?" для обозначения параметров, поэтому предложение WHERE должно иметь следующий вид: `WHERE City = ?`.  
  
> [!NOTE]
> Диалоговые окна и команды меню могут отличаться от описанных в справке в зависимости от ваших текущих параметров или выпуска, который вы используете. Чтобы изменить параметры, перейдите к **средства** меню и выберите **Импорт и экспорт параметров**. Дополнительные сведения см. в статье [Настройка параметров разработки в Visual Studio](https://msdn.microsoft.com/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
## <a name="create-a-parameterized-tableadapter-query"></a>Создание параметризованного запроса адаптера таблицы 
  
- Создайте новый адаптер таблицы, добавив предложение WHERE с требуемыми параметрами в инструкцию SQL. Дополнительные сведения см. в разделе [Создание и настройка адаптеров таблиц](../data-tools/create-and-configure-tableadapters.md).  
  
     -или-  
  
- Добавьте запрос в существующий адаптер таблицы, добавив предложение WHERE с требуемыми параметрами в инструкцию SQL.
  
### <a name="create-a-parameterized-query-while-designing-a-data-bound-form"></a>Создание параметризованного запроса при разработке формы с привязкой к данным  
  
1. Выберите на форме элемент управления, который уже привязан к набору данных. Дополнительные сведения см. в разделе [управляет привязки Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md).  
  
2. На **данных** меню, выберите**добавить запрос**.  
  
3. Заполните диалоговое окно **Построитель условий поиска**, добавив предложение WHERE с требуемыми параметрами в инструкцию SQL.  
  
### <a name="add-a-query-to-an-existing-data-bound-form"></a>Добавление запроса в существующую форму с привязкой к данным  
  
1. Откройте форму в **конструкторе Windows Forms**.  
  
2. На **данных** меню, выберите **добавить запрос** или **данные смарт-тега**.  
  
   > [!NOTE]
   > Если команда **Добавить запрос** в меню **Данные отсутствует**, выберите на форме элемент управления, отображающий тот источник данных, в который вы хотите добавить параметризацию. Например, если форма отображает данные в элементе управления <xref:System.Windows.Forms.DataGridView>, выберите его. Если форма отображает данные в отдельных элементах управления, выберите любой элемент управления с привязкой к данным.  
  
3. В **таблицы источника данных выберите** области, выберите tablethat, вы хотите добавить параметризацию.  
  
4. Введите имя в поле **Имя нового запроса**, если вы создаете запрос.  
  
    -или-  
  
    Выберите запрос в поле **Имя существующего запроса**.  
  
5. В **текст запроса** введите запрос, который принимает параметры.  
  
6. Нажмите кнопку **ОК**.  
  
    Элемент управления для ввода параметра и кнопка **Загрузка** добавляются на форму в элемент управления <xref:System.Windows.Forms.ToolStrip>.  
  
   Параметры адаптера таблицы можно назначить значения null, когда требуется выполнять запросы для записей, которые не должны иметь текущего значения. Например, рассмотрим следующий запрос, имеющий `ShippedDate` параметр в его `WHERE` предложение:  
  
   ```sql
   SELECT CustomerID, OrderDate, ShippedDate  
   FROM Orders  
   WHERE (ShippedDate = @ShippedDate) OR  
   (ShippedDate IS NULL)  
   ```

Если бы это было по запросу, может запрашивать все заказы, которые еще не доставлены следующим кодом:  
  
   [!code-csharp[VbRaddataTableAdapters#8](../snippets/csharp/VS_Snippets_VBCSharp/VbRaddataTableAdapters/CS/Form2.cs#8)]
   [!code-vb[VbRaddataTableAdapters#8](../snippets/visualbasic/VS_Snippets_VBCSharp/VbRaddataTableAdapters/VB/Form2.vb#8)]  
  
### <a name="enable-a-query-to-accept-null-values"></a>Включить запрос, чтобы принимать значения null  
  
1. В **конструктор наборов данных**, выберите запрос TableAdapter, который должен принимать значения null для параметров.  
  
2. В **свойства** выберите **параметры**. Нажмите кнопку с многоточием (**...** ) кнопку, чтобы открыть **редактор коллекции параметров**.  
  
3. Выберите параметр, который допускает значения null и задайте **AllowDbNull** свойства `true`.  
  
## <a name="see-also"></a>См. также

- [Заполнение наборов данных с помощью адаптера таблицы](../data-tools/fill-datasets-by-using-tableadapters.md)