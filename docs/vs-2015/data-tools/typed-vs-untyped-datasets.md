---
title: Типизированные и нетипизированные наборы данных | Документация Майкрософт
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.date: 11/15/2016
ms.topic: conceptual
ms.assetid: c83ba0bb-5425-4d47-8891-6b4dbf937701
caps.latest.revision: 8
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 39a16a200bbc057288ae2741e7d504566b0368e1
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72667156"
---
# <a name="typed-vs-untyped-datasets"></a>Типизированные и нетипизированные наборы данных
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Типизированный набор данных — это набор данных, который сначала является производным от базового класса <xref:System.Data.DataSet>, а затем использует сведения из **Конструктор наборов данных**, который хранится в XSD-файле, для создания нового строго типизированного класса DataSet. Сведения из схемы (таблицы, столбцы и т. д.) создаются и компилируются в этот новый класс DataSet в виде набора объектов и свойств первого класса. Поскольку типизированный набор данных наследуется от базового класса <xref:System.Data.DataSet>, типизированный класс предполагает все функциональные возможности класса <xref:System.Data.DataSet> и может использоваться с методами, принимающими экземпляр класса <xref:System.Data.DataSet> в качестве параметра.

 Нетипизированный набор данных, напротив, не имеет соответствующей встроенной схемы. Как и в типизированном наборе данных, нетипизированный набор данных содержит таблицы, столбцы и т. д., но они доступны только в виде коллекций. (Однако после создания вручную таблиц и других элементов данных в нетипизированном наборе данных можно экспортировать структуру набора данных в виде схемы с помощью метода <xref:System.Data.DataSet.WriteXmlSchema%2A> набора данных.)

## <a name="contrasting-data-access-in-typed-and-untyped-datasets"></a>Сравнение доступа к данным в типизированных и нетипизированных наборах данных
 Класс для типизированного набора данных имеет объектную модель, в которой ее свойства принимают фактические имена таблиц и столбцов. Например, при работе с типизированным набором данных можно ссылаться на столбец с помощью следующего кода:

 [!code-csharp[VbRaddataDatasets#4](../snippets/csharp/VS_Snippets_VBCSharp/VbRaddataDatasets/CS/Form1.cs#4)]
 [!code-vb[VbRaddataDatasets#4](../snippets/visualbasic/VS_Snippets_VBCSharp/VbRaddataDatasets/VB/Form1.vb#4)]

 В отличие от этого, при работе с нетипизированным набором данных эквивалентный код будет следующим:

 [!code-csharp[VbRaddataDatasets#5](../snippets/csharp/VS_Snippets_VBCSharp/VbRaddataDatasets/CS/Form1.cs#5)]
 [!code-vb[VbRaddataDatasets#5](../snippets/visualbasic/VS_Snippets_VBCSharp/VbRaddataDatasets/VB/Form1.vb#5)]

 Типизированный доступ не только упрощает чтение, но и полностью поддерживается технологией IntelliSense в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] **редакторе кода**. Помимо упрощения работы с, синтаксис типизированного набора данных обеспечивает проверку типов во время компиляции, что значительно сокращает вероятность ошибок при присвоении значений элементам набора данных. Если изменить имя столбца в классе <xref:System.Data.DataSet>, а затем скомпилировать приложение, появится сообщение об ошибке сборки. Дважды щелкнув ошибку сборки в **список задач**, можно перейти непосредственно к строке или строкам кода, ссылающимся на старое имя столбца. Доступ к таблицам и столбцам в типизированном наборе данных также выполняется немного быстрее во время выполнения, так как доступ определяется во время компиляции, а не через коллекции во время выполнения.

 Несмотря на то, что типизированные наборы данных имеют много преимуществ, нетипизированный DataSet полезен в различных обстоятельствах. Самый очевидный сценарий — отсутствие схемы, доступной для набора данных. Это может произойти, например, если приложение взаимодействует с компонентом, который возвращает набор данных, но вы заранее не знакомы с его структурой. Аналогично, иногда при работе с данными, не имеющими статической, прогнозируемой структуры. В этом случае нецелесообразно использовать типизированный набор данных, так как придется повторно создавать типизированный класс DataSet с каждым изменением в структуре данных.

 Чаще всего существует много случаев, когда можно создать набор данных динамически, не имея доступной схемы. В этом случае набор данных является просто удобной структурой, в которой можно хранить сведения, если данные могут быть представлены реляционным способом. В то же время можно воспользоваться возможностями набора данных, такими как возможность сериализации данных для передачи в другой процесс или записи XML-файла.
