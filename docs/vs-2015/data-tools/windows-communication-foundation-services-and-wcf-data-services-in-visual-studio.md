---
title: Службы Windows Communication Foundation и WCF Data Services
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
helpviewer_keywords:
- services, WCF Data
- WCF services, binding to
- WCF services, asynchronous service methods
- service references [Visual Studio]
- WCF Data Services
- asynchronous calls
- service references [Visual Studio], type sharing
- endpoints [WCF]
- asynchronous service methods
- service references [Visual Studio] endpoints
- WCF services, type sharing
- Windows Communication Foundation, in Visual Studio
- services, WCF
- WCF service, Visual Studio
- data services, WCF
- services, in Visual Studio
- data binding [Visual Studio], WCF
- service endpoints [Visual Studio]
- service references [Visual Studio], asynchronous calls
- services, Windows Communication Foundation
- type sharing in WCF services
- WCF services, endpoints
- service method, called asynchronously[Visual Studio]
ms.assetid: d56f12cb-e139-4fec-b3e4-488383356642
caps.latest.revision: 29
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: e988c8818cdee756310b73d0d214deda43226f2b
ms.sourcegitcommit: c150d0be93b6f7ccbe9625b41a437541502560f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/10/2020
ms.locfileid: "75850216"
---
# <a name="windows-communication-foundation-services-and-wcf-data-services-in-visual-studio"></a>Службы Windows Communication Foundation и службы данных WCF в Visual Studio
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Visual Studio предоставляет средства для работы с Windows Communication Foundation (WCF) и [!INCLUDE[ssAstoria](../includes/ssastoria-md.md)], технологиями Майкрософт для создания распределенных приложений. В этом разделе приводятся общие сведения о службах с точки зрения [!INCLUDE[vsprvs](../includes/vsprvs-md.md)]. Полную документацию см. в разделе [WCF Data Services 4,5](https://msdn.microsoft.com/library/73d2bec3-7c92-4110-b905-11bb0462357a).

## <a name="what-is-wcf"></a>Что такое WCF?
 [!INCLUDE[vsindigo](../includes/vsindigo-md.md)] — это единая платформа для создания безопасных, надежных, транзакционных и взаимодействующих распределенных приложений. Он заменяет более старые технологии межпроцессного взаимодействия, такие как веб-службы ASMX, .NET Remoting, Enterprise Services (DCOM) и MSMQ. WCF объединяет функциональные возможности всех этих технологий в унифицированной модели программирования. Это упрощает процесс разработки распределенных приложений.

#### <a name="what-are-wcf-data-services"></a>Что такое WCF Data Services
 [!INCLUDE[ssAstoria](../includes/ssastoria-md.md)] является реализацией стандарта протокола Open Data (OData).  WCF Data Services позволяет предоставлять табличные данные в виде набора API-интерфейсов, что позволяет возвращать данные с помощью стандартных глаголов HTTP, таких как GET, POST, Set или DELETE. На стороне сервера WCF Data Services заменяются [веб-API ASP.NET](https://dotnet.microsoft.com/apps/aspnet/apis) для создания новых служб OData. WCF Data Services клиентской библиотеке остается хорошим выбором для использования служб OData в приложении .NET из Visual Studio (**проект &#124; Добавление ссылки на службу**). Дополнительные сведения см. в разделе [Службы данных WCF 4.5](https://msdn.microsoft.com/library/cc668792.aspx).

### <a name="wcf-programming-model"></a>Модель программирования WCF
 Модель программирования WCF основана на связи между двумя сущностями: службой WCF и клиентом WCF. Модель программирования инкапсулирована в пространстве имен <xref:System.ServiceModel> в [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)].

#### <a name="wcf-service"></a>Службы WCF
 Служба WCF основана на интерфейсе, который определяет контракт между службой и клиентом. Он помечается атрибутом <xref:System.ServiceModel.ServiceContractAttribute>, как показано в следующем коде:

 [!code-csharp[WCFWalkthrough#6](../snippets/csharp/VS_Snippets_VBCSharp/wcfwalkthrough/cs/iservice1.cs#6)]
 [!code-vb[WCFWalkthrough#6](../snippets/visualbasic/VS_Snippets_VBCSharp/wcfwalkthrough/vb/iservice1.vb#6)]

 [!code-csharp[WCFWalkthrough#1](../snippets/csharp/VS_Snippets_VBCSharp/wcfwalkthrough/cs/iservice1.cs#1)]
 [!code-vb[WCFWalkthrough#1](../snippets/visualbasic/VS_Snippets_VBCSharp/wcfwalkthrough/vb/iservice1.vb#1)]

 Вы определяете функции или методы, предоставляемые службой WCF, помечая их атрибутом <xref:System.ServiceModel.OperationContractAttribute>. Кроме того, можно предоставить сериализованные данные, пометив составной тип атрибутом <xref:System.Runtime.Serialization.DataContractAttribute>. Это позволяет реализовать привязку данных в клиенте.

 После определения интерфейса и его методов они инкапсулируются в классе, который реализует интерфейс. Один класс службы WCF может реализовывать несколько контрактов служб.

 Служба WCF предоставляется для использования тем, что называется *конечной точкой*. Конечная точка предоставляет единственный способ взаимодействия со службой. Вы не можете получить доступ к службе с помощью прямой ссылки, как и с другими классами.

 Конечная точка состоит из адреса, привязки и контракта. Адрес определяет расположение службы. Это может быть URL, адрес FTP или сетевой или локальный путь. Привязка определяет способ взаимодействия со службой. Привязки WCF предоставляют универсальную модель для указания протокола, например HTTP или FTP, механизма безопасности, такого как проверка подлинности Windows или имена пользователей и пароли, и многое другое. Контракт включает операции, предоставляемые классом службы WCF.

 Для одной службы WCF можно предоставить несколько конечных точек. Это позволяет разным клиентам взаимодействовать с одной и той же службой различными способами. Например, банковская служба может предоставить одну конечную точку для сотрудников и другую для внешних клиентов, каждый из которых использует другой адрес, привязку и (или) контракт.

#### <a name="wcf-client"></a>Клиент WCF
 Клиент WCF состоит из *прокси-сервера* , который позволяет приложению взаимодействовать со службой WCF и конечной точкой, соответствующей конечной точке, определенной для службы. Прокси-сервер создается на стороне клиента в файле App. config и включает сведения о типах и методах, предоставляемых службой. Для служб, предоставляющих несколько конечных точек, клиент может выбрать тот, который наилучшим образом соответствует его потребностям, например, для взаимодействия по протоколу HTTP и использования проверки подлинности Windows.

 После создания клиента WCF вы ссылаетесь на службу в коде так же, как любой другой объект. Например, чтобы вызвать метод `GetData`, показанный выше, необходимо написать код, похожий на следующий:

 [!code-csharp[WCFWalkthrough#3](../snippets/csharp/VS_Snippets_VBCSharp/wcfwalkthrough/cs/form1.cs#3)]
 [!code-vb[WCFWalkthrough#3](../snippets/visualbasic/VS_Snippets_VBCSharp/wcfwalkthrough/vb/form1.vb#3)]

## <a name="wcf-tools-in-visual-studio"></a>Средства WCF в Visual Studio
 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] предоставляет средства, помогающие создавать службы WCF и клиентов WCF. Пошаговое руководство, в котором демонстрируются средства, см. [в разделе Пошаговое руководство. Создание простой службы WCF в Windows Forms](../data-tools/walkthrough-creating-a-simple-wcf-service-in-windows-forms.md).

### <a name="creating-and-testing-wcf-services"></a>Создание и тестирование служб WCF
 Шаблоны [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] WCF можно использовать в качестве основы для быстрого создания собственной службы. Затем можно использовать автоматическое размещение и тестовый клиент WCF службы WCF для отладки и тестирования службы. Вместе эти инструменты обеспечивают быстрый и удобный цикл отладки и тестирования, а также устраняют необходимость занесения в модель размещения на ранней стадии.

#### <a name="wcf-templates"></a>Шаблоны WCF
 Шаблоны [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] WCF предоставляют базовую структуру классов для разработки служб. В диалоговом окне " **Добавление нового проекта** " доступны несколько шаблонов WCF. К ним относятся проекты библиотеки служб WCF, веб-сайты службы WCF и шаблоны элементов служб WCF.

 При выборе шаблона добавляются файлы для контракта службы, реализации службы и конфигурации службы. Все необходимые атрибуты уже добавлены, создается простой тип службы «Hello World», и вам не нужно писать какой-либо код. Вы, конечно же, хотите добавить код для предоставления функций и методов для реальной службы, но шаблоны предоставляют базовую основу.

 Дополнительные сведения о шаблонах WCF см. в разделе [шаблоны WCF Visual Studio](https://msdn.microsoft.com/library/6a608575-3535-4190-89da-911e24c8374f).

#### <a name="wcf-service-host"></a>Узел службы WCF
 При запуске отладчика [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] (нажав клавишу F5) для проекта службы WCF автоматически запускается служебный инструмент WCF для размещения службы локально. Узел службы WCF перечисляет службы в проекте службы WCF, загружает конфигурацию проекта и создает экземпляр узла для каждой найденной службы.

 С помощью узла службы WCF можно протестировать службу WCF без написания дополнительного кода или фиксации на определенном узле во время разработки.

 Дополнительные сведения об узле службы WCF см. в разделе [узел службы WCF (WcfSvcHost. exe)](https://msdn.microsoft.com/library/8643a63d-a357-4c39-bd6c-cdfdf71e370e).

#### <a name="wcf-test-client"></a>Тестовый клиент WCF
 Клиентское средство тестирования WCF позволяет вводить параметры теста, отправлять эти входные данные в службу WCF и просматривать ответ, отправляемый службой обратно. Он обеспечивает удобный процесс тестирования служб при объединении его с узлом службы WCF. Это средство можно найти в папке \Common7\IDE, которая для Visual Studio 2015 установлена на диске C: **C:\Program Files (x86) \Microsoft Visual Studio .\n\n-\ Common7\IDE\\** .

 При нажатии клавиши F5 для отладки проекта службы WCF откроется тестовый клиент WCF и отобразится список конечных точек служб, определенных в файле конфигурации. Вы можете проверить параметры и запустить службу и повторить эту процедуру для постоянного тестирования и проверки службы.

 Дополнительные сведения о тестовом клиенте WCF см. в разделе [WCF Test Client (клиент WcfTestClient. exe)](https://msdn.microsoft.com/library/d4302855-677f-4640-aa90-c5d785d72fb7).

### <a name="accessing-wcf-services-in-visual-studio"></a>Доступ к службам WCF в Visual Studio
 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] упрощает задачу создания клиентов WCF, автоматически создавая прокси-сервер и конечную точку для служб, добавляемых с помощью диалогового окна **Добавление ссылки на службу** . Все необходимые сведения о конфигурации добавляются в файл App. config. В большинстве случаев все, что нужно сделать, — это создать службу, чтобы использовать ее.

 Диалоговое окно **Добавление ссылки на службу** позволяет ввести адрес службы или найти службу, определенную в решении. Диалоговое окно возвращает список служб и операции, предоставляемые этими службами. Он также позволяет определить пространство имен, по которому будут ссылаться на службы в коде.

 Диалоговое окно **Настройка ссылок на службы** позволяет настроить конфигурацию службы. Вы можете изменить адрес службы, указать уровень доступа, асинхронное поведение и типы контрактов сообщений, а также настроить повторное использование типов.

## <a name="how-to-select-a-service-endpoint"></a>Как выбрать конечную точку службы
 Некоторые службы Windows Communication Foundation (WCF) предоставляют несколько конечных точек, через которые клиент может взаимодействовать со службой. Например, служба может предоставлять одну конечную точку, использующую привязку HTTP и безопасность имени пользователя и пароля, а вторую конечную точку, использующую проверку подлинности FTP и Windows. Первая конечная точка может использоваться приложениями, которые обращаются к службе извне брандмауэра, тогда как вторая может использоваться в интрасети.

 В этом случае можно указать `endpointConfigurationName` в качестве параметра конструктора для ссылки на службу.

 [!INCLUDE[note_settings_general](../includes/note-settings-general-md.md)]

#### <a name="to-select-a-service-endpoint"></a>Выбор конечной точки службы

1. Добавьте ссылку на службу WCF, щелкнув правой кнопкой мыши узел проекта в обозреватель решений и выбрав **Добавить ссылку на службу** .

2. В редакторе кода добавьте конструктор для ссылки на службу:

    ```vb
    Dim proxy As New ServiceReference.Service1Client(
    ```

    ```csharp
    ServiceReference.Service1Client proxy = new ServiceReference.Service1Client(
    ```

    > [!NOTE]
    > Замените *укзать* на пространство имен для ссылки на службу и замените *Service1Client* именем службы.

3. Отобразится список IntelliSense с перегрузками для конструктора. Выберите перегрузку `endpointConfigurationName As String`.

4. После перегрузки введите `=` *configurationName*, где *configurationName* — это имя конечной точки, которую вы хотите использовать.

    > [!NOTE]
    > Если вы не знакомы с именами доступных конечных точек, их можно найти в файле App. config.

#### <a name="to-find-the-available-endpoints-for-a-wcf-service"></a>Поиск доступных конечных точек для службы WCF

1. В **Обозреватель решений**щелкните правой кнопкой мыши файл App. config для проекта, содержащего ссылку на службу, а затем нажмите кнопку **Открыть**. Файл появится в редакторе кода.

2. Выполните поиск тега `<Client>` в файле.

3. Найдите тег `<Client>` тега, который начинается с `<Endpoint>`.

     Если ссылка на службу предоставляет несколько конечных точек, то будут состоять из двух или более тегов `<Endpoint`.

4. Внутри тега `<EndPoint>` можно найти параметр `name="`*сомесервице*`"` (где *сомесервице* представляет имя конечной точки). Это имя конечной точки, которое может быть передано в `endpointConfigurationName As String`ую перегрузку конструктора для ссылки на службу.

## <a name="how-to-call-a-service-method-asynchronously"></a>Как асинхронно вызывать метод службы
 Большинство методов в службах Windows Communication Foundation (WCF) могут вызываться синхронно или асинхронно. Асинхронный вызов метода позволяет приложению продолжать работать во время вызова метода, когда он работает через низкую связь.

 По умолчанию при добавлении ссылки на службу в проект она настраивается для синхронного вызова методов. Вы можете изменить поведение для асинхронного вызова методов, изменив параметр в диалоговом окне **Настройка ссылки на службу** .

> [!NOTE]
> Этот параметр задается отдельно для каждой службы. Если один метод для службы вызывается асинхронно, все методы должны вызываться асинхронно.

 [!INCLUDE[note_settings_general](../includes/note-settings-general-md.md)]

#### <a name="to-call-a-service-method-asynchronously"></a>Асинхронный вызов метода службы

1. В **Обозреватель решений**выберите ссылку на службу.

2. В меню **проект** выберите пункт **настроить ссылку на службу**.

3. В диалоговом окне **Настройка ссылки на службу** установите флажок **создать асинхронные операции** .

## <a name="how-to-bind-data-returned-by-a-service"></a>Как привязать данные, возвращаемые службой
 Данные, возвращаемые службой Windows Communication Foundation (WCF), можно привязать к элементу управления точно так же, как можно привязать любой другой источник данных к элементу управления. При добавлении ссылки на службу WCF, если служба содержит составные типы, возвращающие данные, они автоматически добавляются в окно **Источники данных** .

#### <a name="to-bind-a-control-to-single-data-field-returned-by-a-wcf-service"></a>Привязка элемента управления к одному полю данных, возвращаемому службой WCF

1. В меню **Данные** выберите команду **Показать источники данных**. Появится окно **Источники данных** .

2. В окне **Источники данных** разверните узел для ссылки на службу. Будут отображены все составные типы, возвращаемые службой.

3. Разверните узел для типа. Будут отображены поля данных для этого типа.

4. Выберите поле и щелкните стрелку раскрывающегося списка, чтобы отобразить список элементов управления, доступных для данного типа данных.

5. Выберите тип элемента управления, к которому необходимо выполнить привязку.

6. Перетащите поле на форму. Элемент управления будет добавлен в форму вместе с компонентом <xref:System.Windows.Forms.BindingSource> и компонентом <xref:System.Windows.Forms.BindingNavigator>.

7. Повторите шаги 4 – 6 для всех других полей, которые необходимо привязать.

#### <a name="to-bind-a-control-to-composite-type-returned-by-a-wcf-service"></a>Привязка элемента управления к составному типу, возвращаемому службой WCF

1. В меню **данные** выберите команду **отобразить источники данных**. Появится окно **Источники данных** .

2. В окне **Источники данных** разверните узел для ссылки на службу. Будут отображены все составные типы, возвращаемые службой.

3. Выберите узел для типа и щелкните стрелку раскрывающегося списка, чтобы отобразить список доступных параметров.

4. Щелкните **элемент DataGridView** , чтобы отобразить данные в сетке или **подробные сведения** , чтобы отобразить данные в отдельных элементах управления.

5. Перетащите узел на форму. Элементы управления будут добавлены в форму вместе с компонентом <xref:System.Windows.Forms.BindingSource> и компонентом <xref:System.Windows.Forms.BindingNavigator>.

## <a name="how-to-configure-a-service-to-reuse-existing-types"></a>Как настроить службу для повторного использования существующих типов
 При добавлении ссылки на службу в проект все типы, определенные в службе, создаются в локальном проекте. Во многих случаях это создает дублирующиеся типы, когда служба использует общие типы [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] или если типы определены в общей библиотеке.

 Во избежание этой проблемы типы в ссылочных сборках являются общими по умолчанию. Если вы хотите отключить совместное использование типов для одной или нескольких сборок, это можно сделать в диалоговом окне **Настройка ссылок на службы** .

#### <a name="to-disable-type-sharing-in-a-single-assembly"></a>Отключение совместного использования типов в одной сборке

1. В **Обозреватель решений**выберите ссылку на службу.

2. В меню **проект** выберите пункт **настроить ссылку на службу**.

3. В диалоговом окне **Настройка ссылок на службы** выберите **повторно использовать типы в указанных сборках, на которые имеются ссылки**.

4. Установите флажок для каждой сборки, в которой необходимо включить совместное использование типов. Чтобы отключить совместное использование типов для сборки, оставьте флажок снятым.

#### <a name="to-disable-type-sharing-in-all-assemblies"></a>Отключение совместного использования типов во всех сборках

1. В **Обозреватель решений**выберите ссылку на службу.

2. В меню **проект** выберите пункт **настроить ссылку на службу**.

3. В диалоговом окне **Настройка ссылок на службы** снимите флажок **повторно использовать типы в ссылочных сборках** .

## <a name="related-topics"></a>Связанные разделы

|Заголовок|Описание|
|-----------|-----------------|
|[Пошаговое руководство. Создание простой службы WCF в Windows Forms](../data-tools/walkthrough-creating-a-simple-wcf-service-in-windows-forms.md)|Содержит пошаговую демонстрацию создания и использования служб WCF в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)].|
|[Пошаговое руководство. Создание службы данных WCF с помощью WPF и Entity Framework](../data-tools/walkthrough-creating-a-wcf-data-service-with-wpf-and-entity-framework.md)|Содержит пошаговую демонстрацию создания и использования [!INCLUDE[ssAstoria](../includes/ssastoria-md.md)] в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)].|
|[Использование средств разработки WCF](https://msdn.microsoft.com/library/054adb87-c244-4d5a-83d1-0b2b44bd454b)|Описывает создание и тестирование служб WCF в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)].|
|[Как добавить, обновить или удалить ссылку на службу](https://msdn.microsoft.com/library/cacc14bd-4455-4a44-be78-d2ac16113dd9)|Описывает добавление, обновление или удаление служб WCF из проекта.|
|[Практическое руководство. Добавление, обновление или удаление ссылки на службу данных WCF](../data-tools/how-to-add-update-or-remove-a-wcf-data-service-reference.md)|Описывает, как ссылаться и использовать [!INCLUDE[ssAstoria](../includes/ssastoria-md.md)] в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)].|
|[Диагностика ссылок на службы](../data-tools/troubleshooting-service-references.md)|Представляет некоторые распространенные ошибки, которые могут возникнуть при работе со ссылками на службы и способы их предотвращения.|
|[Отладка служб WCF](../debugger/debugging-wcf-services.md)|Описание распространенных проблем отладки и методов, которые могут возникнуть при отладке служб WCF.|
|[Общие сведения о службе проверки подлинности Windows Communication Foundation](https://msdn.microsoft.com/library/6e121a28-89e8-4974-88a8-70aaa6a7d52b)|Описывает использование WCF для предоставления службы роли для веб-сайта.|
|[Пошаговое руководство. Создание многоуровневого приложения для работы с данными](../data-tools/walkthrough-creating-an-n-tier-data-application.md)|Содержит пошаговые инструкции по созданию типизированного набора данных и разделения кода адаптера таблицы и набора данных на несколько проектов.|
|[Диалоговое окно "Настроить ссылку на службу"](../data-tools/configure-service-reference-dialog-box.md)|Описывает элементы пользовательского интерфейса диалогового окна **Настройка ссылки на службу** .|

## <a name="reference"></a>Справочные сведения
 <xref:System.ServiceModel>

 <xref:System.Data.Services>

## <a name="see-also"></a>См. также раздел
 [Visual Studio Data Tools для .NET](../data-tools/visual-studio-data-tools-for-dotnet.md)
