---
title: Добавление новых источников данных | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
f1_keywords:
- vs.datasource.datasourcefieldspicker
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- data [Visual Studio], data sources
- data sources
ms.assetid: ed28c625-bb89-4037-bfde-cfa435d182a2
caps.latest.revision: 60
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: c9f6b7334c7032414bfd0fbf7ecf9ad48b414cb9
ms.sourcegitcommit: 08fc78516f1107b83f46e2401888df4868bb1e40
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65701047"
---
# <a name="add-new-data-sources"></a>Добавление новых источников данных
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

В контексте .NET data tools в Visual Studio термин *источника данных* ссылается на объекты .NET, которые подключаются к хранилищу данных и предоставлять эти данные приложения .NET. Конструкторы Visual Studio можно использовать выходные данные источника данных для создания стандартный код, который привязывает данные формы, при перетаскивании объектов базы данных из **источников данных** окна. Этот тип источника данных может быть:  
  
- Класс в модели Entity Framework, которая связана с каким-либо базы данных.  
  
- Набор данных, который связан с каким-либо базы данных.  
  
- Класс, который представляет сетевой службы, такие как службы Windows Communication Foundation (WCF) данных или к службе REST.  
  
- Класс, представляющий службу SharePoint.  
  
- Класс или коллекции в решении.  
  
> [!NOTE]
> Если вы не используете функции привязки данных, наборы данных, Entity Framework, LINQ to SQL, WCF или SharePoint, понятие «data source» не применяется. Просто подключиться непосредственно к базе данных с помощью объектов SQLCommand и взаимодействовать непосредственно с базой данных.  
  
 Создание и изменение источников данных с помощью **мастер настройки источника данных** в приложении Windows Forms или Windows Presentation Foundation. Для платформы Entity Framework, сначала создайте классы сущностей, а затем запустите мастер, выбрав **проекта** > **добавить новый источник данных** (более подробно далее в этой статье).  
  
 ![Мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png "мастера настройки источника данных")  
  
 После создания источника данных, он отображается в **источников данных** окно инструментов (Shift + Alt + D или **представление** > **Other Windows**  >  **Источника данных**). Можно перетащить из источника данных **источников данных** окна на поверхность разработки формы или элемента управления. Стандартный код будет создан в результате — код, который отображает данные, происходящие в хранилище данных для пользователя. Ниже показан набор данных, который был удален на форму Windows. Если вы выбрали F5 на приложения, данные из базы данных будет отображаться в элементах управления формы.  
  
 ![Операции перетаскивания источника данных](../data-tools/media/raddata-data-source-drag-operation.png "операции перетаскивания raddata источника данных")  
  
## <a name="data-source-for-a-database-or-a-database-file"></a>Источник данных для базы данных или файл базы данных  
  
### <a name="dataset"></a>Набор данных  
 Чтобы создать набор данных в качестве источника данных, выполните **мастер настройки источника данных** (**проекта** > **Добавление новых данных** источника) и выберите  **База данных** типа источника данных. Следуйте инструкциям на экране, чтобы указать подключение к новой или существующей базе данных или файл базы данных.  
  
### <a name="entity-classes"></a>Классы сущностей  
 Чтобы создать модель Entity Framework в качестве источника данных, сначала выполните **мастер моделей EDM** для создания классов сущностей (**проекта** > **Добавление нового элемента**  >  **Модель ADO.NET EDM**).  
  
 ![Новый элемент проекта модели Entity Framework](../data-tools/media/raddata-new-entity-framework-model-project-item.png "элемент проекта модели raddata новой инфраструктуры Entity Framework")  
  
 Выберите метод, по которому необходимо для создания модели.  
  
 ![Мастер моделей EDM](../data-tools/media/raddata-entity-data-model-wizard.png "raddata мастер моделей EDM")  
  
 Добавление модели в качестве источника данных. Классы, которые были созданы, появляются в **мастер настройки источника данных** при выборе **объектов** категории.  
  
 ![Мастер настройки источника данных с классами сущностей](../data-tools/media/raddata-data-source-configuration-wizard-with-entity-classes.png "raddata мастер настройки источника данных с помощью классов сущностей")  
  
## <a name="data-source-for-a-service"></a>Источник данных для службы  
 Чтобы создать источник данных из службы, запустите **мастер настройки источника данных** и выберите **службы** типа источника данных. Это просто ярлык для **Add Service Reference** dialog box, в котором можно также перейти, щелкнув правой кнопкой мыши проект в **обозревателе решений** и выбрав **Добавление ссылки на службу** .  
  
 При создании источника данных из службы Visual Studio добавляет ссылку на службу в проект. Visual Studio также создает прокси-объекты, которые соответствуют объектам, которые возвращает служба. Например это служба, которая возвращает набор данных, представляется в проекте как набор данных; Служба, которая возвращает определенного типа, представляется в проекте как тип.  
  
 Можно создать источник данных из следующих типов служб:  
  
- Службы данных WCF. Дополнительные сведения см. в разделе [Обзор](https://msdn.microsoft.com/library/7924cf94-c9a6-4015-afc9-f5d22b1743bb).  
  
- Службы данных WCF. Дополнительные сведения см. в разделе [службы Windows Communication Foundation и WCF Data Services в Visual Studio](../data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio.md).  
  
- Веб-службы.  
  
    > [!NOTE]
    > Элементы, отображаемые в **источников данных** окне зависят от данных, возвращаемый службой. Некоторые службы могут предоставлять недостаточный объем информации для того, чтобы **Мастер настройки источника данных** создал объекты с возможностью привязки. Например, если служба возвращает нетипизированный набор данных, элементы не будут отображаться в **источников данных** окно, когда вы завершите работу мастера. Это потому, что нетипизированные наборы данных не предусматривают схемы, и поэтому мастер не имеет достаточно сведений для создания источника данных.  
  
## <a name="data-source-for-an-object"></a>Источник данных для объекта  
 Можно создать источник данных из любого объекта, который предоставляет один или несколько общих служб, выполнив **мастер настройки источника данных** и выбрав **объект** типа источника данных. Все открытые свойства объекта отображаются в **источников данных** окна.   Если вы используете Entity Framework и создали модель, это где найти классы сущностей, которые будут находиться источники данных для приложения.  
  
 На **Выбор объектов данных** странице, разверните узлы в представлении в виде дерева для поиска объектов, которые вы хотите выполнить привязку к. Дерево содержит узлы для проекта, а также для сборки и другие проекты, на которые ссылается проект.  
  
 Если вы хотите выполнить привязку к объекту в сборку или проект, который не отображается в представлении в виде дерева, щелкните **добавить ссылку** и использовать **Add Reference Dialog Box** для добавления ссылки на проект или сборку. После добавления ссылки на сборку или проект добавляется в вид дерева.  
  
> [!NOTE]
> Может потребоваться постройте проект, который содержит объекты, объекты отображаются в представлении в виде дерева.  
  
> [!NOTE]
> Для поддержки привязки данных и перетащите объекты, реализующие <xref:System.ComponentModel.ITypedList> или <xref:System.ComponentModel.IListSource> интерфейс должен иметь конструктор по умолчанию. В противном случае Visual Studio не удается создать экземпляр объекта источника данных, и выводится сообщение об ошибке при перетаскивании элемента в область конструктора.  
  
## <a name="data-source-for-a-sharepoint-list"></a>Источник данных для списка SharePoint  
 Можно создать источник данных из списка SharePoint, запустив **мастер настройки источника данных** и выбрав **SharePoint** типа источника данных. SharePoint предоставляет данные через [!INCLUDE[ssAstoria](../includes/ssastoria-md.md)], поэтому создание источника данных SharePoint не отличается от создания источника данных из службы. Выбрав **SharePoint** элемент **мастер настройки источника данных** открывает **Add Service Reference** диалоговое окно, где можно подключиться к службе данных SharePoint Наведите указатель на сервере SharePoint.  Для этого требуется пакет SharePoint SDK.  
  
## <a name="see-also"></a>См. также  
 [Visual Studio Data Tools для .NET](../data-tools/visual-studio-data-tools-for-dotnet.md)
