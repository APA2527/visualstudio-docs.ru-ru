---
title: Добавить новые источники данных | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
f1_keywords:
- vs.datasource.datasourcefieldspicker
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- data [Visual Studio], data sources
- data sources
ms.assetid: ed28c625-bb89-4037-bfde-cfa435d182a2
caps.latest.revision: 60
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 85c07ad7995bc614df4b988bb17fa8977452b5d8
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72673063"
---
# <a name="add-new-data-sources"></a>Добавление новых источников данных
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

В контексте средств работы с данными .NET в Visual Studio термин *источник данных* относится к объектам .NET, которые подключаются к хранилищу данных и предоставляют данные приложению .NET. Разработчики Visual Studio могут использовать выходные данные источника данных для создания стандартного кода, который привязывает данные к формам при перетаскивании объектов базы данных из окна **Источники данных** . Этот тип источника данных может быть следующим:

- Класс в модели Entity Framework, связанный с некоторым типом базы данных.

- Набор данных, связанный с некоторым типом базы данных.

- Класс, представляющий сетевую службу, такую как служба данных Windows Communication Foundation (WCF) или служба RESTFUL.

- Класс, представляющий службу SharePoint.

- Класс или коллекция в решении.

> [!NOTE]
> Если вы не используете функции привязки данных, наборы данных, Entity Framework, LINQ to SQL, WCF или SharePoint, понятие «Data Source» не применяется. Просто подключитесь непосредственно к базе данных с помощью объектов SQLCommand и напрямую взаимодействует с базой данных.

 Создание и изменение источников данных осуществляется с помощью **мастера настройки источника данных** в Windows Forms или Windows Presentation Foundation приложении. Для Entity Framework сначала создайте классы сущностей, а затем запустите мастер, выбрав **проект**  > **Добавить новый источник данных** (более подробно см. Далее в этой статье).

 ![Мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png "мастер настройки источника данных")

 После создания источника данных он отображается в окне инструментов **Источники данных** (Shift + Alt + D или **View**  >  другой**источник данных** > **Windows** ). Источник данных можно перетащить из окна **Источники данных** в область конструктора или на элемент управления формы. В результате создается стандартный код — код, отображающий данные, поступающие в хранилище данных пользователю. На следующем рисунке показан набор данных, который был удален в форму Windows Forms. Если в приложении был выбран параметр F5, то данные из базовой базы данных будут отображаться в элементах управления формы.

 ![Операция перетаскивания источника данных](../data-tools/media/raddata-data-source-drag-operation.png "операция перетаскивания источника данных раддата")

## <a name="data-source-for-a-database-or-a-database-file"></a>Источник данных для базы данных или файла базы данных

### <a name="dataset"></a>Набор данных
 Чтобы создать набор данных в качестве источника данных, запустите **Мастер настройки источника данных** (**проект**  > **Добавить новый источник данных** ) и выберите тип **базы** данных Data-Source. Следуйте инструкциям на экране, чтобы указать новое или существующее подключение к базе данных или файл базы данных.

### <a name="entity-classes"></a>Классы сущностей
 Чтобы создать модель Entity Framework в качестве источника данных, сначала запустите **мастер EDM** , чтобы создать классы сущностей (**проект**  > **добавить новый элемент**  > **ADO.NET EDM**).

 ![Новый элемент проекта модели Entity Framework](../data-tools/media/raddata-new-entity-framework-model-project-item.png "раддата новый элемент проекта модели Entity Framework")

 Выберите метод, по которому требуется создать модель.

 ![Мастер EDM](../data-tools/media/raddata-entity-data-model-wizard.png "Мастер EDM раддата")

 Добавьте модель в качестве источника данных. Созданные классы отображаются в **мастере настройки источника данных** при выборе категории **объекты** .

 ![Мастер настройки источников данных с классами сущностей](../data-tools/media/raddata-data-source-configuration-wizard-with-entity-classes.png "Мастер настройки источника данных раддата с классами сущностей")

## <a name="data-source-for-a-service"></a>Источник данных для службы
 Чтобы создать источник данных из службы, запустите **Мастер настройки источника данных** и выберите тип источника данных **службы** . Это просто ярлык диалогового окна **Добавление ссылки на службу** , доступ к которому можно получить, щелкнув правой кнопкой мыши проект в **Обозреватель решений** и выбрав пункт **Добавить ссылку на службу**.

 При создании источника данных из службы Visual Studio добавляет в проект ссылку на службу. Visual Studio также создает прокси-объекты, которые соответствуют объектам, возвращаемым службой. Например, служба, возвращающая набор данных, представлена в проекте как набор данных. Служба, которая возвращает конкретный тип, представлена в проекте как возвращаемый тип.

 Источник данных можно создать из следующих типов служб:

- Службы данных WCF. Дополнительные сведения см. в разделе [Обзор](https://msdn.microsoft.com/library/7924cf94-c9a6-4015-afc9-f5d22b1743bb).

- WCF Data Services. Дополнительные сведения см. [в разделе Windows Communication Foundation Services and WCF Data Services в Visual Studio](../data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio.md).

- Веб-службы.

    > [!NOTE]
    > Элементы, отображаемые в окне **Источники данных** , зависят от данных, возвращаемых службой. Некоторые службы могут предоставлять недостаточный объем информации для того, чтобы **Мастер настройки источника данных** создал объекты с возможностью привязки. Например, если служба возвращает нетипизированный набор данных, в окне **Источники данных** не будут отображаться элементы после завершения работы мастера. Это обусловлено тем, что нетипизированные наборы данных не предоставляют схему, и поэтому мастер не содержит достаточно сведений для создания источника.

## <a name="data-source-for-an-object"></a>Источник данных для объекта
 Источник данных можно создать из любого объекта, предоставляющего одно или несколько открытых свойств, запустив **Мастер настройки источника данных** , а затем выбрав тип источника данных **объекта** . Все открытые свойства объекта отображаются в окне **Источники данных** .   Если вы используете Entity Framework и создали модель, здесь можно найти классы сущностей, которые будут источниками данных для вашего приложения.

 На странице **Выбор объектов данных** разверните узлы в представлении в виде дерева, чтобы выбрать объекты, к которым необходимо выполнить привязку. Представление в виде дерева содержит узлы проекта, а также сборки и другие проекты, на которые ссылается проект.

 Если требуется выполнить привязку к объекту в сборке или проекте, который не отображается в древовидном представлении, нажмите кнопку **Добавить ссылку** и используйте **диалоговое окно Добавление ссылки** , чтобы добавить ссылку на сборку или проект. После добавления ссылки сборка или проект добавляются в представление в виде дерева.

> [!NOTE]
> Возможно, потребуется построить проект, содержащий объекты, прежде чем они появятся в представлении в виде дерева.

> [!NOTE]
> Для поддержки привязки данных при перетаскивании объекты, реализующие интерфейс <xref:System.ComponentModel.ITypedList> или <xref:System.ComponentModel.IListSource>, должны иметь конструктор по умолчанию. В противном случае Visual Studio не сможет создать экземпляр объекта источника данных и отобразит ошибку при перетаскивании элемента в область конструктора.

## <a name="data-source-for-a-sharepoint-list"></a>Источник данных для списка SharePoint
 Источник данных можно создать из списка SharePoint, запустив **Мастер настройки источника данных** и выбрав тип источника данных **SharePoint** . SharePoint предоставляет данные через [!INCLUDE[ssAstoria](../includes/ssastoria-md.md)], поэтому создание источника данных SharePoint аналогично созданию источника данных из службы. При выборе элемента **SharePoint** в **мастере настройки источника данных** открывается диалоговое окно **Добавление ссылки на службу** , в котором можно подключиться к службе данных SharePoint, указав сервер SharePoint.  Для этого требуется пакет SDK для SharePoint.

## <a name="see-also"></a>См. также раздел
 [Visual Studio Data Tools для .NET](../data-tools/visual-studio-data-tools-for-dotnet.md)
