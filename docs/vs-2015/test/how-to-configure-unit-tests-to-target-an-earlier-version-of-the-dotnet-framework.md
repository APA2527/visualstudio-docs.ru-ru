---
title: Практическое руководство. Настройка модульных тестов для более ранней версии .NET Framework | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-test
ms.topic: conceptual
ms.assetid: adb6c011-5abd-41d2-8ead-08cd7579bf37
caps.latest.revision: 14
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: fd212eb304e6cba022b067b8b432cf00fc3f87ba
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72660539"
---
# <a name="how-to-configure-unit-tests-to-target-an-earlier-version-of-the-net-framework"></a>Практическое руководство. Настройка модульных тестов для более ранней версии .NET Framework
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

При создании тестового проекта в Microsoft Visual Studio последняя версия платформы .NET Framework устанавливается в качестве целевой по умолчанию. Кроме того, при обновлении тестовых проектов, созданных в предыдущих версиях Visual Studio, они обновляются до последней версии платформы .NET Framework. Путем изменения свойств проекта можно явно изменить целевую версию .NET Framework для проекта на более раннюю.

 Вы можете создавать проекты модульных тестов, предназначенные для определенных версий .NET Framework. Целевой версией может быть версия 3.5 или более поздняя и не может быть версия клиента. Visual Studio включает следующую базовую поддержку для модульных тестов, которые предназначены для определенных версий:

- Можно создать проекты модульных тестов и установить для них определенную версию платформы .NET Framework.

- Можно запускать модульные тесты, которые предназначены для определенной версии платформы .NET Framework, в Visual Studio на локальном компьютере.

- Можно запускать модульные тесты, которые предназначены для определенной версии платформы .NET Framework, с помощью программы MSTest.exe из командной строки.

- Можно выполнять модульные тесты в агенте сборки в рамках сборки.

  **Тестирование приложений SharePoint**

  Перечисленные выше возможности также позволяют с помощью Visual Studio создавать модульные тесты и тесты интеграции для приложений SharePoint. [!INCLUDE[crabout](../includes/crabout-md.md)] О способах разработки приложений SharePoint в Visual Studio см. в разделах [Создание решений SharePoint](https://msdn.microsoft.com/library/4bfb1e59-97c9-4594-93f8-3068b4eb9631), [Построение и отладка решений SharePoint](https://msdn.microsoft.com/library/c9e7c9ab-4eb3-40cd-a9b9-6c2a896f70ae) и [Проверка и отладка кода SharePoint](https://msdn.microsoft.com/library/b5f3bce2-6a51-41b1-a292-9e384bae420c).

  **Ограничения**

  При изменении требуемой версии .NET Framework для тестовых проектов на более раннюю версию действуют указанные ниже ограничения.

- В .NET Framework 3.5 настройка для различных версий поддерживается для тестовых проектов, содержащих только модульные тесты. Версия .NET Framework 3.5 не поддерживает какие-либо другие типы тестов, например закодированные тесты пользовательского интерфейса или нагрузочные тесты. Изменение требуемой версии .NET Framework заблокировано для всех типов тестов, кроме модульных тестов.

- Выполнение тестов, которые предназначены для более ранних версий платформы .NET Framework, поддерживается только в адаптере по умолчанию. Оно не поддерживается для адаптера ASP.NET. Приложения ASP.NET, которые должны выполняться в контексте ASP.NET Development Server, должны быть совместимы с текущей версией .NET Framework.

- Поддержка сбора данных отключена при запуске тестов, поддерживающих настройку для различных версий, включая .NET Framework 3.5. Покрытие кода можно обеспечить с помощью программ командной строки Visual Studio.

- Модульные тесты, использующие .NET Framework 3.5, нельзя выполнять на удаленном компьютере.

- Невозможно назначить модульные тесты для более ранних клиентских версий платформы.

### <a name="re-targeting-to-a-specific-version-of-the-net-framework-for-visual-basic-unit-test-projects"></a>Назначение определенной версии платформы .NET Framework для проектов модульных тестов Visual Basic

1. Создайте проект модульного теста Visual Basic. В меню **Файл** выберите команду **Создать**, а затем пункт **Проект**.

     Откроется диалоговое окно **Новый проект**.

2. В области **Установленные шаблоны** разверните узел **Visual Basic**. Выберите **Тест**, а затем шаблон **Тестовый проект**.

3. В текстовом поле **Имя** введите имя тестового проекта Visual Basic и нажмите кнопку **ОК**.

4. В обозревателе решений выберите пункт **Свойства** в контекстном меню нового тестового проекта Visual Basic.

     Будут показаны свойства тестового проекта Visual Basic.

5. На вкладке **Компиляция** выберите **Дополнительные параметры компиляции**, как показано на приведенной ниже иллюстрации.

     ![Дополнительные параметры компиляции](../test/media/howtoconfigureunittest35frameworka.png "HowToConfigureUnitTest35FrameworkA")

6. С помощью раскрывающегося списка **Заданная исполняющая среда (все конфигурации)** измените требуемую версию на **.NET Framework 3.5** или на более позднюю, как показано в выноске В на рисунке ниже. Указывать версию клиента не следует.

     ![Раскрывающийся&#45;список целевой платформы](../test/media/howtoconfigureunitest35frameworkstepb.png "HowToConfigureUniTest35FrameworkStepB")

### <a name="re-targeting-to-a-specific-version-of-the-net-framework-for-visual-c-unit-test-projects"></a>Назначение определенной версии платформы .NET Framework для проектов модульных тестов Visual C#

1. Создайте проект модульного теста Visual C#. В меню **Файл** выберите команду **Создать**, а затем пункт **Проект**.

     Откроется диалоговое окно **Новый проект**.

2. В области **Установленные шаблоны** разверните узел **Visual C#** . Выберите **Тест**, а затем шаблон **Тестовый проект**.

3. В текстовом поле **Имя** введите имя тестового проекта Visual C# и нажмите кнопку **ОК**.

4. В обозревателе решений выберите пункт **Свойства** в контекстном меню нового тестового проекта Visual C#.

     Будут показаны свойства тестового проекта Visual C#.

5. На вкладке **Приложение** выберите **Целевая рабочая среда**, а затем **.NET Framework 3.5** или более позднюю версию из раскрывающегося списка, чтобы изменить целевую платформу, как показано на рисунке ниже. Указывать версию клиента не следует.

     ![Раскрывающийся&#45;список целевой платформы](../test/media/howtoconfigureunittest35frameworkcsharp.png "HowToConfigureUnitTest35FrameworkCSharp")

### <a name="re-targeting-to-a-specific-version-of-the-net-framework-for-ccli-unit-test-projects"></a>Перенацеливание на определенную версию платформы .NET Framework для проектов модульного теста C++/CLI.

1. Создайте проект модульного теста C++. В меню **Файл** последовательно выберите пункты **Создать** и **Проект**.

     Откроется диалоговое окно **Новый проект**.

    > [!WARNING]
    > Для сборки модульных тестов C++/CLI для предыдущей версии платформы .NET Framework для Visual C++ следует использовать соответствующую версию Visual Studio. Например, чтобы задать .NET Framework 3.5 в качестве целевой версии, необходимо установить [!INCLUDE[vs_orcas_long](../includes/vs-orcas-long-md.md)] и [!INCLUDE[vs_orcas_long](../includes/vs-orcas-long-md.md)] с пакетом обновления 1 (SP1).

2. В области **Установленные шаблоны** разверните узел **Visual C++** . Выберите **Тест**, а затем шаблон **Тестовый проект**.

3. В текстовом поле **Имя** введите имя тестового проекта Visual C++ и нажмите кнопку **ОК**.

4. В обозревателе решений выберите команду **Выгрузить проект** для нового тестового проекта Visual C++.

5. В обозревателе решений выберите выгруженный тестовый проект Visual C++, а затем **Изменить \<имя проекта>.vcxproj**.

     VCXPROJ-файл откроется в редакторе.

6. Задайте для `TargetFrameworkVersion` версию 3.5 или более позднюю в группе `PropertyGroup`, обозначенной как `"Globals"`. Указывать версию клиента не следует.

    ```
    <PropertyGroup Label="Globals">
        <TargetName>DefaultTest</TargetName>
        <ProjectTypes>{3AC096D0-A1C2-E12C-1390-A8335801FDAB};{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}</ProjectTypes>
        <ProjectGUID>{CE16D77A-E364-4ACD-948B-1EB6218B0EA3}</ProjectGUID>
        <TargetFrameworkVersion>3.5</TargetFrameworkVersion>
        <Keyword>ManagedCProj</Keyword>
        <RootNamespace>CPP_Test</RootNamespace>
      </PropertyGroup>

    ```

7. Сохраните и закройте VCXPROJ-файл.

8. В обозревателе решений выберите в контекстном меню нового тестового проекта Visual C++ пункт **Перезагрузить проект**.

## <a name="see-also"></a>См. также раздел
 [Создание и запуск модульных тестов для существующего кода](https://msdn.microsoft.com/e8370b93-085b-41c9-8dec-655bd886f173) [Создание решений SharePoint](https://msdn.microsoft.com/library/4bfb1e59-97c9-4594-93f8-3068b4eb9631) создание [и отладка решений sharepoint](https://msdn.microsoft.com/library/c9e7c9ab-4eb3-40cd-a9b9-6c2a896f70ae) [Дополнительные параметры компилятора (Visual Basic)](../ide/reference/advanced-compiler-settings-dialog-box-visual-basic.md)
