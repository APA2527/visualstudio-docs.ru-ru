---
title: Определение профиля для расширения UML | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-modeling
ms.topic: conceptual
helpviewer_keywords:
- profiles, UML
- stereotypes, UML
- UML, profiles and stereotypes
- UML - extending, defining profiles
- UML, customizing
- UML, profiles
ms.assetid: 776589cb-f89d-48d5-aafa-04a4c074b0d6
caps.latest.revision: 44
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: e621297b36d75a0e48baed4ab24d50abd5e61663
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72668691"
---
# <a name="define-a-profile-to-extend-uml"></a>Определение профиля для расширения UML
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Можно определить *профиль UML* для настройки стандартных элементов модели для конкретных целей. Профиль определяет один или несколько *стереотипов UML*. Стереотип можно использовать, чтобы пометить тип как представляющий определенный вид объекта. Стереотип также может расширять список свойств элемента.

 В поддерживаемых выпусках Visual Studio установлено несколько профилей. Чтобы узнать, какие версии Visual Studio поддерживают эту функцию, см. раздел [Version support for architecture and modeling tools](../modeling/what-s-new-for-design-in-visual-studio.md#VersionSupport). Дополнительные сведения об этих профилях и о применении стереотипов см. в статье [Настройка модели с помощью профилей и стереотипов](../modeling/customize-your-model-with-profiles-and-stereotypes.md).

 Вы можете определить собственные профили, чтобы адаптировать и расширить UML в соответствии с конкретной сферой бизнеса и архитектурой системы. Пример:

- Если вы регулярно определяете веб-сайты, можно определить собственный профиль, предоставляющий стереотип "Веб-страница", который можно применять к классам на схеме классов. Затем схемы классов можно использовать для планирования веб-сайта. Каждый класс "Веб-страница" будет иметь дополнительные свойства для содержимого страницы, стиля и т. д.

- При разработке программного обеспечения для банковских операций можно определить профиль, предоставляющий стереотип "Счет". Затем схемы классов можно использовать для определения различных типов счетов и отображения отношений между ними.

  Профили можно распределить между членами команды. Каждый член команды может установить ваш профиль. Это позволяет им редактировать и создавать модели, использующие стереотипы профиля.

> [!NOTE]
> Если стереотипы профиля применяются в редактируемой модели, после чего общий доступ к модели предоставляется другим людям, им необходимо установить тот же профиль на своих компьютерах. В противном случае они не смогут увидеть использованные стереотипы.

 Профиль часто является частью большего [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)] расширения. Например, можно определить команду, которая переводит некоторые части модели в код. Вы можете определить профиль, который пользователи должны применять к пакетам, которые нужно перевести. Созданная команда распространяется вместе с профилем в одном расширении [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)].

 Также можно определить локализованные варианты профиля. Пользователи, загружающие расширение, видят вариант, соответствующий их языку и региональным параметрам.

## <a name="DefineProfile"></a>Определение профиля

#### <a name="to-define-a-uml-profile"></a>Определение профиля UML

1. Создайте XML-файл с расширением `.profile`.

2. Добавьте определения стереотипа в соответствии с рекомендациями, описанными в разделе [Структура профиля](#Schema).

3. Добавьте профиль в расширение Visual Studio (файл `.vsix`). Вы можете либо создать новое расширение для профиля, либо добавить профиль в существующее расширение.

     См. следующий раздел, [в котором описывается добавление профиля в расширение Visual Studio](#AddProfile).

4. Установите расширение на компьютер.

    1. Дважды щелкните файл расширения, который имеет расширение `.vsix`.

    2. Перезапустите Visual Studio.

5. Убедитесь в том, что профиль установлен.

    1. Выберите модель в обозревателе UML.

    2. В окно свойств щелкните свойство **Profiles** . Профиль появится в меню. Установите флажок рядом с профилем.

    3. Выберите элемент, для которого профиль определяет стереотипы. В окно свойств щелкните свойство **стереотипы** . Стереотипы появятся в списке. Установите флажок рядом с одним из стереотипов.

    4. Если профиль определяет дополнительные свойства для этого стереотипа, для их просмотра разверните свойство стереотипа.

6. Отправьте файл расширения другим пользователям [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] для установки на их компьютеры.

## <a name="AddProfile"></a>Добавление профиля в расширение Visual Studio
 Чтобы установить профиль и разрешить его отправку другим пользователям, нужно добавить профиль в расширение Visual Studio. Дополнительные сведения см. в разделе [развертывание расширений Visual Studio](http://go.microsoft.com/fwlink/?LinkId=160780).

#### <a name="to-define-a-profile-in-a-new-visual-studio-extension"></a>Определение профиля в новом расширении Visual Studio

1. Создайте проект расширения Visual Studio.

   > [!NOTE]
   > Чтобы выполнить эту процедуру, нужно установить пакет SDK для [!INCLUDE[vsipsdk](../includes/vsipsdk-md.md)].

   1. В меню **Файл** выберите пункт **Создать**, а затем команду **Проект**.

   2. В диалоговом окне **Новый проект** в разделе **Установленные шаблоны**разверните узел **визуальный C#** элемент, щелкните **расширяемость**, а затем щелкните **проект VSIX**. Задайте имя проекта и нажмите кнопку **ОК**.

2. Добавьте профиль в проект.

   - В обозреватель решений щелкните правой кнопкой мыши проект, наведите указатель на пункт **Добавить**и выберите пункт **существующий элемент**. В диалоговом окне найдите файл профиля.

3. Установите свойство **Копировать в выходной** файл профиля.

   1. В обозреватель решений щелкните правой кнопкой мыши файл профиля и выберите пункт **Свойства**.

   2. В окно свойств задайте для свойства **Копировать в выходной каталог** значение **всегда копировать**.

4. В обозревателе решений откройте файл `source.extension.vsixmanifest`.

    Файл откроется в редакторе манифеста расширения.

5. На странице **активы** добавьте строку, описывающую профиль:

   - Щелкните **Создать**. Задайте поля в диалоговом окне **Добавление нового ресурса** следующим образом.

   - Задайте для параметра **тип** значение `Microsoft.VisualStudio.UmlProfile`

        Это значение недоступно в раскрывающемся списке. Введите его с клавиатуры.

   - Щелкните **файл в файловой системе** и выберите имя файла профиля, например `MyProfile.profile`

6. Выполните построение проекта.

7. **Чтобы выполнить отладку профиля**, нажмите клавишу F5.

    Откроется экспериментальный экземпляр Visual Studio. Откройте в нем проект моделирования. В обозревателе UML выберите корневой элемент модели, а затем в окне "Свойства" выберите свой профиль. Затем выберите элементы внутри модели и задайте стереотипы, определенные для них.

8. **Извлечение VSIX для развертывания**

   1. В проводнике Windows откройте папку **.\бин\дебуг** или **.\бин\релеасе** , чтобы найти **VSIX** файл. Это файл расширения [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)]. Его можно установить на своем компьютере и отправить другим пользователям Visual Studio.

   2. Чтобы установить расширение, выполните указанные ниже действия.

       1. Дважды щелкните файл `.vsix`. Запустится установщик расширения Visual Studio.

       2. Перезапустите все выполняемые экземпляры Visual Studio.

   Если пакет [!INCLUDE[vsipsdk](../includes/vsipsdk-md.md)] не установлен, для небольших расширений можно использовать описанную ниже альтернативную процедуру.

#### <a name="to-define-a-profile-extension-without-using-visual-studio-sdk"></a>Определение расширения профиля без использования Visual Studio SDK

1. Создайте каталог Windows, содержащий следующие три файла:

    - *YourProfile* `.profile`

    - `extension.vsixmanifest`

    - `[Content_Types].xml` — введите это имя, как показано здесь, заключив его в квадратные скобки.

2. Измените файл `[Content_Types].xml`, включив в него приведенный ниже текст. Обратите внимание, что он содержит запись для каждого расширения имени файла.

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
      <Default Extension="profile" ContentType="application/octet-stream" />
      <Default Extension="vsixmanifest" ContentType="text/xml" />
    </Types>
    ```

3. Скопируйте существующий файл `extension.vsixmanifest` и измените его с помощью редактора XML. Измените узлы ID, Name и Content.

    - Пример файла `extension.vsixmanifest` можно найти в следующем каталоге:

         *диск* **: \Program Files\Microsoft Visual Studio [версия] \Common7\IDE\Extensions\Microsoft\Architecture тулс\умлпрофилес**

    - Узел Content должен иметь следующий вид:

        ```
        <Content>
          <CustomExtension Type="Microsoft.VisualStudio.UmlProfile"
          >YourProfile.Profile</CustomExtension>
        </Content>
        ```

4. Упакуйте три файла в сжатый ZIP-файл.

     В проводнике Windows выберите три файла, щелкните правой кнопкой мыши, наведите указатель на пункт **Отправить**, а затем выберите пункт **Сжатая ZIP-папка**.

5. Переименуйте ZIP-файл и измените его расширение с `.zip` на `.vsix`.

6. Чтобы установить профиль на любой компьютер с соответствующими выпусками Visual Studio, дважды щелкните файл `.vsix`.

#### <a name="to-install-a-uml-profile-from-a-visual-studio-extension"></a>Установка профиля UML из расширения Visual Studio

1. Дважды щелкните файл `.vsix` в проводнике или откройте его в Visual Studio.

2. В появившемся диалоговом окне нажмите кнопку **установить** .

3. Чтобы удалить или временно отключить расширение, откройте меню **Сервис** и выберите пункт **расширения и обновления** .

## <a name="Localized"></a>Определение локализованных профилей
 Вы можете определить разные профили для разных языков и региональных параметров и упаковать их в одно расширение. При загрузке расширения пользователь увидит профиль, определенный для его языка и региональных параметров.

 Всегда нужно указывать профиль по умолчанию. Он отображается, если профиль для языка и региональных параметров пользователя не определен.

#### <a name="to-define-a-localized-profile"></a>Определение локализованного профиля

1. Создайте профиль, как описано в предыдущих разделах[Определение профиля](#DefineProfile) и [Добавление профиля в расширение Visual Studio](#AddProfile). Это профиль по умолчанию, который будет использоваться в любой установке, для которой не предоставлен локализованный профиль.

2. Добавьте новый каталог в каталог, в котором уже находится файл профиля по умолчанию.

    > [!NOTE]
    > Если расширение создается с помощью проекта расширения Visual Studio, для добавления новой папки в проект используйте обозреватель решений.

3. Измените имя нового каталога на короткий код ISO для языка локализации, например `bg` для болгарского или `fr` для французского. Следует использовать нейтральный идентификатор языка и региональных параметров (как правило, состоящий из двух букв), а не указывать конкретные язык и региональные параметры, например `fr-CA`. Дополнительные сведения о кодах языка и региональных параметрах см. в разделе [метод CultureInfo. DataCulture](http://go.microsoft.com/fwlink/?LinkId=160782), который предоставляет полный список кодов языка и региональных параметров.

4. Добавьте копию профиля по умолчанию в новый каталог. Не изменяйте имя файла.

     Пример папки расширения [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)], перед ее построением или сжатием в файл `.vsix`, будет содержать следующие папки и файлы:

     `extension.vsixmanifest`

     `MyProfile.profile`

     `fr\MyProfile.profile`

     `de\MyProfile.profile`

    > [!NOTE]
    > Не следует вставлять в файл `extension.vsixmanifest` ссылку на локализованные версии профилей. Скопированные файлы профилей должны иметь те же имена, что и профили в родительской папке.

5. Измените новую копию профиля, переведя на соответствующий язык все части, которые будут видны пользователю, такие как атрибуты `displayName`.

6. Вы можете создать дополнительные папки и локализованные профили для неограниченного числа языков и региональных параметров.

7. Выполните сборку расширения Visual Studio, создав проект расширения или сжав все файлы, следуя инструкциям в предыдущих разделах.

## <a name="Schema"></a>Структура профиля
 XSD-файл для профилей UML можно найти в следующем примере: [Настройка стереотипов и профилей XSD](http://go.microsoft.com/fwlink/?LinkID=213811). Для облегчения изменения файлов профилей установите файл `.xsd` в следующий каталог:

 **%ProgramFiles%\Microsoft Visual Studio [версия] \Ксмл\счемас**

 В этом разделе в качестве примера используется профиль C#. Полное определение профиля можно найти в следующем каталоге:

 *диск* **: \Program Files\Microsoft Visual Studio [версия] \Common7\IDE\Extensions\Microsoft\Architecture тулс\умлпрофилес\кшарп.профиле**

 В вашей установке первые части этого пути могут отличаться от указанных.

 Дополнительные сведения о профиле .NET см. в разделе [Стандартные стереотипы для моделей UML](../modeling/standard-stereotypes-for-uml-models.md).

### <a name="main-sections-of-the-uml-profile-definition"></a>Основные разделы определения профиля UML
 Каждый профиль имеет следующее содержимое:

```
<?xml version="1.0" encoding="utf-8"?>
<profile dslVersion="1.0.0.0"
       name="CSharpProfile" displayName="C# Profile"
       xmlns="http://schemas.microsoft.com/UML2.1.2/ProfileDefinition">
  <stereotypes>...</stereotypes>
  <metaclasses>...</metaclasses>
  <propertyTypes>...</propertyTypes>
</profile>
```

> [!NOTE]
> В атрибуте `name` не должно быть пробелов или знаков препинания. Атрибут `displayName`, отображаемый в пользовательском интерфейсе, должен представлять собой допустимую строку XML.

 В каждом профиле имеется три основных раздела. Ниже они представлены в обратном порядке.

- `<propertyTypes>` — список типов, которые используются для свойств, определенных в разделе стереотипов.

- `<metaclasses>` — список типов элементов модели, к которым применимы стереотипы в этом профиле, такие как IClass, IInterface, IOperation, IDependency.

- `<stereotypes>` — определения стереотипов. Каждое определение включает имена и типы свойств, добавляемых в целевой элемент модели.

#### <a name="property-types"></a>Типы свойств
 В разделе `<propertyTypes>` объявляется список типов, используемых для свойств в разделе `<stereotypes>`. Существует две разновидности типов свойств: внешние типы и перечисление.

 Внешний тип объявляет полное имя стандартного типа .NET.

```
<externalType name="System.String" />
```

 Тип перечисления определяет набор литеральных значений.

```
<enumerationType name="PackageVisibility">
  <enumerationLiterals>
    <enumerationLiteral name="internal" displayName="internal"  />
    <enumerationLiteral name="protectedinternal" displayName="protected internal" />
  </enumerationLiterals>
</enumerationType>
```

#### <a name="metaclasses"></a>Метаклассы
 Раздел `<metaclasses>` представляет собой список типов элементов модели, для которых можно определить стереотипы в данном профиле.

```
<metaclass
      name="Microsoft.VisualStudio.Uml.Classes.IClass" />
<metaclass
      name="Microsoft.VisualStudio.Uml.Classes.IInterface" />
<metaclass
      name="Microsoft.VisualStudio.Uml.Components.IComponent" />
```

 Полный список элементов модели и типов отношений, которые можно использовать в качестве метаклассы, см. в разделе [типы элементов модели](#Elements).

#### <a name="stereotype-definition"></a>Определение стереотипа
 Раздел `<stereotypes>` содержит одно или несколько определений стереотипов.

```
<stereotype name="CSharpClass" displayName="C# Class"> ...
```

 В каждом стереотипе перечислены один или несколько типов элементов модели или отношений, к которым его можно применять. Можно указать имя базового типа, в который включены все производные типы. Например, если задать `Microsoft.VisualStudio.Uml.Classes.IType`, стереотип можно применить к `IClass`, `IInterface`, `IEnumeration` и некоторым другим типам элементов.

```
<metaclasses>
  <metaclassMoniker name=
   "/CSharpProfile/Microsoft.VisualStudio.Uml.Classes.IClass" />
</metaclasses>
```

 Атрибут `name` объекта `metaclassMoniker` представляет собой ссылку на элемент в разделе `<metaClasses>`.

> [!NOTE]
> Имя моникера должно начинаться с `/yourProfileName/`, где `yourProfileName` определяется в атрибуте `name` профиля (CSharpProfile в этом примере). Моникер заканчивается именем одной из записей в разделе метаклассов.

 В каждом стереотипе можно перечислить сколько угодно свойств (или ни одного), которые он добавляет в любой элемент модели, к которому применяется. @No__t_0 содержит ссылку на один из типов, определенных в разделе `<propertyTypes>`. Это должна быть ссылка `<externalTypeMoniker>`, указывающая на `<externalType>,`, или `<enumerationTypeMoniker>`, указывающая на `<enumerationType>`. Ссылка начинается с имени профиля.

```
  <properties>
    <property name="IsStatic"
            displayName="Is Static" defaultValue="false">
      <propertyType>
<externalTypeMoniker
               name="/CSharpProfile/System.Boolean" />
      </propertyType>
    </property>
    <property name="PackageVisibility"
              displayName="Package Visibility"
              defaultValue="internal">
      <propertyType>
        <enumerationTypeMoniker
              name="/CSharpProfile/PackageVisibility"/>
      </propertyType>
    </property>
  </properties>
</stereotype>
```

## <a name="Elements"></a>Типы элементов модели
 Набор типов, для которых можно определить стереотипы, перечислен в [типах элементов модели UML](../modeling/uml-model-element-types.md).

## <a name="troubleshooting"></a>Устранение неполадок
 Мои стереотипы не отображаются в моделях UML.
Необходимо выбрать свой профиль в пакете или модели. Стереотипы появятся в элементах внутри пакета или модели. Дополнительные сведения см. [в разделе Добавление стереотипов в элементы модели UML](../modeling/add-stereotypes-to-uml-model-elements.md).

 При открытии модели UML появляется следующая ошибка: **VS1707: не удается загрузить следующие профили из-за ошибки сериализации: мипрофиле. Profile**
1. Убедитесь в правильности базового синтаксиса XML файла PROFILE.

2. Убедитесь в том, что имя каждого моникера представлено в форме /имя_профиля/имя_узла. Имя_профиля — это значение атрибута имени в корневом узле профиля. Имя_узла — это значение атрибута имени в метаклассе, внешнем типе или типе перечисления.

3. Убедитесь, что синтаксис описан здесь, и, как показано в разделе _диск_ **: \Program Files\Microsoft Visual Studio [версия] \Common7\IDE\Extensions\Microsoft\Architecture тулс\умлпрофилес \\** .

4. Удалите расширение с ошибкой. В меню **Сервис** выберите пункт **Расширения и обновления**.

   - Если расширение не отображается, см. следующий пункт.

5. Выполните повторную сборку файла VSIX и откройте его в проводнике для повторной установки. Перезапустите [!INCLUDE[vsprvs](../includes/vsprvs-md.md)].

   Расширение не отображается в диспетчере расширений, но при попытке его повторной установки появляется следующее сообщение: **расширение уже установлено для всех применимых продуктов.**
   1. Удалите файл расширения из вложенной папки *LocalAppData*\микрософт\висуалстудио \\ [Version] \екстенсионс\

   - Чтобы увидеть *LocalAppData*, необходимо установить флажки Показать скрытые файлы и папки на вкладке Вид в окне Параметры папки проводника Windows.

   - *LocalAppData* обычно находится в C:\Users \\*имя_пользователя*\аппдата\локал\

6. Перезапустите [!INCLUDE[vsprvs](../includes/vsprvs-md.md)].

## <a name="see-also"></a>См. также раздел
 [Добавление стереотипов в элементы модели UML](../modeling/add-stereotypes-to-uml-model-elements.md) [Настройка модели с помощью профилей и](../modeling/customize-your-model-with-profiles-and-stereotypes.md) [стандартных стереотипов стереотипов для моделей UML](../modeling/standard-stereotypes-for-uml-models.md) [пример. цвет элементов UML по образцу стереотипа](http://go.microsoft.com/fwlink/?LinkID=213841) [: Настройка стереотипов, XSD-схем](http://go.microsoft.com/fwlink/?LinkID=213811)
