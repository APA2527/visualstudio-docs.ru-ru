---
title: Использовать карты кода для отладки приложений | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-modeling
ms.topic: conceptual
helpviewer_keywords:
- Visual Studio Ultimate, visualizing code
- Visual Studio Ultimate, navigating code visually
- Visual Studio Ultimate, understanding code
- Visual Studio Ultimate, mapping code relationships
- Visual Studio Ultimate, code maps
- mapping code relationships
- code maps
- mapping relationships in code
ms.assetid: 9fd0c9a2-d351-40c8-be88-0749788264bf
caps.latest.revision: 51
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: b7f446d2c9a1b22488746eff9ba04044d2621013
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63439673"
---
# <a name="use-code-maps-to-debug-your-applications"></a>Использование карт кода для отладки приложений
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Карты кода помогают не запутаться в больших базах кода, малознакомом или устаревшем коде. Например, при отладке может потребоваться просмотреть код во множестве файлов и проектов. Используйте карты кода для перехода между частями кода и просмотра связей между ними. Таким образом, вам не нужно держать весь этот код у себя в голове или рисовать отдельную схему. Карты кода помогут вспомнить особенности кода в случае перерыва в работе.  
  
 ![Карта кода &#45; сопоставить связи в коде](../modeling/media/codemapstoryboardpaint.png "CodeMapStoryboardPaint")  
  
 **Зеленая стрелка показывает нахождение курсора в редакторе**  
  
 Узнать о командах и действиях, которые можно использовать при работе с картами кода, см. в разделе [Просмотр и реорганизация карт кода](../modeling/browse-and-rearrange-code-maps.md).  
  
## <a name="understand-the-problem"></a>Определение проблемы  
 Предположим, что возникла ошибка в программе рисования, над которой вы работаете. Чтобы воспроизвести ошибку, откройте решение в Visual Studio и нажать клавишу **F5** запустить отладку.  
  
 При рисовании линии и выберите **отменить последнюю линию**, ничего не происходит, пока не будет нарисована следующая строка.  
  
 ![Карта кода &#45; воспроизведение ошибки](../modeling/media/codemapstoryboardpaint0.png "CodeMapStoryboardPaint0")  
  
 Таким образом, вы начинаете поиск ошибки с поиска метода `Undo`. Он находится в классе `PaintCanvas`.  
  
 ![Карта кода &#45; поиск кода](../modeling/media/codemapstoryboardpaint1.png "CodeMapStoryboardPaint1")  
  
## <a name="start-mapping-the-code"></a>Запуск сопоставления кода  
 Теперь можно начинать сопоставление метода `undo` и его отношений. В редакторе кода добавьте метод `undo` и поля, на которые он ссылается, в новую карту кода. При создании новой карты потребуется какое-то время на индексацию кода. Благодаря этому последующие операции выполняются быстрее.  
  
 ![Карта кода &#45; Показать метода и соответствующих полей](../modeling/media/codemapstoryboardpaint3.png "CodeMapStoryboardPaint3")  
  
> [!TIP]
> Зеленым цветом выделены последние элементы, добавленные на карту. Зеленая стрелка указывает положение курсора в коде. Стрелки между элементами представляют различные отношения. Можно получить дополнительные сведения об элементах на карте, наведя на них указатель мыши и изучив подсказки.  
  
 ![Карта кода &#45; отображение всплывающих подсказок](../modeling/media/codemapstoryboardpaint4.png "CodeMapStoryboardPaint4")  
  
## <a name="navigate-and-examine-code-from-the-map"></a>Навигация и просмотр кода из сопоставления  
 Чтобы просмотреть определение кода для каждого поля, дважды щелкните поле на карте или выберите поле и нажмите клавишу **F12**. Зеленая стрелка перемещается между элементами на карте. Курсор в редакторе кода также перемещается автоматически.  
  
 ![Карта кода &#45; Проверка определения поля](../modeling/media/codemapstoryboardpaint5.png "CodeMapStoryboardPaint5")  
  
 ![Карта кода &#45; Проверка определения поля](../modeling/media/codemapstoryboardpaint5a.png "CodeMapStoryboardPaint5A")  
  
> [!TIP]
> Кроме того, для перемещения зеленой стрелки на карте можно перемещать курсор в редакторе кода.  
  
## <a name="understand-relationships-between-pieces-of-code"></a>Отношения между частями кода  
 Теперь необходимо узнать, какой другой код взаимодействует с полями `history` и `paintObjects`. Можно добавить все методы, которые ссылаются на эти поля, на карту. Это можно сделать из карты или из редактора кода.  
  
 ![Карта кода &#45; найти все ссылки](../modeling/media/codemapstoryboardpaint6.png "CodeMapStoryboardPaint6")  
  
 ![Откройте карту кода из редактора кода](../modeling/media/codemapstoryboardpaint6a.PNG "CodeMapStoryboardPaint6A")  
  
> [!NOTE]
> Если вы добавляете элементы из проекта, который совместно используется несколькими приложениями, такими как приложения Windows Phone или Магазина Windows, эти элементы всегда отображаются вместе с текущим активным проектом приложения на карте. Таким образом, при изменении контекста на другой проект приложения контекст на карте для вновь добавленных элементов из общего проекта также изменяется. Операции, выполняемые с элементом на карте, применяются только к тем элементам, которые имеют общий контекст.  
  
 Измените макет, чтобы изменить поток отношений и упростить чтение карты. Также можно перемещать элементы по карте, перетаскивая их.  
  
 ![Карта кода &#45; изменение макета](../modeling/media/codemapstoryboardpaint7a.png "CodeMapStoryboardPaint7A")  
  
> [!TIP]
> По умолчанию **последовательный макет** включен. Это значит, что изменение макета карты будет минимальным при добавлении новых элементов. Для всей карты изменялся при каждом добавлении новых элементов, отключите **последовательный макет**.  
  
 ![Карта кода &#45; изменение макета](../modeling/media/codemapstoryboardpaint7.png "CodeMapStoryboardPaint7")  
  
 Рассмотрим эти методы. На карте, дважды щелкните **PaintCanvas** метод, или выберите этот метод и нажмите клавишу **F12**. Этот метод создаст `history` и `paintObjects` как пустые списки.  
  
 ![Карта кода &#45; Проверка определения метода](../modeling/media/codemapstoryboardpaint8.png "CodeMapStoryboardPaint8")  
  
 Теперь повторите эти же шаги, чтобы просмотреть определение метода `clear`. Метод `clear` выполнит некоторые задачи с `paintObjects` и `history`. Затем он вызовет метод `Repaint`.  
  
 ![Карта кода &#45; Проверка определения метода](../modeling/media/codemapstoryboardpaint9.png "CodeMapStoryboardPaint9")  
  
 Теперь просмотрите определение метода `addPaintObject`. Он также выполнит некоторые задачи с `history` и `paintObjects`. Он также вызовет `Repaint`.  
  
 ![Карта кода &#45; Проверка определения метода](../modeling/media/codemapstoryboardpaint10.png "CodeMapStoryboardPaint10")  
  
## <a name="find-the-problem-by-examining-the-map"></a>Поиск проблемы путем анализа сопоставления  
 Кажется, что все методы, изменяющие `history` и `paintObjects`, вызывают `Repaint`. Однако метод `undo` не вызывает `Repaint`, даже если `undo` изменяет те же поля. Поэтому эту проблему можно решить, вызвав метод `Repaint` из `undo`.  
  
 ![Карта кода &#45; поиск отсутствующего вызова метода](../modeling/media/codemapstoryboardpaint11.png "CodeMapStoryboardPaint11")  
  
 Если бы не было карты, на которой можно проверить этот отсутствующий вызов, найти эту проблему было бы сложнее, особенно в более сложном коде.  
  
## <a name="share-your-discovery-and-next-steps"></a>Совместное использование обнаружения и следующие действия  
 Прежде чем вы или кто-то другой исправит эту ошибку, можно оставить на карте примечания о проблеме и о том, как ее исправить.  
  
 ![Карта кода &#45; комментирование и пометка элементов для исполнения](../modeling/media/codemapstoryboardpaint12.png "CodeMapStoryboardPaint12")  
  
 Например, можно добавить комментарии на карту и отметить элементы с помощью цветов.  
  
 ![Карта кода &#45; комментария и отмеченные элементы](../modeling/media/codemapstoryboardpaint12a.png "CodeMapStoryboardPaint12A")  
  
 Если установлена программа Microsoft Outlook, можно отправить карту другим пользователям по электронной почте. Можно также экспортировать карту в виде изображения или в другом формате.  
  
 ![Карта кода &#45; общую папку экспорта, mail](../modeling/media/codemapstoryboardpaint13.png "CodeMapStoryboardPaint13")  
  
## <a name="fix-the-problem-and-show-what-you-did"></a>Устранение проблемы и отображение сделанного  
 Чтобы исправить ошибку, добавьте вызов `Repaint` в `undo`.  
  
 ![Карта кода &#45; Добавление отсутствующего вызова метода](../modeling/media/codemapstoryboardpaint14.png "CodeMapStoryboardPaint14")  
  
 Чтобы убедиться, что ошибка исправлена, перезапустите сеанс отладки и попробуйте воспроизвести ошибку. Теперь команда **отменить последнюю линию** работает должным образом и подтверждает внесенные правильным решением.  
  
 ![Карта кода &#45; исправление кода Подтверждение](../modeling/media/codemapstoryboardpaint15.png "CodeMapStoryboardPaint15")  
  
 Можно обновить карту для отображения внесенного исправления.  
  
 ![Карта кода &#45; обновление карты с учетом отсутствующего вызова метода](../modeling/media/codemapstoryboardpaint16.png "CodeMapStoryboardPaint16")  
  
 Теперь на карте отображается связь между **отменить** и **Repaint**.  
  
 ![Карта кода &#45; обновленная карта с вызовом метода](../modeling/media/codemapstoryboardpaint17.png "CodeMapStoryboardPaint17")  
  
> [!NOTE]
> При обновлении карты можно увидеть сообщение об обновлении индекса кода, используемого для создания карты. Это значит, что кто-то изменил код, в результате чего ваша карта не соответствует текущему коду. Это не помешает обновить карту, однако может потребоваться заново создать карту, чтобы убедиться, что она соответствует коду.  
  
 Расследование закончено. Вы успешно нашли и устранили проблему путем сопоставления кода. Также у вас есть карта, с помощью которой можно переходить по коду, вспоминать предыдущие действия и просматривать действия, предпринятые для решения проблемы.  
  
## <a name="see-also"></a>См. также  
 [Сопоставление методов в стеке вызовов при отладке](../debugger/map-methods-on-the-call-stack-while-debugging-in-visual-studio.md)   
 [Визуализация кода](../modeling/visualize-code.md)
