---
title: Развертывание MSI и VSIX для DSL | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-modeling
ms.topic: conceptual
ms.assetid: 6ce16f06-1978-4e19-8cdc-441ee65a3fb2
caps.latest.revision: 4
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 749763a9a2bb742bb3670050010f497c5c15fba4
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72668594"
---
# <a name="msi-and-vsix-deployment-of-a-dsl"></a>Развертывание доменного языка с использование MSI и VSIX
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Вы можете установить доменный язык на своем компьютере или на других компьютерах. [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] уже должны быть установлены на целевом компьютере.

## <a name="which"></a>Выбор между развертыванием VSIX и MSI
 Существует два способа развертывания предметно-ориентированного языка:

|Метод|Преимущества|
|------------|--------------|
|VSX (расширение [!INCLUDE[vsprvs](../includes/vsprvs-md.md)])|Простота развертывания: Скопируйте и выполните **VSIX** файл из проекта DslPackage.<br /><br /> Дополнительные сведения см. [в статье Установка и удаление DSL с помощью VSX](#Installing).|
|MSI (файл установщика)|— Позволяет пользователю открыть [!INCLUDE[vsprvs](../includes/vsprvs-md.md)], дважды щелкнув файл DSL.<br />— Связывает значок с типом файла DSL на конечном компьютере.<br />— Связывает XSD (схему XML) с типом файла DSL. Это позволяет избежать предупреждений при загрузке файла в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)].<br /><br /> Чтобы создать MSI-файл, необходимо добавить в решение проект установки.<br /><br /> Дополнительные сведения см. в разделе [Развертывание DSL с помощью MSI-файла](#msi).|

## <a name="Installing"></a>Установка и удаление DSL с помощью VSX
 При установке DSL этим методом пользователь может открыть файл DSL в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)], но файл нельзя открыть из проводника Windows.

#### <a name="to-install-a-dsl-by-using-the-vsx"></a>Установка DSL с помощью VSX

1. На компьютере найдите **VSIX** файл, созданный проектом пакета DSL.

    1. В **Обозреватель решений**щелкните правой кнопкой мыши проект **DslPackage** и выберите пункт **Открыть папку в проводнике Windows**.

    2. Откройте файл **bin \\ \* \\** _йоурпрожект_ **. DslPackage. VSIX**

2. Скопируйте **VSIX** файл на конечный компьютер, на который необходимо установить DSL. Это может быть как ваш собственный компьютер, так и любой другой.

    - На целевом компьютере должен быть установлен один из выпусков [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)], поддерживающих DSL во время выполнения. Дополнительные сведения см. в разделе [Поддерживаемые выпуски Visual Studio для визуализации & моделирования SDK](../modeling/supported-visual-studio-editions-for-visualization-amp-modeling-sdk.md).

    - На целевом компьютере должен быть установлен один из выпусков [!INCLUDE[vsprvs](../includes/vsprvs-md.md)], указанных в **дслпаккаже\саурце.екстенсионс.манифест**.

3. На целевом компьютере дважды щелкните **VSIX** -файл.

     Откроется**установщик расширений Visual Studio** , который устанавливает расширение.

4. Запустите или перезапустите [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)].

5. Чтобы протестировать DSL, используйте [!INCLUDE[vsprvs](../includes/vsprvs-md.md)], чтобы создать новый файл с расширением, определенным для вашего DSL.

#### <a name="to-uninstall-a-dsl-that-was-installed-by-using-vsx"></a>Удаление DSL, установленного с помощью VSX

1. В меню **Сервис** выберите пункт **Диспетчер расширений**.

2. Разверните узел **Установленные расширения**.

3. Выберите расширение, в котором определен DSL, и нажмите кнопку **Удалить**.

   Иногда неисправное расширение не удается загрузить, в результате чего в окне ошибок создается отчет, который не отображается в диспетчере расширений. В этом случае расширение можно удалить, удалив файл из следующей папки:

   *LocalAppData* **\Microsoft\VisualStudio\10.0\Extensions**

## <a name="msi"></a>Развертывание DSL в MSI
 Определив файл MSI (установщик Windows) для DSL, можно разрешить пользователям открывать файлы DSL из проводника Windows. Можно также связать значок и краткое описание с расширением имени файла. Кроме того, MSI может установить XSD, который можно использовать для проверки файлов DSL. При необходимости можно добавить в MSI другие компоненты, которые будут установлены одновременно.

 Дополнительные сведения о файлах MSI и других вариантах развертывания см. в разделе [развертывание приложений, служб и компонентов](../deployment/deploying-applications-services-and-components.md).

 Чтобы создать MSI, добавьте в решение [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] проект установки. Самый простой способ создать проект установки — использовать шаблон CreateMsiSetupProject.tt, который можно загрузить с [сайта VMSDK](http://go.microsoft.com/fwlink/?LinkID=186128).

#### <a name="to-deploy-a-dsl-in-an-msi"></a>Развертывание DSL в MSI

1. Задайте `InstalledByMsi` в манифесте расширения. Это предотвращает установку и удаление VSX, кроме MSI. Это важно, если в MSI будут включены другие компоненты.

   1. Открыть Дслпаккаже\саурце.екстенсион.ТТ

   2. Перед `<SupportedProducts>` вставьте следующую строку:

       ```
       <InstalledByMsi>true</InstalledByMsi>
       ```

2. Создайте или измените значок, который будет представлять ваш DSL в проводнике Windows. Например, Edit **дслпаккаже\ресаурцес\филе.ИКО**

3. Убедитесь в правильности следующих атрибутов DSL:

   - В обозревателе DSL щелкните корневой узел, а затем в окно свойств проверьте следующее:

       - Описание

       - Version

   - Щелкните узел **редактора** и в окно свойств щелкните **значок**. Задайте значение для ссылки на файл значка в **дслпаккаже\ресаурцес**, например **File. ico.**

   - В меню **Сборка** откройте **Configuration Manager**и выберите конфигурацию, которую требуется собрать, например **выпуск** или **отладку**.

4. Перейдите на [домашнюю страницу SDK визуализации и моделирования](http://go.microsoft.com/fwlink/?LinkID=186128)и на вкладке **Downloads (загрузки** ) Скачайте **CreateMsiSetupProject.TT**.

5. Добавьте **CreateMsiSetupProject.TT** в проект DSL.

    [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] создаст файл с именем **креатемсисетуппрожект. vdproj**.

6. В проводнике Windows скопируйте DSL \\ *. vdproj в новую папку с именем Setup.

    (Если нужно, теперь можно исключить CreateMsiSetupProject.tt из проекта DSL.)

7. В **Обозреватель решений**добавьте **программу установки \\ \*. vdproj** в качестве существующего проекта.

8. В меню **проект** выберите пункт **зависимости проекта**.

    В диалоговом окне **зависимости проекта** выберите проект установки.

    Установите флажок рядом с **DslPackage**.

9. Выполните повторную сборку решения.

10. В проводнике Windows выберите в проекте установки созданный MSI файл.

     Скопируйте MSI-файл на компьютер, на котором требуется установить DSL. Дважды щелкните файл MSI. Запускается установщик.

11. На конечном компьютере создайте новый файл с расширением DSL. Убедитесь, что:

    - В представлении списка проводника Windows файл отображается с указанными значком и описанием.

    - При двойном щелчке файла [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] запускается и открывается файл DSL в редакторе DSL.

    При желании можно создать проект установки вручную, а не использовать текстовый шаблон. Пошаговое руководство, включающее эту процедуру, см. в главе 5 [лаборатории SDK визуализации и моделирования](http://go.microsoft.com/fwlink/?LinkId=208878).

#### <a name="to-uninstall-a-dsl-that-was-installed-from-an-msi"></a>Удаление DSL, установленного из MSI

1. В Windows откройте панель управления **программы и компоненты** .

2. Удалите DSL.

3. Перезапустите Visual Studio.
