---
title: Рефакторинг для извлечения интерфейса (C#) | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-general
ms.topic: reference
f1_keywords:
- vs.csharp.refactoring.extractinterface
dev_langs:
- CSharp
helpviewer_keywords:
- refactoring [C#], Extract Interface
- Extract Interface refactoring operation [C#]
ms.assetid: 7d0aa225-3b33-4331-9652-5a67cac6f3d0
caps.latest.revision: 25
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: fdcf281e1ace40d1d7cdac0be302810ea173581b
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72667553"
---
# <a name="extract-interface-refactoring-c"></a>Рефакторинг для извлечения интерфейса (C#)
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Извлечение интерфейса — это операция рефакторинга, которая предоставляет простой способ создания нового интерфейса с элементами, которые берутся из существующего класса, структуры или интерфейса.

 Когда несколько клиентов используют одно и то же подмножество членов класса, структуры или интерфейса или если несколько классов, структур или интерфейсов имеют подмножество членов, может быть полезно реализуют подмножество элементов в интерфейсе. Дополнительные сведения об использовании интерфейсов см. в разделе [интерфейсы](https://msdn.microsoft.com/library/2feda177-ce11-432d-81b4-d50f5f35fd37).

 При извлечении интерфейса создается интерфейс в новом файле и курсор помещается в начало нового файла. Можно указать, какие члены следует извлекать в новый интерфейс, имя нового интерфейса и имя созданного файла с помощью диалогового окна **Извлечение интерфейса** .

### <a name="to-use-extract-interface"></a>Использование извлечения интерфейса

1. Создайте консольное приложение с именем `ExtractInterface`, а затем замените `Program` следующим кодом.

    ```csharp
    // Invoke Extract Interface on ProtoA.
    // Note:  the extracted interface will be created in a new file.
    class ProtoA
    {
        public void MethodB(string s) { }
    }
    ```

2. С курсором, расположенным в `MethodB`, и выберите в меню **Рефакторинг** пункт **извлечь интерфейс** .

     Откроется диалоговое окно **Извлечение интерфейса** .

     Можно также ввести сочетание клавиш CTRL + R, а затем отобразить диалоговое окно **Извлечение интерфейса** .

     Можно также щелкнуть правой кнопкой мыши, выбрать пункт **Рефакторинг**, а затем выбрать пункт **извлечь интерфейс** , чтобы открыть диалоговое окно **Извлечение интерфейса** .

3. Щелкните **выбрать все**.

4. Нажмите кнопку **ОК**.

     Вы увидите новый файл IProtoA.cs и следующий код:

    ```csharp
    using System;
    namespace TopThreeRefactorings
    {
        interface IProtoA
        {
            void MethodB(string s);
        }
    }
    ```

## <a name="remarks"></a>Заметки
 Эта функция доступна только при размещении курсора в классе, структуре или интерфейсе, содержащем элементы, которые требуется извлечь. Если курсор находится в этой позиции, вызовите операцию рефакторинга извлечения интерфейса.

 При вызове метода Extract для класса или структуры список базовых классов и интерфейсов изменяется для включения нового имени интерфейса. При вызове метода Extract в интерфейсе список базовых классов и интерфейсов не изменяется.

## <a name="see-also"></a>См. также раздел
 [Рефакторинг (C#)](../csharp-ide/refactoring-csharp.md)