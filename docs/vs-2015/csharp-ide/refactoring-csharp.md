---
title: Рефакторинг (C#) | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-general
ms.topic: conceptual
f1_keywords:
- vs.csharp.refactoring.preview
- vs.csharp.refactoring.issues
- vs.csharp.refactoring.buildwarning
- VS.PreviewChanges
dev_langs:
- CSharp
helpviewer_keywords:
- refactoring [C#]
ms.assetid: a39e656a-f81f-4c87-b484-a23168ff1dfc
caps.latest.revision: 23
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: fa8fbfd8837fb35617b79089fffd11ea3b8d2e93
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63444530"
---
# <a name="refactoring-c"></a>Рефакторинг (C#)
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Рефакторинг — это процесс усовершенствования кода после его написания путем изменения внутренней структуры кода без изменения его внешнего поведения кода.  
  
 Visual C# предоставляет следующие команды на **Refactoring** меню:  
  
- [Рефакторинг для извлечения метода (C#)](../csharp-ide/extract-method-refactoring-csharp.md)  
  
- [Переименование рефакторинга (C#)](../csharp-ide/rename-refactoring-csharp.md)  
  
- [Рефакторинг для инкапсуляции поля (C#)](../csharp-ide/encapsulate-field-refactoring-csharp.md)  
  
- [Рефакторинг для извлечения интерфейса (C#)](../csharp-ide/extract-interface-refactoring-csharp.md)  
  
- [Рефакторинг для удаления параметров (C#)](../csharp-ide/remove-parameters-refactoring-csharp.md)  
  
- [Рефакторинг для изменения порядка параметров (C#)](../csharp-ide/reorder-parameters-refactoring-csharp.md)  
  
## <a name="multi-project-refactoring"></a>Рефакторинг для нескольких проектов  
 Visual Studio поддерживает многопроектная оптимизация для проектов, которые находятся в одном решении. Все операции рефакторинга, исправляющие ссылки между файлами исправление ссылок во все проекты, на том же языке. Это подходит для любой ссылки проекта на проект. Например, если у вас есть консольное приложение, которое ссылается на библиотеку классов, при переименовании типа в библиотеке классов (с помощью `Rename` операция рефакторинга), также обновляются ссылки на тип в библиотеке классов в консольном приложении.  
  
## <a name="changes-preview"></a>Предварительный просмотр изменений  
 Многие операции рефакторинга дают возможность просматривать все изменения ссылок, которые операция рефакторинга будут выполнены в коде, прежде чем зафиксировать эти изменения. Для этих операций, рефакторинга **Предварительный просмотр измененных ссылок** параметр будет отображаться в диалоговом окне оптимизации. После выбора этого параметра и принятие операции рефакторинга, **диалоговое окно предварительного просмотра изменений** будет отображаться. Обратите внимание, что **Просмотр изменений** диалоговое окно имеет два представления. В нижнем представлении отображается код со всеми обновлениями ссылок из-за операции рефакторинга. Нажав клавишу **отменить** на **Просмотр изменений** диалоговое окно будет остановлено операции рефакторинга и не будут изменены в код.  
  
## <a name="refactoring-warnings"></a>Предупреждение при оптимизации  
 Если компилятор не имеет полного понимания программы, а возможно, что подсистема рефакторинга не может обновить все соответствующие ссылки, откроется диалоговое окно предупреждения. Это диалоговое окно предупреждения также дает возможность выполнить предварительный просмотр кода в **Просмотр изменений** диалоговое окно, прежде чем зафиксировать изменения.  
  
> [!NOTE]
> Если метод содержит синтаксическую ошибку (указывающий интегрированной среды разработки с красной волнистой линией), подсистема оптимизации не обновит все ссылки на элемент в этом методе. Это показано в следующем примере.  
  
 По умолчанию при выполнении операции рефакторинга без предварительного просмотра ссылки изменений и в программе обнаруживается ошибка компиляции, то среда разработки отображает это диалоговое окно предупреждения.  
  
 При выполнении операции рефакторинга, имеющий **Предварительный просмотр изменений ссылок** включен и в программе обнаруживается ошибка компиляции, а затем в среде разработки отобразит сообщение об ошибке в нижней части **Просмотр изменений** , вместо диалогового **предупреждение при оптимизации** диалоговое окно:  
  
 **Проект или один из его зависимостей не построены. Ссылки не могут быть обновлены.**  
  
 Это предупреждение рефакторинга доступна только для операций рефакторинга, которые предоставляют **Предварительный просмотр изменений ссылок** параметр.  
  
## <a name="error-tolerant-refactoring-and-verification-results"></a>Нечеткий рефакторинг и результаты проверки  
 Рефакторинг — это ошибка нечувствительного к ошибкам. Другими словами можно выполнить оптимизацию в проекте, который не может создать. Тем не менее в этих случаях процесс оптимизации может не обновить неоднозначные ссылки.  
  
 **Результаты проверки** диалоговое окно может уведомлять пользователя при оптимизации обнаруживает ошибки компиляции или обнаруживает, что операция рефакторинга случайно вызывает привязку ссылки кода к другим с того момента изначально привязан к (повторная привязка проблема).  
  
 Чтобы включить функцию результаты проверки, на **средства** меню, щелкните **параметры**. В **параметры** диалогового окна разверните узел **текстовый редактор**, а затем разверните **C#**. Нажмите кнопку **Дополнительно** и выберите **проверить результаты рефакторинга** "флажок".  
  
 **Результаты проверки** диалоговое окно различаются два вида проблемы с повторной привязкой.  
  
### <a name="references-whose-definition-will-no-longer-be-the-renamed-symbol"></a>Ссылки, определение которого больше не будет переименован символа  
 Такого рода перепривязки проблема происходит, когда ссылка больше не будет ссылаться на переименованный символ. Рассмотрим следующий пример кода:  
  
```csharp  
class Example  
{  
    private int a;  
    public Example(int b)  
    {  
        a = b;  
    }  
}  
```  
  
 Если вы используете рефакторинга для переименования `a` для `b`, это диалоговое окно. Ссылка на переименованную переменную `a` теперь привязывает параметр, который передается в конструктор вместо привязки к полю.  
  
### <a name="references-whose-definition-will-now-become-the-renamed-symbol"></a>Ссылки, определение которого теперь становятся переименованный символ.  
 Такого рода перепривязки проблема происходит, когда ссылка, которая ранее не ссылается на переименованный символ теперь содержит ссылку на переименованный символ. Рассмотрим следующий пример кода:  
  
```csharp  
class Example  
{  
    private static void Method(object a) { }  
    private static void OtherMethod(int a) { }  
    static void Main(string[] args)  
    {  
        Method(5);  
    }  
}  
```  
  
 Если вы используете рефакторинга для переименования `OtherMethod` для `Method`, это диалоговое окно. Ссылка в `Main` теперь ссылается на перегруженный метод, который принимает `int` параметр вместо перегруженный метод, который принимает `object` параметра.  
  
## <a name="see-also"></a>См. также  
 [Использование среды разработки Visual Studio для C#](../csharp-ide/using-the-visual-studio-development-environment-for-csharp.md)   
 [Практическое руководство. Восстановление фрагментов кода для рефакторинга в C#](../ide/how-to-restore-csharp-refactoring-snippets.md)