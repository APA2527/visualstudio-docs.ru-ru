---
title: Сбор данных о выделении памяти для объектов .NET и времени их жизни | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
helpviewer_keywords:
- .NET memory profiling method
- Profiling Tools,.NET memory method
ms.assetid: 62a6dd5f-db66-4456-9d57-f8913dbfe4d5
caps.latest.revision: 23
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 68decc73e14f8748d8434e05e50d6d3b48612d40
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "90842953"
---
# <a name="collecting-net-memory-allocation-and-lifetime-data"></a>Сбор данных о выделении памяти для объектов .NET и времени их жизни
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Средства профилирования [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] поддерживают возможность сбора данных о выделении памяти для объектов .NET и времени их жизни, что облегчает выявление проблем производительности приложения, связанных с памятью.  
  
- Данные о выделении памяти .NET включают сведения о размере и количестве выделенных объектов памяти .NET Framework.  
  
- Данные о времени жизни объектов включают сведения о размере и числе объектов памяти .NET Framework, которые были удалены в трех поколениях сборки мусора.  
  
  **Требования**  
  
- [!INCLUDE[vsUltLong](../includes/vsultlong-md.md)], [!INCLUDE[vsPreLong](../includes/vsprelong-md.md)], [!INCLUDE[vsPro](../includes/vspro-md.md)]  
  
> [!NOTE]
> Возможности расширенной безопасности в Windows 8 и Windows Server 2012 требовали значительных изменений в способе, которым профилировщик Visual Studio собирает данные на этих платформах. Приложениям для магазина Windows также требуются новые методы сбора. См. раздел [Средства производительности в приложениях Windows 8 и Windows Server 2012](../profiling/performance-tools-on-windows-8-and-windows-server-2012-applications.md).  
  
 Можно собрать данные с использованием метода выборки или метода профилирования с инструментированием.  
  
- При использовании метода выборки профилировщик отслеживает все операции выделения памяти .NET и объекты, которые были созданы запущенным процессом или процессом, к которому он присоединен.  
  
- При использовании метода инструментирования профилировщик отслеживает только те объекты и операции выделения памяти .NET, которые создаются инструментированными модулями.  
  
> [!IMPORTANT]
> При сборе данных о памяти .NET (операции выделения, время жизни объектов или все вместе) с помощью метода выборки, все заданные пользователем события выборки игнорируются, и для сбора данных используются соответствующие события выделения памяти.  
  
 Если включается профилирование операций выделения памяти .NET, также следует включить представление "Выделение". Если включается профилирование данных о времени жизни .NET, также следует включить представление "Время существования объектов". Дополнительные сведения см. в статьях [Allocations View](../profiling/dotnet-memory-allocations-view.md) (Представление "Выделение") и [Object Lifetime View](../profiling/object-lifetime-view.md) (Представление "Время существования объектов").  
  
 Сведения о порядке сбора данных об использовании памяти .NET с использованием программ командной строки средств профилирования см. в разделе строки средств профилирования см. в разделе "Использование метода анализа использования памяти .NET для сбора данных о выделении памяти и сроках существования объектов" в статье [Using Profiling Methods From the Command Line](../profiling/using-profiling-methods-to-collect-performance-data-from-the-command-line.md) (Использование методов профилирования из командной строки).  
  
### <a name="to-collect-net-memory-data"></a>Сбора данных об использовании памяти .NET  
  
1. В **обозревателе производительности**щелкните правой кнопкой мыши сеанс производительности, а затем выберите **Свойства**.  
  
2. В диалоговом окне _Сеанс производительности_**Страницы свойств** перейдите на вкладку **Общие** и установите флажок **Собирать сведения о выделении объектов .NET**.  
  
3. Для сбора данных о времени существования объектов .NET, установите флажок **Также собирать сведения о времени жизни объектов .NET**.  
  
## <a name="common-tasks"></a>Общие задачи  
 Дополнительные параметры можно указать в диалоговом окне _Сеанс производительности_**страницы свойств** сеанса анализа производительности. Чтобы открыть это диалоговое окно, выполните указанные ниже действия.  
  
- В **Обозреватель производительности**щелкните правой кнопкой мыши имя сеанса анализа производительности и выберите пункт **свойства**.  
  
  Задачи в следующей таблице описывают параметры, которые можно задать в диалоговом окне _Сеанс производительности_**Страницы свойств** при выполнении сбора данных об использовании памяти .NET.  
  
|Задача|Связанное содержимое|  
|----------|---------------------|  
|На странице **Общие** задайте сведения об имени создаваемого файла данных профилирования (VSP).|-   [Сбор данных о выделении памяти для объектов .NET и времени их жизни](../profiling/collecting-dotnet-memory-allocation-and-lifetime-data.md)<br />-   [Практическое руководство. Настройка параметров имени файла с данными о производительности](../profiling/how-to-set-performance-data-file-name-options.md)|  
|На странице **Запуск** выберите приложение для запуска, если в решении с кодом содержится несколько проектов исполняемых файлов (EXE).|-   [Сбор данных об уровневом взаимодействии](../profiling/collecting-tier-interaction-data.md)|  
|На странице **Взаимодействие уровней** добавьте данные вызова ADO.NET в сеанс профилировщика.|-   [Сбор данных об уровневом взаимодействии](../profiling/collecting-tier-interaction-data.md)|  
|На странице **События Windows** укажите одно или несколько событий трассировки Windows, которые необходимо собирать с данными выборки.|-   [Как получить данные трассировки событий для Windows (ETW)](../profiling/how-to-collect-event-tracing-for-windows-etw-data.md)|  
|На странице **Счетчики Windows** выберите один или несколько счетчиков производительности операционной системы, значения которых будут добавляться в данные профилирования в качестве меток.|-   [Руководство. получение данных счетчиков Windows](../profiling/how-to-collect-windows-counter-data.md)|  
|На странице **Дополнительно** укажите версию среды выполнения .NET Framework для профилирования, если модули приложения используют несколько версий. По умолчанию профилируется первая загруженная версия.|-   [Руководство. Указание среды выполнения .NET Framework](../profiling/how-to-specify-the-dotnet-framework-runtime.md)|  
  
## <a name="instrumentation-tasks"></a>Задачи инструментирования  
 Задачи в следующей таблице представляют собой параметры диалогового окна **Страницы свойств**, характерные для профилирования с использованием метода инструментирования.  
  
|Задача|Связанное содержимое|  
|----------|---------------------|  
|На странице **Двоичные файлы** укажите расположение для инструментированных копий модулей. По умолчанию исходные двоичные файлы перемещаются в папку для резервного копирования.|-   [Руководство. Перемещение инструментированных двоичных файлов](../profiling/how-to-relocate-instrumented-binaries.md)|  
|На странице **Инструментирование** исключите профилирование небольших функций, чтобы уменьшить накладные расходы, связанные с профилированием, выполните профилирование кода JavaScript на веб-страницах ASP.NET и задайте команды, которые необходимо выполнить в командной строке перед началом процесса инструментирования и по его завершении.|-   [Как исключить или включить небольшие функции из инструментирования](../profiling/how-to-exclude-or-include-short-functions-from-instrumentation.md)<br />-   [Руководство. Профилирование кода JavaScript на веб-страницах](../profiling/how-to-profile-javascript-code-in-web-pages.md)<br />-   [Как указать команды, выполняемые до и после инструментирования](../profiling/how-to-specify-pre-and-post-instrument-commands.md)|  
|На странице **Счетчики ЦП** выберите один или несколько счетчиков производительности процессора, значения которых будут добавляться в данные профилирования.|-   [Как получать данные счетчиков ЦП](../profiling/how-to-collect-cpu-counter-data.md)|  
|На странице **Дополнительно** задайте дополнительные необходимые параметры VSInstr.exe, например параметры для включения или исключения определенных функций. Дополнительные сведения о параметрах VSInstr см. в статье [VSInstr](../profiling/vsinstr.md).|-   [Как указать дополнительные параметры инструментирования](../profiling/how-to-specify-additional-instrumentation-options.md)<br />-   [Как ограничить инструментирование конкретными функциями](../profiling/how-to-limit-instrumentation-to-specific-functions.md)|  
  
## <a name="see-also"></a>См. также:  
 [Настройка сеансов анализа производительности](../profiling/configuring-performance-sessions.md)   
 [Как выбрать методы сбора](../profiling/how-to-choose-collection-methods.md)   
 [Свойства сеанса анализа производительности](../profiling/performance-session-properties.md)
