---
title: Руководство по профилированию производительности для начинающих | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.performance.wizard.intropage
helpviewer_keywords:
- Profiling Tools, quick start
- performance tools, wizard
- Performance Wizard
ms.assetid: da2fbf8a-2d41-4654-a509-dd238532d25a
caps.latest.revision: 50
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: ecfd329e0e5c096e6e0c2011b60cd97dcd1c2937
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "90843397"
---
# <a name="beginners-guide-to-performance-profiling"></a>Руководство по профилированию производительности для начинающих
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Средства профилирования Visual Studio можно использовать для анализа проблем с производительностью в приложении. Эта процедура показывает, как использовать данные **выборки**.  
  
 **Выборка** представляет собой статистический метод профилирования, показывающий функции, которые выполняют основную часть работы в пользовательском режиме приложения. С выборки удобно начать поиск областей, позволяющих ускорить работу приложения.  
  
 Метод **выборки** собирает сведения о функциях, которые выполняются в приложении, через заданные интервалы времени. После завершения сеанса профилирования представление **Сводка** показывает дерево вызовов наиболее активных функций, которое называется **горячим или критическим путем**, где была выполнена основная часть работы в приложении. Кроме того, в этом представлении перечислены функции, которые выполнили максимальный объем индивидуальной работы, а также представлен график временной шкалы, который позволяет сосредоточить внимание на определенных сегментах сеанса выборки.  
  
 Если **выборка** не предоставляет необходимые данные, можно воспользоваться другими методами сбора данных профилирования, предоставляющими другие виды информации, которая может оказаться полезной. Дополнительные сведения об этих методах см. [в разделе инструкции. Выбор методов сбора](../profiling/how-to-choose-collection-methods.md)данных.  
  
> [!TIP]
> Если вы выполняете профилирование кода, вызывающего функции Windows, следует убедиться, что используются самые новые версии PDB-файлов. Без этих файлов имена функций Windows в представлениях отчетов будут отображаться в непонятном или трудном для понимания виде. Дополнительные сведения о том, как убедиться в наличии необходимых файлов, см. [в разделе руководство. справочные сведения о символах Windows](../profiling/how-to-reference-windows-symbol-information.md).  
  
## <a name="create-and-run-a-performance-session"></a><a name="Step1"></a> Создание и запуск сеанса анализа производительности  
 Чтобы получить нужные данные для анализа, необходимо сначала создать сеанс производительности, а затем запустить его. Обе эти задачи помогает выполнить **мастер производительности**.  
  
 Если вы не выполняете профилирование классического приложения Windows или приложения ASP.NET, необходимо использовать другое средство профилирования. См. статью [Profiling Tools](../profiling/profiling-tools.md) (Средства профилирования).  
  
#### <a name="to-create-and-run-a-performance-session"></a>Порядок создания и выполнения сеанса производительности  
  
1. Откройте решение в Visual Studio. Выберите конфигурацию «Выпуск». (Найдите на панели инструментов поле **Конфигурации решений**, в котором по умолчанию задано значение **Отладка**. Измените это значение на **Выпуск**.)  
  
    > [!IMPORTANT]
    > Если вы не являетесь администратором на том компьютере, где работаете, при использовании профилировщика следует запустить Visual Studio от имени администратора. (Щелкните правой кнопкой мыши значок приложения Visual Studio и выберите пункт **Запуск от имени администратора**.  
  
2. В меню **Отладка** выберите пункт **Профилировщик производительности**.  
  
3. Установите флажок **Мастер производительности** и нажмите кнопку **Запуск**.  
  
4. Установите флажок **Выборка циклов ЦП (рекомендуется)** и нажмите кнопку **Готово**.  
  
5. Запускается ваше приложение, а профилировщик начинает сбор данных.  
  
6. Проверьте функции, которые могут вызывать проблемы с производительностью.  
  
7. Закройте приложение обычным образом.  
  
     После завершения работы приложения в основном окне Visual Studio отображается представление данных профилирования **Сводка** а в окне **Обозреватель производительности** отображается значок для нового сеанса.  
  
## <a name="step-2-analyze-sampling-data"></a><a name="Step2"></a> Шаг 2. анализ данных выборки  
 После завершения выполнения сеанса производительности в основном окне Visual Studio отображается представление отчета профилирования **Сводка**.  
  
 Мы рекомендуем начать анализ данных с проверки **горячего пути**, затем проверить список функций, выполняющих основную часть работы, и наконец сосредоточиться на других функциях с помощью **шкалы сводки**. Можно также просмотреть предложения и предупреждения профилирования в окне **Список ошибок**.  
  
 Имейте в виду, что метод выборки может не дать необходимые вам сведения. Например, выборки собираются только в том случае, когда приложение выполняет код пользовательского режима. Таким образом, выборка не охватывает некоторые функции, например операции ввода и вывода. В средствах профилирования предусмотрено несколько методов сбора, которые обеспечивают возможность сосредоточиться на важных данных. Дополнительные сведения о других методах см. [в разделе инструкции. Выбор методов сбора](../profiling/how-to-choose-collection-methods.md)данных.  
  
 Каждая нумерованная область на рисунке соответствует определенному шагу в процедуре.  
  
 ![Представление сводного отчета для выборки](../profiling/media/summary-sampling.png "Summary_Sampling")  
  
#### <a name="to-analyze-sampling-data"></a>Анализ данных выборки  
  
1. **Горячий путь** в представлении **Сводка** показывает ветвь дерева вызовов вашего приложения с наиболее инклюзивными выборками. Это путь выполнения, который был самым активным при сборе данных. Наиболее инклюзивные значения могут указывать на возможность оптимизации алгоритма, формирующего дерево вызовов. Найдите в коде функцию, находящуюся в самом конце пути. Обратите внимание, что этот путь может также содержать системные функции или функции во внешних модулях.  
  
     ![Критический путь профилировщика](../profiling/media/profiler-hotpath.png "Profiler_HotPath")  
  
    1. **Инклюзивные выборки** указывают, какой объем работы был выполнен некоторой функцией и всеми вызванными ей функциями. Высокие инклюзивные значения указывают на функции, которые в целом являются наиболее дорогостоящими.  
  
    2. **Эксклюзивные выборки** указывают, какой объем работы был выполнен кодом в теле функции, за исключением работы, выполненной вызванными ей функциями. Высокие эксклюзивные значения могут свидетельствовать об узких местах производительности внутри самой функции.  
  
2. Щелкните имя функции для отображения представления **Сведения о функции** с данными профилирования. Представление **Сведения о функции** содержит графическое представление данных профилирования для выбранной функции, показывающее все функции, вызывавшие данную функцию, и все функции, которые были вызваны выбранной функцией.  
  
    - Размер блоков вызывающих и вызываемых функций соответствует относительной частоте, с которой функции выполняли вызовы или были вызваны.  
  
    - Можно щелкнуть имя вызывающей или вызываемой функции, чтобы она стала активной функцией в представлении «Сведения о функции».  
  
    - На нижней панели окон **Сведения о функции** отображается код самой функции. Если вы проанализировали код и нашли возможность для оптимизации производительности, щелкните имя исходного файла, чтобы открыть его в редакторе Visual Studio.  
  
3. Для продолжения анализа вернитесь в представление **Сводка**, выбрав элемент **Сводка** в раскрывающемся списке Представление. Затем проанализируйте функции в области **Функции с максимальной индивидуальной работой**. Этот список содержит функции с наиболее эксклюзивными выборками. Код в теле этих функций выполнял значительный объем работы, и вы можете быть в состоянии оптимизировать его. Для дальнейшего анализа определенной функции щелкните имя этой функции, чтобы отобразить ее в представлении **Сведения о функции**.  
  
     ![Список функций, выполняющих большую часть работы](../profiling/media/functions-mostwork.png "Functions_MostWork")  
  
     Для продолжения анализа сеанса профилирования можно повторно проанализировать сегмент данных профилирования с помощью временной шкалы в представлении **Сводка**, чтобы отобразить показатели **Горячий путь** и **Функции с максимальной индивидуальной работой** для выбранного сегмента. Например, сосредоточившись на небольшом пике на временной шкале, можно выявить дорогостоящие деревья вызовов и функции, которые не были выявлены в рамках анализа всего сеанса профилирования.  
  
     Чтобы заново проанализировать сегмент, выберите его в поле временной шкалы сводки и щелкните **Фильтр по выделенному**.  
  
     ![Временная шкала представления сводки производительности](../profiling/media/performancesummary.png "PerformanceSummary")  
  
4. Профилировщик также использует набор правил, чтобы предлагать способы улучшения сеанса профилирования и выявлять возможные проблемы с производительностью. В случае обнаружения проблемы в окне **Список ошибок** отображается предупреждение. Чтобы открыть окно **Список ошибок**, щелкните пункт **Список ошибок** в меню **Вид**.  
  
    - Чтобы просмотреть функции, вызвавшие предупреждение в представлении **Сведения о функции**, дважды щелкните это предупреждение.  
  
    - Чтобы просмотреть подробные сведения о предупреждении, щелкните ошибку правой кнопкой мыши и выберите пункт **Показать справочные сведения об ошибке**.  
  
## <a name="step-3-revise-code-and-rerun-a-session"></a><a name="Step3"></a> Шаг 3. Пересмотр кода и повторный запуск сеанса  
 После нахождения и оптимизации одной или нескольких функций можно повторить сеанс профилирования и сравнить данные, чтобы определить, как внесенные изменения повлияли на производительность приложения.  
  
#### <a name="to-revise-code-and-rerun-the-profiler"></a>Пересмотр кода и повторный запуск сеанса  
  
1. Измените код.  
  
2. Чтобы открыть **обозреватель производительности**, в меню **Отладка** выберите пункт **Профилировщик**, затем — **Обозреватель производительности** и щелкните **Показать обозреватель производительности**.  
  
3. В **обозревателе производительности** щелкните правой кнопкой мыши сеанс, который необходимо запустить повторно, и выберите пункт **Запустить с профилированием.**  
  
4. После повторного запуска сеанса в папку **Отчеты** папки для сеанса в **обозревателе производительности** добавляется другой файл данных. Выберите исходные и новые данные профилирования, щелкните выбранное правой кнопкой мыши и выберите пункт **Сравнить отчеты о производительности**.  
  
     Открывается новое окно отчета с результатами сравнения. Дополнительные сведения об использовании представления сравнения см. [в разделе Практические руководства. Сравнение файлов данных производительности](../profiling/how-to-compare-performance-data-files.md).  
  
## <a name="see-also"></a>См. также:  
 [Обозреватель производительности](../profiling/performance-explorer.md)   
 [начало работы](../profiling/getting-started-with-performance-tools.md)   
 [Разделы общих сведений](../profiling/overviews-performance-tools.md)
