---
title: Пошаговое руководство. Профилирование из командной строки с помощью метода инструментирования | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
helpviewer_keywords:
- profiling tools, walkthroughs
- performance tools, walkthroughs
- performance tools, command-line tools
ms.assetid: 1c6f1586-3d6a-431f-bedf-c54088e280ba
caps.latest.revision: 20
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 3a37350cf274fbb551326ac96387330b0f3956e7
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63439698"
---
# <a name="walkthrough-command-line-profiling-using-instrumentation"></a>Пошаговое руководство. Командной строки, профилирование с помощью метода инструментирования
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Это пошаговое руководство описывает профилирование автономного приложения [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] для сбора подробных сведений о времени и количестве вызовов с помощью метода инструментирования средств профилирования. В этом пошаговом руководстве выполняются следующие задачи:  
  
- использование программы командной строки [VSInstr](../profiling/vsinstr.md) для создания инструментированных двоичных файлов;  
  
- использование средства [VSPerfCLREnv](../profiling/vsperfclrenv.md) для задания переменных среды с целью сбора данных профилирования .NET;  
  
- использование средства [VSPerfCmd](../profiling/vsperfcmd.md) для сбора данных профилирования;  
  
- использование средства [VSPerfReport](../profiling/vsperfreport.md) для создания файловых отчетов по данным профилирования.  
  
## <a name="prerequisites"></a>Предварительные требования  
  
- [!INCLUDE[vsprvsts](../includes/vsprvsts-md.md)]  
  
- Средний уровень знания языка C#.  
  
- Средний уровень навыков работы с программами командной строки.  
  
- Копия [примера PeopleTrax](../profiling/peopletrax-sample-profiling-tools.md).  
  
- Для работы со сведениями, полученными при профилировании, рекомендуется включить отладочные символы. Дополнительные сведения см. в разделе [Как Сведения о символах Windows ссылку](../profiling/how-to-reference-windows-symbol-information.md).  
  
## <a name="command-line-profiling-using-the-instrumentation-method"></a>Профилирование из командной строки с помощью метода инструментирования  
 Инструментирование представляет собой метод профилирования, с помощью которого в особым образом построенные версии профилируемых двоичных файлов внедряются функции-зонды. Эти зонды собирают информацию о времени при входе в функции и выходе из них в инструментированном модуле. Так как этот метод профилирования является более активным, чем выборка, он приводит к значительному увеличению нагрузки. Кроме того, инструментированные двоичные файлы больше по размеру, чем двоичные файлы для отладки или выпуска, и не предназначены для развертывания.  
  
> [!NOTE]
> Не отправляйте инструментированные двоичные файлы своим заказчикам. Использование инструментированных двоичных файлов влечет за собой ряд рисков. Такие двоичные файлы содержат сведения, позволяющие упростить реконструирование вашего приложения, а также создают угрозы безопасности.  
  
#### <a name="to-profile-the-peopletrax-application-by-using-the-instrumentation-method"></a>Профилирование приложения PeopleTrax с помощью метода инструментирования  
  
1. Установите пример приложения PeopleTrax и выполните сборку окончательной версии.  
  
2. Откройте командную строку и добавьте каталог **средств профилирования** в локальную переменную среды Path.  
  
3. Измените рабочую папку на каталог, содержащий двоичные файлы PeopleTrax.  
  
4. Создайте каталог для файлов отчетов. Введите следующую команду:  
  
    ```  
    md Reports  
    ```  
  
5. Воспользуйтесь программой командной строки VSInstr для инструментирования двоичных файлов приложения. В отдельных командных строках введите следующие команды:  
  
    ```  
    VSInstr PeopleTrax.exe  
    VSInstr PeopleTrax.exe  
    VSInstr People.dll  
    VSInstr Person.dll  
    VSInstr Operation.dll  
    ```  
  
     **Примечание**. По умолчанию программа VSInstr создает неинструментированную резервную копию исходного файла. Файл резервной копии имеет расширение ORIG. Например, исходная версия файла MyApp.exe будет сохранена как MyApp.exe.orig.  
  
6. Установите соответствующие переменные среды с помощью следующей команды:  
  
    ```  
    VsPerfCLREnv /traceon  
    ```  
  
7. Чтобы запустить профилировщик, введите следующую команду:  
  
    ```  
    VsPerfCmd /start:trace /output:Reports\Report.vsp  
    ```  
  
8. Запустив профилировщик в режиме трассировки, запустите инструментированную версию процесса PeopleTrax.exe для сбора данных.  
  
     Откроется окно приложения **PeopleTrax**.  
  
9. Щелкните **Get People** (Получить пользователей).  
  
     Таблица PeopleTrax заполнится данными.  
  
10. Щелкните **Export Data** (Экспорт данных).  
  
     В Блокноте откроется новый файл, содержащий список людей из приложения **PeopleTrax**.  
  
11. Закройте Блокнот и приложение **PeopleTrax**.  
  
12. Завершите работу профилировщика. Введите следующую команду:  
  
    ```  
    VSPerfCmd /shutdown  
    ```  
  
13. Сбросьте переменные среды с помощью следующей команды:  
  
    ```  
    VSPerfCLREnv /off  
    ```  
  
14. Используйте средство VSPerfReport для создания отчетов в виде файлов со значениями, разделенными запятыми (CSV). Тип:  
  
    ```  
    VSPerfReport Reports\Report.vsp /output:Reports /summary:all  
    ```  
  
     Вы можете анализировать созданные отчеты в редакторе электронных таблиц или использовать интегрированную среду разработки [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] для анализа данных профилирования в файле Report.vsp. Дополнительные сведения см. в разделе [Анализ данных средств производительности](../profiling/analyzing-performance-tools-data.md).  
  
## <a name="see-also"></a>См. также  
 [Общие сведения о сеансе анализа производительности](../profiling/performance-session-overview.md)   
 [Профилирование из командной строки](../profiling/using-the-profiling-tools-from-the-command-line.md)   
 [VSPerfCmd](../profiling/vsperfcmd.md)   
 [Общие сведения о значениях выборочных данных](../profiling/understanding-sampling-data-values.md)   
 [Представления отчетов о производительности](../profiling/performance-report-views.md)
