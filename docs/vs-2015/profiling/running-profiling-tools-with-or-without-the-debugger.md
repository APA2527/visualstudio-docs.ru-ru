---
title: Выполнение средств профилирования с отладчиком и без него | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
ms.assetid: 3fcdccad-c1bd-4c67-bcec-bf33a8fb5d63
caps.latest.revision: 12
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 806eeba9b3dfee8dc45c90f0a6d2f99ed0772ec7
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "68191670"
---
# <a name="running-profiling-tools-with-or-without-the-debugger"></a>Выполнение средств профилирования с отладчиком и без него
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Теперь в Visual Studio можно выбирать средства производительности. Некоторые из них (например, **Загрузка ЦП** и **Использование памяти**) можно использовать с отладчиком или без него. Средства производительности, используемые без отладчика, предназначены для выполнения в конфигурациях выпуска, а средства, интегрированные в отладчик, предназначены для выполнения в конфигурациях отладки.  
  
## <a name="should-i-run-the-tool-with-or-without-the-debugger"></a>Следует ли запускать средство с отладчиком или без него?  
 Средства производительности, интегрированные в отладчик, позволяют выполнять множество задач, которые невозможно реализовать с помощью средств, используемых без отладчика, например устанавливать точки останова и проверять значения переменных. Выходные данные средств, используемых без отладчика, практически аналогичны сведениям, которые будут доступны пользователям выпущенного приложения.  
  
 Ниже приведены некоторые вопросы, которые помогут решить, какое именно средство подходит для ваших целей.  
  
1. Проблема была обнаружена во время разработки приложения или она появилась в окончательной версии?  
  
     Если проблема была обнаружена во время разработки, возможно, не требуется запускать средства производительности в окончательной сборке. Если проблема появилась в окончательной версии, следует воспроизвести проблему в конфигурации выпуска, а затем решить, поможет ли отладчик в ее дальнейшем изучении.  
  
2. Проблема вызвана интенсивной загрузкой ЦП?  
  
     Многие неполадки возникают из-за внешних проблем с производительностью, таких как операции файлового ввода-вывода или время отклика сети, поэтому принимая решение о запуске средств производительности с отладчиком или без него, не следует делать большой разницы. Если проблема связана с высокой загрузкой ЦП, разница между конфигурациями выпуска и отладки может быть существенной. Поэтому перед использованием средств, интегрированных в отладчик, возможно, потребуется проверить наличие проблемы в окончательной сборке.  
  
3. Необходимо точно измерять производительность или приемлемы приблизительные данные?  
  
     В отладочных построениях отсутствуют определенные оптимизации, доступные в окончательных сборках, например встраивание вызовов функций и констант, способы хранения переменных, которые не могут использоваться отладчиком. Отладчик сам изменяет время производительности, так как он выполняет некоторые операции, необходимые для отладки (например, перехват исключений и события загрузки модулей). Поэтому показатели производительности в средствах, встроенных в отладчик, точны только до десятков миллисекунд. Показатели производительности для конфигураций выпуска при использовании средств без отладчика являются гораздо более точными.  
  
## <a name="BKMK_Quick_start__Collect_diagnostic_data"></a> Сбор данных профилирования во время отладки  
 В следующем разделе представлены сведения о локальной отладке. Информацию об отладке на устройстве и удаленной отладке см. в разделах ниже.  
  
1. Откройте проект, который вы хотите отладить, щелкните **Отладка | Начать отладку** (или **Запуск** на панели инструментов либо нажмите клавишу **F5**).  
  
2. Окно **Средства диагностики** появится автоматически, если вы не отключали эту функцию. Чтобы снова открыть окно, щелкните **Отладка | Окна | Показать средства диагностики**.  
  
3. Запустите сценарии, для которых вы хотите собрать данные.  
  
    При выполнении этого сеанса вы можете просмотреть сведения о событиях, памяти процесса и загрузке ЦП.  
  
    На рисунке ниже показано окно **Средства диагностики** в Visual Studio 2015 с обновлением 1.  
  
    ![DiagnosticTools: обновление 1](../profiling/media/diagnostictools-update1.png "DiagnosticTools-Update1")  
  
4. Вы можете выбрать, что следует просмотреть — **использование памяти** или **загрузку ЦП** (либо и то, и другое) — с помощью параметра **Выбор средств** на панели инструментов. Если вы используете Visual Studio Enterprise, можно включить или отключить IntelliTrace, последовательно выбрав **Сервис | Параметры | IntelliTrace**.  
  
5. Сеанс диагностики закончится при остановке отладки.  
  
   В Visual Studio 2015 с обновлением 1 окно **Средства диагностики** позволяет сосредоточиться на интересующих вас событиях.   К именам событий теперь в качестве префикса добавляется название категории (**Жест**, **Выходные данные программы**, **Точка останова**, **Файл** и т. д.), что позволяет быстро найти в списке события нужной категории или пропустить категории, которые вас не интересуют.  
  
   Окно теперь содержит поле поиска, с помощью которого можно найти определенную строку в любом месте списка событий. Например, на рисунке ниже показаны результаты поиска строки install, которой соответствуют четыре события.  
  
   ![DiagnosticsEventSearch](../profiling/media/diagnosticseventsearch.png "DiagnosticsEventSearch")  
  
   Вы также можете фильтровать события, отображаемые в окне. В раскрывающемся списке **Фильтр** можно выбрать определенные категории событий или отменить их выбор. Имена категорий совпадают с префиксами.  
  
   ![DiagnosticEventFilter](../profiling/media/diagnosticeventfilter.png "DiagnosticEventFilter")  
  
   Дополнительные сведения см. в разделе [Поиск и фильтрация на вкладке "События" окна "Средства диагностики"](http://blogs.msdn.com/b/visualstudioalm/archive/2015/11/12/searching-and-filtering-the-events-tab-of-the-diagnostic-tools-window.aspx).  
  
## <a name="collect-profiling-data-without-debugging"></a>Сбор данных профилирования без отладки  
 Для работы некоторым средствам профилирования требуются права администратора. Вы можете запустить Visual Studio от имени администратора или запустить средства от имени администратора при начале диагностического сеанса.  
  
1. Откройте проект в Visual Studio.  
  
2. В меню **Отладка** выберите пункт **Профилировщик производительности...** (Сочетание клавиш: ALT + F2).  
  
3. На странице запуска средств диагностики выберите режим запуска одного средства или нескольких средств в сеансе. Отображаются только инструменты, подходящие типу проекта и языку программирования. При выборе средства диагностики можно указать только те средства, которые могут работать в одном и том же сеансе диагностики. Вот как может выглядеть вариант вашего выбора для универсального приложения Windows на C#:  
  
    ![Выбор средств диагностики](../profiling/media/diag-selecttool.png "DIAG_SelectTool")  
  
4. Для запуска диагностического сеанса нажмите кнопку **Запуск**.  
  
5. Запустите сценарии, для которых необходимо собрать данные.  
  
    Во время выполнения сеанса некоторые средства отображают графики по данным в режиме реального времени на странице запуска средств диагностики.  
  
    ![Сбор данных на странице "Производительность и диагностика"](../profiling/media/pdhub-collectdata.png "PDHUB_CollectData")  
  
6. Для завершения диагностического сеанса выберите команду **Остановить сбор**.  
  
   При остановке сбора данных в диагностическом сеансе выполняется анализ данных и на странице "Диагностика" отображается отчет.  
  
   Также на странице запуска средств диагностики в перечне недавних файлов можно открывать сохраненные файлы сеанса диагностики.  
  
   ![Открытие сохраненного файла диагностического сеанса](../profiling/media/pdhub-openexistingdiagsession.png "PDHUB_OpenExistingDiagSession")  
  
## <a name="the-profiling-report"></a>Отчет о профилировании  
 ![Отчет средств диагностики](../profiling/media/diag-report.png "DIAG_Report")  
  
|||  
|-|-|  
|![Шаг 1](../profiling/media/procguid-1.png "ProcGuid_1")|На временной шкале отображаются продолжительность сеанса профилирования, события активации жизненного цикла приложения и пользовательские отметки.|  
|![Шаг 2](../profiling/media/procguid-2.png "ProcGuid_2")|Отчет можно ограничить частью временной шкалы, перетащив синие панели, чтобы выбрать нужную область временной шкалы.|  
|![Шаг 3](../profiling/media/procguid-3.png "ProcGuid_3")|Средство отображает одну основную диаграмму или несколько основных диаграмм. Если диагностический сеанс создается с использованием нескольких средств, будут отображаться все основные диаграммы.|  
|![Шаг 4](../profiling/media/procguid-4.png "ProcGuid_4")|Индивидуальные диаграммы можно сворачивать и разворачивать.|  
|![Шаг 5](../profiling/media/procguid-6.png "ProcGuid_6")|Если данные содержат информацию из нескольких средств, подробные сведения для конкретного средства накапливаются на отдельной вкладке.|  
|![Шаг 6](../profiling/media/procguid-6a.png "ProcGuid_6a")|Средство может иметь одно представление сведений или несколько представлений сведений. Представление фильтруется по выбранной области временной шкалы.|  
  
## <a name="setting-the-analysis-target-to-another-device"></a>Настройка другого устройства в качестве целевого объекта анализа  
 Кроме запуска приложения из проекта Visual Studio, диагностические сеансы также можно запускать на альтернативных целевых объектах. Например, может потребоваться диагностика проблем производительности для определенной версии вашего приложения, установленного из Магазина приложений Windows.  
  
 ![Выбор целевого объекта анализа для средств диагностики](../profiling/media/pdhub-chooseanalysistarget.png "PDHUB_ChooseAnalysisTarget")  
  
 Можно запускать приложения, которые уже установлены на устройстве, или можно подключать средства диагностики к приложениям, которые уже работают. При выборе режима **выполняемого приложения** или **установленного приложения** вы выбираете приложение в списке приложений, обнаруженных в указанном целевом объекте развертывания.  
  
 ![Выбор выполняемого или установленного приложения для диагностики](../profiling/media/pdhub-selectrunningapp.png "PDHUB_SelectRunningApp")  
  
 При выборе **Internet Explorer** вы указываете URL-адрес и можете изменить телефон, который является целевым объектом развертывания.  
  
 ![Указание URL-адреса для отображения в Internet Explorer](../profiling/media/pdhub-choosephoneanalysistarget.png "PDHUB_ChoosePhoneAnalysisTarget")  
  
## <a name="remote-debugging"></a>Remote Debugging  
 Чтобы запустить сеанс диагностики на удаленном ПК или планшете, на устройстве должны быть установлены и запущены инструменты удаленной отладки Visual Studio. Для классических приложений см. раздел [Удаленная отладка](../debugger/remote-debugging.md).  Для универсальных приложений Windows см. раздел [Запуск приложений Магазина Windows на удаленном компьютере](../debugger/run-windows-store-apps-on-a-remote-machine.md).  
  
## <a name="blog-posts-and-msdn-articles-from-the-diagnostics-development-team"></a>Записи в блогах и статьи MSDN от команды разработчиков средств диагностики  
 [Журнал MSDN Magazine. Анализ производительности во время отладки в Visual Studio 2015](https://msdn.microsoft.com/magazine/dn973013.aspx)  
  
 [Журнал MSDN Magazine. Использование IntelliTrace для ускоренной диагностики проблем](https://msdn.microsoft.com/magazine/dn973014.aspx)  
  
 [Запись блога. Диагностика утечек памяти обработчика событий с помощью средства "Использование памяти" в Visual Studio 2015](http://blogs.msdn.com/b/visualstudioalm/archive/2015/04/29/diagnosing-event-handler-leaks-with-the-memory-usage-tool-in-visual-studio-2015.aspx)  
  
 [Видео. Отладка с ведением журнала с помощью IntelliTrace в Microsoft Visual Studio Ultimate 2015](https://channel9.msdn.com/Events/Ignite/2015/BRK3716)  
  
 [Видео. Отладка проблем производительности с помощью Visual Studio 2015](https://channel9.msdn.com/Events/Build/2015/3-731)  
  
 [PerfTips. Информация о производительности прямо при отладке с помощью Visual Studio](http://blogs.msdn.com/b/visualstudioalm/archive/2014/08/18/perftips-performance-information-at-a-glance-while-debugging-with-visual-studio.aspx)  
  
 [Окно отладчика "Средства диагностики" в Visual Studio 2015](http://blogs.msdn.com/b/visualstudioalm/archive/2015/01/16/diagnostic-tools-debugger-window-in-visual-studio-2015.aspx)  
  
 [IntelliTrace в Visual Studio Enterprise 2015](http://blogs.msdn.com/b/visualstudioalm/archive/2015/01/16/intellitrace-in-visual-studio-ultimate-2015.aspx)
