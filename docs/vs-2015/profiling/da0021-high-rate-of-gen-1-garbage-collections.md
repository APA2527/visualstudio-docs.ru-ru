---
title: 'DA0021: Высокая доля сборок мусора в поколении 1 | Документы Майкрософт'
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: reference
f1_keywords:
- vs.performance.21
- vs.performance.DA0021
- vs.performance.rules.DA0021
ms.assetid: ebf5d9b3-a1ac-4688-8f0f-39a85f4dd15f
caps.latest.revision: 14
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: d901d09350af063a11e3d156f36a100df85e7718
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "82586916"
---
# <a name="da0021-high-rate-of-gen-1-garbage-collections"></a>DA0021. Высокая доля сборок мусора в генерации 1
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Идентификатор правила | DA0021 |  
| Категория |. Использование NET Framework |  
| Методы профилирования | Все |  
| Сообщение | Существует довольно большое количество сборок мусора поколения 1. Если алгоритмом ваших программ предусмотрено, что большинство структур данных выделено постоянно и в течение длительного времени, то это нормально. Если же вы считаете такое поведение непредвиденным, то, возможно, ваше приложение вызывает закрепление объектов. Чтобы понять, как происходит выделение памяти, используемой вашим приложением, вы можете собрать данные о распределении памяти .NET и сведения о времени жизни объекта.|  
| Тип правила | Сведения |  
  
 При профилировании с помощью выборки, памяти .NET или методов разрешения конфликтов ресурсов необходимо собрать минимум 10 выборок, чтобы активировать это правило.  
  
## <a name="cause"></a>Причина:  
 Данные о производительности системы, собранные во время профилирования, указывают, что во время сборки мусора в поколении 1 была освобождена память, отведенная для объектов .NET Framework, значительно большая, чем при сборке мусора в поколении 0.  
  
## <a name="rule-description"></a>Описание правила  
 Среда CLR Microsoft .NET обеспечивает автоматический механизм управления памятью, использующий сборщик мусора для удаления из памяти объектов, которые приложение больше не использует. Сборщик мусора ориентирован на поколение, исходя из той предпосылки, что многие выделения памяти являются краткосрочными. Например, срок жизни локальных переменных должен быть небольшим. Вновь созданные объекты сначала находятся в поколении 0 (gen 0), а затем переходят в поколение 1, если они сохраняются после выполнения сборки мусора и, наконец, переходят в поколение 2, если приложение по-прежнему использует их.  
  
 Объекты поколения 0 собираются часто и обычно очень эффективно. Объекты поколения 1 собираются менее часто и менее эффективно. Наконец, сбор долгоживущих объектов в поколении 2 должен происходить еще реже. Сбор поколения 2, то есть полная сборка мусора, также является наиболее ресурсоемкой операцией.  
  
 Это правило применяется в тех случаях, когда доля времени, затраченного на сборку мусора для поколения 1, становится слишком велика. Если слишком большое число краткосрочных объектов остаются после сборки мусора в поколении 0, но их удается собрать с поколением 1, затраты на управление памятью становится слишком высокими. Дополнительные сведения см. в статье [Кризис среднего возраста](https://docs.microsoft.com/archive/blogs/ricom/mid-life-crisis) в Rico Mariani's Performance Tidbits на веб-сайте MSDN.  
  
## <a name="how-to-investigate-a-warning"></a>Изучение причин предупреждения  
 Дважды щелкните сообщение в окне "Список ошибок", чтобы перейти к представлению [Метки](../profiling/marks-view.md) данных профилирования. Найдите столбцы **Память CLR .NET\\Сборов мусора для поколения 0** и **Память CLR .NET\\Сборов мусора для поколения 1**. Установите, есть ли какие-либо этапы выполнения программы, где сборка мусора происходит чаще. Сравните эти значения со значениями в столбце **% времени сборщика мусора**, чтобы узнать, не вызывает ли схема выделения управляемой памятью чрезмерные затраты памяти.  
  
 Чтобы понять схему использования управляемой памяти в приложении, выполните его повторное профилирование, запустив профиль выделения памяти .NET, и сделайте запрос измерения времени жизни объекта.  
  
 Сведения о том, как повысить производительность сборки мусора, см. в статье [Сведения о повышении производительности сборки мусора](https://msdn2.microsoft.com/library/ms973837.aspx) на веб-сайте корпорации Майкрософт. Сведения о дополнительных затратах на автоматическую сборку мусора см. в статье [Представляем кучу для массивных объектов](https://msdn.microsoft.com/magazine/cc534993.aspx).
