---
title: Варианты 0 x-2 x-4 x MSAA | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
ms.assetid: 668a6603-5082-4c78-98e6-f3dc871aa55b
caps.latest.revision: 11
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: f6cc62e4ba56cb7be461bbf3cee5435cb404b7fe
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63439978"
---
# <a name="0x2x4x-msaa-variants"></a>Варианты 0x/2x/4x MSAA
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Переопределяет параметры многовыборочного сглаживания (MSAA) для всех целевых объектов отрисовки и цепочек буферов.  
  
## <a name="interpretation"></a>Интерпретация  
 Многовыборочное сглаживание повышает качество изображения благодаря взятию нескольких образцов из разных мест одного пикселя. Чем выше уровень MSAA, тем больше образцов берется. Если MSAA не используется, берется только один образец из центра пикселя. Включение MSAA в приложении обычно оказывает небольшое, но заметное влияние на производительность отрисовки, но для некоторых рабочих нагрузок или определенных GPU это влияние может быть почти не ощутимым.  
  
 Если в приложении технология MSAA уже включена, то для вариантов MSAA более низкого уровня указываются потери производительности относительно текущего более высокого уровня MSAA. В частности, для варианта 0x MSAA указывается относительная производительность в сравнении с приложением без MSAA.  
  
 Если в приложении технология MSAA еще не включена, то указываются относительные потери производительности при включении вариантов 2-кратного и 4-кратного сглаживания MSAA в приложении. Если потери допустимо малы, рекомендуем включить MSAA, чтобы повысить качество изображения в приложении.  
  
> [!NOTE]
> Оборудование может не полностью поддерживать MSAA для всех форматов. Если для какого-либо варианта имеются аппаратные ограничения, которые нельзя обойти, соответствующий столбец в сводной таблице производительности будет пуст и появится сообщение об ошибке.  
  
## <a name="remarks"></a>Примечания  
 Эти варианты переопределяют аргументы числа и качества образцов при вызовах метода `ID3DDevice::CreateTexture2D`, создающих целевые объекты отрисовки. В частности, эти параметры переопределяются в указанных ниже случаях.  
  
- Объект `D3D11_TEXTURE2D_DESC`, передаваемый в `pDesc`, описывает целевой объект отрисовки, то есть:  
  
  - Для члена BindFlags установлен флаг D3D11_BIND_TARGET или D3D11_BIND_DEPTH_STENCIL.  
  
  - Для члена Usage установлен флаг D3D11_USAGE_DEFAULT.  
  
  - Член CPUAccessFlags имеет значение 0.  
  
  - Член MipLevels имеет значение 1.  
  
- Устройство поддерживает запрошенное число образцов (0, 2 или 4) и качество образцов (0) для запрошенного формата целевого объекта отрисовки (член D3D11_TEXTURE2D_DESC::Format), что определяется флагом `ID3D11Device::CheckMultisampleQualityLevels`.  
  
  Если для члена D3D11_TEXTURE2D_DESC::BindFlags установлен флаг D3D_BIND_SHADER_RESOURCE или D3D11_BIND_UNORDERED_ACCESS, создаются две версии текстуры. У первой версии эти флаги сняты, и она предназначена для использования в качестве целевого объекта отрисовки. Вторая версия — это текстура без MSAA, у которой эти флаги оставлены без изменений. Она служит буфером разрешения для первой версии. Это необходимо по той причине, что использование текстуры MSAA в качестве ресурса шейдера или для неупорядоченного доступа, скорее всего, будет недопустимым. Например, применение к ней шейдера даст неправильные результаты, так как шейдер будет ожидать текстуру без MSAA. Если вариант создал дополнительную текстуру без MSAA, то при удалении целевого объекта отрисовки MSAA из контекста устройства, его содержимое разрешается в текстуру без MSAA. Аналогично, при связывании целевого объекта отрисовки MSAA в качестве ресурса шейдера или его использовании в представлении с неупорядоченным доступом вместо него привязывается разрешенная текстура без MSAA.  
  
  Эти варианты также переопределяют параметры MSAA для всех цепочек буферов, созданных с помощью `IDXGIFactory::CreateSwapChain`, `IDXGIFactory2::CreateSwapChainForHwnd`, `IDXGIFactory2::CreateSwapChainForCoreWindow`, `IDXGIFactory2::CreateSwapChainForComposition` и `ID3D11CreateDeviceAndSwapChain`.  
  
  Конечным итогом этих изменений является то, что все операции отрисовки выполняются в целевом объекте отрисовки MSAA, но если приложение использует один из этих целевых объектов или буферов, включенных в цепочку буферов, в качестве представления ресурса шейдера или представления неупорядоченного доступа, выборка данных производится из разрешенной копии целевого объекта отрисовки без MSAA.  
  
## <a name="restrictions-and-limitations"></a>Ограничения  
 В Direct3D11 в отношении текстур MSAA действует больше ограничений, чем в отношении текстур без MSAA. Например, нельзя вызвать метод `ID3D11DeviceContext::UpdateSubresource` для текстуры MSAA, а вызов метода `ID3D11DeviceContext::CopySubresourceRegion` завершится сбоем, если число и качество образцов для исходного и конечного ресурса не совпадают. Это может произойти в том случае, если вариант переопределяет параметры MSAA только одного из ресурсов.  
  
 Если при воспроизведении выявляются конфликты подобного рода, делается все возможное для того, чтобы воспроизвести требуемое поведение. Но получение точных результатов может оказаться невозможным. Хотя ситуация, когда влияние варианта на производительность отрисовки оказывается представлено неверно, маловероятна, она все же возможна, например, если контроль потока выполнения в построителе текстуры определяется точным содержимым текстуры. В этом случае реплицированная текстура может иметь отличающееся содержимое.  
  
## <a name="example"></a>Пример  
 Эти варианты можно воспроизвести для целевых объектов отрисовки, созданных методом `ID3D11Device::CreateTexture2D`, с помощью следующего кода:  
  
```  
D3D11_TEXTURE2D_DESC target_description;  
target_description.BindFlags = D3D11_BIND_RENDER_TARGET;  
target_description.SampleDesc.Count = 4; // 4x MSAA, can be 2 or 0 instead  
target_description.SampleDesc.Quality = 0;  
d3d_device->CreateTexture2D(&target_description, nullptr, &render_target);  
```  
  
## <a name="example"></a>Пример  
 Для цепочек буферов, созданных методом IDXGISwapChain::CreateSwapChain или D3D11CreateDeviceAndSwapChain, их можно воспроизвести с помощью следующего кода:  
  
```  
DXGI_SWAP_CHAIN_DESC chain_description;  
chain_description.SampleDesc.Count = 4; // 4x MSAA, can be 2 or 0 instead  
chain_description.SampleDesc.Quality = 0;  
  
// Call IDXGISwapChain::CreateSwapChain or D3D11CreateDeviceAndSwapChain, etc.  
```
