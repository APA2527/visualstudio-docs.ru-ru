---
title: Присоединение к выполняющимся процессам с помощью отладчика | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.debug.processes.attach
- vs.debug.process
- vs.debug.programs
- vs.debug.detaching
- vs.debug.processes
- vs.debug.error.attach
- vs.debug.remotemachine
dev_langs:
- C++
- CSharp
- FSharp
- VB
- c++
helpviewer_keywords:
- remote debugging, attaching to programs
- processes, attaching to running processes
- Attach to Process dialog box
- debugging [Visual Studio], attaching to processes
- debugger, processes
ms.assetid: 27900e58-090c-4211-a309-b3e1496d5824
caps.latest.revision: 62
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 03cd890802e5563ce2daeb78438c56f4452d74f0
ms.sourcegitcommit: bad28e99214cf62cfbd1222e8cb5ded1997d7ff0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2019
ms.locfileid: "74299514"
---
# <a name="attach-to-running-processes-with-the-visual-studio-debugger"></a>Присоединение к выполняемым процессам с использованием отладчика Visual Studio
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Отладчик Visual Studio можно подключить к запущенному процессу на локальном или удаленном компьютере. После выполнения процесса щелкните **Отладка/присоединение к процессу** (или нажмите клавиши **CTRL + ALT + P**), чтобы открыть диалоговое окно **Присоединение к процессу** .

Эту возможность можно использовать для отладки приложений, запущенных на локальном или удаленном компьютере, одновременной отладки нескольких процессов или отладки приложения, которое не было создано в Visual Studio. Это часто полезно, если требуется выполнить отладку приложения, но (по какой-либо причине) вы не запустили приложение из Visual Studio с присоединенным отладчиком. Например, если вы запускаете приложение без отладчика и вызвали исключение, можно присоединиться к процессу, в котором выполняется приложение, чтобы начать отладку.

> [!TIP]
> Не уверены, нужно ли использовать **Присоединение к процессу** для сценария отладки? См. раздел [Общие сценарии отладки](#BKMK_Scenarios). Если требуется выполнить отладку приложений ASP.NET, развернутых в службах IIS, см. раздел [Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md).

## <a name="BKMK_Attach_to_a_running_process"></a>Присоединение к выполняющемуся процессу на локальном компьютере
 Чтобы присоединиться к процессу, необходимо узнать имя процесса (см. раздел [Общие сценарии отладки](#BKMK_Scenarios) для нескольких распространенных имен процессов).

1. В Visual Studio выберите **Отладка/присоединение к процессу** (или нажмите клавиши **CTRL + ALT + P**).

2. В диалоговом окне **Присоединение к процессу** найдите программу, к которой требуется присоединиться, в списке **Доступные процессы** .

     Чтобы быстро выбрать нужный процесс, введите первую букву имени процесса. Если имя процесса неизвестно, см. раздел [Общие сценарии отладки](#BKMK_Scenarios).

     ![DBG_Basics_Attach_To_Process](../debugger/media/dbg-basics-attach-to-process.png "DBG_Basics_Attach_To_Process")

     Если процесс выполняется с другой учетной записью пользователя, установите флажок **Показать процессы всех пользователей** .

3. Убедитесь, что в окне **Присоединиться к** указан тип кода, который необходимо отладить. Параметр по умолчанию **Авто** пытается определить тип кода, который нужно отладить. Чтобы вручную задать тип кода, выполните следующие действия.

    1. В поле **Присоединиться к** щелкните **Выбрать**.

    2. В диалоговом окне **Выбор типа кода** нажмите кнопку **Выполнять отладку кода следующих типов** и выберите типы для отладки.

    3. Нажмите кнопку **ОК**.

4. Нажмите кнопку **Присоединить**.

## <a name="BKMK_Attach_to_a_process_on_a_remote_computer"></a> Присоединение к процессу на удаленном компьютере
 Чтобы присоединиться к процессу, необходимо узнать имя процесса (см. раздел [Общие сценарии отладки](#BKMK_Scenarios) для нескольких распространенных имен процессов). Более полные инструкции для приложений ASP.NET, развернутых в службах IIS, см. [в разделе Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md). Для других приложений, возможно, имя процесса удастся найти в диспетчере задач.

 При использовании диалогового окна **Присоединение к процессу** можно выбрать другой компьютер, который настроен для удаленной отладки. Дополнительные сведения см. в разделе [Удаленная отладка](https://msdn.microsoft.com/library/90f45630-0d26-4698-8c1f-63f85a12db9c). После выбора удаленного компьютера можно просмотреть список доступных процессов, запущенных на этом компьютере, и подключиться к одному или нескольким процессам для отладки.

 **Чтобы выбрать удаленный компьютер, выполните следующие действия.**

1. В Visual Studio выберите **Отладка/присоединение к процессу** (или нажмите клавиши **CTRL + ALT + P**).

2. В диалоговом окне **Присоединение к процессу** выберите подходящий тип подключения в списке **Транспорт** . **По умолчанию** — правильный параметр в большинстве случаев.

   Параметр **Транспорт** хранится между сеансами отладки.

3. Воспользуйтесь списком **Квалификатор** для выбора имени удаленного компьютера одним из следующих способов:

   1. Введите имя в списке **Квалификатор** .

      > [!NOTE]
      > Если в последующих шагах вы не сможете подключиться с помощью имени удаленного компьютера, используйте IP-адрес. (Номер порта может отображаться автоматически после выбора процесса. Его также можно ввести вручную. На рисунке ниже 4020 является портом по умолчанию для удаленного отладчика.)

   2. Щелкните стрелку раскрывающегося списка **Квалификатор** и выберите из раскрывающегося списка имя компьютера.

   3. Нажмите кнопку **найти** рядом со списком **квалификатор** , чтобы открыть диалоговое окно **Выбор подключения удаленного отладчика** . В диалоговом окне **Выбор подключения к удаленному отладчику** будут перечислены все устройства, присутствующие в локальной подсети, а также устройства, непосредственно подключенные к компьютеру с помощью кабеля Ethernet (если таковые имеются). Щелкните нужный компьютер или устройство, после чего щелкните **Выбрать**.

      Параметр **Квалификатор** хранится между сеансами отладки только в случае успешного подключения отладки с этим квалификатором.

4. Нажмите кнопку **Обновить**.

     Список **Доступные процессы** отображается автоматически при открытии диалогового окна **Процессы** . Процессы могут запускаться и останавливаться в фоновом режиме, пока диалоговое окно открыто. Однако содержимое окна не всегда отражает текущее состояние. Можно обновить список в любое время, щелкнув кнопку **Обновить**, чтобы просмотреть текущий список процессов.

5. В диалоговом окне **Присоединение к процессу** найдите программу, к которой требуется присоединиться, в списке **Доступные процессы** .

    Если процесс выполняется с другой учетной записью пользователя, установите флажок **Показать процессы всех пользователей** .

6. Нажмите кнопку **Присоединить**.

## <a name="additional-info"></a>Дополнительные сведения

Во время отладки можно подключиться к нескольким программам, но в любой момент времени только одна из них активна в отладчике. Можно выбрать текущую программу в панели инструментов **Место отладки** или окне **Процессы** . Дополнительные сведения см. в разделе [Практическое руководство: Установка текущей программы](https://msdn.microsoft.com/7e1d7fa5-0e40-44cf-8c41-d3dba31c969e).

Если попытаться подключиться к процессу, работающему под управлением ненадежной учетной записи, появится диалоговое окно подтверждения с предупреждением безопасности. Дополнительные сведения см. в разделе [предупреждение системы безопасности: Присоединение к процессу, принадлежит недоверенному пользователю может быть опасно. Если следующие сведения не вызывают доверия, то не следует присоединяться к процессу](/visualstudio/debugger/security-warning-attaching-to-a-process-owned-by-an-untrusted-user?view=vs-2015).

В некоторых случаях при отладке в сеансе удаленного рабочего стола (службы терминалов), список **Доступные процессы** не отображает все доступные процессы. При работе с Visual Studio в качестве пользователя с ограниченным доступом в списке **Доступные процессы** не будут отображаться процессы, запущенные в сеансе 0, который используется для служб и других серверных процессов, включая w3wp.exe. Можно устранить эту проблему, запустив [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] под учетной записью администратора или запустив [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] с консоли сервера вместо сеанса служб терминалов. Если ни один из этих обходных путей использовать невозможно, третий вариант — присоединение к процессу путем запуска `vsjitdebugger.exe -p` *ProcessId* из командной строки Windows. Можно определить идентификатор процесса с помощью Tlist.exe. Чтобы получить файл tlist.exe, скачайте и установите средства отладки для Windows, которые доступны на  [странице файлов загрузки WDK и WinDbg](https://go.microsoft.com/fwlink/?LinkId=168279).

## <a name="BKMK_Scenarios"></a>Распространенные сценарии отладки

Чтобы определить, нужно ли использовать **Присоединение к процессу** и какой процесс присоединить к, здесь показаны несколько распространенных сценариев отладки (список не является исчерпывающим). Где доступны дополнительные инструкции, мы предоставляем ссылки.

Для некоторых типов приложений (например, приложений Магазина Windows) вы не подключаетесь напрямую к имени процесса, а вместо этого используйте команду " **Отладка установленного пакета приложения** " (см. таблицу).

> [!NOTE]
> Сведения об основных отладках в Visual Studio см. в разделе [Приступая к работе с отладчиком](../debugger/getting-started-with-the-debugger.md).

|Сценарий|Метод Debug|Имя процесса|Примечания и ссылки|
|-|-|-|-|
|Отладка управляемого или собственного приложения на локальном компьютере|Использовать присоединение к процессу или [стандартную отладку](../debugger/getting-started-with-the-debugger.md)|*AppName*. exe|Для быстрого доступа к диалоговому окну используйте **сочетание клавиш CTRL + ALT + P** , а затем введите первую букву имени процесса.|
|Отладка ASP.NET приложений на локальном компьютере после запуска приложения без отладчика|Использовать присоединение к процессу|iiexpress.exe|Это может быть полезно для ускорения загрузки приложения, например (например,) при профилировании. |
|Удаленная отладка ASP.NET 4 или 4,5 на сервере IIS|Использование средств удаленного взаимодействия и присоединение к процессу|w3wp.exe|См. раздел [Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md) .|
|ASP.NET Core удаленной отладки на сервере IIS|Использование средств удаленного взаимодействия и присоединение к процессу|DNX. exe|Сведения о развертывании приложений см. [в разделе Publishing to IIS](https://docs.asp.net/en/latest/publishing/iis.html). Сведения об отладке см. [в разделе Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md) .|
|Отладка других поддерживаемых типов приложений в серверном процессе|Использование средств удаленной обработки (если сервер является удаленным) и подключение к процессу|iexplore. exe или другие процессы|При необходимости используйте диспетчер задач, чтобы определить процесс. См. раздел [Удаленная отладка](../debugger/remote-debugging.md) и более поздние версии этой статьи.|
|Удаленная отладка классического приложения Windows|удаленные средства и F5|Н/Д| См. раздел [Удаленная отладка](../debugger/remote-debugging.md)|
|Удаленная отладка приложения Windows Universal (UWP), OneCore, HoloLens или IoT|Отладка установленного пакета приложения|Н/Д|Использовать **отладку/другие целевые объекты отладки/отладить установленный пакет приложения** вместо **присоединения к процессу**|
|Отладка универсального приложения Windows (UWP), OneCore, HoloLens или центра Интернета вещей, которое не было запущено из Visual Studio|Отладка установленного пакета приложения|Н/Д|Использовать **отладку/другие целевые объекты отладки/отладить установленный пакет приложения** вместо **присоединения к процессу**|

> [!WARNING]
> Для присоединения к универсальному приложению Windows, которое написано на JavaScript, сначала необходимо включить отладку для приложения. См. раздел [Attach the debugger](../debugger/start-a-debugging-session-for-store-apps-in-visual-studio-javascript.md#BKMK_Attach_the_debugger) в Центре разработчика Windows.

> [!NOTE]
> Чтобы отладчик мог присоединиться к коду на языке C++, код должен предоставлять `DebuggableAttribute`. Это можно добавить в код автоматически, путем связывания с параметром [/ASSEMBLYDEBUG](https://msdn.microsoft.com/library/94443af3-470c-41d7-83a0-7434563d7982) компоновщика.

## <a name="what-debugger-features-can-i-use"></a>Какие возможности отладчика можно использовать?

Чтобы использовать все функции отладчика Visual Studio (например, точки останова) при присоединении к процессу, исполняемый файл должен точно соответствовать локальному источнику и символам (т. е. отладчик должен иметь возможность загрузки правильных [файлов символов (. ПБД)](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md)). По умолчанию для этого требуется отладочная сборка.

В сценариях удаленной отладки должен быть уже открыт исходный код (или копия исходного кода) в Visual Studio. Скомпилированные двоичные файлы приложения на удаленном компьютере должны поступать из той же сборки, что и на локальном компьютере.

В некоторых локальных сценариях отладки можно выполнять отладку в Visual Studio без доступа к источнику, если в приложении имеются правильные файлы символов (по умолчанию для этого требуется отладочная сборка). Дополнительные сведения см. в разделе [Указание исходных символов и файлов](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md).

## <a name="BKMK_Troubleshoot_attach_errors"></a> Устранение ошибок присоединения
 При присоединении отладчика к выполняющемуся процессу этот процесс может содержать один или несколько типов кода. Типы кода, к которым может присоединиться отладчик, отображаются и выбираются в диалоговом окне **Выбор типа кода** .

 Иногда отладчик может успешно присоединяться к одному типу кода, но не к другому. Такое может происходить при попытке присоединения к процессу, выполняющемуся на удаленном компьютере. На удаленном компьютере для одних типов кода могут иметься компоненты удаленной отладки, а для других — нет. Такое также может происходить при попытке присоединиться к двум или более процессам для прямой отладки базы данных. Отладка SQL поддерживает присоединение только к одному процессу.

 Если отладчик может присоединиться не ко всем типам кода, то будет отображено сообщение, идентифицирующее типы, к которым присоединиться не удалось.

 Если отладчик успешно подключается хотя бы к одному типу кода, то можно приступать к отладке процесса. Но отлаживать можно будет только те типы кода, к которым удалось подсоединиться. В приведенном выше сообщении указано, что не удалось присоединиться к типу кода скриптов. Поэтому проводить отладку кода скриптов в данном процессе не удастся. Код скриптов в этом процессе будет выполняться, но задавать в этом сценарии точки останова, просматривать данные и выполнять другие операции отладки не удастся.

 Если нужны более конкретные сведения о том, почему отладчику не удалось присоединиться к некоторому типу кода, можно попытаться повторно присоединиться только к этому типу кода.

 **Получение конкретных сведений о том, почему не удалось присоединиться к типу кода**

1. Отключитесь от процесса. В меню **Отладка** выберите команду **Отсоединить все**.

2. Вновь подключитесь к процессу, выбрав единственный тип кода.

   1. В диалоговом окне **Присоединение к процессу** выберите процесс в списке **Доступные процессы** .

   2. Нажмите кнопку **Выбрать**.

   3. В диалоговом окне **Выбор типа кода** выберите **Выполнять отладку кода следующих типов** и выберите тип кода, к которому не удалось присоединиться. Отмените выбор всех остальных типов кода.

   4. Нажмите кнопку **ОК**. Диалоговое окно **Выбор типа кода** будет закрыто.

   5. В диалоговом окне **Присоединение к процессу** нажмите **Присоединиться**.

      На этот раз присоединение не пройдет полностью, и будет выдано сообщение о конкретной ошибке.

## <a name="see-also"></a>См. также
 [Отладка нескольких процессов](../debugger/debug-multiple-processes.md) [JIT-отладка](../debugger/just-in-time-debugging-in-visual-studio.md) [Удаленная отладка](../debugger/remote-debugging.md)
