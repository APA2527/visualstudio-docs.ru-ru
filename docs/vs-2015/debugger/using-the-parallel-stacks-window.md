---
title: С помощью параллельных стеков окно | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.debug.parallelstacks
dev_langs:
- FSharp
- VB
- CSharp
- C++
helpviewer_keywords:
- debugger, parallel tasks window
ms.assetid: f50efb78-5206-4803-bb42-426ef8133f2f
caps.latest.revision: 22
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: df764ac38f437be33b71e7a816709a46234f751e
ms.sourcegitcommit: 08fc78516f1107b83f46e2401888df4868bb1e40
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65684222"
---
# <a name="using-the-parallel-stacks-window"></a>Использование окна "Параллельные стеки"
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

**Параллельные стеки** окно полезен при отладке многопоточных приложений. Его **представление "Потоки"** содержит сведения о стеке вызова для всех потоков в приложении. Оно также позволяет переходить в различные потоки и кадры стека в потоках. В управляемом коде **представление "задачи"** отображает стеки вызова <xref:System.Threading.Tasks.Task?displayProperty=fullName> объектов. В машинном коде **представление "задачи"** отображает стеки вызова [группы задач](https://msdn.microsoft.com/library/42f05ac3-2098-494a-ba84-737fcdcad077), [параллельные алгоритмы](https://msdn.microsoft.com/library/045dca7b-4d73-4558-a44c-383b88a28473), [асинхронных агентов](https://msdn.microsoft.com/library/6cf6ccc6-87f1-4e14-af15-ea8ba58fef1a)и [упрощенных задач](https://msdn.microsoft.com/library/9aba278c-e0c9-4ede-b7c6-fedf7a365d90).  
  
## <a name="threads-view"></a>Представление потоков  
 На следующем рисунке показан поток, идущий от Main через A до B, а затем во внешний код. Два других потока начались во внешнем коде, а затем перешли к A, но один из потоков продолжился в объект B и затем во внешний код, а другой потом продолжился в объект C и затем в метод AnonymousMethod.  
  
 ![Представление в окне параллельных стеков потоков](../debugger/media/parallel-stacksthread.png "Parallel_StacksThread")  
  
 На рисунке путь вызова текущего потока выделен синим, а активный кадр стека обозначается желтой стрелкой. Текущий кадр стека можно изменить, выбрав другой метод в **Параллельные стеки** окна. При этом также может измениться текущий поток в зависимости от того, входит ли выбранный метод в текущий поток или является частью другого потока. В следующей таблице описаны основные возможности **Параллельные стеки** окна, как показано на рисунке.  
  
|Буква выноски|Имя элемента|Описание|  
|--------------------|------------------|-----------------|  
|А|Сегмент или узел стека вызова|Содержит последовательности контекстов методов для одного или нескольких потоков. Если узел не имеет линий со стрелками, то он представляет собой единый путь вызова для потоков.|  
|С|Синее выделение|Указывает путь вызова текущего потока.|  
|В|Линии со стрелками|Соединяют узлы и показывают единый путь вызова для потоков.|  
|D|Всплывающая подсказка заголовка узла|Показывает идентификатор и пользовательское имя каждого потока, путь вызова которого использует данный узел.|  
|E|Контекст метода|Представляет один или несколько кадров стека одного метода.|  
|C|Всплывающая подсказка для контекста метода|В представлении "Потоки" отображает все потоки в таблицу аналогичную **потоков** окна. В представлении задач, он отображает все задачи в виде таблицы аналогичную **параллельных задач** окна.|  
  
 Кроме того, окно параллельных стеков показано **птичьего полета** значок в основной области, когда график проходит слишком велик для окна. Щелкнув этот значок, можно просмотреть в окне всю схему целиком.  
  
## <a name="method-context-icons"></a>Значки контекста метода  
 В следующей таблице описываются значки, которые предоставляют сведения об активных и текущих кадрах стека.  
  
|||  
|-|-|  
|Значок|Описание|  
|![Желтая стрелка параллельных стеков](../debugger/media/icon-parallelyellowarrow.gif "Icon_ParallelYellowArrow")|Указывает на то, что контекст метода содержит активный кадр стека текущего потока.|  
|![Параллельных стеков потоков значок](../debugger/media/icon-parallelthreads.gif "Icon_ParallelThreads")|Указывает на то, что контекст метода содержит активный кадр стека потока, который не является текущим.|  
|![Зеленая стрелка параллельных стеков](../debugger/media/icon-parallelgreenarrow.gif "Icon_ParallelGreenArrow")|Указывает на то, что контекст метода содержит текущий кадр стека. Имя этого метода выделено жирным шрифтом во всех узлах.|  
  
## <a name="toolbar-controls"></a>Элементы управления панели инструментов  
 На следующем рисунке и в следующей таблице описываются элементы управления, доступные на панели управления "Параллельные стеки".  
  
 ![Панель инструментов в окне параллельных стеков](../debugger/media/parallel-stackstoolbar.png "Parallel_StacksToolbar")  
  
|Буква выноски|Элемент управления|Описание|  
|--------------------|-------------|-----------------|  
|А|Поле со списком "Потоки"/"Задачи"|Переключает отображение между стеками вызова для потоков и стеками вызова для задач. Дополнительные сведения см. в разделах по представлениям "Задачи" и "Потоки".|  
|С|Показывать только помеченные|Отображает стеки вызова только для потоков, которые помечены в других окнах отладки, такие как **потоки GPU** окна и **контроль параллельных данных** окна.|  
|В|Представление метода|Переключает представление стека и представление метода. Дополнительные сведения см. в разделе представления "Метод".|  
|D|Автопрокрутка к текущему кадру стека|Автоматически прокручивает схему для отображения текущего кадра стека. Этот компонент применяется при изменении текущего кадра стека из других окон или при появлении точки останова в крупных диаграммах.|  
|E|Переключить элемент управления масштабом|Отображает или скрывает элемент управления масштабом. Можно также увеличить масштаб, нажав клавишу CTRL и повернуть колесо мыши, независимо от видимости находится элемент управления, или используя **CTRL + SHIFT + '+'** чтобы увеличить масштаб и **CTRL + SHIFT + "-"** для уменьшения масштаба. Нажав клавишу **CTRL + F8** будет масштаб по размеру экрана.|  
  
### <a name="context-menu-items"></a>Элементы контекстного меню  
 На следующем рисунке и в с таблице ниже описываются элементы контекстного меню, доступные при нажатии правой кнопки мыши при наведении на контекст метода в представлении "Потоки" или "Задачи". Последние шесть элементов получены напрямую из окна "Стек вызова" и не предоставляют новых возможностей.  
  
 ![Контекстное меню в окне параллельных стеков](../debugger/media/parallel-contmenu.png "Parallel_ContMenu")  
  
|Menu Item|Описание|  
|---------------|-----------------|  
|Flag|Помечает выбранный элемент.|  
|Снять пометку|Снимает пометку с выбранного элемента.|  
|Заморозить|Замораживает выбранный элемент.|  
|Разморозить|Размораживает выбранный элемент.|  
|Переход к задаче (поток)|Выполняет ту же функцию, что и поле со списком на панели инструментов. При этом кадр стека остается выделенным.|  
|Перейти к исходному коду|Вызывает переход к расположению в исходном коде, которое соответствует кадру стека, который пользователь щелкнул правой кнопкой мыши.|  
|Перейти к кадру|Выполняет те же функции, то и соответствующая команда меню в окне "Стек вызова". При этом функция "Параллельные стеки" позволяет нескольким кадрам соответствовать одному контексту метода. Таким образом, этот элемент меню имеет вложенные меню, каждое из которых представляет определенный кадр стека. Если один из кадров стека расположен в текущем потоке, то выбирается меню, соответствующее этому кадру стека.|  
|Перейти к дизассемблированию|Вызывает переход к расположению в окне дизассемблирования, которое соответствует кадру стека, который пользователь щелкнул правой кнопкой мыши.|  
|Показать внешний код|Скрывает и показывает внешний код.|  
|Шестнадцатеричный вывод|Переключается между десятичным и шестнадцатеричным отображением.|  
|Сведения о загрузке символов|Отображает соответствующее диалоговое окно.|  
|Параметры символов|Отображает соответствующее диалоговое окно.|  
  
## <a name="tasks-view"></a>Представление задач  
 Если приложение использует <xref:System.Threading.Tasks.Task?displayProperty=fullName> объектов (управляемый код) или `task_handle` объектов (машинный код) для выражения параллелизма, можно использовать поле со списком на панели инструментов окна "Параллельные стеки" переключиться на *представление "задачи"*. Представление "Задачи" отображает стеки вызова задач вместо потоков. Представление "Задачи" отличается от представления "Потоки" следующим образом:  
  
- Стеки вызова потоков, не выполняющие задачи, не отображаются.  
  
- Стеки вызова потоков, выполняющие задачи, визуально отделяются в верхней и нижней части для отображения наиболее релевантных кадров, относящихся к задачам.  
  
- Когда несколько задач расположены в одном потоке, стеки вызова этих задач разделяются в отдельные узлы.  
  
  На следующем рисунке представление задач параллельных стеков показано с правой стороны, а с левой стороны — соответствующее представление "Потоки".  
  
  ![Задачи представления в окне параллельных стеков](../debugger/media/parallel-tasksview.png "Parallel_TasksView")  
  
  Чтобы просмотреть весь стек вызова, переключитесь в представление "Потоки", щелкнув правой кнопкой мыши кадр стека и выбрав **перейти к потоку**.  
  
  Как было описано в приведенной выше таблице, дополнительные сведения о контексте метода можно получить, наведя указатель мыши на контекст метода. На следующем рисунке показаны сведения всплывающей подсказки в представлении потоков и задач.  
  
  ![Всплывающие подсказки в окне параллельных стеков](../debugger/media/parallel-stack-tooltips.png "Parallel_Stack_Tooltips")  
  
## <a name="method-view"></a>Представление метода  
 Представление потоков или задач позволяет прикрепить график для текущего метода. Для этого следует щелкнуть значок представления метода на панели инструментов. Представление методы показывает все методы для всех потоков, которые вызывают текущий метод или вызываются им. На следующем рисунке показано представление потоков, а также отображение той же информации в представлении методов.  
  
 ![Представление методов в окне параллельных стеков](../debugger/media/parallel-methodview.png "Parallel_MethodView")  
  
 Переключение на новый кадр стека делает этот метод текущим методом и отображает в окне все вызывающие и вызываемые объекты нового метода. Из-за этого некоторые потоки могут появиться на представлении или исчезнуть из него (в зависимости от того, отображается ли этот метод в их стеках вызова). Чтобы вернуться в представление стека, повторно нажмите кнопку представления метода на панели инструментов.  
  
## <a name="see-also"></a>См. также  
 [Пошаговое руководство: Отладка параллельного приложения](../debugger/walkthrough-debugging-a-parallel-application.md)   
 [Основы отладки](../debugger/debugger-basics.md)   
 [Отладка управляемого кода](../debugger/debugging-managed-code.md)   
 [Параллельное программирование](https://msdn.microsoft.com/library/4d83c690-ad2d-489e-a2e0-b85b898a672d)   
 [Использование окна задач](../debugger/using-the-tasks-window.md)   
 [Пошаговое руководство: Отладка параллельного приложения](../debugger/walkthrough-debugging-a-parallel-application.md)   
 [Класс Task](../extensibility/debugger/task-class-internal-members.md)
