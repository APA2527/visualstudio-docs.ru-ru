---
title: Удаленная отладка | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.debug.remote.overview
dev_langs:
- C++
- CSharp
- FSharp
- JScript
- VB
helpviewer_keywords:
- remote debugging, setup
ms.assetid: 5a94ad64-100d-43ca-9779-16cb5af86f97
caps.latest.revision: 81
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 68ebd9ab8c4f9d3cda1371d90a8da459edb1592b
ms.sourcegitcommit: bad28e99214cf62cfbd1222e8cb5ded1997d7ff0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2019
ms.locfileid: "74300552"
---
# <a name="remote-debugging"></a>Удаленная отладка
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Вы можете отладить приложение Visual Studio, развернутое на другом компьютере.  Для этого используется удаленный отладчик Visual Studio.  
  
 Информация в этом разделе относится к классическим приложениям Windows и приложениям ASP.NET.  Сведения об удаленной отладке приложений для Магазина Windows и приложений Azure см. [в статье Удаленная отладка в магазине Windows и приложения Azure](#bkmk_winstoreAzure).  
  
## <a name="get-the-remote-tools"></a>Получение средств удаленной работы  
Вы можете загрузить средства удаленного управления непосредственно на устройстве или сервере, которые необходимо отладить, или получить средства удаленного управления с главного компьютера с установленной Visual Studio.

### <a name="to-download-and-install-the-remote-tools"></a>Загрузка и установка средств удаленной установки
  
1. На устройстве или компьютере сервера, который требуется отладить (а не на компьютере с Visual Studio), получите правильную версию средств удаленного управления.

    |Версия|Ссылка|Примечания|
    |-|-|-|
    |Visual Studio 2015 с обновлением 3|[Инструменты удаленной отладки](https://my.visualstudio.com/Downloads?q=remote%20tools%20visual%20studio%202015)|При появлении запроса присоединитесь к бесплатной группе Visual Studio Dev Essentials или просто войдите с помощью действительной подписки Visual Studio. При необходимости повторно откройте ссылку. Всегда скачивать версию, соответствующую операционной системе вашего устройства (версия x86, x64 или ARM)|
    |Visual Studio 2015 (более старая версия)|[Инструменты удаленной отладки](https://my.visualstudio.com/Downloads?q=remote%20tools%20visual%20studio%202015)|При появлении запроса присоединитесь к бесплатной группе Visual Studio Dev Essentials или просто войдите с помощью действительной подписки Visual Studio. При необходимости повторно откройте ссылку.|
    |Visual Studio 2013|[Инструменты удаленной отладки](https://msdn.microsoft.com/library/bt727f1t(v=vs.120).aspx#BKMK_Installing_the_Remote_Tools)|Страница загрузки в документации по Visual Studio 2013|
    |Visual Studio 2012|[Инструменты удаленной отладки](https://msdn.microsoft.com/library/bt727f1t(v=vs.110).aspx#BKMK_Installing_the_Remote_Tools)|Страница загрузки документации по Visual Studio 2012|
  
2. На странице загрузки выберите версию средств, соответствующих вашей операционной системе (x86, x64 или ARM), и скачайте средства удаленного управления.
  
    > [!IMPORTANT]
    > Рекомендуется установить самую последнюю версию средств удаленной установки, соответствующих вашей версии Visual Studio. Не рекомендуется использовать несоответствующие версии.  
    >   
    >  Кроме того, необходимо установить средства удаленной установки, имеющие ту же архитектуру, что и операционная система, в которой вы хотите установить их. Иными словами, если требуется выполнить отладку 32-разрядного приложения на удаленном компьютере под управлением 64-разрядной операционной системы, необходимо установить 64-разрядную версию средств удаленного управления на удаленном компьютере.  
  
3. Скачав исполняемый файл, следуйте инструкциям по установке приложения на удаленном компьютере. См. [инструкции по установке](#bkmk_setup)

При попытке скопировать удаленный отладчик (msvsmon. exe) на удаленный компьютер и запустить его, имейте в виду, что **Мастер настройки удаленного отладчика** (**рдбгвиз. exe**) устанавливается только при скачивании средств и может потребоваться использовать мастер для настройки позже, особенно если требуется, чтобы удаленный отладчик выполнялся в качестве службы. Дополнительные сведения см. [в разделе (необязательно) Настройка удаленного отладчика как службы](#bkmk_configureService) ниже.

### <a name="to-run-the-remote-debugger-from-a-file-share"></a>Запуск удаленного отладчика из общей папки

Удаленный отладчик (**msvsmon. exe**) можно найти на компьютере с уже установленным сообществом Visual Studio 2015 Community, Professional или Enterprise. Для многих сценариев самый простой способ настроить удаленную отладку — запустить удаленный отладчик (msvsmon. exe) из общей папки. Ограничения по использованию см. на странице справки удаленного отладчика (**Справка и использование** в удаленном отладчике).

1. Найдите **файл msvsmon. exe** в каталоге, соответствующем вашей версии Visual Studio. Для Visual Studio 2015:

      **Программа Files\Microsoft Visual Studio (Common7\IDE\Remote) Debugger\x86\msvsmon.exe**
      
      **Программа Files\Microsoft Visual Studio (Common7\IDE\Remote) Debugger\x64\msvsmon.exe**

2. Предоставьте общий доступ к папке **удаленного отладчика** на компьютере с Visual Studio.

3. На удаленном компьютере запустите **msvsmon. exe**. Следуйте [инструкциям по установке](#bkmk_setup).

> [!TIP] 
> Сведения об установке командной строки и Справочнике по командной строке см. на странице справки по **msvsmon. exe.** для этого введите ``msvsmon.exe /?`` в командной строке на компьютере с установленной средой Visual Studio (или выберите **Справка/использование** в удаленном отладчике).

## <a name="supported-operating-systems"></a>Supported Operating Systems  
 Удаленный компьютер должен работать под управлением одной из следующих операционных систем:  
  
- Windows 10  
  
- Windows 8 или 8.1  
  
- Windows 7 с пакетом обновления 1 (SP1)  
  
- Windows Server 2012 или Windows Server 2012 R2  
  
- Windows Server 2008 с пакетом обновления 2 (SP2), Windows Server 2008 R2 с пакетом обновления 1 (SP1)  
  
## <a name="supported-hardware-configurations"></a>Поддерживаемые конфигурации оборудования  
  
- Процессор с тактовой частотой 1,6 ГГц и выше  
  
- 1 ГБ ОЗУ (1,5 ГБ при выполнении в виртуальной машине)  
  
- 1 ГБ свободного дискового пространства  
  
- Жесткий диск 5400 об/мин  
  
- Видеоадаптер с поддержкой DirectX 9 и разрешением экрана 1024x768 или выше  
  
## <a name="network-configuration"></a>Сетевая конфигурация  
 Удаленный компьютер и компьютер Visual Studio должны быть подключены по сети, объединены в рабочую или домашнюю группу либо соединены напрямую с помощью кабеля Ethernet. Отладка через Интернет не поддерживается.  
  
## <a name="bkmk_setup"></a>Настройка удаленного отладчика  
 на удаленном компьютере требуются права администратора.  
  
1. Найдите приложение "Удаленный отладчик". (Откройте меню "Пуск" и выполните поиск **удаленного отладчика**.)
  
    Если удаленный отладчик запущен на удаленном сервере, можно щелкнуть правой кнопкой мыши приложение удаленного отладчика и выбрать **Запуск от имени администратора** (или же запустить удаленный отладчик как службу). Если вы не запускаете его на удаленном сервере, просто запустите его в обычном режиме.
  
2. При запуске средств удаленного выполнения в первый раз (или до его настройки) появляется поле далог **Configuration (Настройка удаленной отладки** ).  
  
    ![ремотедебугжерконфвизардпаже](../debugger/media/remotedebuggerconfwizardpage.png "RemoteDebuggerConfWizardPage")  
  
3. Если API службы Windows не установлен (что происходит только в Windows Server 2008 R2), нажмите кнопку **установить** .  
  
4. Выберите типы сетей, в которых необходимо использовать инструменты удаленной отладки. Должен быть выбран по крайней мере один тип сети. Если компьютеры соединены через домен, необходимо выбрать первый пункт. Если компьютеры соединены посредством рабочей или домашней группы, необходимо выбрать второй или третий пункт.  
  
5. Выберите **Настройка удаленной отладки** , чтобы настроить брандмауэр и запустить средство.  
  
6. По завершении настройки появится окно удаленного отладчика.
  
    ![ремотедебугжервиндов](../debugger/media/remotedebuggerwindow.png "RemoteDebuggerWindow")
  
    Теперь удаленный отладчик ожидает соединения. Запишите отображаемое имя сервера и номер порта, так как это потребуется позже для настройки в Visual Studio.  
  
   После завершения отладки и необходимости остановите удаленный отладчик, щелкните **файл/выход** в окне. Его можно перезапустить из меню " **Пуск** " или из командной строки:  
  
   **\<каталог установки Visual Studio > \Common7\IDE\Remote debugger\\< x86, x64 или аппкс\мсвсмон.ЕКСЕ**.  
  
## <a name="configure-the-remote-debugger"></a>Настройка удаленного отладчика  
 После первого запуска удаленного отладчика можно изменить некоторые аспекты его конфигурации.
  
- Чтобы разрешить другим пользователям подключаться к удаленному отладчику, выберите **Сервис/разрешения**. Для предоставления разрешений или отказа в предоставлении необходимо обладать правами администратора.

  > [!IMPORTANT]
  > Удаленный отладчик можно запустить под учетной записью пользователя, которая отличается от учетной записи пользователя, используемой на компьютере Visual Studio, но необходимо добавить другую учетную запись пользователя к разрешениям удаленного отладчика. 

   Кроме того, можно запустить удаленный отладчик из командной строки с помощью параметра **/allow \<username >** параметр: **msvsmon/allow \<username@computer>** .
  
- Для изменения режима проверки подлинности или номера порта или для указания значения времени ожидания для средств удаленной настройки: выберите **Сервис/параметры**.  
  
   Список номеров портов, используемых по умолчанию, см. в разделе [назначение портов удаленного отладчика](../debugger/remote-debugger-port-assignments.md).  
  
   > [!WARNING]
  > Вы можете запускать инструменты удаленной отладки в режиме "без аутентификации", однако настоятельно рекомендуется не использовать этот режим. При работе в этом режиме сетевая безопасность не обеспечивается. Режим без аутентификации можно выбрать, только если вы уверены в отсутствии вредоносного или опасного трафика.

## <a name="bkmk_configureService"></a>Используемых Настройка удаленного отладчика как службы
 Для отладки в ASP.NET и других серверных средах необходимо либо запустить удаленный отладчик от имени администратора, либо, если вы хотите, чтобы он всегда выполнялся, запустить удаленный отладчик как службу.
  
 Если вы хотите настроить удаленный отладчик как службу, выполните следующие действия.  
  
1. Найдите **мастер настройки удаленного отладчика** (rdbgwiz.exe). (Это отдельное приложение из удаленного отладчика.) Он доступен только при установке средств удаленной установки. Вместе с Visual Studio он не устанавливается.  
  
2. Запустите мастер настройки. Когда появится первая страница, нажмите кнопку **Далее**.  
  
3. Установите флажок **Запускать удаленный отладчик Visual Studio 2015 как службу** .  
  
4. Добавьте имя учетной записи пользователя и пароль.  
  
    Для этой учетной записи может потребоваться добавить разрешение **Вход в качестве службы** . (Найдите элемент **Локальная политика безопасности** (secpol.msc) на **начальной** странице или в начальном окне (либо введите **secpol** в командной строке). В открывшемся окне дважды щелкните элемент **Назначение прав пользователя**, а затем в области справа найдите элемент **Вход в качестве службы** . Дважды щелкните его. Добавьте учетную запись пользователя в окно **Свойства** и нажмите кнопку **ОК**.) Нажмите кнопку **Далее**.  
  
5. Выберите тип сети, с которой должны взаимодействовать инструменты удаленной отладки. Должен быть выбран по крайней мере один тип сети. Если компьютеры соединены через домен, необходимо выбрать первый пункт. Если компьютеры соединены посредством рабочей или домашней группы, необходимо выбрать второй или третий пункт. Нажмите кнопку **Далее**.  
  
6. Если службу удается запустить, вы увидите сообщение **Вы успешно завершили работу мастера настройки удаленного отладчика Visual Studio**. Если службу не удается запустить, вы увидите сообщение **Не удалось завершить мастер настройки удаленного отладчика Visual Studio**. На странице также приводится ряд советов по запуску службы.  
  
7. Нажмите кнопку **Готово**.  
  
   Теперь удаленный отладчик должен работать как служба. Чтобы проверить, так ли это, выберите **Панель управления/Службы** и найдите службу **Удаленный отладчик Visual Studio 2015**.  
  
   Останавливать и запускать службу удаленного отладчика можно с помощью компонента **Панель управления / Службы**.  

## <a name="remote-debug-an-aspnet-application"></a>Удаленная отладка приложения ASP.NET  
 Развертывание приложения ASP.NET на удаленном компьютере со службами IIS выполняется по-разному в зависимости от операционной системы и версии IIS. Для удаленных компьютеров под управлением Windows Server 2008 или Windows Server 2012 с установленными службами IIS 7,5 или более поздней версии см. раздел [Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md).
 
 При отладке ASP.NET Core приложения см. раздел [Публикация в службах IIS](https://docs.asp.net/en/latest/publishing/iis.html). Для публикации ASP.NET Core служб IIS требуются различные действия. После успешного опубликования ASP.NET Core приложения можно выполнять удаленную отладку, [так же как и другие приложения ASP.NET](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md), за исключением того, что процесс, к которому необходимо подключиться, — это DNX. exe, а не w3wp. exe.

## <a name="remote-debug-a-visual-c-project"></a>Удаленная отладка проекта Visual C++  
 В следующей процедуре имя и путь проекта — К:\ремотетемп\мимфк, а имя удаленного компьютера — **МЖО-DL**.  
  
1. Создайте приложение MFC с именем **mymfc**.  
  
2. Создайте точку останова в легкодоступном месте приложения, например в файле **MainFrm.cpp**, в начале `CMainFrame::OnCreate`.  
  
3. В обозреватель решений щелкните правой кнопкой мыши проект и выберите пункт **Свойства**. Откройте вкладку **Отладка**.  
  
4. Для параметра **Загружаемый отладчик** задайте значение **Удаленный отладчик Windows**.  
  
    ![ремотедебуггингкплус](../debugger/media/remotedebuggingcplus.png "RemoteDebuggingCPlus")  
  
5. Внесите в свойства следующие изменения:  
  
   |Параметр|значения|
   |-|-|  
   |Удаленная команда|C:\remotetemp\mymfc.exe|  
   |Рабочий каталог|C:\remotetemp|  
   |Имя удаленного сервера|МЖО-DL:*номер_порта*|  
   |Подключение|Удаленный доступ с аутентификацией Windows|  
   |Тип отладчика|Только машинный код|  
   |Каталог развертывания|C:\remotetemp.|  
   |Дополнительные файлы развертывания|C:\data\mymfcdata.txt.|  
  
    При развертывании дополнительных файлов (необязательно) папка должна существовать на обоих компьютерах.  
  
6. В обозреватель решений щелкните решение правой кнопкой мыши и выберите **Configuration Manager**.  
  
7. Для конфигурации **Отладка** установите флажок **Развертывание**.  
  
    ![ремотедебугкплусдеплой](../debugger/media/remotedebugcplusdeploy.png "RemoteDebugCplusDeploy")  
  
8. Запустите отладку (**Отладка, запуск отладки**или **F5**).  
  
9. Исполняемый файл автоматически развернется на удаленном компьютере.  
  
10. При появлении запроса введите сетевые учетные данные для подключения к удаленному компьютеру.  
  
     Необходимые учетные данные зависят от конфигурации безопасности вашей сети. Например, на компьютере домена можно выбрать сертификат безопасности или ввести имя домена и пароль. На компьютере, не являющемся доменом, можно ввести имя компьютера и допустимое имя учетной записи пользователя, например <strong>MJO-DL\name@something.com</strong>, а также правильный пароль.  
  
11. На компьютере с Visual Studio вы должны увидеть, что выполнение остановилось в точке останова.  
  
    > [!TIP]
    > Кроме того, файлы можно развернуть как отдельный шаг. В **обозревателе решений** щелкните правой кнопкой мыши узел **mymfc** и выберите пункт **Развернуть**.  
  
    Если приложение должно использовать файлы, не являющиеся файлами кода, их нужно включить в проект Visual Studio. Создайте папку проекта для дополнительных файлов (в **Обозреватель решений**щелкните **Добавить/создать папку**.) Затем добавьте файлы в папку (в **Обозреватель решений**щелкните **Добавить/существующий элемент**, а затем выберите файлы.) На странице **Свойства** для каждого файла задайте для свойства **Копировать в выходной каталог** значение **Всегда копировать**.  
  
## <a name="remote-debug-a-visual-c-or-visual-basic-project"></a>Удаленная отладка проекта Visual C# или Visual Basic  
 Отладчик не может развертывать классические приложения Visual C# и Visual Basic на удаленном компьютере, но вы все же можете выполнять их удаленную отладку описанным ниже образом. В следующей процедуре предполагается, что вы хотите выполнить отладку на компьютере с именем **МЖО-DL**, как показано на предыдущем рисунке.
  
1. Создайте проект WPF с именем **MyWpf**.  
  
2. Установите точку останова в легкодоступном месте кода.  
  
    Например, ее можно установить в обработчике кнопки. Для этого откройте файл MainWindow. XAML и добавьте элемент управления Button из панели элементов, а затем дважды щелкните кнопку, чтобы открыть обработчик.
  
3. В обозревателе решений щелкните правой кнопкой мыши проект и выберите пункт **Свойства**.  
  
4. На странице **Свойства** откройте вкладку **Отладка**.  
  
    ![ремотедебугжеркшарп](../debugger/media/remotedebuggercsharp.png "RemoteDebuggerCSharp")  
  
5. Убедитесь, что текстовое поле **Рабочий каталог** пустое.  
  
6. Выберите **использовать удаленный компьютер**и введите **МЖО-DL: 4020** в текстовом поле. (4020 — номер порта, отображаемый в окне удаленного отладчика).  
  
7. Убедитесь в том, что параметр **Разрешить отладку машинного кода** не выбран.  
  
8. Выполните построение проекта.  
  
9. Создайте на удаленном компьютере папку с тем же путем, что и у папки **Debug** на компьютере с Visual Studio: **\<исходный путь>\MyWPF\MyWPF\bin\Debug**.  
  
10. Скопируйте исполняемый файл, сборку которого вы только что выполнили, с компьютера с Visual Studio в созданную на удаленном компьютере папку.
  
    > [!CAUTION]
    > Не вносите изменения в код или перестроение (или необходимо повторить этот шаг). Исполняемый файл, скопированный на удаленный компьютер, должен в точности совпадать с локальным исходным кодом и символами.

    Вы можете скопировать проект вручную, использовать XCOPY, Robocopy, PowerShell или другие параметры.
  
11. Убедитесь, что удаленный отладчик работает на целевом компьютере. (Если это не так, выполните поиск **удаленного отладчика** в меню " **Пуск** ". ) Окно удаленного отладчика выглядит следующим образом.  
  
     ![ремотедебугжервиндов](../debugger/media/remotedebuggerwindow.png "RemoteDebuggerWindow")  
  
12. В Visual Studio запустите отладку (**Отладка, запуск отладки**или **F5**).  
  
13. При появлении запроса введите сетевые учетные данные для подключения к удаленному компьютеру.  
  
     Требуемые учетные данные зависят от конфигурации безопасности вашей сети. Например, на компьютере домена можно ввести имя домена и пароль. На компьютере, не являющемся доменом, можно ввести имя компьютера и допустимое имя учетной записи пользователя, например <strong>MJO-DL\name@something.com</strong>, а также правильный пароль.

     Главное окно приложения WPF должно быть открыто на удаленном компьютере.
  
14. При необходимости выполните действия для попадания в точку останова. Она должна быть активна. Если она не активна, символы для приложения не загрузились. Повторите попытку. Если это не сработает, получите сведения о загрузке символов и об устранении неполадок в [файлах символов и параметрах символов в Visual Studio](https://devblogs.microsoft.com/devops/understanding-symbol-files-and-visual-studios-symbol-settings/).
  
15. На компьютере с Visual Studio вы должны увидеть, что выполнение остановилось в точке останова.
  
    Если приложение должно использовать файлы, не являющиеся файлами кода, их нужно включить в проект Visual Studio. Создайте папку проекта для дополнительных файлов (в **Обозреватель решений**щелкните **Добавить/создать папку**.) Затем добавьте файлы в папку (в **Обозреватель решений**щелкните **Добавить/существующий элемент**, а затем выберите файлы.) На странице **Свойства** для каждого файла задайте для свойства **Копировать в выходной каталог** значение **Всегда копировать**.
  
## <a name="set-up-debugging-with-remote-symbols"></a>Настройка отладки с удаленными символами  
 Вы можете отлаживать код с использованием символов, созданных на компьютере Visual Studio. Производительность удаленного отладчика гораздо выше при использовании локальных символов.  Если необходимо использовать удаленные символы, укажите, что монитор удаленной отладки должен искать символы на удаленном компьютере.  
  
 Начиная с версии Visual Studio 2013 с обновлением 2 можно использовать следующий параметр командной строки msvsmon для использования удаленных символов для управляемого кода: `Msvsmon / /FallbackLoadRemoteManagedPdbs`  
  
 Дополнительные сведения см. в справке по удаленной отладке (нажмите клавишу **F1** в окне удаленного отладчика или выберите **Справка/использование**). Также см. запись блога с описанием [изменений, связанных с удаленной загрузкой символов .NET в Visual Studio 2012 и 2013](https://devblogs.microsoft.com/devops/net-remote-symbol-loading-changes-in-visual-studio-2012-and-2013/).  
  
## <a name="bkmk_winstoreAzure"></a>Удаленная отладка в магазине Windows и в приложениях Azure  
 Сведения об удаленной отладке приложений для Магазина Windows см. в статье [Отладка и тестирование приложений для Магазина Windows на удаленном устройстве из Visual Studio](https://msdn.microsoft.com/library/windows/apps/hh441469.aspx).  
  
 Сведения об отладке в Azure см. в одном из следующих разделов:  
  
- [Отладка облачной службы или виртуальной машины в Visual Studio](../azure/vs-azure-tools-debug-cloud-services-virtual-machines.md)  
  
- [Отладка серверной части .NET в Visual Studio](https://blogs.msdn.microsoft.com/azuremobile/2014/03/14/debugging-net-backend-in-visual-studio/)  
  
- Общие сведения об удаленной отладке на веб-сайтах Azure ([часть 1](https://azure.microsoft.com/blog/2014/05/06/introduction-to-remote-debugging-on-azure-web-sites/), [часть 2](https://azure.microsoft.com/blog/2014/05/07/introduction-to-remote-debugging-azure-web-sites-part-2-inside-remote-debugging/), [часть 3](https://azure.microsoft.com/blog/2014/05/08/introduction-to-remote-debugging-on-azure-web-sites-part-3-multi-instance-environment-and-git/)).  
  
## <a name="see-also"></a>См. также  
 [Отладка в Visual Studio](../debugger/debugging-in-visual-studio.md)   
 [Настройка брандмауэра Windows для удаленной отладки](../debugger/configure-the-windows-firewall-for-remote-debugging.md)   
 [Remote Debugger Port Assignments](../debugger/remote-debugger-port-assignments.md)   
 [Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md)  
 [Ошибки удаленной отладки и их устранение](../debugger/remote-debugging-errors-and-troubleshooting.md)
