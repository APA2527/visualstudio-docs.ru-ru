---
title: Использование окна задач | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.debug.paralleltasks
dev_langs:
- FSharp
- VB
- CSharp
- C++
helpviewer_keywords:
- debugger, parallel tasks window
ms.assetid: bd5e0612-a0dc-41cf-a7af-1e87d0d5c35f
caps.latest.revision: 23
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 267a04e0d717bde311423aae7f35fba07ca6f39b
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "65684039"
---
# <a name="using-the-tasks-window"></a>Использование окна задач
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Окно **Задачи** выглядит так же, как окно **Потоки**, за тем исключением, что вместо сведений о каждом потоке в нем отображаются сведения об объектах <xref:System.Threading.Tasks.Task?displayProperty=fullName>, [task_handle](https://msdn.microsoft.com/library/b4af5b28-227d-4488-8194-0a0d039173b7) или [WinJS.Promise](https://msdn.microsoft.com/library/windows/apps/br211867.aspx). Как и потоки, задачи представляют асинхронные операции, которые могут выполняться параллельно; однако несколько задач могут выполняться в одном потоке. Дополнительные сведения см. [в статье асинхронное программирование в JavaScript (приложения для Магазина Windows)](https://msdn.microsoft.com/library/windows/apps/hh700330.aspx) .  
  
 В случае управляемого кода окно **Задачи** можно использовать при работе с объектами <xref:System.Threading.Tasks.Task?displayProperty=fullName> или ключевыми словами **await** и **async** (**Await** и **Async** в Visual Basic). Дополнительные сведения о задачах в управляемом коде см. в статье о [параллельном программировании](https://msdn.microsoft.com/library/4d83c690-ad2d-489e-a2e0-b85b898a672d).  
  
 В случае машинного кода окно **Задачи** можно использовать при работе с [группами задач](https://msdn.microsoft.com/library/42f05ac3-2098-494a-ba84-737fcdcad077), [параллельными алгоритмами](https://msdn.microsoft.com/library/045dca7b-4d73-4558-a44c-383b88a28473), [асинхронными агентами](https://msdn.microsoft.com/library/6cf6ccc6-87f1-4e14-af15-ea8ba58fef1a) и [упрощенными задачами](https://msdn.microsoft.com/library/9aba278c-e0c9-4ede-b7c6-fedf7a365d90). Дополнительные сведения о задачах в машинном коде см. в статье [Среда выполнения с параллелизмом](https://msdn.microsoft.com/library/874bc58f-8dce-483e-a3a1-4dcc9e52ed2c).  
  
 В случае JavaScript окно "Задачи" можно использовать при работе с методом обещания .then.  
  
 Окно **Задачи** можно использовать всякий раз при переключении в режим отладчика. Его можно открыть в меню **Отладка**, щелкнув пункт **Окна**, а затем выбрав **Задачи**. На следующем рисунке показано окно **Задачи** в режиме по умолчанию.  
  
 ![Окно параллельных задач](../debugger/media/parallel-tasks-window.png "Parallel_Tasks_Window")  
  
> [!NOTE]
> В случае управляемого кода объект <xref:System.Threading.Tasks.Task>, который имеет состояние <xref:System.Threading.Tasks.TaskStatus>, <xref:System.Threading.Tasks.TaskStatus> или <xref:System.Threading.Tasks.TaskStatus>, может не отображаться в окне "Задачи", если управляемые потоки находятся в состоянии сна или состоянии соединения.  
  
## <a name="tasks-column-information"></a>Сведения в столбцах окна "Задачи"  
 В столбцах окна **Задачи** отображаются следующие сведения.  
  
|Имя столбца|Описание|  
|-----------------|-----------------|  
|**Флаги**|Показывает, какие задачи помечены, и позволяет помечать задачи и снимать с них метки.|  
|**Значки**|Рядом с текущей задачей отображается желтая стрелка. Текущая задача находится на самом верхнем уровне текущего потока.<br /><br /> Белая стрелка указывает прерванную задачу, т.е. задачу, которая была текущей во время вызова отладчика.<br /><br /> Значок паузы указывает задачу, замороженную пользователем. Задачу можно заморозить или разморозить, щелкнув ее в списке правой кнопкой мыши.|  
|**ID**|Предоставленный системой номер задачи. В машинном коде этот номер является адресом задачи.|  
|**Состояние**|Текущее состояние задачи (запланирована, активна, заблокирована, находится в ожидании или завершена). Запланированная задача – это задача, которая еще не выполнялась и, следовательно, не имеет стека вызова, назначенного потока и других соответствующих сведений.<br /><br /> Активная задача — это задача, которая выполняла код, пока не была прервана в отладчике.<br /><br /> Находящаяся в ожидании задача – это задача, заблокированная вследствие ожидания сигнала события, освобождения блокировки или завершения другой задачи.<br /><br /> Заблокированная задача – это находящаяся в ожидании задача, чей поток заблокирован другим потоком.<br /><br /> Наведите указатель мыши на ячейку **состояния** для незаблокированной или ожидающей задачи, чтобы просмотреть дополнительные сведения о блоке. **Предупреждение.**  Окно **Задачи** сообщает о состоянии взаимоблокировки только для заблокированных задач, использующих примитив синхронизации, который поддерживается функцией прохождения цепочки ожидания (Wait Chain Traversal, WCT). Например, для взаимозаблокированного <xref:System.Threading.Tasks.Task> объекта, который использует WCT, отладчик сообщает о **состоянии ожидания взаимоблокировки**. Для заблокированной задачи, управляемой средой выполнения с параллелизмом, которая не поддерживает WCT, отладчик отображает состояние **Ожидание**. Дополнительные сведения о функции WCT см. в статье [Wait Chain Traversal](https://msdn.microsoft.com/library/ms681622\(VS.85\).aspx) (Прохождение цепочки ожидания).|  
|**Время начала**|Время, когда задача стала активной.|  
|**Длительность**|Количество секунд, в течение которого задача была активна.|  
|**Время выполнения**|Время, когда задача была завершена.|  
|**Расположение**|Текущее расположение в стеке вызова задачи. Наведите указатель мыши на эту ячейку, чтобы увидеть весь стек вызова задачи. У запланированных задач значение в этом столбце отсутствует.|  
|**Задача**|Исходный метод и какие-либо аргументы, которые были переданы в задачу при ее создании.|  
|**Родительский объект**|Идентификатор задачи, создавшей данную задачу. Если эта ячейка пуста, то у задачи нет родительской задачи. Это применимо только для управляемых программ.|  
|**Назначение потоков**|Идентификатор и имя потока, в котором запущена задача.|  
|**Состояние возврата**|Состояние задачи при ее завершении. Возвращаемые значения состояния: **успешно**, **отменено**и **Ошибка**.|  
|**AppDomain**|Для управляемого кода это домен приложения, в котором выполняется задача.|  
|**task_group**|Для машинного кода это адрес объекта [task_group](https://msdn.microsoft.com/library/b4af5b28-227d-4488-8194-0a0d039173b7), который запланировал задачу. Для асинхронных агентов и упрощенных задач этот столбец содержит значение 0.|  
|Процесс|Идентификатор процесса, к которому относится выполняемая задача.|  
|Асинхронное состояние|В случае управляемого кода указывает состояние задачи. По умолчанию этот столбец скрыт. Для отображения этого столбца откройте контекстное меню для одного из заголовков столбцов. Выберите **Столбцы**, **AsyncState**.|  
  
 В это представление можно добавлять столбцы, щелкнув правой кнопкой мыши заголовок столбца и выбрав нужные столбцы. (Отмените выбор элементов, чтобы удалить столбцы.) Кроме того, можно изменять порядок столбцов, перетаскивая их влево или вправо. На следующем рисунке показано контекстное меню столбца.  
  
 ![Контекстное меню представлений в окне параллельных стеков](../debugger/media/parallel-tasks-contextmenu.png "Parallel_Tasks_ContextMenu")  
  
## <a name="sorting-tasks"></a>Сортировка задач  
 Чтобы выполнить сортировку задач, щелкните заголовок столбца. Например, если щелкнуть заголовок столбца **ИД**, задачи будут отсортированы по идентификаторам: 1,2,3,4,5 и так далее. Чтобы изменить порядок сортировки, еще раз щелкните заголовок столбца. Текущий столбец сортировки и порядок сортировки указывается стрелкой в столбце.  
  
## <a name="grouping-tasks"></a>Группирование задач  
 Задачи можно группировать на основе любого столбца в представлении списка. Например, щелкнув правой кнопкой мыши заголовок столбца **состояние** , а затем выбрав **Группировать по состоянию**, можно сгруппировать все задачи, имеющие одинаковое состояние. Затем можно быстро просмотреть задачи, находящиеся в определенном состоянии, например в состоянии ожидания, чтобы понять причину их блокировки. Можно также свернуть группу, которая не представляет интереса в текущем сеансе отладки. Таким же образом можно группировать задачи по другим столбцам. Можно установить или удалить пометку группы, просто нажав кнопку рядом с заголовком группы. На следующем рисунке показано окно **Задачи** в режиме группирования.  
  
 ![Группированный режим в окне параллельных задач](../debugger/media/parallel-tasks-groupedmode.png "Parallel_Tasks_GroupedMode")  
  
## <a name="parent-child-view"></a>Представление родительского и дочернего объектов  
 (Это представление доступно только для управляемого кода.) Щелкнув правой кнопкой мыши заголовок столбца и выбрав **родительский дочерний вид**, можно изменить список задач на иерархическое представление, в котором каждая дочерняя задача является подузловой, которую можно отобразить или скрыть в родительском элементе. На следующем рисунке показаны задачи в представлении родительского и дочернего объектов.  
  
 ![Родительский&#45;дочернего представления в окне параллельных задач](../debugger/media/parallel-tasks-parentchildview.png "Parallel_Tasks_ParentChildView")  
  
## <a name="flagging-tasks"></a>Пометка задач  
 Можно пометить поток задачей, в которой выполняется задача, выбрав элемент списка задач, а затем выбрав пункт **пометить** в контекстном меню или щелкнув значок флага в первом столбце. Если помечается несколько задач, то затем их можно сортировать по столбцу флага, чтобы вывести все помеченные задачи наверх и далее сосредоточиться только на них. Для просмотра только помеченных флагом задач можно также воспользоваться окном **Параллельные стеки**. Это позволяет отфильтровывать задачи, которые не нужны для отладки. Между сеансами отладки пометки не существуют.  
  
## <a name="freezing-and-thawing-tasks"></a>Замораживание и размораживание задач  
 Чтобы заморозить поток, в котором запущена задача, можно щелкнуть правой кнопкой мыши элемент задачи в списке и выбрать **Заморозить назначенный поток**. (Если задача уже заморожена, то вместо этого пункта в контекстном меню появляется пункт **Разморозить назначенный поток**.) Когда поток замораживается, он не будет выполняться при пошаговом проходе по коду после текущей точки останова. **Заморозить все потоки, но эта** команда закрепляет все потоки, за исключением того, который исполняет элемент списка задач.  
  
 На следующем рисунке показаны остальные пункты меню для каждой задачи.  
  
 ![Контекстное меню потоков в окне параллельных стеков](../debugger/media/parallel-tasks-contextmenu2.png "Parallel_Tasks_ContextMenu2")  
  
## <a name="see-also"></a>См. также:  
 [Основы отладчика](../debugger/debugger-basics.md)   
 [Отладка управляемого кода](../debugger/debugging-managed-code.md)   
 [Параллельное программирование](https://msdn.microsoft.com/library/4d83c690-ad2d-489e-a2e0-b85b898a672d)   
 [среда выполнения с параллелизмом](https://msdn.microsoft.com/library/874bc58f-8dce-483e-a3a1-4dcc9e52ed2c)   
 [Использование окна "Параллельные стеки"](../debugger/using-the-parallel-stacks-window.md)   
 [Пошаговое руководство: Отладка параллельного приложения в Visual Studio](../debugger/walkthrough-debugging-a-parallel-application.md)
