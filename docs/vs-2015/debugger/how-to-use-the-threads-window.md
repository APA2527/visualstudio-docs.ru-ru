---
title: Как использовать окно "потоки" | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.debug.threads
dev_langs:
- FSharp
- VB
- CSharp
- C++
helpviewer_keywords:
- threading [Visual Studio], debugging
- Thread.Name property
- debugger, Threads window
- SetThreadName function
- Threads window
- '@TIB'
- debugging [Visual Studio], threads
ms.assetid: adfbe002-3d7b-42a9-b42a-5ac0903dfc25
caps.latest.revision: 48
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: da41524fcb231ea399dbbd2a2904afd935e5c4f8
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "67824247"
---
# <a name="how-to-use-the-threads-window"></a>Практическое руководство. Использование окна потоков
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

В окне **потоки** можно проверять потоки в приложении, которые вы выполняете отладку, и работать с ними.  
  
 Окно **потоки** содержит таблицу, в которой каждая строка представляет поток в приложении. По умолчанию в таблице перечисляются все потоки приложения, но можно фильтровать этот список, чтобы в нем показывались только нужные потоки. В каждом столбце содержится свой тип сведений. Можно также скрывать некоторые столбцы. Если отображаются все столбцы, то в них имеются следующие сведения (слева направо):  
  
- Столбец флагов, где можно пометить поток, которому планируется уделить особое внимание. Сведения о том, как пометить поток, см. [в разделе Практические руководства. флаги и снятие флагов для потоков](../debugger/how-to-flag-and-unflag-threads.md).  
  
- Столбец активных потоков, в котором желтая стрелка указывает активный поток. Контур стрелки указывает поток, где выполнение было передано в отладчик.  
  
- Столбец **ID** , который содержит идентификационный номер для каждого потока.  
  
- Столбец **управляемого идентификатора** , который содержит управляемые идентификационные номера для управляемых потоков.  
  
- Столбец **Category** , который распределяет потоки по категориям в виде потоков пользовательского интерфейса, обработчиков вызовов удаленных процедур или рабочих потоков. Особая категория идентифицирует главный поток приложения.  
  
- Столбец **имени** , который определяет каждый поток по имени, если он имеет одно значение или \<No Name> .  
  
- Столбец **Location (расположение** ), в котором отображается место выполнения потока. Можно развернуть это расположение, чтобы отобразить полный стек вызова для потока.  
  
- Столбец **приоритет** , который содержит приоритет или приоритет, назначенный системе каждому потоку.  
  
- Столбец **affinity mask** , который является расширенным столбцом, который обычно скрыт. В этом столбце показывается маска сходства процессора для каждого потока. В многопроцессорной системе маска сходства определяет, какой процессор в каком потоке может работать.  
  
- Столбец **приостановленных счетчиков** , содержащий счетчик приостановок. Этот счетчик определяет, может ли поток выполняться. Описание счетчика приостановок см. в разделе "Замораживание и размораживание потоков" далее в этой теме.  
  
- Столбец **имя процесса** , содержащий процесс, которому принадлежит каждый поток. Этот столбец может быть полезен при отладке нескольких процессов, но обычно он скрыт.  
  
### <a name="to-display-the-threads-window-in-break-mode-or-run-mode"></a>Открытие окна потоков в режиме приостановки или в режиме выполнения  
  
- В меню **Отладка** укажите пункт **окна**, а затем выберите пункт **потоки**.  
  
### <a name="to-display-or-hide-a-column"></a>Отображение или скрытие столбца  
  
- На панели инструментов в верхней части окна **потоки** щелкните **столбцы**, а затем выберите или очистите имя столбца, который требуется отобразить или скрыть.  
  
### <a name="to-switch-the-active-thread"></a>Переключение активного потока  
  
- Выполните одно из следующих действий.  
  
  - Дважды щелкните любой поток.  

  - Щелкните поток правой кнопкой мыши и выберите команду **переключиться на поток**.  

    Рядом с новым активным потоком появится желтая стрелка. Серый контур стрелки указывает поток, где выполнение было передано в отладчик.  
  
## <a name="grouping-and-sorting-threads"></a>Группирование и сортировка потоков  
 При группировании потоков в таблице появляется заголовок для каждой группы. В заголовке содержится описание группы, например "Рабочие потоки" или "Непомеченные потоки", и элемент управления "Дерево". Потоки-элементы каждой группы отображаются под заголовком группы. Если требуется скрыть потоки-элементы в какой-либо группе, можно свернуть эту группу с помощью элемента управления "Дерево".  
  
 Поскольку группирование имеет приоритет перед сортировкой, можно, например, группировать потоки по категориям, а затем по идентификаторам внутри каждой категории.  
  
#### <a name="to-sort-threads"></a>Сортировка потоков  
  
1. На панели инструментов в верхней части окна **потоки** нажмите кнопку в верхней части любого столбца.  
  
     Теперь потоки отсортированы по значениям в этом столбце.  
  
2. Если требуется изменить порядок сортировки, нажмите кнопку же еще раз.  
  
     Потоки, которые отображались вверху списка, теперь отображаются внизу.  
  
#### <a name="to-group-threads"></a>Группирование потоков  
  
- На панели инструментов окна **потоков** щелкните список **Группировать по** , а затем выберите критерий, по которому нужно сгруппировать потоки.  
  
#### <a name="to-sort-threads-within-groups"></a>Сортировка потоков в группах  
  
1. На панели инструментов в верхней части окна **потоки** щелкните список **Группировать по** , а затем щелкните критерий, по которому необходимо сгруппировать потоки.  
  
2. В окне **потоки** нажмите кнопку в верхней части любого столбца.  
  
     Теперь потоки отсортированы по значениям в этом столбце.  
  
#### <a name="to-expand-or-collapse-all-groups"></a>Сворачивание и разворачивание всех групп  
  
- На панели инструментов в верхней части окна **потоки** щелкните **Развернуть группы** или **Свернуть группы**.  
  
## <a name="searching-for-specific-threads"></a>Поиск конкретных потоков  
 В [!INCLUDE[vs_dev11_long](../includes/vs-dev11-long-md.md)] можно искать потоки, соответствующие указанной строке. При поиске потоков в окне **потоки** в окне отображаются все потоки, соответствующие строке поиска в любом столбце. Эти сведения включают расположение потока, которое отображается в верхней части стека вызовов в столбце **Расположение** . Однако по умолчанию поиск во всем стеке вызова не выполняется.  
  
#### <a name="to-search-for-specific-threads"></a>Поиск конкретных потоков  
  
- В панели инструментов, находящейся в верхней части окна **Потоки**, перейдите в поле **Поиск** и выполните одно из следующих действий:  
  
  - введите строку поиска и нажмите клавишу ВВОД;  

    \- или -  

  - Щелкните раскрывающийся список рядом с полем **поиска** и выберите строку поиска из предыдущего поиска.  
  
- Чтобы включить в поиск полный стек вызова, выберите **Поиск в стеке вызова** (необязательно).  
  
## <a name="freezing-and-thawing-threads"></a>Замораживание и размораживание потоков  
 Если поток заморожен, то система не начнет его выполнение, даже если будут доступны все ресурсы.  
  
 В машинном коде можно приостанавливать или возобновлять потоки путем вызова функций Windows `SuspendThread` и `ResumeThread` или функций MFC для класса [CWinThread:: суспендсреад](https://msdn.microsoft.com/library/57189c7e-fd71-42e5-bc4b-3de7cd373d28) и [CWinThread:: ресумесреад](https://msdn.microsoft.com/library/d6f97a2f-5c9f-4ee1-b978-d74938784db5). При вызове `SuspendThread` или `ResumeThread` вы изменяете *счетчик приостановок*, который отображается в окне **потоки** . Однако замораживание или размораживание собственного потока не приводит к изменению счетчика приостановок. В машинном коде поток не может выполняться, если он является размороженным и имеет счетчик приостановок, равный нулю.  
  
 В управляемом коде замораживание или размораживание потока приводит к изменению счетчика приостановок. В управляемом коде замороженный поток имеет счетчик приостановок со значением 1. В машинном коде замороженный поток имеет счетчик приостановок со значением 0 до тех пор, пока этот поток не будет приостановлен путем вызова `SuspendThread`.  
  
> [!NOTE]
> При отладке вызова управляемого кода из машинного кода управляемый код выполняется в том же физическом потоке, что и вызывающий его машинный код. Приостановка выполнения или замораживание присущего данному объекту кода приводит также к замораживанию управляемого кода.  
  
#### <a name="to-freeze-or-thaw-execution-of-a-thread"></a>Заморозка и разморозка выполнения потока  
  
- На панели инструментов в верхней части окна **потоки** щелкните **заморозить потоки** или **разморозить потоки**.  
  
     Это действие влияет только на потоки, выбранные в окне **Потоки**.  
  
## <a name="displaying-flagged-threads"></a>Отображение помеченных потоков  
 Поток, которому планируется уделить особое внимание, можно пометить, поставив рядом с ним значок в окне **Потоки**. Дополнительные сведения см. [в разделе Практические руководства. флаги и снятие флагов для потоков](../debugger/how-to-flag-and-unflag-threads.md). В окне "Потоки" можно выбрать отображение всех потоков или только помеченных потоков.  
  
#### <a name="to-display-only-flagged-threads"></a>Отображение только помеченных потоков  
  
- Нажмите кнопку Flag (флаг) в левом верхнем углу окна **потоки** .  
  
## <a name="displaying-thread-call-stacks-and-switching-between-frames"></a>Отображение стека вызовов потоков и переключение между фреймами  
 В многопотоковых программах каждый поток имеет свой собственный стек вызовов. Окно **Потоки** обеспечивает удобный способ просмотра этих стеков.  
  
#### <a name="to-view-the-call-stack-of-a-thread"></a>Просмотр стека вызовов потока  
  
- В столбце **Расположение** щелкните инвертированный треугольник рядом с расположением потока.  
  
     Расположение будет развернуто, и будет отображен стек вызова для потока.  
  
#### <a name="to-view-or-collapse-the-call-stacks-of-all-threads"></a>Просмотр и сворачивание стеков вызовов всех потоков  
  
- На панели инструментов в верхней части окна **потоки** щелкните **развернуть стеки вызовов** или **Свернуть стеки вызовов**.  
  
## <a name="see-also"></a>См. также:  
 [Отладка многопоточных приложений](../debugger/debug-multithreaded-applications-in-visual-studio.md)   
 [Пошаговое руководство. Отладка многопоточных приложений](../debugger/walkthrough-debugging-a-multithreaded-application.md)
