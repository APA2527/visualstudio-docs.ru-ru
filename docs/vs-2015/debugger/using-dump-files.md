---
title: Использование файлов дампа | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.debug.crashdump
dev_langs:
- FSharp
- VB
- CSharp
- C++
- JScript
- VB
- CSharp
- C++
helpviewer_keywords:
- dumps, about dumps
- crash dumps
- dump files
- dumps
ms.assetid: b71be6dc-57e0-4730-99d2-b540a0863e49
caps.latest.revision: 56
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 1a2d6215887512f2e0c1410688b2bc924dc1fe3a
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "86387061"
---
# <a name="using-dump-files"></a>Использование файлов дампа
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Файлы дампа с кучами или без куч; создание файла дампа; открытие файла дампа; поиск двоичных файлов, PDB-файлов и исходных файлов для файла дампа. 
  
## <a name="contents"></a><a name="BKMK_Contents"></a> Описание  
 [Что такое файл дампа?](#BKMK_What_is_a_dump_file_)  
  
 [Файлы дампа с кучами или без них](#BKMK_Dump_files__with_or_without_heaps)  
  
 [Требования и ограничения](#BKMK_Requirements_and_limitations)  
  
 [Создание файла дампа](#BKMK_Create_a_dump_file)  
  
 [Открытие файла дампа](#BKMK_Open_a_dump_file)  
  
 [Поиск двоичных файлов, файлов символов (.pdb) и исходных файлов](#BKMK_Find_binaries__symbol___pdb__files__and_source_files)  
  
## <a name="what-is-a-dump-file"></a><a name="BKMK_What_is_a_dump_file_"></a> Что такое файл дампа?  
 *Файл дампа* — это моментальный снимок приложения на момент создания дампа. Он показывает, какой процесс исполнялся и какие модули были загружены в момент создания дампа. Если дамп был сохранен с данными кучи, файл дампа содержит снимок того, что находилось в памяти приложения в тот момент времени. Открытие файла дампа с кучей в Visual Studio похоже на остановку в точке останова в сеансе отладки. Хотя выполнение продолжить невозможно, можно просмотреть стеки, потоки и значения переменных приложения, соответствующие моменту времени создания дампа.  
  
 Дампы в основном используются для отладки в тех случаях, когда у разработчика нет доступа к компьютерам, на которых возникли проблемы. Например, файл дампа можно использовать на компьютере клиента, если не удается воспроизвести программу, которая не отвечает на работу клиента или на компьютере. Кроме того, дампы создаются тестерами для сохранения незавершенных или не реагирующих данных программы, поэтому тестовый компьютер можно использовать для большего тестирования. Отладчик Visual Studio может сохранять файлы дампа для управляемого и машинного кода. Отладчик может загружать файлы дампа, созданные Visual Studio или другими программами, которые сохраняют файлы в формате *минидампа* .  
  
 ![В начало](../debugger/media/pcs-backtotop.png "PCS_BackToTop") [Содержимое](#BKMK_Contents)  
  
## <a name="dump-files-with-or-without-heaps"></a><a name="BKMK_Dump_files__with_or_without_heaps"></a> Файлы дампа с кучами или без них  
 Можно создавать файлы дампа со сведениями кучи или без них.  
  
- **Файлы дампа с кучами** содержат моментальный снимок памяти приложения. Сюда входят значения переменных в момент создания дампа. После загрузки файла дампа, сохраненного с кучей, Visual Studio может загружать символы, даже если двоичный файл приложения не найден. Visual Studio также сохраняет в файле дампа двоичные файлы загруженных модулей машинного кода, что может значительно упростить отладку.  
  
- **Файлы дампа без куч** значительно меньше, чем дампы со сведениями о куче. Однако в этом случае для поиска сведений о символах отладчик должен загружать двоичные файлы приложения. Двоичные файлы должны в точности соответствовать двоичным файлам, которые использовались при создании дампа. В файлах дампа без данных кучи хранятся только значения переменных стека.  
  
  ![В начало](../debugger/media/pcs-backtotop.png "PCS_BackToTop") [Содержимое](#BKMK_Contents)  
  
## <a name="requirements-and-limitations"></a><a name="BKMK_Requirements_and_limitations"></a> Требования и ограничения  
  
- Отладка с использованием файлов дампа оптимизированного кода может сопровождаться ложной информацией. К примеру, встраивание компилятором функций может приводить к непредвиденным стекам вызовов, а другие виды оптимизации могут изменять время существования переменных.  
  
- Отладка с использованием файла дампа, созданного на 64-разрядном компьютере, должна производиться в экземпляре Visual Studio, работающем на 64-разрядном компьютере.  
  
- В версиях Visual Studio до VS 2013 невозможно открыть дампы 32-разрядных приложений, выполняющихся на 64-разрядных компьютерах, которые были собраны определенными средствами (например, диспетчером задач и 64-разрядной версией WinDbg). В VS 2013 это ограничение снято.  
  
- Visual Studio поддерживает отладку файлов дампа, создаваемых приложениями в машинных кодах на устройствах ARM. Visual Studio также поддерживает отладку файлов дампа, создаваемых управляемыми приложениями на устройствах ARM, но только в отладчике машинного кода.  
  
- Чтобы выполнить отладку файлов дампа [режима ядра](https://msdn.microsoft.com/library/windows/hardware/ff551880.aspx) в Visual Studio 2013, скачайте [Windows 8.1 версию средств отладки для Windows](https://msdn.microsoft.com/windows/hardware/gg463009). См. раздел [Отладка ядра в Visual Studio](https://msdn.microsoft.com/library/windows/hardware/jj149675.aspx).  
  
- Visual Studio не может выполнять отладку файлов дампа, сохраненных в старом формате дампа, известном как [полный дамп пользовательского режима](/windows-hardware/drivers/debugger/user-mode-dump-files#full). Обратите внимание, что "полный дамп в режиме пользователя" и "дамп с кучей" — это не одно и то же.  
  
- Для отладки с [SOS.dll (расширение отладки SOS)](https://msdn.microsoft.com/library/9ac1b522-77ab-4cdc-852a-20fcdc9ae498) в Visual Studio необходимо установить средства отладки для Windows, которые входят в комплект драйверов Windows (WDK). См. раздел [Предварительная версия Windows 8.1: Download Kit, BITS и Tools](https://msdn.microsoft.com/library/windows/hardware/bg127147.aspx).  
  
  ![В начало](../debugger/media/pcs-backtotop.png "PCS_BackToTop") [Содержимое](#BKMK_Contents)  
  
## <a name="create-a-dump-file"></a><a name="BKMK_Create_a_dump_file"></a> Создание файла дампа  
 Создание файла дампа с использованием Visual Studio:  
  
- При отладке процесса в Visual Studio можно сохранить файл дампа, когда отладчик останавливает выполнение в точке останова или при возникновении исключения. Выберите **сохранить дамп как**, **Отладка**. В диалоговом окне **Сохранение дампа как** в списке **Тип файла** можно выбрать **Малый дамп** или **Малый дамп с кучей** (по умолчанию).  
  
- При включенной [JIT-отладке](../debugger/just-in-time-debugging-in-visual-studio.md) можно подключить отладчик к аварийному процессу, который выполняется вне отладчика, а затем сохранить файл дампа. См. раздел [Подключение к запущенным процессам](../debugger/attach-to-running-processes-with-the-visual-studio-debugger.md) .  
  
  Файлы дампа также можно создавать с помощью любой программы, которая поддерживает формат минидампов Windows. Например, программа командной строки **ProcDump** из [Windows Sysinternals](https://technet.microsoft.com/sysinternals/default) может создавать файлы аварийного дампа процесса на основе триггеров или по требованию. Дополнительные сведения об использовании других средств для создания файлов дампа см. в разделе [требования и ограничения](../debugger/using-dump-files.md#BKMK_Requirements_and_limitations) этой статьи.  
  
  ![В начало](../debugger/media/pcs-backtotop.png "PCS_BackToTop") [Содержимое](#BKMK_Contents)  
  
## <a name="open-a-dump-file"></a><a name="BKMK_Open_a_dump_file"></a> Открытие файла дампа  
  
1. В Visual Studio выберите **файл**, **Открыть**, **файл**.  
  
2. В диалоговом окне **Открытие файла** найдите и выберите файл дампа. Обычно они имеют расширение DMP. Нажмите кнопку **ОК**.  
  
3. Появится окно **Сводка по файлу дампа** . В этом окне можно просмотреть сведения об отладке для файла дампа, установить путь символов, запустить отладку и скопировать сводку в буфер.  
  
     ![Страница сводки минидампа](../debugger/media/dbg-dump-summarypage.png "DBG_DUMP_SummaryPage")  
  
4. Чтобы начать отладку, перейдите к разделу **действия** и выберите **Отладка только машинный код** или **Отладка с использованием смешанных**.  
  
## <a name="find-binaries-symbol-pdb-files-and-source-files"></a><a name="BKMK_Find_binaries__symbol___pdb__files__and_source_files"></a> Поиск двоичных файлов, файл символов (PDB) и исходные файлы  
 Чтобы можно было использовать все возможности Visual Studio для отладки файла дампа, необходимо иметь доступ к следующим файлам:  
  
- EXE-файл, для которого был получен дамп, и другие двоичные файлы (DLL и т. п.), которые использовались в процессе, для которого был создан дамп.  
  
   Если для отладки используется дамп с данными кучи, Visual Studio может справиться с отсутствием двоичных файлов для некоторых модулей, но должен иметь двоичные файлы для достаточного количества модулей, чтобы создавать допустимые стеки вызовов. Visual Studio включает модули машинного кода в файл дампа с кучей.  
  
- Файлы символов (.pdb) для EXE-файлов и других двоичных файлов.  
  
- Исходные файлы для нужных модулей.  
  
   Исполняемый файл и PDB-файлы должны точно соответствовать версии и сборке файлов, которые использовались при создании дампа.  
  
   Если не удается найти исходные файлы, для отладки можно использовать дизассемблированный код модулей.  
  
  **Пути поиска по умолчанию для исполняемых файлов**  
  
  Visual Studio автоматически ищет исполняемые файлы, не включенные в файл дампа, в следующих расположениях:  
  
1. Каталог, содержащий файл дампа.  
  
2. Путь к модулю, указанный в файле дампа. Это путь к модулю на компьютере, на котором был создан дамп.  
  
3. Пути к символам, заданные на странице **Отладка**, **Параметры**, **символы** диалогового окна **Параметры** **Visual Studio.** При необходимости на этой странице можно добавить другие расположения для поиска.  
  
   **Использование страниц "Двоичные файлы не найдены" / "Символы не найдены" / "Исходный код не найден"**  
  
   Если Visual Studio не удается найти файлы, необходимые для отладки модуля в дампе, отображается соответствующая страница (**двоичный файл не найден**, **символы не найдены**или **источник не найден**). Эти страницы предоставляют подробные сведения о причине проблемы, а также ссылки на действия, которые могут помочь определить правильное расположение файлов. См. раздел [Указание символов (. pdb) и исходных файлов](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md).  
  
   ![В начало](../debugger/media/pcs-backtotop.png "PCS_BackToTop") [Содержимое](#BKMK_Contents)  
  
## <a name="see-also"></a>См. также:  
 [JIT-отладка](../debugger/just-in-time-debugging-in-visual-studio.md)   
 [Указание символов (. pdb) и исходных файлов](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md)   
 [IntelliTrace](../debugger/intellitrace.md)
