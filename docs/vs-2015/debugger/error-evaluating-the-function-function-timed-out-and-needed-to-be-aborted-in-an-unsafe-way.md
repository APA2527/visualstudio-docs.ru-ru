---
title: 'Ошибка: Истекло время ожидания при вычислении функции &#39;функция&#39;, поэтому его требуется завершить небезопасным образом | Документация Майкрософт'
ms.date: 11/15/2016
ms.topic: reference
f1_keywords:
- vs.debug.error.unsafe_func_eval_abort
ms.assetid: 0a9f70ed-21ad-4a10-8535-b9c5885ad8f4
caps.latest.revision: 9
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: a27bf67770eef770fddef0301a804e6c45579539
ms.sourcegitcommit: a77158415da04e9bb8b33c332f6cca8f14c08f8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2020
ms.locfileid: "86387126"
---
# <a name="error-evaluating-the-function-39function39-timed-out-and-needed-to-be-aborted-in-an-unsafe-way"></a>Ошибка: Истекло время ожидания при вычислении функции &#39;функция&#39;, поэтому его требуется завершить небезопасным образом
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Полный текст сообщения: Истекло время ожидания при вычислении функции "функция", поэтому его требуется завершить небезопасным образом. Это могло привести к повреждению целевого процесса. 

Чтобы упростить проверку состояния для объектов .NET, отладчик автоматически выполняет дополнительный код в отлаживаемом процессе (обычно это методы получения свойств и функции ToString). В большинстве случаев эти функции выполняются быстро и значительно упрощают отладку. Однако отладчик не запускает приложение в песочнице. В результате метод считывания или ToString, который вызывает собственную функцию, которая перестает отвечать, может привести к долгому времени ожидания, которое не может быть восстановлено. Если вы увидите указанное выше сообщение об ошибке, значит, возникла именно такая ситуация.
 
Одна из распространенных причин возникновения этой проблемы связана с тем, что когда отладчик вычисляет свойство, он разрешает выполнение только проверяемого потока. Таким образом, если свойство ожидает выполнения других потоков в отлаживаемом приложении и ожидает, что среда выполнения .NET не может прерывать работу, эта проблема возникает.
 
## <a name="to-correct-this-error"></a>Исправление ошибки
 
Существует три возможных решения этой проблемы.
 
### <a name="solution-1-prevent-the-debugger-from-calling-the-getter-property-or-tostring-method"></a>Решение 1. Запрет вызова метода получения свойств или метода ToString в отладчике
 
В сообщении об ошибке будет указано имя функции, которую отладчик пытался вызвать. Если вы можете изменить эту функцию, запретите отладчику вызывать метод получения свойств или метод ToString. Выполните одно из указанных ниже действий.
 
* Укажите в методе любой другой тип кода, кроме метода получения свойств и метода ToString, и проблема исчезнет.
    -или-
* (Для ToString) Определите для типа атрибут DebuggerDisplay, чтобы отладчик мог вычислить другое значение, кроме ToString.
    -или-
* (Для метода получения свойства) Установите для свойства атрибут `[System.Diagnostics.DebuggerBrowsable(DebuggerBrowsableState.Never)]`. Это может быть полезно, если какой-то из ваших методов должен оставаться свойством для обеспечения совместимости с API, хотя по сути является настоящим методом.
 
### <a name="solution-2-have-the-target-code-ask-the-debugger-to-abort-the-evaluation"></a>Решение 2. Запрос на прерывание вычисления отладчиком в целевом коде
 
В сообщении об ошибке будет указано имя функции, которую отладчик пытался вызвать. Если метод получения свойств или метод ToString иногда не выполняется правильно, особенно когда причина в том, что код требует выполнения другого потока, функция реализации может вызвать `System.Diagnostics.Debugger.NotifyOfCrossThreadDependency`, чтобы запросить прерывание вычисления функции отладчиком. При использовании этого решения можно по-прежнему явно вычислять функции, но по умолчанию при вызове NotifyOfCrossThreadDependency выполнение останавливается.
 
### <a name="solution-3-disable-all-implicit-evaluation"></a>Решение 3. Отключение всех неявных вычислений
 
Если ни одно из предыдущих решений не устраняет проблему, перейдите в раздел *Средства* / *Параметры* и снимите флажок *Отладка* / *Общие* / *Включить вычисление свойства и другие неявные вызовы функций*. Это отключит большинство неявных вычислений функций, что должно устранить проблему.
