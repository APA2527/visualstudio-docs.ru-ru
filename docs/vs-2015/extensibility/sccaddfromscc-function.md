---
title: Функция Сккаддфромскк | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: reference
f1_keywords:
- SccAddFromScc
helpviewer_keywords:
- SccAddFromScc function
ms.assetid: 902e764d-200e-46e1-8c42-4da7b037f9a0
caps.latest.revision: 18
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: ccf3a25bda14cf98fdba4a58b0032444badc4c4a
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "90842984"
---
# <a name="sccaddfromscc-function"></a>Функция SccAddFromScc
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Эта функция позволяет пользователю просматривать файлы, уже находящиеся в системе управления версиями, и затем делать эти файлы частью текущего проекта. Например, эта функция может получить общий файл заголовка в текущем проекте без копирования файла. Возвращаемый массив файлов `lplpFileNames` содержит список файлов, которые пользователь хочет добавить в проект интегрированной среды разработки.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp#  
SCCRTN SccAddFromScc (  
   LPVOID   pvContext,  
   HWND     hWnd,  
   LPLONG   lpnFiles,  
   LPCSTR** lplpFileNames  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 пвконтекст  
 окне Структура контекста подключаемого модуля системы управления версиями.  
  
 hWnd  
 окне Обработчик окна интегрированной среды разработки, который может использоваться подключаемым модулем системы управления версиями в качестве родительского для любых предоставляемых им диалоговых окон.  
  
 лпнфилес  
 [вход, выход] Буфер для числа файлов, которые добавляются в. (Это происходит, `NULL` Если память, на которую указывает, будет `lplpFileNames` освобождена. Дополнительные сведения см. в разделе Примечания.)  
  
 лплпфиленамес  
 [вход, выход] Массив указателей на все имена файлов без путей к каталогу. Этот массив выделяется и освобождается подключаемым модулем системы управления версиями. Если `lpnFiles` = 1 и не `lplpFileNames` является `NULL` , первое имя в массиве, на которое указывает, `lplpFileNames` содержит целевую папку.  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:  
  
|Значение|Description|  
|-----------|-----------------|  
|SCC_OK|Файлы успешно найдены и добавлены в проект.|  
|SCC_I_OPERATIONCANCELED|Операция была отменена без влияния.|  
|SCC_I_RELOADFILE|Необходимо перезагрузить файл или проект.|  
  
## <a name="remarks"></a>Remarks  
 Интегрированная среда разработки вызывает эту функцию. Если подключаемый модуль системы управления версиями поддерживает указание локальной папки назначения, среда IDE передает значение `lpnFiles` 1 и передает имя локальной папки в `lplpFileNames` .  
  
 Когда вызов `SccAddFromScc` функции возвращает, подключаемый модуль присваивает значения `lpnFiles` и `lplpFileNames` , при необходимости выделяя память для массива имен файлов (Обратите внимание, что это выделение заменяет указатель в `lplpFileNames` ). Подключаемый модуль системы управления версиями отвечает за помещение всех файлов в каталог пользователя или в указанную папку-обозначение. Затем интегрированная среда разработки добавляет файлы в проект интегрированной среды разработки.  
  
 Наконец, интегрированная среда разработки вызывает эту функцию второй раз, передавая `NULL` для `lpnFiles` . Это интерпретируется как Специальный сигнал от подключаемого модуля системы управления версиями для освобождения памяти, выделенной для массива имен файлов в `lplpFileNames``.`  
  
 `lplpFileNames` является `char ***` указателем. Подключаемый модуль системы управления версиями помещает указатель на массив указателей на имена файлов, таким образом передавая список стандартным способом для этого API.  
  
> [!NOTE]
> В первоначальных версиях API ВССЦИ не предусмотрен способ указания целевого проекта для добавленных файлов. Для этого семантика `lplpFIleNames` параметра была улучшена, чтобы сделать его параметром in/out, а не выходным параметром. Если указан только один файл, то есть значение, на которое указывает `lpnFiles` = 1, первый элемент `lplpFileNames` содержит целевую папку. Чтобы использовать эту новую семантику, интегрированная среда разработки вызывает `SccSetOption` функцию с `nOption` параметром, для которого задано значение `SCC_OPT_SHARESUBPROJ` . Если подключаемый модуль системы управления версиями не поддерживает семантику, возвращается значение `SCC_E_OPTNOTSUPPORTED` . Это отключает использование функции **добавления из системы управления версиями** . Если подключаемый модуль поддерживает функцию **добавления из системы управления версиями** ( `SCC_CAP_ADDFROMSCC` ), то он должен поддерживать новую семантику и возвращать `SCC_I_SHARESUBPROJOK` .  
  
## <a name="see-also"></a>См. также:  
 [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)   
 [SccSetOption](../extensibility/sccsetoption-function.md)
