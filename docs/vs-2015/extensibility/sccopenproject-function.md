---
title: Функция SccOpenProject | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: reference
f1_keywords:
- SccOpenProject
helpviewer_keywords:
- SccOpenProject function
ms.assetid: d609510b-660a-46d7-b93d-2406df20434d
caps.latest.revision: 17
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: af2b33d31d813533d833e4a5c15a3b562bc2e94e
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63446798"
---
# <a name="sccopenproject-function"></a>Функция SccOpenProject
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Эта функция открывает существующий проект элемента управления источника или создает новую.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp#  
SCCRTN SccOpenProject (  
   LPVOID        pvContext,  
   HWND          hWnd,  
   LPSTR         lpUser,  
   LPCSTR        lpProjName,  
   LPCSTR        lpLocalProjPath,  
   LPSTR         lpAuxProjPath,  
   LPCSTR        lpComment,  
   LPTEXTOUTPROC lpTextOutProc,  
   LONG          dwFlags  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Структура подключаемого модуля контекста исходного элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для любой диалоговых окон, которые он предоставляет.  
  
 lpUser  
 [in, out] Имя пользователя (не превышая ресурсов SCC_USER_SIZE, включая символ конца строки NULL).  
  
 lpProjName  
 [in] Строка, определяющая имя проекта.  
  
 lpLocalProjPath  
 [in] Путь рабочей папки для проекта.  
  
 lpAuxProjPath  
 [in, out] Необязательный дополнительный строка, определяющая проекта (не превышая ресурсов SCC_AUXPATH_SIZE, включая символ конца строки NULL).  
  
 lpComment  
 [in] Комментарий в новый проект, который создается.  
  
 lpTextOutProc  
 [in] Необязательная функция обратного вызова для отображения текста в выходных данных из подключаемого модуля системы управления версиями.  
  
 dwFlags  
 [in] Сигналы ли новый проект должен быть создан, если проект является неизвестным источником элемент управления подключаемого модуля. Значение может представлять собой сочетание `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN.`  
  
## <a name="return-value"></a>Возвращаемое значение  
 Подключаемый модуль реализации элемента управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|-----------|-----------------|  
|SCC_OK|Успех при открытии проекта.|  
|SCC_E_INITIALIZEFAILED|Не удалось инициализировать проект.|  
|SCC_E_INVALIDUSER|Пользователю не удалось войти в систему управления версиями.|  
|SCC_E_COULDNOTCREATEPROJECT|Проект не существовала до вызова метода;  `SCC_OPT_CREATEIFNEW` был установлен флаг, но не удалось создать проект.|  
|SCC_E_PROJSYNTAXERR|Синтаксис недопустимый проект.|  
|SCC_E_UNKNOWNPROJECT|Проект, неизвестен подключаемого модуля системы управления версиями и `SCC_OPT_CREATEIFNEW` не был установлен флаг.|  
|SCC_E_INVALIDFILEPATH|Путь к файлу недопустим или непригодным для использования.|  
|SCC_E_NOTAUTHORIZED|Пользователю запрещено для этой операции.|  
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления версиями, возможно, из-за проблемы с сетью или конфликтов. Рекомендуется повторить операцию.|  
|SCC_E_NONSPECFICERROR|Обнаружена неспецифическая ошибка; Система управления версиями не инициализирован.|  
  
## <a name="remarks"></a>Примечания  
 Интегрированная среда разработки может передать имя пользователя (`lpUser`), или он может просто передать указатель на пустую строку. Если имя пользователя, подключаемый модуль системы управления версиями следует использовать по умолчанию. Тем не менее, если имя не было передано, или произошел сбой при входе с заданным именем, подключаемый модуль должен запросить пользователя выполнить вход и возвращает допустимое имя в `lpUser` при получении действительного имени входа`.` так как подключаемый модуль может изменяться строки имени пользователя , IDE выделит всегда буфер размером (`SCC_USER_LEN`+ 1 или SCC_USER_SIZE, который включает свободное место для завершающего).  
  
> [!NOTE]
> Первое действие интегрированной среды разработки, которые могут потребоваться для выполнения может иметь явный вызов в `SccOpenProject` функции или [SccGetProjPath](../extensibility/sccgetprojpath-function.md). По этой причине у них совпадают `lpUser` параметра.  
  
 `lpAuxProjPath` и`lpProjName` считываются из файла решения, или они возвращаются из вызова `SccGetProjPath` функции. Эти параметры содержат строки, которые подключаемый модуль системы управления версиями связывает с проектом и имеют смысл только в подключаемый модуль. Если не такие строки в файле решения и пользователь не получил запрос для просмотра (вернет строку через `SccGetProjPath` функции), интегрированной среды разработки передает пустые строки для обоих `lpAuxProjPath` и `lpProjName`и ожидает, что эти значения, чтобы обновить Если подключаемый модуль возвращает эта функция.  
  
 `lpTextOutProc` является указателем на функцию обратного вызова, предоставляемые интегрированной среды разработки в систему управления версиями, подключаемый модуль в целях отображения выходных данных команды результат. Эта функция обратного вызова описан подробно [LPTEXTOUTPROC](../extensibility/lptextoutproc.md).  
  
> [!NOTE]
> Если подключаемый модуль системы управления версиями собирается воспользоваться этой, его необходимо установить `SCC_CAP_TEXTOUT` флаг в [SccInitialize](../extensibility/sccinitialize-function.md). Если этот флаг не был задан или если интегрированной среды разработки не поддерживает эту функцию `lpTextOutProc` будет `NULL`.  
  
 `dwFlags` Параметр контролирует результат в случае недоступности открываемого проекта не существует. Он состоит из двух битовые флаги, `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN`. Если проект открывается уже существует, функция просто открывает проект и возвращает `SCC_OK`. Если проект не существует и если `SCC_OP_CREATEIFNEW` флаг установлен, подключаемый модуль системы управления версиями можно создать проект в системе управления версиями, откройте его и возвращать `SCC_OK`. Если проект не существует и если `SCC_OP_CREATEIFNEW` флаг имеет значение off, подключаемый модуль должен затем проверьте наличие `SCC_OP_SILENTOPEN` флаг. Если этот флаг снят, подключаемый модуль может запросить у пользователя для имени проекта. Если этот флаг установлен в, подключаемый модуль должен просто возвращать `SCC_E_UNKNOWNPROJECT`.  
  
## <a name="calling-order"></a>Порядка вызовов  
 Во время обычной событий [SccInitialize](../extensibility/sccinitialize-function.md) будет называться сначала открыть сеанс управления источника. Сеанс может состоять из вызова `SccOpenProject`, следуют другие вызовы функций API подключаемых модулей управления источника и будет завершена с вызова [SccCloseProject](../extensibility/scccloseproject-function.md). Такие сеансы могут повторяться несколько раз, прежде чем [SccUninitialize](../extensibility/sccuninitialize-function.md) вызывается.  
  
 Если наборы подключаемого модуля управления версиями `SCC_CAP_REENTRANT` бит в `SccInitialize`, а затем приведенную выше последовательность сеанса может повторяться много раз в параллельном режиме. Различные `pvContext` структур отслеживания сеансов, в котором каждый `pvContext` связан с одним открытым проектом одновременно. На основе`pvContext` параметра, подключаемый модуль можно определить, какой проект указывается в любой конкретный вызов. Если бит возможность `SCC_CAP_REENTRANT` не задано, nonreentrant подключаемых модулей системы управления версиями имели ограниченные возможности для работы с несколькими проектами.  
  
> [!NOTE]
> `SCC_CAP_REENTRANT` Бит появилась в версии 1.1 API подключаемого модуля управления источника. Он не задан или учитывается в версии 1.0, и все версии 1.0 источника подключаемые модули управления считаются nonreentrant.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)   
 [SccCloseProject](../extensibility/scccloseproject-function.md)   
 [SccGetProjPath](../extensibility/sccgetprojpath-function.md)   
 [SccInitialize](../extensibility/sccinitialize-function.md)   
 [SccUninitialize](../extensibility/sccuninitialize-function.md)   
 [Ограничения длины строки](../extensibility/restrictions-on-string-lengths.md)   
 [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)
