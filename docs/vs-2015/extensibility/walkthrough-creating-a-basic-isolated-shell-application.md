---
title: Пошаговое руководство. Создание базового приложения Isolated Shell | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- Visual Studio shell, walkthroughs
- Shell [Visual Studio], walkthroughs
- walkthroughs [Visual Studio], isolated shell-based application
ms.assetid: 8b12e223-aae3-4c23-813d-ede1125f5f69
caps.latest.revision: 55
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: e92fa99a266dc1d1b537387f3dae848a6ecb285d
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63442284"
---
# <a name="walkthrough-creating-a-basic-isolated-shell-application"></a>Пошаговое руководство. Создание базового приложения изолированной оболочки
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

В этом пошаговом руководстве показано, как создать решение изолированной оболочки, Настройка окна инструментов Справка — о программе и создать программу установки, который устанавливает изолированной оболочки.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для выполнения этого пошагового руководства необходимо установить пакет SDK для Visual Studio. Дополнительные сведения см. в разделе [пакет SDK для Visual Studio](../extensibility/visual-studio-sdk.md). Для развертывания изолированной оболочки, необходимо также использовать распространяемый пакет оболочки Visual Studio (изолированная).  
  
## <a name="creating-an-isolated-shell-solution"></a>Создание решения изолированной оболочки  
 В этом разделе показано, как использовать изолированную оболочку Visual Studio шаблон проекта для создания решения изолированной оболочки. Решение содержит следующие проекты:  
  
- *SolutionName*. AboutBoxPackage проект, который позволяет настраивать внешний вид Справка / "о программе".  
  
- Проект ShellExtensionsVSIX, который содержит файл source.extension.vsixmanifest, который определяет различные компоненты приложения изолированной оболочки.  
  
- *SolutionName* проект, который создает исполняемый файл, который использует приложение изолированной оболочки. Этот проект содержит папку настроек оболочки, которая позволяет настроит звуковое внешнего вида и поведения приложения изолированной оболочки.  
  
- *SolutionName* проект пользовательского интерфейса, который создает вспомогательной сборке, которая определяет активное меню команды и локализуемые строки.  
  
#### <a name="to-create-a-basic-isolated-shell-solution"></a>Чтобы создать решение основных изолированной оболочки  
  
1. Откройте Visual Studio и создайте новый проект.  
  
2. В **новый проект** окне разверните **другие типы проектов** и затем **расширяемости**. Выберите **изолированную оболочку Visual Studio** шаблона проекта.  
  
3. Присвойте проекту имя `MyVSShellStub` и укажите расположение. Убедитесь, что **создать каталог для решения** проверяется и нажмите кнопку **ОК**.  
  
     Новое решение отображается в **обозревателе решений**.  
  
4. Выполните сборку решения и начните отладку приложения изолированной оболочки.  
  
     Изолированная оболочка Visual Studio отображается. Считывает заголовок **MyVSShellStub**. The title bar icon is generated from \MyVSShellStub\Resource Files\ApplicationIcon.ico.  
  
## <a name="customizing-the-application-name-and-icon"></a>Настройка приложения имя и значок  
 Может потребоваться добавление фирменной символики приложения, используя имя вашей компании и логотипа в заголовке окна. Ниже показано, как изменить имя и значок, которые отображаются в строке заголовка пользовательского приложения, изменив файл определения пакета, MyVSShellStub.Application.pkgdef.  
  
#### <a name="to-customize-the-application-name-and-icon"></a>Чтобы настроить имя приложения и значок  
  
1. В проекте MyVSShellStub откройте \Shell Customization\MyVSShellStub.Application.pkgdef.  
  
2. Изменение `AppName` значение элемента для **«AppName» = "Редактор Fabrikam Music»**  
  
3. Чтобы изменить значок приложения, скопируйте в каталог \MyVSShellStub\MyVSShellStub\MyVSShellStub\ другой значок. Переименуйте существующий файл ApplicationIcon.ico в ApplicationIcon1.ico. Переименуйте новый файл в ApplicationIcon.ico.  
  
4. Постройте решение и запустите отладку. Отображается для интегрированной среды разработки изолированной оболочки. В строке заголовка есть новый значок рядом с полем **редактор музыки Fabrikam**.  
  
## <a name="customizing-the-default-web-browser-home-page"></a>По умолчанию Web Домашняя страница браузера настройки  
 В этом разделе показано, как изменение домашней страницы по умолчанию из **веб-браузере** окно, изменив файл определения пакета.  
  
#### <a name="to-customize-the-default-web-browser-home-page"></a>Чтобы настроить домашнюю страницу веб-браузер по умолчанию  
  
1. В файле MyVSShellStub.Application.pkgdef, измените `DefaultHomePage` значение элемента для "<http://www.microsoft.com>«.  
  
2. Перестройте проект MyVSShellStub.  
  
3. Постройте решение и запустите отладку.  
  
4. В **представления / Other Windows**, нажмите кнопку **веб-браузере**. **Веб-браузере** окно отображает домашнюю страницу корпорации Майкрософт.  
  
## <a name="removing-the-print-command"></a>Удаление команды печати  
 Vsct-файл в проекте пользовательского интерфейса изолированной оболочки состоит из набора объявлений формы `<Define name=No_` *элемент*`>`, где *элемент* является одним из стандартных меню Visual Studio и команды.  
  
 Если объявление раскомментируется, этого меню или команды исключается из изолированной оболочки. И наоборот Если объявление закомментирована, меню или команды включается в изолированной оболочки.  
  
 В следующих шагах раскомментируйте печати команды в файл .vsct.  
  
#### <a name="to-remove-the-print-command"></a>Чтобы удалить команду печати  
  
1. Убедитесь, что **печати** отображается команда в **файл** меню в приложении изолированной оболочки.  
  
2. В проекте MyVSShellStubUI откройте \Resource Files\MyVSShellStubUI.vsct для редактирования.  
  
3. Раскомментируйте эту строку:  
  
    ```  
    <!-- <Define name="No_PrintChildrenCommand"/> -->  
    ```  
  
4. Это удаляет команды print.  
  
5. Начните отладку приложения изолированной оболочки. Убедитесь, что **файл / печать** команды отсутствует.  
  
## <a name="removing-features-from-the-isolated-shell"></a>Удаление компонентов из изолированной оболочки  
 Вы можете удалить некоторые из пакетов, загруженных в Visual Studio путем редактирования файла .pkgundef в том случае, если требуется отключить эти функции в приложении пользовательских изолированной оболочки. Укажите пакет, в одном из подразделов раздела реестра $RootKey$ \Packages.  
  
> [!NOTE]
> Функции идентификаторов GUID из Visual Studio, см. в статье [пакет идентификаторов GUID из функции Visual Studio](../extensibility/package-guids-of-visual-studio-features.md).  
  
 Ниже показано, как удалите XML-редактор из изолированной оболочки.  
  
#### <a name="to-remove-the-xml-editor"></a>Чтобы удалить редактора XML  
  
1. Откройте файл MyVSShellStub.pkgundef в папке настроек оболочки MyVSShellStub проекта.  
  
2. Раскомментируйте следующую строку:  
  
     [$RootKey$\Packages\\{87569308-4813-40a0-9cd0-d7a30838ca3f}]  
  
3. Перестройте решение и запустите отладку изолированной оболочки. Откройте XML-файл, например, \MyVSShellStub\MyVSShellStub\MyVSShellStubUI\MyVSShellStubUI.vsct. Убедитесь, что ключевые слова XML в файле не выделяются цветом и что нажатие «<» в строке не активизирует подсказки XML.  
  
## <a name="customizing-the-helpabout-box"></a>Настройка справки / "о программе"  
 Вы можете настроить Справка / "о программе", который создается как часть шаблона проекта изолированной оболочки.  
  
#### <a name="to-customize-the-company-name"></a>Чтобы изменить название компании  
  
1. Название компании, сведения об авторских правах, версия продукта и описание продукта в проекте MyVSShellStub.AboutBoxPackage, находятся в файле \Properties\AssemblyInfo.cs. Откройте этот файл.  
  
2. Изменение `AssemblyCompany` значение **Fabrikam**, `AssemblyProduct` и `AssemblyTitle` значения **редактор музыки Fabrikam**и `AssemblyCopyright` значение **авторское право © Fabrikam 2015**:  
  
    ```  
    [assembly: AssemblyTitle("Fabrikam Music Editor")]  
    [assembly: AssemblyDescription("")]  
    [assembly: AssemblyConfiguration("")]  
    [assembly: AssemblyCompany("Fabrikam")]  
    [assembly: AssemblyProduct("Fabrikam Music Editor")]  
    [assembly: AssemblyCopyright("Copyright © Fabrikam 2015")] [assembly: AssemblyCompany("Fabrikam")]  
    [assembly: AssemblyProduct("Fabrikam Music Editor ")]  
    [assembly: AssemblyCopyright("Copyright © Fabrikam 2015”)]  
    ```  
  
3. Чтобы добавить описание продукта, измените `AssemblyDescription` значение **Описание редактора Fabrikam музыки.**:  
  
    ```  
    [assembly: AssemblyDescription("The description of Fabrikam Music editor.”)]  
    ```  
  
4. Начните отладку и приложения изолированной оболочки, откройте **Справка / о программе** поле. Вы должны увидеть измененные строки. Заголовок справки / "о программе" совпадает со значением `AssemblyTitle` значение в файле AssemblyInfo.cs.  
  
5. Свойства **Справка/о программе** самого поля находятся в файле MyVSShellStub.AboutBoxPackage\AboutBox.xaml. Чтобы изменить ширину справки / "о программе", перейдите к `AboutDialogStyle` блокировать и задайте `Width` свойство до 200:  
  
    ```  
    <Style x:Key="AboutDialogStyle" TargetType="Window">  
        <Setter Property="Height" Value="Auto" />  
        <Setter Property="Width" Value="200" />  
        <Setter Property="ShowInTaskbar" Value="False" />  
        <Setter Property="ResizeMode" Value="NoResize" />  
        <Setter Property="WindowStyle" Value="SingleBorderWindow" />  
        <Setter Property="SizeToContent" Value="Height" />  
    </Style>  
    ```  
  
6. Перестройте решение и запустите отладку изолированной оболочки. Справка / "о программе" должно быть приблизительно square.  
  
## <a name="before-you-deploy-the-isolated-shell-application"></a>Перед развертыванием приложения изолированной оболочки  
 Приложения изолированной оболочки может устанавливаться на любом компьютере с распространяемый пакет оболочки Visual Studio (изолированная). Дополнительные сведения о распространяемого пакета, см. в разделе [загрузки Visual Studio Extensibility](http://go.microsoft.com/fwlink/?LinkID=119298) веб-сайта.  
  
## <a name="deploying-the-isolated-shell-application"></a>Развертывание приложения изолированной оболочки  
 Вы развернете приложение изолированной оболочки с целевым компьютером, создав проект установки. Необходимо указать следующее:  
  
- Макет папки и файлы на конечном компьютере.  
  
- Условия запуска, которые гарантируют, что платформа .NET Framework и Visual Studio оболочки среды выполнения устанавливаются на конечном компьютере.  
  
  В следующей процедуре необходимо будет установить InstallShield Limited Edition на компьютере.  
  
#### <a name="to-create-the-setup-project"></a>Создание проекта установки  
  
1. В **обозревателе решений**, щелкните правой кнопкой мыши узел решения и нажмите кнопку **Добавление нового проекта**.  
  
2. В **новый проект** диалогового окна разверните узел **другие типы проектов** , а затем выберите **установки и развертывания**. Выберите шаблон, InstallShield. Назовите новый проект `MySetup` и нажмите кнопку **ОК**.  
  
3. Если InstallShield Limited Edition уже установлен, перейдите к следующему шагу.  
  
    Если не InstallShield Limited Edition уже установлен, появится на странице загрузки InstallShield. Следуйте инструкциям, чтобы загрузить и установить продукт, выбрав версию InstallShield, которая совместима с версией Visual Studio. Необходимо решить, следует зарегистрировать установки InstallShield или использовать его в качестве оценки. После завершения установки необходимо перезапустить Visual Studio.  
  
   > [!IMPORTANT]
   > Перед созданием проекта InstallShield, необходимо запустить Visual Studio с правами администратора. Если этого не сделать, вы получите ошибку при сборке проекта.  
  
   Далее показано, как настроить проект установки.  
  
> [!IMPORTANT]
> Убедитесь, что вы создали конфигурации выпуска проекта изолированной оболочки по крайней мере один раз, прежде чем настраивать проект установки.  
  
#### <a name="to-configure-the-setup-project"></a>Чтобы настроить проект установки  
  
1. В **обозревателе решений**в разделе **MySetup** проекта, выберите **Project Assistant**. В нижнем ряду **Project Assistant** окно, выберите **сведений о приложении**. Введите **Fabrikam** как имя компании и **редактор музыки Fabrikam** в качестве имени приложения. Нажмите стрелку вперед в правом нижнем углу **Project Assistant**.  
  
2. Выберите **Да** под **приложения требуется программное обеспечение для установки на компьютере?** , а затем выберите **полный пакет Microsoft .NET Framework 4.5**.  
  
3. Выберите **файлы приложения** , расположенную в нижней части окна и убедитесь, что **редактор музыки Fabrikam** выбрать папку.  
  
4. Выберите **добавить файлы** кнопки. В **добавить файлы** диалоговое окно, добавьте следующие файлы из **MyVSShellStub\Release** папку:  
  
    1. MyVSShellStub.exe.config  
  
    2. DebuggerProxy.dll  
  
    3. DebuggerProxy.dll.manifest  
  
    4. MyVSShellStub.pkgdef  
  
    5. MyVSShellStub.pkgundef  
  
    6. MyVSShellStub.winprf  
  
    7. Splash.bmp  
  
5. Нажмите кнопку **Добавление выходных элементов проекта** и добавьте **MyVSShellStub-источник выходных данных**. Нажмите кнопку **ОК**.  
  
6. В области слева в разделе **конечный компьютер**, щелкните правой кнопкой мыши **Fabrikam музыки редактор [INSTALLDIR]** узел и добавьте **новую папку** с именем **расширения** .  
  
7. Щелкните правой кнопкой мыши **расширения** узел в области слева и добавьте новую папку с именем **приложения**.  
  
8. Выберите **приложения** папку и нажмите кнопку **Добавление выходных элементов проекта** кнопку, а затем выбрать основные выходные файлы из проекта MyVSShellStub.AboutBoxPackage.  
  
9. Нажмите кнопку **добавить файлы** и из папки \MyVSShellStub\Release\Extensions\Application\ добавьте следующие файлы:  
  
    - MyVSShellStub.AboutBoxPackage.pkgdef  
  
    - MyVSShellStub.Application.pkgdef  
  
10. Щелкните правой кнопкой мыши **Fabrikam музыки редактор [INSTALLDIR]** узел в области слева и добавьте новую папку с именем **1033**.  
  
11. Выберите папку 1033, а затем нажмите кнопку **Добавление выходных элементов проекта** и выберите основные выходные файлы из проекта MyVSShellStubUI.  
  
12. Переместить **ярлыков приложений** окна.  
  
13. Нажмите кнопку **New** создать ярлык и выбрать **\Fabrikam\Fabrikam Music Editor\MyVSShellStub.Primary Output [ProgramFilesFolder]**.  
  
14. Переместить **интервью установки** области.  
  
15. Все элементы **нет**.  
  
16. В **обозревателе решений**, в проекте MySetup, откройте **определить требования к установке и действия \ требования**. **Требования** откроется окно.  
  
17. Щелкните правой кнопкой мыши **требования к программному обеспечению системы** и выберите **Создание нового условия запуска**. **Мастера поиска системы** отображается.  
  
18. В **что вы хотите найти?** панели выберите **запись реестра** в раскрывающемся списке и нажмите кнопку **Далее**.  
  
19. В **как вы хотите искать его?** области выберите **HKEY_LOCAL_MACHINE** как корень реестра. Введите **SOFTWARE\Wow6432Node\Microsoft\DevDiv\vs\Servicing\14.0\isoshell** для 64-разрядных системах или **SOFTWARE\Microsoft\DevDiv\vs\Servicing\14.0\isoshell** для 32-разрядных систем и введите  **Установка** как значение реестра. Нажмите кнопку **Далее**.  
  
20. В **что вы хотите сделать со значением?** области введите **этого продукта требуется Visual Studio 2015 изолированной оболочки распространяемый пакет для установки.** отображаемый текст и нажмите кнопку **Готово**.  
  
21. Перестройте решение изолированной оболочки, чтобы создать проект установки.  
  
     Файл setup.exe можно найти в следующей папке:  
  
     \MyVSShellStub\MySetup\MySetup\Express\SingleImage\DiskImages\DISK1  
  
## <a name="testing-the-installation-program"></a>Тестирование программы установки  
 Для проверки установки, скопируйте файл setup.exe на другой компьютер и запустите исполняемый файл программы установки. Вы сможете запустить приложение изолированной оболочки.
