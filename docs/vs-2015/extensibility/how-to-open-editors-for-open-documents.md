---
title: Руководство. открытие редакторов для открытых документов | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- editors [Visual Studio SDK], opening for open documents
ms.assetid: 1a0fa49c-efa4-4dcc-bdc0-299b7052acdc
caps.latest.revision: 14
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: ae6e565e026ca49825a7b00a82e4e5c62a2f6c3c
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "68204145"
---
# <a name="how-to-open-editors-for-open-documents"></a>Практическое руководство. Открытие редакторов для открытых документов
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Прежде чем открыть окно документа, проект сначала должен определить, открыт ли файл в окне документа для другого редактора. Файл может быть либо открыт в редакторе конкретного проекта, либо одним из стандартных редакторов, зарегистрированных в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] .  
  
## <a name="opening-a-project-specific-editor"></a>Открытие редактора, зависящего от проекта  
 Используйте следующую процедуру, чтобы открыть редактор, зависящий от проекта, для файла, который уже открыт.  
  
#### <a name="to-open-a-project-specific-editor-for-an-open-file"></a>Открытие редактора проекта для открытого файла  
  
1. Вызовите метод <xref:Microsoft.VisualStudio.Shell.Interop.IVsUIShellOpenDocument.IsDocumentOpen%2A> .  
  
    Этот вызов возвращает указатели на иерархию документа, элемент иерархии и рамку окна, если это уместно.  
  
2. Если документ открыт, проект должен проверить, существует ли только объект данных документа, или если присутствует также объект представления документов.  
  
   - Если объект представления документов существует и это представление предназначено для другой иерархии или элемента иерархии, то в проекте используется указатель на фрейм окна представления, чтобы изменить поверхность существующего окна.  
  
   - Если объект представления документов существует и это представление предназначено для той же иерархии и элемента иерархии, то проект может открыть второе представление, если оно может подключаться к базовому объекту данных документа. В противном случае проект должен использовать указатель на фрейм окна представления для переповерхности существующего окна.  
  
   - Если существует только объект данных документа, проект должен определить, может ли он использовать объект данных документа для своего представления. Если объект данных документа совместим, выполните действия, описанные в разделе [Открытие редактора для конкретного проекта](../extensibility/how-to-open-project-specific-editors.md).  
  
     Если объект данных документа несовместим, для пользователя отображается сообщение об ошибке, показывающее, что файл используется в данный момент. Эта ошибка должна отображаться только в временных случаях, например при компиляции файла в то же время, когда пользователь пытается открыть файл, используя редактор, отличный от [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] основного текстового редактора. Базовый текстовый редактор может совместно использовать объект данных документа с компилятором.  
  
3. Если документ не открыт из-за отсутствия объекта данных документа или объекта представления документов, выполните действия, описанные в разделе [Открытие редактора для конкретного проекта](../extensibility/how-to-open-project-specific-editors.md).  
  
## <a name="opening-a-standard-editor"></a>Открытие стандартного редактора  
 Используйте следующую процедуру, чтобы открыть стандартный редактор для уже открытого файла.  
  
#### <a name="to-open-a-standard-editor-for-an-open-file"></a>Открытие стандартного редактора для открытого файла  
  
1. Вызовите процедуру <xref:Microsoft.VisualStudio.Shell.Interop.IVsUIShellOpenDocument.OpenStandardEditor%2A>.  
  
     Этот метод сначала проверяет, что документ еще не открыт с помощью вызова <xref:Microsoft.VisualStudio.Shell.Interop.IVsUIShellOpenDocument.IsDocumentOpen%2A> . Если документ уже открыт, то его окно редактора будет переустановлено.  
  
2. Если документ не открыт, выполните действия, описанные в разделе [как открыть стандартные редакторы](../extensibility/how-to-open-standard-editors.md).  
  
## <a name="see-also"></a>См. также:  
 [Открытие и сохранение элементов проекта](../extensibility/internals/opening-and-saving-project-items.md)   
 [Пошаговое руководство. открытие редакторов, зависящих от проекта](../extensibility/how-to-open-project-specific-editors.md)   
 [Практическое руководство. Открытие стандартных редакторов](../extensibility/how-to-open-standard-editors.md)
