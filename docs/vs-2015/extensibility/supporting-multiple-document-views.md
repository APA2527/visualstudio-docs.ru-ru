---
title: Поддержка нескольких представлений документов | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- editors [Visual Studio SDK], custom - multiple document views
ms.assetid: c7ec2366-91c4-477f-908d-e89068bdb3e3
caps.latest.revision: 26
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: 9377fc12db8cedba65a418fd32b82a1421bd9b43
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "68160515"
---
# <a name="supporting-multiple-document-views"></a>Поддержка представления нескольких документов
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Можно предоставить несколько представлений документа, создав отдельные данные документа и объекты представления документов для редактора. Ниже перечислены некоторые случаи, в которых можно использовать дополнительное представление документа.  
  
- Поддержка новых окон. необходимо, чтобы редактор предоставил два или более представления одного типа, чтобы пользователь, который уже открыл окно в редакторе, мог открыть новое окно, выбрав команду " **создать окно** " в меню " **окно** ".  
  
- Поддержка представлений форм и кода. необходимо, чтобы редактор предоставил представления различных типов. [!INCLUDE[vbprvb](../includes/vbprvb-md.md)]Например, предоставляет как представление формы, так и представление кода.  
  
  Дополнительные сведения см. в описании процедуры CreateEditorInstance в файле EditorFactory.cs в проекте пользовательского редактора, созданном с помощью шаблона пакета Visual Studio. Дополнительные сведения об этом проекте см. [в разделе Пошаговое руководство. Создание пользовательского редактора](../extensibility/walkthrough-creating-a-custom-editor.md).  
  
## <a name="synchronizing-views"></a>Синхронизация представлений  
 При реализации нескольких представлений объект данных документа отвечает за поддержание синхронизации всех представлений с данными. Интерфейсы обработки событий для можно использовать <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> для синхронизации нескольких представлений с данными.  
  
 Если объект не используется <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> для синхронизации нескольких представлений, необходимо реализовать собственную систему событий для управления изменениями, внесенными в объект данных документа. Можно использовать разные уровни гранулярности, чтобы иметь возможность обновления нескольких представлений. С параметром максимальной гранулярности при вводе в одном представлении другие представления немедленно обновляются. При минимальной детализации другие представления не обновляются до тех пор, пока они не будут активированы.  
  
## <a name="determining-whether-document-data-is-already-open"></a>Определение того, являются ли данные документа уже открытыми  
 Таблица выполняемых документов (РДТ) в интегрированной среде разработки (IDE) помогает контролировать, открыт ли уже данные для документа, как показано на следующей схеме.  
  
 ![График DocDataView](../extensibility/media/docdataview.gif "докдатавиев")  
Несколько представлений  
  
 По умолчанию каждое представление (объект представления документа) содержится в отдельном фрейме окна ( <xref:Microsoft.VisualStudio.Shell.Interop.IVsWindowFrame> ). Однако, как уже отмечалось, данные документа могут отображаться в нескольких представлениях. Чтобы сделать это, Visual Studio проверяет РДТ, чтобы определить, открыт ли уже данный документ в редакторе. Когда интегрированная среда разработки вызывает <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory.CreateEditorInstance%2A> для создания редактора, значение, отличное от NULL, возвращается в `punkDocDataExisting` параметре, указывающее, что документ уже открыт в другом редакторе. Дополнительные сведения о функциях РДТ см. в разделе [выполнение таблицы документов](../extensibility/internals/running-document-table.md).  
  
 В <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory> реализации изучите объект данных документа, возвращенный в, `punkDocDataExisting` чтобы определить, подходят ли данные документа для редактора. (Например, HTML-редактор должен отображать только данные HTML.) Если это уместно, Фабрика редактора должна предоставить второе представление для данных. Если `punkDocDataExisting` параметр не имеет значение `NULL` , возможно, объект данных документа открыт в другом редакторе или, скорее всего, данные документа уже открыты в другом представлении с тем же редактором. Если данные документа открыты в другом редакторе, который не поддерживается фабрикой редактора, Visual Studio не сможет открыть фабрику редактора. Дополнительные сведения см. [в разделе руководство. присоединение представлений к данным документа](../extensibility/how-to-attach-views-to-document-data.md).
