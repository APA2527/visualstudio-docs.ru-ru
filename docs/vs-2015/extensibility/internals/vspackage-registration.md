---
title: Регистрация VSPackage | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- registration, VSPackages
- VSPackages, registering
ms.assetid: ecd20da8-b04b-4141-a8f4-a2ef91dd597a
caps.latest.revision: 19
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: a11f05edb4e7d476fdbcab82d365f9327dd4869a
ms.sourcegitcommit: 08fc78516f1107b83f46e2401888df4868bb1e40
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65685285"
---
# <a name="vspackage-registration"></a>Регистрация VSPackage
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

Пакеты VSPackage необходимо сообщить [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] что они установлены, а должна быть загружена. Этот процесс выполняется путем записи информации в реестре. Это типичное задание установщика.  
  
> [!NOTE]
> Распространенной практикой является во время разработки VSPackage, чтобы использовать автоматическую регистрацию. Тем не менее [!INCLUDE[vsipprvsip](../../includes/vsipprvsip-md.md)] партнеров не может поставляться их продуктов с помощью самостоятельной регистрации в процессе установки.  
  
 Записи реестра в пакет установщика Windows обычно устанавливаются в таблице реестра. Вы также можете зарегистрировать расширения файлов в таблице реестра. Тем не менее установщик Windows предоставляет встроенную поддержку через программный идентификатор (ProgId), класса, расширение и таблицы команд. Дополнительные сведения см. в разделе [таблиц базы данных](https://msdn.microsoft.com/library/aa368259\(VS.85\).aspx).  
  
 Убедитесь, что к элементам реестра связаны с компонентом, который подходит для выбранной стратегии side-by-side. Например записи реестра для общих файлов, необходимо связать с помощью компонента установщика Windows этот файл. Аналогичным образом записи реестра для конкретной версии файла должна быть связана с помощью этого файла компонента. В противном случае установка или удаление пакета VSPackage для одной версии [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] может привести к нарушению VSPackage в других версиях. Дополнительные сведения см. в разделе [поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md)  
  
> [!NOTE]
> Самый простой способ управлять регистрацией — использовать те же данные в тех же файлах для регистрации разработчика и регистрации во время установки. Например некоторые средства разработки установщика может использовать файл в файл с расширением REG формате во время сборки. Если разработчики Ведение REG-файлы для ежедневной разработки и отладки, эти файлы могут быть включены в установщик автоматически. Если нельзя совместно использовать автоматически регистрационные данные, необходимо убедиться, что установщик копия регистрационные данные является текущей.  
  
## <a name="registering-unmanaged-vspackages"></a>Регистрация неуправляемые пакеты VSPackage  
 Неуправляемые пакеты VSPackage, (в том числе созданные шаблона пакета Visual Studio) стиле ATL .rgs файлы используются для хранения сведений о регистрации. Формат файла .rgs относится к ATL и обычно не может быть использован как-— с помощью установки, средства разработки. Сведения о регистрации VSPackage установщика необходимо обслуживать отдельно. К примеру разработчики могут сохранить файлы в формате .reg синхронизирован с .rgs изменения файлов. REG-файлов может быть объединена с RegEdit для разработки или используемых установщиком.  
  
## <a name="registering-managed-vspackages"></a>Регистрация управляемых пакетов VSPackage  
 Средство RegPkg считывает атрибуты регистрации из управляемого пакета VSPackage и могут либо записывать сведения непосредственно в реестр или записи файл с расширением REG формат файлов, которые могут быть использованы установщика.  
  
> [!NOTE]
> Средство RegPkg не могут устанавливаться и не может использоваться для регистрации VSPackage в системе пользователя.  
  
## <a name="why-vspackages-should-not-self-register-at-install-time"></a>Почему пакеты VSPackage не нужно самостоятельно регистрировать во время установки  
 Собственных установщиков VSPackage не следует полагаться на автоматическую регистрацию. На первый взгляд сохранение значений реестра VSPackage только в VSPackage, сам может показаться хорошей идеей. Учитывая, что разработчики должны значений реестра, доступных для рутинных работы и тестирования, имеет смысл во избежание обслуживание отдельную копию данных реестра в установщике. Установщик может полагаться на сам пакет VSPackage для записи значения реестра.  
  
 Хоть и хорош в теории автоматическую регистрацию имеет несколько недостатков, которые делают его непригодным для установки пакета VSPackage.  
  
- Правильно поддержки установки, удаления, откат установки и удаления отката необходимо создать четыре нестандартных действий для каждого управляемого пакета VSPackage, которая самостоятельно регистрируется путем вызова RegPkg.  
  
- Ваш подход к поддержке side-by-side может потребоваться, создаваемых четыре настраиваемые действия, которые вызывают RegSvr32 или RegPkg для каждой поддерживаемой версии [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].  
  
- Установка с самостоятельным зарегистрированных модулей нельзя откатить безопасно, так как нет способа определить, используются ли самостоятельно зарегистрирован ключи, другой компонент или приложение.  
  
- Иногда самостоятельно Зарегистрированные DLL связать вспомогательные библиотеки DLL, которые не существуют или имеют неправильную версию. Напротив установщика Windows можно зарегистрировать библиотеки DLL с помощью таблицы не зависит от текущего состояния системы.  
  
- Код автоматической регистрации может быть запрещен доступ к сетевым ресурсам, таким как библиотеки типов, если компонент не указан как запуск из источника и перечисленных в таблице SelfReg. Это может привести к установке компонента к сбою во время точки административной установки.  
  
## <a name="see-also"></a>См. также  
 [Установщик Windows](https://msdn.microsoft.com/library/cc185688\(VS.85\).aspx)   
 [Регистрация управляемых пакетов](https://msdn.microsoft.com/f69e0ea3-6a92-4639-8ca9-4c9c210e58a1)
