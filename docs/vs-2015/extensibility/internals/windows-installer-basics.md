---
title: Основы установщик Windows | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- Windows Installer, VSPackages
- VSPackages, Windows Installer basics
ms.assetid: 497e479b-add8-4644-870a-917f15306b97
caps.latest.revision: 13
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: 4693654e12dc37209cb92e3e2ba95bde8bd13e77
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "65687678"
---
# <a name="windows-installer-basics"></a>Основные сведения об установщике Windows
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

Установщик Windows устанавливает и удаляет приложения или программные продукты на компьютере пользователя, выполняя эти задачи в единицах, которые называются установщик Windows компонентами (иногда называются Викс или просто компонентами). Идентификатор GUID определяет каждый компонент WIC, который является базовой единицей установки и подсчета ссылок для установок с помощью установщик Windows.  
  
 Подробную документацию по установщик Windows см. в разделе пакет SDK для платформы [установщик Windows](/previous-versions/2kt85ked(v=vs.120)).  
  
## <a name="authoring-a-vspackage"></a>Создание пакета VSPackage  
 Установщик Windows использует пакеты установки, содержащие сведения, которые установщик Windows требуется для установки, удаления или восстановления продукта, а также для запуска пользовательского интерфейса программы установки. Каждый пакет установки включает MSI-файл, который содержит базу данных установки, информационный поток сводки и потоки данных для различных частей установки. Чтобы использовать установщик, необходимо создать установку. Поскольку установщик организует установки вокруг концепции компонентов и хранит сведения об установке в реляционной базе данных, процесс создания пакета установки в общем случае включает следующие шаги.  
  
1. Спланируйте создание программы установки для поддержки управления версиями и параллельных стратегий.  
  
2. Найдите функции, которые будут представлены пользователям.  
  
3. Упорядочите VSPackage и зависимости на компоненты.  
  
4. Заполните базу данных установки данными.  
  
5. Проверьте пакет установки.  
  
   Эта документация связана главным образом с первым и третьим этапом процесса. Во время выполнения этих действий вы организуете функции VSPackage в Викс, чтобы вы могли зафреймировать стратегию управления версиями и обслуживания для учета последующих версий [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] . Оставшиеся три шага подробно рассматриваются в установщик Windows документации в пакете Platform SDK.  
  
## <a name="key-terms"></a>Основные понятия  
 Ниже приведены определения основных терминов, связанных с технологией установщик Windows.  
  
 Ресурс  
 Файлы, разделы реестра, ярлыки и т. д., которые могут быть установлены на компьютере. Эти ресурсы логически сгруппированы в компоненты установщик Windows.  
  
 Компонент установщик Windows (WIC)  
 Базовая единица установки, представляющая логическую группу связанных ресурсов, которые устанавливаются и удаляются как единое целое. Установщик Windows компоненты идентифицируются по уникальному ИДЕНТИФИКАТОРу компонента или идентификатору GUID. Более того, установщик Windows поддерживает подсчет ссылок на уровне WIC. Для максимальной гибкости управления версиями включите в данный компонент WIC не более одного первичного ресурса, например библиотеки DLL. Обратите внимание, что после того, как вы назначите и заполните WIC, присвойте ему идентификатор GUID и развернете его, вы не сможете изменить его композицию. Дополнительные сведения см. [в разделе Упорядочение приложений по компонентам](https://msdn.microsoft.com/library/aa370561.aspx).  
  
 Пакет (распространяемый пакет)  
 Единица развертывания, состоящая из MSI-файла и внешних исходных файлов, на которые может указывать этот файл. Пакет содержит все сведения, которые установщик Windows требуется для запуска пользовательского интерфейса и установки или удаления приложения.  
  
 MSI файл  
 Файл хранилища, структурированный COM, содержащий инструкции и данные, необходимые для установки приложения. Каждый пакет содержит по крайней мере один MSI файла. MSI-файл содержит базу данных установщика, информационный поток сводки и, возможно, один или несколько преобразований и внутренних исходных файлов. Устанавливаемые файлы можно либо сжать в CAB-файл и сохранить в потоке в MSI-файле, либо сохранить, сжать или без сжатия, вне MSI-файла на исходном носителе. Дополнительные сведения см. в разделе [установщик Windows расширения файлов](https://msdn.microsoft.com/library/aa372842\(VS.85\).aspx).  
  
## <a name="windows-installer-rules-enforcement"></a>Применение правил установщик Windows  
 Два набора правил определяют развертывание ресурсов с помощью компонентов программы установки. Один набор правил поддерживается самим установщик Windowsом, а второй набор — автором установки.  
  
> [!NOTE]
> Применение правил установщик Windows выполняется только в том случае, если выполняется проверка MSI-файла. Тем не менее, вы должны рассматривать эти правила как рекомендации. Дополнительные сведения см. в разделе [Проверка базы данных установки](https://msdn.microsoft.com/library/aa372477\(VS.85\).aspx) и [Проверка пакета](https://msdn.microsoft.com/library/aa370569\(VS.85\).aspx).  
  
#### <a name="installer-enforced-rules"></a>Правила, принудительно применяемые установщиком  
  
- Все файлы в заданном компоненте должны быть установлены в одном каталоге. И наоборот, файлы, установленные в отдельные папки, должны принадлежать отдельным компонентам.  
  
- Для каждого компонента может существовать только один путь к ключу. Путь к ключу — это просто файл или раздел реестра, представляющий весь компонент.  
  
#### <a name="component-provider-responsibilities"></a>Обязанности поставщиков компонентов  
  
- Все два ресурса, которые могут поставляться отдельно в последующих версиях, должны существовать в отдельных компонентах. Ресурсы должны быть сгруппированы в один и тот же компонент только в том случае, если вы уверены, что эти ресурсы никогда не будут поставляться отдельно. На самом деле рекомендуется, чтобы все основные ресурсы (например, библиотеки DLL) всегда существовали в отдельных Викс. Дополнительные сведения см. в разделе [Определение компонентов установщика](https://msdn.microsoft.com/library/aa368269\(VS.85\).aspx).  
  
- Ни один ресурс с версией не должен поставляться в нескольких компонентах WIC.  
  
## <a name="see-also"></a>См. также:  
 [Что произойдет, если правила компонентов будут разорваны?](https://msdn.microsoft.com/library/aa372795\(VS.85\).aspx)
