---
title: Проектирование команд | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- commands
- commands, implementation
ms.assetid: 097108c3-f758-4b87-89d6-b32d12d9041a
caps.latest.revision: 35
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: a6e9eaf69be62b38a880b07fd8eb51cfc9c256a3
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "68195076"
---
# <a name="command-design"></a>Конструктор команд
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

При добавлении команды в VSPackage необходимо указать, где она будет отображаться, когда она будет доступна и как она должна быть обработана.  
  
## <a name="defining-commands"></a>Определение команд  
 Чтобы определить новые команды, включите в проект VSPackage файл таблицы команд Visual Studio (. vsct). Если вы создали пакет VSPackage с помощью шаблона пакета Visual Studio, проект включает один из этих файлов. Дополнительные сведения см. в разделе [Visual Studio Command Table (.Vsct) Files](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md).  
  
 Visual Studio выполняет слияние всех найденных vsct файлов, чтобы они могли отображать команды. Поскольку эти файлы отличаются от двоичного файла VSPackage, Visual Studio не требуется загружать пакет для поиска команд. Дополнительные сведения см. в статье [Добавление элементов пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
 Visual Studio использует <xref:Microsoft.VisualStudio.Shell.ProvideMenuResourceAttribute> атрибут регистрации для определения ресурсов меню и команд. Дополнительные сведения см. в разделе [Реализация](../../extensibility/internals/command-implementation.md).  
  
 Команды во время выполнения можно изменять несколькими способами. Они могут быть отображены или скрыты, включены или отключены. Они могут отображать разные текстовые или значки или содержать разные значения. Большую часть настройки можно выполнить до того, как Visual Studio загрузит пакет VSPackage. Дополнительные сведения см. в статье [Добавление элементов пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
## <a name="command-handlers"></a>Обработчики команд  
 При создании команды необходимо предоставить обработчик событий для выполнения команды. Если пользователь выбирает команду, он должен быть соответствующим образом перенаправлен. Маршрутизация команды означает передачу ее в правильный пакет VSPackage, чтобы включить или отключить ее, скрыть или отобразить и выполнить ее, если пользователь решит это. Дополнительные сведения см. в разделе [алгоритм маршрутизации](../../extensibility/internals/command-routing-algorithm.md).  
  
## <a name="the-visual-studio-command-environment"></a>Командная среда Visual Studio  
 В Visual Studio может размещаться любое количество пакетов VSPackage, каждый из которых может участвовать в наборе команд. Среда отображает только те команды, которые соответствуют текущей задаче. Дополнительные сведения см. в разделе [объекты контекста](../../extensibility/internals/selection-context-objects.md) [доступности](../../extensibility/internals/command-availability.md) и выбора.  
  
 Пакет VSPackage, определяющий новые команды, меню, панели инструментов или контекстные меню, предоставляет сведения о команде Visual Studio во время установки с помощью записей реестра, ссылающихся на ресурсы в машинных или управляемых сборках. Затем каждый ресурс ссылается на файл ресурсов двоичных данных (. CTO), который создается при компиляции файла таблицы команд Visual Studio (. vsct). Это позволяет Visual Studio предоставлять Объединенные наборы команд, меню и панели инструментов без необходимости загружать все установленные пакеты VSPackage.  
  
### <a name="command-organization"></a>Организация команд  
 Среда размещает команды по группам, приоритету и меню.  
  
- Группы — это логические коллекции связанных команд, например, группы команд **Вырезать**, **Копировать**и **Вставить** . Группы — это команды, которые отображаются в меню.  
  
- Приоритет определяет порядок, в котором отдельные команды в группе отображаются в меню.  
  
- Меню выступает в качестве контейнеров для групп.  
  
  Среда определяет некоторые команды, группы и меню. Дополнительные сведения см. в разделе [команда по умолчанию, группирование и размещение панели инструментов](../../extensibility/internals/default-command-group-and-toolbar-placement.md).  
  
  Команда может быть назначена основной группе. Основная группа определяет расположение команды в структуре главного меню и в диалоговом окне **Настройка** . Команда может отображаться в нескольких группах. Например, команда может находиться в главном меню, в контекстном меню и на панели инструментов. Дополнительные сведения см. в статье [Добавление элементов пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
### <a name="command-routing"></a>маршрутизация команд  
 Процесс вызова и маршрутизации команд для пакетов VSPackage отличается от процесса вызова методов в экземплярах объектов.  
  
 Среда направляет команды последовательно из внутреннего (локального) контекста команды, который основан на текущем выделении, к самому внешнему (глобальному) контексту. Первый контекст, который способен выполнить команду, — это тот, который ее обрабатывает. Дополнительные сведения см. в разделе [алгоритм маршрутизации](../../extensibility/internals/command-routing-algorithm.md).  
  
 В большинстве случаев среда обрабатывает команды с помощью <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейса. Так как схема маршрутизации команд позволяет различным объектам обрабатывать команды, <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> может реализовываться любым количеством объектов. сюда входят элементы управления Microsoft ActiveX, реализации оконных представлений, объекты документов, иерархии проектов и сами объекты VSPackage (для глобальных команд). В некоторых специализированных случаях, например при маршрутизации команд в иерархии, <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> интерфейс должен быть реализован.  
  
## <a name="related-topics"></a>См. также  
  
|Заголовок|Описание|  
|-----------|-----------------|  
|[Реализация](../../extensibility/internals/command-implementation.md)|Описывает, как реализовать команды в VSPackage.|  
|[Доступность](../../extensibility/internals/command-availability.md)|Описывает, как контекст Visual Studio определяет доступные команды.|  
|[Алгоритм маршрутизации](../../extensibility/internals/command-routing-algorithm.md)|Описывает, как архитектура маршрутизации команд Visual Studio позволяет обрабатывать команды разными пакетами VSPackage.|  
|[Рекомендации по размещению](../../extensibility/internals/command-placement-guidelines.md)|Предлагает способ размещения команд в среде Visual Studio.|  
|[Как добавить элементы пользовательского интерфейса с помощью пакетов VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md)|Описывает оптимальное использование пакетов VSPackage для архитектуры команд Visual Studio.|  
|[Стандартное размещение команды, группы и панели инструментов](../../extensibility/internals/default-command-group-and-toolbar-placement.md)|Описывает оптимальное использование пакетов VSPackage для работы с командами, которые входят в Visual Studio.|  
|[Управление пакетами VSPackage](../../extensibility/managing-vspackages.md)|Описывает, как Visual Studio загружает пакеты VSPackage.|  
|[Файлы таблицы команд Visual Studio (VSCT-файлы)](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md)|Содержит сведения о vsct-файлах на основе XML, которые используются для описания макета и внешнего вида команд в VSPackage.|
