---
title: Сценарии установки VSPackage | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- VSPackages, deployment considerations
ms.assetid: d2928498-f27c-46b4-a9cd-cba41fd85a10
caps.latest.revision: 22
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: 58b4350812900bc11e8aaa3222b3b0898db19e13
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63440792"
---
# <a name="vspackage-setup-scenarios"></a>Сценарии установки VSPackage
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

Очень важно для разработки VSPackage установщик для обеспечения гибкости. Например может понадобиться в будущем выпуске исправления безопасности, или можно изменить бизнес-стратегии, которые требуют поддержки тщательного управления версиями side-by-side.  
  
 В [поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md), можно узнать преимущества и проблемы с поддержкой установок side-by-side [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] с совместно используемой или side-by-side установок VSPackage. Короче говоря, пакеты VSPackage side-by-side дают наибольшую гибкость для поддержки новых возможностей [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].  
  
 Сценарии, рассмотренные в этом разделе не только выбранные параметры, но они представлены в виде рекомендации.  
  
## <a name="components-privacy-and-sharing"></a>Компоненты, конфиденциальности и управления доступом  
  
##### <a name="make-your-components-independent"></a>Создание независимых компонентов  
 После идентификации и заполнить компонента, назначить `GUID`и развернуть компонент, нельзя изменить его композиции. При изменении компонента композиции, итоговый компонент должен быть компонента с новым `GUID`. Учитывая эти факты, наибольшую гибкость управления версиями является обеспечиваемый что делает каждый компонент независимые, проводить более единицы. Дополнительные сведения о правила, управляющие компоненты, см. в разделе [изменения кода компонент](http://msdn.microsoft.com/library/aa367849\(VS.85\).aspx) и [что произойдет, если компонент правила разбиваются?](http://msdn.microsoft.com/library/aa372795\(VS.85\).aspx).  
  
##### <a name="do-not-mix-shared-and-private-resources-in-a-component"></a>Не следует смешивать общие и закрытые ресурсы в компоненте  
 Подсчет ссылок происходит на уровне компонента. Следовательно смешение общие и закрытые ресурсы в одном компоненте делает невозможным обновление частного ресурсы, такие как исполняемого файла, без также перезаписи общих ресурсов. Этот сценарий создает проблемы обратной совместимости и запрещает создание возможностей side-by-side.  
  
 Например, значения реестра, используемый для регистрации VSPackage с [!INCLUDE[vsipsdk](../../includes/vsipsdk-md.md)] должны храниться в компоненте отдельно от тому, который используется для регистрации VSPackage с [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]. Общие файлы или значения реестра перейдите в еще один компонент.  
  
## <a name="scenario-1-shared-vspackage"></a>Сценарий 1. Общий VSPackage  
 В этом случае общие VSPackage (единый двоичный файл, который поддерживает несколько версий [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]) поставляется в пакет установщика Windows. Регистрация с каждой версией [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] управляется с возможностью выбора пользователем функции. Это также означает, что при назначении для разделения функций каждого компонента могут быть выбраны для установки или удаления, поместить пользователя в элементе управления интеграции VSPackage в разных версиях [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]. (См. в разделе [возможности установщика Windows](http://msdn.microsoft.com/library/aa372840\(VS.85\).aspx) Дополнительные сведения об использовании функций в пакеты установщика Windows.)  
  
 ![График VS Shared VSPackage](../../extensibility/internals/media/vs-sharedpackage.gif "VS_SharedPackage")  
Общий установщик VSPackage  
  
 Как показано на рисунке, общие компоненты становятся частью Feat_Common компонента, который всегда устанавливается. Благодаря функции Feat_VS2002 и Feat_VS2003 видимым, пользователи могут выбирать во время установки в. какие версии [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] они хотят интегрировать VSPackage. Пользователи также могут использовать режим обслуживания установщика Windows для добавления или удаления компонентов, который в данном случае добавляет или удаляет сведения о регистрации VSPackage из разных версий [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].  
  
> [!NOTE]
> Установка компонента отображаемый столбец 0 скрывает его. Значение столбца низкого уровня, например 1, гарантирует, что он будет всегда установлен. Дополнительные сведения см. в разделе [installlevel, ОЗНАЧАЮТ свойство](http://msdn.microsoft.com/library/aa369536\(VS.85\).aspx) и [таблицы компонентов](http://msdn.microsoft.com/library/aa368585.aspx).  
  
## <a name="scenario-2-shared-vspackage-update"></a>Сценарий 2. Общие обновления пакета VSPackage  
 В этом случае поставляется обновленную версию установщика VSPackage в сценарии 1. Для целей обсуждения обновление добавляет поддержку [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], но также может быть проще безопасности обновления или исправления пакета обновления. Правила установщика Windows для установки новых компонентов требуют, что компоненты без изменений в системе не копируются повторно. В этом случае система с версии 1.0 уже присутствует перезапишет обновляемого компонента Comp_MyVSPackage.dll и позволить пользователям выбирать для добавления новой функции Feat_VS2005 с его компонентом Comp_VS2005_Reg.  
  
> [!CAUTION]
> Каждый раз, когда VSPackage является общим для нескольких версий [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], очень важно, что последующие версии пакета VSPackage обратной совместимости с предыдущими версиями платформы [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]. Там, где невозможно обеспечить обратную совместимость, необходимо использовать пакеты VSPackage side-by-side, закрытым. Дополнительные сведения см. в разделе [поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md).  
  
 ![Изображение обновление пакета VS Shared VS](../../extensibility/internals/media/vs-sharedpackageupdate.gif "VS_SharedPackageUpdate")  
Общий установщик обновлений VSPackage  
  
 Этот сценарий представлен новый установщик VSPackage, использование преимуществ поддержки установщика Windows для промежуточных обновлений. Пользователи просто установить версию 1.1, и его обновление версии 1.0. Тем не менее не обязательно иметь версии 1.0 в системе. Тот же установщик будет установить версию 1.1, в системе, не версии 1.0. Для предоставления промежуточных обновлений таким образом удобен тем, что нет необходимости проходить через работу по разработке обновления установщик и установщик full продукта. Один установщик выполняет оба задания. Исправление безопасности или пакетом обновления могут вместо этого воспользуйтесь преимуществами исправлений установщика Windows. Дополнительные сведения см. в разделе [Установка исправлений и обновлений](http://msdn.microsoft.com/library/aa370579\(VS.85\).aspx).  
  
## <a name="scenario-3-side-by-side-vspackage"></a>Сценарий 3. Side-by-Side VSPackage  
 Этот сценарий предоставляет два установщика VSPackage — один для каждой версии Visual Studio .NET 2003 и [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]. Каждый установщик устанавливает side-by-side, или private, пакет VSPackage (один, специально созданных и установлены для конкретной версии [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]). Каждый пакет VSPackage имеет свой собственный компонент. Следовательно, каждый можно по отдельности обслуживаться с исправлениями или обслуживания выпусков. Так как библиотеки DLL VSPackage теперь конкретной версии, можно безопасно для включения сведений о его регистрации в том же компоненте, где находится библиотека DLL.  
  
 ![На стороне VS&#45;по&#45;пакета VS стороне](../../extensibility/internals/media/vs-sbys-package.gif "VS_SbyS_Package")  
Установщик пакета VSPackage Side-by-side  
  
 Каждый установщик также включает код, который совместно используется два установщика. Если общий код установки в общую папку, при установке оба файла MSI-файла будет установлена общий код только один раз. Второй установщик просто увеличивает значение счетчика ссылок на компонент. Счетчик ссылок гарантирует, что если удаляется один из пакетов VSPackage, общий код будут действовать для других VSPackage. Если также удаляется второй VSPackage, общий код будут удалены.  
  
## <a name="scenario-4-side-by-side-vspackage-update"></a>Сценарий 4. Обновление пакета VSPackage Side-by-Side  
 В этом случае VSPackage для [!INCLUDE[vsprvslong](../../includes/vsprvslong-md.md)] было ошибок с точки зрения безопасности уязвимость, если необходимо обновление. Как и в сценарии 2 можно создать новый MSI-файл, который обновляет существующую установку включают исправление безопасности, а также развертывание новых установок с исправлением безопасности уже на месте.  
  
 В этом случае VSPackage — это управляемый пакет VSPackage, установлены в глобальный кэш сборок (GAC). При перестроении он включает исправление безопасности, необходимо изменить часть номера версии, номера версии сборки. Сведения о регистрации для нового номера версии сборки заменяет предыдущую версию, вызывая [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] для загрузки предопределенной сборки.  
  
 ![На стороне VS&#45;по&#45;обновление пакета VS стороне](../../extensibility/internals/media/vs-sbys-packageupdate.gif "VS_SbyS_PackageUpdate")  
Установщик обновлений VSPackage Side-by-side  
  
 **Примечание** Дополнительные сведения о развертывании side-by-side сборок см. в разделе [Упрощение развертывания и решению осложнения с библиотеками DLL в .NET Framework](http://msdn.microsoft.com/library/ms973843.aspx).  
  
## <a name="see-also"></a>См. также  
 [Установщик Windows](http://msdn.microsoft.com/library/cc185688\(VS.85\).aspx)   
 [Поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md)
