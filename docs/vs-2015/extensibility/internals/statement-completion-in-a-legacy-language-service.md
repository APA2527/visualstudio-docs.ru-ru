---
title: Завершение операторов в языковой службе прежних версий | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- statement completion
- language services, statement completion
ms.assetid: 617439dc-3f0e-4e5f-b346-3e4e7fcf3c1b
caps.latest.revision: 13
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: 163eb0f23716fa2f036d07612b741c0c9419b92e
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "90842700"
---
# <a name="statement-completion-in-a-legacy-language-service"></a>Завершение операторов в языковой службе прежних версий
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

Завершение операторов — это процесс, с помощью которого служба языка помогает пользователям завершить ключевое слово языка или элемент, которые они начали вводить в основном редакторе. В этом разделе описывается, как работает завершение операторов и как его реализовать в языковой службе.  
  
 Устаревшие языковые службы реализуются как часть VSPackage, но более новым способом реализации функций языковой службы является использование расширений MEF. Дополнительные сведения о новом способе реализации завершения операторов см. в разделе [Пошаговое руководство. Отображение завершения операторов](../../extensibility/walkthrough-displaying-statement-completion.md).  
  
> [!NOTE]
> Рекомендуется как можно скорее начать использовать новый API редактора. Это улучшит производительность языковой службы и позволит использовать новые функции редактора.  
  
## <a name="implementing-statement-completion"></a>Реализация завершения операторов  
 В основном редакторе завершение операторов активирует специальный пользовательский интерфейс, который в интерактивном режиме упрощает и ускоряет написание кода. Завершение операторов позволяет при необходимости отображать соответствующие объекты или классы, что позволяет избежать необходимости запоминать определенные элементы или искать их в справочном разделе справки.  
  
 Для реализации завершения операторов язык должен иметь триггер завершения операторов, который можно проанализировать. Например, [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] использует оператор с точкой (.), а [!INCLUDE[vcprvc](../../includes/vcprvc-md.md)] использует оператор стрелки (->). Языковая служба может использовать более одного триггера для завершения инструкции. Эти триггеры запрограммированы в фильтре команд.  
  
## <a name="command-filters-and-triggers"></a>Фильтры и триггеры команд  
 Команда фильтрует вхождения триггера или триггеров. Чтобы добавить фильтр команд в представление, реализуйте <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейс и присоедините его к представлению, вызвав <xref:Microsoft.VisualStudio.TextManager.Interop.IVsTextView.AddCommandFilter%2A> метод. Вы можете использовать один и тот же фильтр команд ( <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> ) для всех аспектов языковой службы, таких как завершение операторов, маркеры ошибок и советы по методам. Дополнительные сведения см. в разделе [перехват команд языковой службы прежних версий](../../extensibility/internals/intercepting-legacy-language-service-commands.md).  
  
 При входе триггера в редактор, в частности, в текстовом буфере, языковая служба затем вызывает <xref:Microsoft.VisualStudio.TextManager.Interop.IVsTextView.UpdateCompletionStatus%2A> метод. Это приводит к тому, что редактор выводит пользовательский интерфейс, чтобы пользователь мог выбирать из кандидатов на завершение операторов. Этот метод требует реализации <xref:Microsoft.VisualStudio.TextManager.Interop.IVsCompletionSet> и <xref:Microsoft.VisualStudio.TextManager.Interop.UpdateCompletionFlags> флагов в качестве параметров. Список элементов завершения отображается в списке прокрутки. По мере того, как пользователь продолжит ввод, выбор в списке обновляется, чтобы отразить наиболее близкое совпадение с последними введенными символами. Основной редактор реализует пользовательский интерфейс для завершения операторов, но языковая служба должна реализовать интерфейс, <xref:Microsoft.VisualStudio.TextManager.Interop.IVsCompletionSet> чтобы определить набор элементов завершения для инструкции.  
  
## <a name="see-also"></a>См. также:  
 [Перехват команд языковой службы прежних версий](../../extensibility/internals/intercepting-legacy-language-service-commands.md)
