---
title: Архитектура пакета VSPackage в системе управления версиями | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- source control packages, architecture
ms.assetid: 453125fc-23dc-49b1-8476-94581f05e6c7
caps.latest.revision: 26
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: 3cca9e39714f87024b01ab2c925189aacbe22785
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "68183413"
---
# <a name="source-control-vspackage-architecture"></a>Архитектура пакета VSPackage системы управления версиями
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

Пакет управления версиями — это VSPackage, использующий службы, [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] предоставляемые интегрированной средой разработки. В случае возврата пакет управления версиями предоставляет свои функциональные возможности в качестве службы управления версиями. Кроме того, пакет управления версиями является более универсальным вариантом, чем подключаемый модуль системы управления версиями для интеграции системы управления версиями в [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] .  
  
 Подключаемый модуль системы управления версиями, реализующий интерфейс API подключаемого модуля системы управления версиями, придерживается определенного контракта. Например, подключаемый модуль не может заменить пользовательский интерфейс по умолчанию [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] . Кроме того, интерфейс API подключаемого модуля системы управления версиями не позволяет подключаемому модулю реализовать собственную модель управления версиями. Однако пакет управления версиями имеет оба этих ограничения. Пакет управления версиями имеет полный контроль над процессом управления версиями [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] пользователя. Кроме того, пакет управления версиями может использовать собственную модель и логику системы управления версиями, а также может определять все пользовательские интерфейсы, связанные с системой управления версиями.  
  
## <a name="source-control-package-components"></a>Компоненты пакета управления версиями  
 Как показано на схеме архитектуры, [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] компонент с именем заглушки системы управления версиями — это VSPackage, который интегрирует пакет управления версиями с [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] .  
  
 Заглушка системы управления версиями обрабатывает следующие задачи.  
  
- Предоставляет общий пользовательский интерфейс, необходимый для регистрации пакета управления версиями.  
  
- Загружает пакет управления версиями.  
  
- Устанавливает пакет управления версиями как активный или неактивный.  
  
  Заглушка системы управления версиями ищет активную службу для пакета управления версиями и направляет все входящие вызовы служб из IDE в этот пакет.  
  
  Пакет адаптера системы управления версиями — это специальный пакет управления версиями, [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] предоставляемый. Этот пакет является центральным компонентом для поддержки подключаемых модулей системы управления версиями на основе API подключаемого модуля системы управления версиями. Если подключаемый модуль системы управления версиями является активным подключаемым модулем, заглушка системы управления версиями отправляет свои события в пакет адаптера системы управления версиями. В свою очередь, пакет адаптера системы управления версиями взаимодействует с подключаемым модулем системы управления версиями с помощью API подключаемого модуля системы управления версиями, а также предоставляет пользовательский интерфейс по умолчанию, который является общим для всех подключаемых модулей системы управления версиями.  
  
  С другой стороны, если пакет управления исходным кодом является активным, заглушка системы управления версиями напрямую взаимодействует с пакетом с помощью [!INCLUDE[vsipsdk](../../includes/vsipsdk-md.md)] интерфейсов пакета управления версиями. Пакет управления версиями отвечает за размещение собственного пользовательского интерфейса системы управления версиями.  
  
  ![График архитектуры системы управления версиями](../../extensibility/internals/media/vsipsccarch.gif "всипсккарч")  
  
  Для пакета управления версиями не [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] предоставляет код системы управления версиями или API для интеграции. Сравните это с подходом, описанным в статьи [Создание подключаемого модуля системы](../../extensibility/internals/creating-a-source-control-plug-in.md) управления версиями, где подключаемый модуль системы управления версиями должен реализовывать жесткий набор функций и обратных вызовов.  
  
  Как и пакеты VSPackage, пакет управления версиями — это COM-объект, который можно создать с помощью `CoCreateInstance` . Пакет VSPackage делает интерфейс IDE доступным для [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] реализации <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage> . После создания экземпляра VSPackage получает указатель сайта и <xref:Microsoft.VisualStudio.OLE.Interop.IServiceProvider> интерфейс, который предоставляет VSPackage доступ к доступным службам и интерфейсам в интегрированной среде разработки.  
  
  Написание пакета управления версиями на основе VSPackage требует более продвинутого опыта программирования, чем написание подключаемого модуля на основе API для подключаемого модуля системы управления версиями.  
  
## <a name="see-also"></a>См. также:  
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>   
 [Начало работы](../../extensibility/internals/getting-started-with-source-control-vspackages.md)
