---
title: Основные компоненты службы | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- services, essentials
ms.assetid: fbe84ad9-efe1-48b1-aba3-b50b90424d47
caps.latest.revision: 14
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: 407dda2f203b7be20b19c0e296caa9ce1c95b32c
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "65696069"
---
# <a name="service-essentials"></a>Основные компоненты службы
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

Служба — это контракт между двумя пакетами VSPackage. Один пакет VSPackage предоставляет конкретный набор интерфейсов для использования другим пакетом VSPackage. [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] является коллекцией пакетов VSPackage, которые предоставляют службы другим пакетам VSPackage.  
  
 Например, службу Свсактивитилог можно использовать для получения интерфейса Ивсактивитилог, который можно использовать для записи в журнал действий. Дополнительные сведения см. в разделе [инструкции. Использование журнала действий](../../extensibility/how-to-use-the-activity-log.md).  
  
 [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] также предоставляет некоторые встроенные службы, которые не зарегистрированы. Пакеты VSPackage могут заменить встроенные или другие службы, предоставляя переопределение службы. Для любой службы разрешено только одно переопределение службы.  
  
 Службы не имеют возможности обнаружения. Таким образом, необходимо указать идентификатор службы (SID) службы, которую требуется использовать, а также сведения о предоставляемых им интерфейсах. Эта информация представлена в справочной документации по службе.  
  
- Пакеты VSPackage, предоставляющие службы, называются поставщиками услуг.  
  
- Службы, предоставляемые другим пакетам VSPackage, называются глобальными службами.  
  
- Службы, доступные только для пакета VSPackage, который их реализует, или для любого объекта, который он создает, называются локальными службами.  
  
- Службы, которые заменяют встроенные службы или службы, предоставляемые другими пакетами, называются переопределениями служб.  
  
- Службы или переопределения служб загружаются по требованию, то есть поставщик услуг загружается, когда предоставляемая им служба запрашивается другим пакетом VSPackage.  
  
- Для поддержки загрузки по запросу поставщик услуг регистрирует свои глобальные службы с помощью [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] . Дополнительные сведения см. в разделе [Регистрация служб](../../misc/registering-services.md).  
  
- После получения службы используйте [QueryInterface](https://msdn.microsoft.com/library/62fce95e-aafa-4187-b50b-e6611b74c3b3) (неуправляемый код) или приведение (управляемый код) для получения требуемого интерфейса, например:  
  
    ```vb  
    TryCast(GetService(GetType(SVsActivityLog)), IVsActivityLog)  
    ```  
  
    ```csharp  
    GetService(typeof(SVsActivityLog)) as IVsActivityLog;  
  
    ```  
  
- Управляемый код ссылается на службу по ее типу, тогда как неуправляемый код ссылается на службу по ее идентификатору GUID.  
  
- При [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] загрузке VSPackage он передает поставщику служб пакету VSPackage, чтобы предоставить VSPackage доступ к глобальным службам. Это называется "заблокировано" пакетом VSPackage.  
  
- Пакеты VSPackage могут быть поставщиками служб для создаваемых ими объектов. Например, форма может отправить запрос на службу цвета в кадр, который может передать запрос [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] .  
  
- Управляемые объекты, которые глубоко вложены или вообще не являются узлами, могут вызывать <xref:Microsoft.VisualStudio.Shell.Package.GetGlobalService%2A> для прямого доступа к глобальным службам. Дополнительные сведения см. [в разделе инструкции. Использование GetGlobalService](../../misc/how-to-use-getglobalservice.md).  
  
## <a name="see-also"></a>См. также:  
 [Список доступных служб](../../extensibility/internals/list-of-available-services.md)   
 [Использование и предоставление служб](../../extensibility/using-and-providing-services.md)   
 [Приведение и преобразование типов](https://msdn.microsoft.com/library/568df58a-d292-4b55-93ba-601578722878)   
 [Приведение](https://msdn.microsoft.com/library/3dbeb06e-2f4b-4693-832d-624bc8ec95de)
