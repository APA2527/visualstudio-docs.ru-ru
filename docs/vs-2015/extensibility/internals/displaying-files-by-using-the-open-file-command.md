---
title: Отображение файлов с помощью команды "открыть файл" | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- project types, supporting Open File command
- Open File command
- persistence, supporting Open File command
ms.assetid: 4fff0576-b2f3-4f17-9769-930f926f273c
caps.latest.revision: 14
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: dd0018df4efb023357e10ab8050f6cf5e9eba1fb
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "90843160"
---
# <a name="displaying-files-by-using-the-open-file-command"></a>Отображение файлов с помощью команды "Открыть файл"
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

Следующие шаги описывают, как интегрированная среда разработки обрабатывает команду **Open File** , доступную в меню **файл** в среде [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] . Эти шаги также описывают, как проекты должны отвечать на вызовы, происходящие из этой команды.  
  
 Когда пользователь щелкает команду **Открыть файл** в меню **файл** и выбирает файл из диалогового окна **Открытие файла** , выполняется следующий процесс.  
  
1. С помощью таблицы выполняющегося документа интегрированная среда разработки определяет, открыт ли файл в проекте.  
  
    - Если файл открыт, интегрированная среда разработки перемещает окно.  
  
    - Если файл не открыт, интегрированная среда разработки вызывает <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.IsDocumentInProject%2A> запрос к каждому проекту, чтобы определить, какой проект может открыть файл.  
  
        > [!NOTE]
        > В реализации проекта <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.IsDocumentInProject%2A> Укажите значение приоритета, указывающее уровень, на котором проект открывает файл. Значения приоритета предоставляются в <xref:Microsoft.VisualStudio.Shell.Interop.VSDOCUMENTPRIORITY> перечислении.  
  
2. Каждый проект реагирует на уровень приоритета, который указывает важность, которую он накладывает на проект, чтобы открыть файл.  
  
3. Интегрированная среда разработки использует следующие критерии, чтобы определить, какой проект открывает файл:  
  
    - Проект, отвечающий с наивысшим приоритетом (DP_Intrinsic), открывает файл. Если несколько проектов отвечают этому приоритету, первый проект, который будет отвечать, открывает файл.  
  
    - Если ни один проект не отвечает с наивысшим приоритетом (DP_Intrinsic), но все проекты отвечают с тем же самым низким приоритетом, активный проект открывает файл. Если проект не активен, первый проект для ответа открывает файл.  
  
    - Если нет утверждений проекта на владение файлом (DP_Unsupported), проект прочих файлов открывает файл.  
  
         Если создается экземпляр проекта прочих файлов, то проект всегда отвечает со значением DP_CanAddAsExternal. Это значение указывает, что проект может открыть файл. Этот проект используется для размещения открытых файлов, которые не входят в другие проекты. Список элементов в этом проекте не сохранен; Этот проект отображается в **Обозреватель решений** только в том случае, если он используется для открытия файла.  
  
         Если проект "Прочие файлы" не указывает, что он может открыть файл, то экземпляр проекта не был создан. В этом случае интегрированная среда разработки создает экземпляр проекта прочих файлов и указывает проекту открыть файл.  
  
4. Как только интегрированная среда разработки определит, какой проект открывает файл, он вызывает <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.OpenItem%2A> метод для этого проекта.  
  
5. Затем проект имеет возможность открыть файл с помощью редактора конкретного проекта или стандартного редактора. Дополнительные сведения см. в статьях [как открывать редакторы для конкретного проекта](../../extensibility/how-to-open-project-specific-editors.md) и [как открывать стандартные редакторы](../../extensibility/how-to-open-standard-editors.md)соответственно.  
  
## <a name="see-also"></a>См. также:  
 [Отображение файлов при помощи команды «Открыть с помощью»](../../extensibility/internals/displaying-files-by-using-the-open-with-command.md)   
 [Открытие и сохранение элементов проекта](../../extensibility/internals/opening-and-saving-project-items.md)   
 [Пошаговое руководство. открытие редакторов, зависящих от проекта](../../extensibility/how-to-open-project-specific-editors.md)   
 [Практическое руководство. Открытие стандартных редакторов](../../extensibility/how-to-open-standard-editors.md)
