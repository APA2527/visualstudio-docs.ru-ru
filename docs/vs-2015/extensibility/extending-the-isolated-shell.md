---
title: Расширение изолированной оболочки | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- Visual Studio shell, isolated mode
ms.assetid: 9a641d8f-211e-4486-a1b1-4a89fafe7ee8
caps.latest.revision: 11
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: ea55039de769598b26868727a93cfa11726e4838
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "90842649"
---
# <a name="extending-the-isolated-shell"></a>Расширение изолированной оболочки
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Вы можете расширить изолированную оболочку Visual Studio, добавив пакет VSPackage, компонент Managed Extensibility Framework (MEF) или универсальный проект VSIX в изолированное приложение оболочки.  
  
> [!NOTE]
> Следующие шаги пресуппосе, что вы создали базовое приложение изолированной оболочки с помощью шаблона проекта изолированной оболочки Visual Studio. Дополнительные сведения об этом шаблоне проекта см. [в разделе Пошаговое руководство. Создание базового приложения изолированной оболочки](../extensibility/walkthrough-creating-a-basic-isolated-shell-application.md).  
  
## <a name="locations-for-the-visual-studio-package-project-template"></a>Расположения шаблона проекта пакета Visual Studio  
 Шаблон проекта пакета Visual Studio можно найти в трех разных местах диалогового окна **Создание проекта** .  
  
1. В **Visual Basic**разделе Visual Basic **расширяемость**. Язык проекта по умолчанию — Visual Basic.  
  
2. В **Visual C#** **расширяемость**. Язык проекта по умолчанию — C#.  
  
3. В разделе **другие типы проектов** **расширяемость**. Язык проекта по умолчанию — C++.  
  
## <a name="adding-a-vspackage"></a>Добавление VSPackage  
 Пакет VSPackage можно добавить в приложение изолированной оболочки. Ниже показано, как создать такой объект, который добавляет команды меню.  
  
#### <a name="to-add-a-new-vspackage"></a>Добавление нового пакета VSPackage  
  
1. Добавьте проект пакета Visual Studio с именем `MenuCommandsPackage` .  
  
2. На странице **Основные сведения о VSPackage** мастера установите для параметра **название компании** значение `Fabrikam` и имя пакета **VSPackage** значение `FabrikamMenuCommands` . Нажмите кнопку **Далее**.  
  
3. На следующей странице выберите **команду меню** , а затем нажмите кнопку **Далее**.  
  
4. На следующей странице задайте для параметра **имя команды** значение `Fabrikam Command` и **идентификатор команды** `cmdidFabrikamCommand` , а затем нажмите кнопку **Далее**.  
  
5. На странице **Выбор параметров тестового проекта** очистите параметры тестирования, а затем нажмите кнопку **Готово** .  
  
6. В проекте Шеллекстенсионсвсикс откройте файл Source. extension. vsixmanifest.  
  
     Раздел **Assets** должен содержать запись для проекта Всшеллстуб. абаутбокспаккаже.  
  
7. Нажмите кнопку **создать** .  
  
8. В окне **Добавление нового актива** в списке **Тип** выберите **Microsoft. VisualStudio. VSPackage**.  
  
9. В списке **источник** убедитесь, что выбран **проект в текущем решении** . В списке **проект** выберите **менукоммандспаккаже**.  
  
10. Сохраните и закройте файл.  
  
11. Перестройте решение и начните отладку изолированной оболочки.  
  
12. В строке меню последовательно выберите пункты меню **Сервис** и **Fabrikam команда**.  
  
     Должно отобразиться окно сообщения.  
  
13. Останавливает отладку приложения.  
  
## <a name="adding-a-mef-component-part"></a>Добавление части компонента MEF  
 Ниже показано, как добавить часть компонента MEF в приложение изолированной оболочки.  
  
#### <a name="to-add-a-mef-component"></a>Добавление компонента MEF  
  
1. В диалоговом окне **Добавление нового проекта** в разделе **Visual C#** выберите **расширяемость**и добавьте проект с помощью шаблона **поля редактора** . Назовите его `ShellEditorMargin`.  
  
2. В проекте Шеллекстенсионсвсикс откройте файл Source. extension. vsixmanifest в представление конструирования, а не в представлении кода.  
  
3. В `Asset` разделе Выберите **Добавить содержимое**.  
  
4. В окне **Добавление нового актива** в списке **Тип** выберите **Microsoft. VisualStudio. MefComponent**.  
  
5. В списке **источник** убедитесь, что выбран **проект в текущем решении** . В списке **проект** выберите **шелледитормаргин**.  
  
6. Сохраните и закройте файл.  
  
7. Перестройте решение и начните отладку изолированной оболочки.  
  
8. Откройте текстовый файл.  
  
     Зеленое поле, содержащее слова "Hello World!" должен отображаться в нижней части окна текстового файла.  
  
9. Останавливает отладку приложения.  
  
## <a name="adding-a-generic-vsix-project"></a>Добавление универсального проекта VSIX  
  
#### <a name="to-add-a-generic-vsix-project"></a>Добавление универсального проекта VSIX  
  
1. В диалоговом окне **Добавление нового проекта** в разделе **Visual C#**, **расширяемость**, используйте шаблон **всикспрожект** для добавления проекта. Назовите его `EmptyVSIX`.  
  
2. В проекте Шеллекстенсионсвсикс откройте файл Source. Extensions. vsixmanifest в представление конструирования, а не в представлении кода.  
  
3. В `Assets` разделе Выберите **создать**.  
  
4. В окне **Добавление нового актива** в списке **тип** выберите добавляемый тип содержимого.  
  
5. В поле **источник**убедитесь, что выбран параметр **проект в текущем решении** . В списке выберите имя проекта VSIX.  
  
6. Сохраните и закройте файл.  
  
7. Если этот проект содержит скомпилированный код, необходимо изменить проект, чтобы сборка включалась в выходные данные.  
  
    1. Выгрузите проект VSIX и откройте файл проекта.  
  
    2. В первом `<PropertyGroup>` блоке измените значение `<CopyBuildOutputToOutputDirectory>` на `true` .  
  
    3. Сохраните и перезагрузите проект.  
  
8. Выполните сборку и запуск решения.  
  
## <a name="see-also"></a>См. также:  
 [Пошаговое руководство. Создание базового приложения изолированной оболочки](../extensibility/walkthrough-creating-a-basic-isolated-shell-application.md)
