---
title: Текст и справка пользовательского интерфейса
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
ms.assetid: e8747d07-6c90-46cc-b425-55b589f7e9e4
caps.latest.revision: 3
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: ea4f2b49838340fcee41bc9c41ef94558e44825e
ms.sourcegitcommit: 95f26af1da51d4c83ae78adcb7372b32364d8a2b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79301245"
---
# <a name="ui-text-and-help-for-visual-studio"></a>Текст пользовательского интерфейса и справки для Visual Studio
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

## <a name="ui-text-and-terminology"></a><a name="BKMK_UITextAndTerminology"></a>Текст и терминология uI
 Понятный текст имеет решающее значение для эффективного uI. Пользователи программного обеспечения, как правило, читают метки во-первых, а именно те, которые наиболее актуальны для выполнения поставленной задачи. Статический текст считывается с меньшей частотой. Планируйте для пользователей, чтобы начать свои рабочие сессии с быстрого сканирования всего окна, а затем чтение пользовательского пользовательского или того, в этом приблизительном порядке:

1. Интерактивные элементы управления в центре

2. Кнопки фиксации

3. Интерактивные элементы управления, найденные в другом месте

4. Основные инструкции

5. Дополнительные объяснения

6. Название окна

7. Другой статический текст в основном теле

### <a name="usage-patterns-for-ui-text"></a>Шаблоны использования для текста uI

#### <a name="title-bar-text"></a>Текст в заголовке
 Текст раздела бар должен соответствовать команде, которая породила uI.

#### <a name="instructional-text-helper-text"></a>Учебный текст (текст помощника)
 В некоторых диалогах полезно предоставить важные основные инструкции, объясняющие, что делать в окне или на странице. Иногда это называют «текстом помощника».

##### <a name="writing-style-rules-for-helper-text"></a>Правила написания стиля для текста-помощника

- Не объясняй очевидного. Если это абсолютно необходимо, не включайте учебный текст.

- Учебный текст всегда находится в верхней части диалога и должен относиться к выполняемой задаче.

- Точно объясните пользователям, что им нужно сделать. Избегайте чрезмерной коммуникации и избыточности.

- Просмотрите каждое окно и удалите дубликаты слов и заявлений.

- Держите учебный текст коротким. Если для определенных пользователей или сценариев необходима дополнительная информация, предоставьте ссылку на подробную концептуальную онлайн-тему.

- Напишите текст так, чтобы каждое слово присебено и необходимо.

- Следуйте существующим рекомендациям Корпорации Майкрософт для [текста пользовательского интерфейса](https://msdn.microsoft.com/library/windows/desktop/dn742478\(v=vs.85\).aspx) и [стиля и тона](https://msdn.microsoft.com/library/windows/desktop/dn742477\(v=vs.85\).aspx).

#### <a name="supplemental-instructions"></a>Дополнительные инструкции
 Дополнительные инструкции предоставляют дополнительную информацию, которая помогает пользователю понять элементы управления или группирования элементов управления. Это также может включать текст подсказки, необходимый для понимания того, какой формат ожидает элемент управления входного ввода. Используйте дополнительные инструкции экономно. Зарезервируйте их на случай, когда пользователь, скорее всего, не до конца поймет последствия выбора, который он делает.

 ![Пояснительный текст в Visual Studio](../../extensibility/ux-guidelines/media/0601-b-supplementaltext1.png "0601-b_SupplementalText1")

 **Пояснительный текст в Visual Studio**

 ![Пояснительный текст в Visual Studio](../../extensibility/ux-guidelines/media/0601-c-supplementaltext2.png "0601-c_SupplementalText2")

 **Пояснительный текст в Visual Studio**

#### <a name="infotips"></a>InfoTips
 Часто учебный текст может быть слишком длинным, чтобы позиционировать сяврявку в пользовательской области, или может быть полезен только новым пользователям, чувствуя себя беспорядочным для опытных пользователей. В этом случае учебный/информационный текст должен быть размещен в качестве инструмента под InfoTip.

 InfoTips должны быть размещены рядом с элементами управления, с которыми они связаны, и должны использовать определенный значок InfoTip, который является ненавязчивым, но заметным.

 ![Подсказка в Visual Studio](../../extensibility/ux-guidelines/media/0601-d-infotip.png "0601-d_InfoTip")

 **Пример InfoTip в визуальной студии**

##### <a name="writing-style-rules-for-infotips"></a>Написание правил стиля для InfoTips

- Напишите InfoTips как полные предложения. Они требуют конкретных глаголов, случае вынесения приговора и прекращения пунктуации.

- Используйте InfoTips в дополнение к вашей основной инструкции или информации. Если вы просто используете разные слова, чтобы пересмотреть основную идею, вам не нужен InfoTip.

- Держите InfoTips коротким и сладким. Используйте маленькие слова и простой, повседневный язык, который поддерживает и поощряет пользователя.

- Следуйте существующим рекомендациям Корпорации Майкрософт для [текста пользовательского интерфейса](https://msdn.microsoft.com/library/windows/desktop/dn742478\(v=vs.85\).aspx) и [стиля и тона](https://msdn.microsoft.com/library/windows/desktop/dn742477\(v=vs.85\).aspx).

#### <a name="control-labels"></a>Контрольные метки
 Метки управления должны быть короткими, краткими и следовать [рекомендациям Windows Desktop для управления.](https://msdn.microsoft.com/library/windows/desktop/dn742399\(v=vs.85\).aspx)

 Для получения дополнительной информации о формате этикетки управления и размещении в рамках uI, обратитесь к [Layout для Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md).

#### <a name="help-links"></a>Ссылки на справку
 Ссылки на справки могут быть размещены в учебном тексте или в корпусе uI. Они могут быть ссылками для справки или запуска внутренних диалогов.

##### <a name="visual-style-rules-for-help-links"></a>Правила визуального стиля для ссылок справки

- Используйте правильные цвета среды для гиперссылок. Правильно стиле гиперссылки не будет кратко вспышки красного при нажатии. Если вы видите это, то это признак того, что цвета среды не используются.

- Подчеркивания должны использоваться только на нависке или при встраивании ссылки в абзац.

- Для получения более подробной информации о визуальных стилях и стилях взаимодействия для гиперссылок см.

##### <a name="writing-style-rules-for-help-links"></a>Написание правил стиля для ссылок справки

- При запуске диалогов, поддерживать стандарты для эллипсов: нет эллипсис для навигации, эллипсы, если задача требует дополнительного uI.

     ![Ссылка на справку в Visual Studio](../../extensibility/ux-guidelines/media/0601-e-helplink.png "0601-e_HelpLink")

     **Эллипсис (...) в ссылке справки указывает на задачу потребует дополнительного uI.**

- Ссылки не должны начинаться с "Учиться", так как это не является намерением пользователя. Пользователь хочет ответить на конкретный вопрос, а не получить общее образование.

- Фраза помочь ссылки, чтобы они задают вопрос, что тема будет отвечать.

     Неправильно: "Узнайте больше о ценах на мобильные услуги Windows Azure"

     Правильно: "Какие варианты ценообразования доступны для мобильных служб Windows Azure?"

- Никогда не используйте *Нажмите...* к тексту ссылки.

- Никогда не связывайте только слово "здесь". Это проблематично для некоторых читателей экрана, которые будут озвучивать только гиперссылки слово.

     Неправильно: "Найти информацию о Windows Azure Мобильные услуги **здесь**"

     Правильно: "Какие варианты ценообразования доступны для мобильных служб Windows Azure?"

- Для получения дополнительной информации о правильном стиле [Windows Desktop guidance for Help](https://msdn.microsoft.com/library/windows/desktop/dn742494\(v=vs.85\).aspx)записи для ссылок справки см.

#### <a name="hint-text"></a>Подсказка текст
 Подсказка текст появляется как водяной знак в элементе управления или ниже элемента управления. Правильное форматирование будет применено с помощью `Environment.GrayText`соответствующего токена VSColors.

 Он может появиться в нескольких формах.

- Вместо метки управления:

     ![Текст подсказки в Visual Studio](../../extensibility/ux-guidelines/media/0601-f-hinttext1.png "0601-f_HintText1")

- С глаголом, давая инструкции:

     ![Текст подсказки в Visual Studio](../../extensibility/ux-guidelines/media/0601-g-hinttext2.png "0601-g_HintText2")

- С текстом, указывающим на требуемую запись:

     ![Текст подсказки в Visual Studio](../../extensibility/ux-guidelines/media/0601-h-hinttext3.png "0601-h_HintText3")

#### <a name="watermark-text"></a>Текст водяного знака
 На пустой поверхности дизайна текст должен указывать, что делать, а также предоставлять ссылки для открытия других связанных окон, если это необходимо:

 ![Текст водяного знака в Visual Studio](../../extensibility/ux-guidelines/media/0601-i-watermarktext.png "0601-i_WatermarkText")

 **Пример текста водяного знака в Visual Studio**

### <a name="common-terminology"></a>Общая терминология

|Термин|Объяснение|Комментарий|
|----------|-----------------|-------------|
|Войти в систему / Войти|Глаголы использовали синонимы Интернета для представления аутентификации в веб-свойстве. В клиентских клиентах мы используем это раз как понятие верхнего уровня для входного подключения iDE и выхода из нее, которое представляет собой идентификатор верхнего уровня, обеспечивающий возможности более высокого уровня, такие как роуминг и лицензирование, которые не доступны со всеми другими соединениями.|Пользователь IDE является единственной функцией, которая должна представлять знак в / выйти глагол, так как он представляет верхнего уровня IDE пользователя.|
|Подключение / Отключение|Используйте в местах, где функция поддерживает одно подключение к онлайн-сервису.|Server Explorer, где можно иметь только одно активное соединение Azure одновременно, является примером Connect/Disconnect.|
|Добавить / Удалить|Неразрушающий. Используйте при добавлении или удалении чего-либо из списка.|Диалог списка серверов tFS Connection Manager является примером добавления/удаления.|
|DELETE|Разрушительной. Используйте только тогда, когда удаленный элемент будет навсегда удален или удален с диска.|"Удалить" обычно требуется запрос, если результат удаляет файл с диска.|

## <a name="error-messages"></a>Сообщения об ошибках

### <a name="overview"></a>Обзор
 Ошибки случаются. Установка ограничений на то, что пользователь может сделать, является разумным первым шагом в предотвращении предотвратимых сообщений об ошибках. Однако, когда ошибка действительно происходит, хорошо написанное сообщение об ошибке может иметь большое значение для смягчения проблемы. Сообщения об ошибках, возможно, являются одним из наиболее важных типов уведомлений, которые видит пользователь, поскольку они синхронны и указывают на проблему, которую необходимо решить. Плохо написанные сообщения об ошибках оставляют пользователей сами решать причину ошибок и любых возможных решений.

 Пользователи могут перестать обращать внимание на чрезмерно используемые или запутанные сообщения об ошибках, поэтому напишите только необходимые сообщения, которые повышают ценность пользовательского интерфейса. Если сообщение является просто уведомлением, используйте альтернативную презентацию.

### <a name="rules-for-creating-an-error-message"></a>Правила создания сообщения об ошибке

- При построении сообщений об ошибках выберите подходящий уровень ошибки для аудитории. Цель для простых резюме, которые обеспечивают действия пользователь может предпринять, если это применимо. Не заявляйте ничего, что пользователь не должен знать.

- Оказание конструктивной помощи. Легче читать и действовать на сообщение об ошибке, содержащее инструкцию.

- Не используйте двойные негативы.

- Выполните как автоматизированную, так и ручную грамматику и проверку правописания на любом сообщении об ошибке, которое вы пишете.

- При сложных сообщениях об ошибках избегайте последовательных сообщений. Никогда не используйте подключение F1 для сообщения об ошибке. Само сообщение должно быть достаточным.

- Используйте правильный значок.

- Упрощайте понимание и использование кнопок, которые имеют четкий выбор, такие как "Удалить" и "Отменить".

- Для предупреждений, четко о том, что последствия разбирательства будет. Кнопки должны указывать последствия.

- Для ошибок опишите, что пользователь может сделать, чтобы исправить проблему. Кнопки должны быть действия или сказать "Закрыть". Не используйте кнопку "OK" для сообщения об ошибке.

- Некоторые вопросы, которые нужно задать себе при построении сообщения об ошибке:

  - Может ли пользователь выяснить, как решить проблему с этой ошибкой в одиночку?

  - Использует ли пользователь тот же словарный запас, что и эта ошибка?

  - Является ли эта ошибка необыдательна или распространена в нескольких ситуациях? Если да, то как вы направляете пользователей к решению, в ней нуждается?

#### <a name="build-errors"></a>Ошибки сборки
 Поскольку Visual Studio является инструментом разработки программного обеспечения, многие из ее компонентов имеют компиляцию, преобразование или кодирование для преобразования работы разработчика в двоичную форму. Эти преобразования могут привести к ошибкам, когда компилятор не может обрабатывать неправильно авторированные файлы или когда параметры компилятора не были настроены правильно.

 Пользователи Visual Studio могут тратить огромное количество часов разработки на устранение ошибок сборки. Время разрешения увеличивается, когда ошибки имеют зависимости или когда сообщения об ошибках плохо написаны, что может затруднить обнаружение источника ошибки.

 Лучшие ошибки сборки являются те, которые не происходят в первую очередь, поэтому Visual Studio предоставляет AutoComplete и IntelliSense squiggles. Валидаторы схемы и подобные инструменты обеспечивают такую же обратную связь. Эти механизмы активно направляют пользователя к построению хорошо сформированного кода, что уменьшает вероятность ошибок сборки.

 Visual Studio предоставляет окно инструментов, где пользователи могут читать и перемещаться по ошибкам, которые произошли в окнах документов. Клавиатура ярлыки предоставляются так, что пользователь может быстро перемещаться большие объемы кода и перейти непосредственно к месту проблемы. Visual Studio также позволяет привязать ошибку сборки к конкретному идентификатору ключевого слова/контексту, чтобы пользователь мог перейти непосредственно к теме справки, которая дает более подробную информацию об ошибке.

 Напишите четкие, краткие ошибки сборки:

- **Используйте простой язык,** который объясняет проблему практически без жаргона компилятора. Текст ошибки сборки не должен быть слишком техническим.

- **Очертить возможные причины.** Например, "Отсутствует толстой кишки между имуществом и значением в '(имущество) : (значение)' декларации ".

- Предоставьте подробную информацию о возможных исправлениях. Если места не хватает, то дополнительные детали могут быть помещены в соответствующую тему справки.

### <a name="components-of-a-well-written-error-message"></a>Компоненты хорошо написанного сообщения об ошибке

#### <a name="use-the-shell-dialog-service-for-error-messages"></a>Используйте службу диалога оболочки для сообщений об ошибках.
 Использование службы диалога оболочки позволяет контролировать внешний вид сообщения - шрифты, в частности - без серьезных изменений в отдельных элементах. Используйте механизмы **IErrorInfo** и сообщаем о них с помощью **IVsUIShell::SetErrorInfo/ReportErrorInfo**.

#### <a name="choose-an-effective-and-appropriate-notification-presentation"></a>Выберите эффективное и соответствующее представление уведомлений.
 Используйте модальный диалог с критическим предупреждением, если необходимы незамедлительные действия, чтобы избежать потери данных (синхронное уведомление). Критические значки зарезервированы для ситуаций, в которых закрытие сообщения без чтения может привести к негативным последствиям. Потеря данных является критической ситуацией, которая требует реагирования на сигнал тревоги. Чрезмерное использование критического значка десенсибилизирует пользователей к его важности. Если сообщение об ошибке является информационным по своему характеру, рассмотрите альтернативы модального диалогу (асинхронное уведомление).

#### <a name="provide-a-clean-succinct-explanation-of-why-the-problem-occurred-rather-than-a-technical-explanation"></a>Предоставьте чистое и краткое объяснение причин возникновения проблемы, а не техническое объяснение.
 Перегрузка пользователей техническими деталями в объяснении сделает их более склонными игнорировать сообщения об ошибках. Примеры хорошего обмена сообщениями:

- "Не удается открыть запрошенный файл."

- "Не удается подключиться к Интернету."

#### <a name="provide-information-about-how-to-fix-the-problem"></a>Предоставьте информацию о том, как решить проблему.
 Предложите пользователю предложения о том, как решить проблему. Будьте честны с пользователем, если нет предложений. Предоставление прямых ссылок на альтернативные онлайн-источники, такие как техническая поддержка или поддержка сообщества. Попробуйте указать пользователям на конкретную онлайн-информацию, относяэту к проблеме. Для идентификатора ошибки рассмотрите возможность привязки пользователей к обсуждению этой конкретной ошибки. Примеры хорошего обмена сообщениями:

- "Убедитесь, что вы подключены к Интернету и попробуйте эту операцию еще раз."

- "Убедитесь, что файл существует и что у вас есть разрешение на его открытие".

#### <a name="write-a-message-that-is-short-and-to-the-point"></a>Напишите короткое и по существу сообщение.
 Сообщение об ошибке может уведомлять, объяснять и предлагать решение, но все равно быть проигнорировано, если оно слишком многословно. Одним из решений является использование прогрессивного раскрытия информации с кнопкой детализации. Например, дайте краткое описание / решение, а затем положить более подробную информацию под кнопку детали. Если пользователи решили прочитать больше информации об ошибке, они могут сделать это.

 Язык в сообщении должен быть:

- **Домен-соответствующий.** Используйте язык, который поймет пользователь. Несмотря на то, что наши клиенты являются разработчиками, они часто не имеют контекста и терминологии у нас есть.

- **Конкретных.** Избегайте расплывчатых формулировок и дайте конкретные названия и местоположения объектов. Например, сообщение об ошибке, такое как "символ недействителен", не полезно. Какой персонаж? "Файл не найден." Какой файл?

- **Вежливый.** Не вините пользователя или заставить их чувствовать себя глупо. Избегайте враждебных или оскорбительных выражений (убить, казнить, прекратить, фатально, незаконно). Избегайте верхнего текста, который часто рассматривается как крик и не так читаем. Не используй юмор.

- **Правильно.** Используйте правильное правописание и грамматику (даже в альфа). Типы непрофессиональны и смущают.

- **Контекстуально уместно.** Используйте соответствующий текст кнопки. Избегайте кнопки "OK" и вместо этого используйте "Продолжить" или "Да / Нет".

### <a name="error-message-examples"></a>Примеры сообщений об ошибке

|Хорошая.|Плохое|
|----------|---------|
|"Номер, который вы набрали больше не в эксплуатации. Пожалуйста, проверьте номер и наберите еще раз или наберите 0 для оператора ".|- "Ошибка (449): Незаконный номер"<br />- "Эта ошибка необработанного исключения указывает на то, что операция завершена успешно."<br /><br /> ![Сообщение об ошибке в Visual Studio](../../extensibility/ux-guidelines/media/0602-a-errordialog.png "0602-a_ErrorDialog")|

## <a name="accessing-help"></a>Получение доступа к справке

### <a name="overview"></a>Обзор
 В дополнение к документации в MSDN, пользователь Visual Studio имеет несколько точек доступа, чтобы помочь пользователю в то время как в пользовательском интерфейсе. Для обеспечения того, чтобы эти точки доступа были постоянно доступны, группы функций должны воспользоваться системой справки, предлагаемой средой. Эти точки доступа:

- **Учебный и дополнительный текст в диалогах.** Статический текст, дающий направление или объяснение, либо на поверхности uI, либо доступнына на нависении над значком InfoTip.

- **Справка F1** (только редактор). В редакторе Visual Studio пользователь может поверить, что в любое время, нажав на F1, будет поднимать тему справки, специфичную для текущего выбора. Убедитесь, что темы, связанные с F1, являются уместными и информативными.

- **Гиперссылки, чтобы помочь темы.** Гиперссылка в диалоге, окне инструмента или дизайн поверхности, которая запускает тему, чтобы помочь пользователю в получении дополнительной информации о технологии, возможности, или информацию о том, как выполнить задачу.

- **Механизмы uI-приложения helper, такие как интеллектуальные теги и диалоги по созданию.** Эти механизмы помогают пользователю понять элемент пользовательского интерфейса или облегчить задачу, такую как смарт-теги или диалоги строителей.

- **Кнопки помощи uI** (унипраженные). Видимый индикатор в заглавной панели, который дает доступ к соответствующей теме Справки F1.

### <a name="text"></a>текст

#### <a name="instructional-and-supplemental-text-in-dialogs"></a>Учебный и дополнительный текст в диалогах
 В диалогах, поддерживающих сложные задачи, может возникнуть необходимость в предоставлении учебного текста в рамках uI, часто в верхней части диалога или вблизи сложных элементов управления. Подробную информацию о стиле написания можно узнать из [текста и терминологии UI.](../../extensibility/ux-guidelines/ui-text-and-help-for-visual-studio.md#BKMK_UITextAndTerminology)

#### <a name="infotips"></a>InfoTips
 Часто учебный текст может быть слишком длинным, чтобы позиционировать сявря в пользовательской области или может быть полезен только новым пользователям, чувствуя себя беспорядочным для опытных пользователей. В этом случае учебный/информационный текст должен быть размещен в качестве инструмента под InfoTip.

 InfoTips должны быть размещены рядом с элементами управления, с которыми они связаны, и должны использовать определенный значок InfoTip, который является ненавязчивым, но заметным.

 ![Подсказка в Visual Studio](../../extensibility/ux-guidelines/media/0601-d-infotip.png "0601-d_InfoTip")

 **Пример InfoTip в визуальной студии**

### <a name="interactive-help-mechanisms"></a>Механизмы интерактивной справки

#### <a name="f1-help"></a>справка F1
 Справка F1 требуется в пределах поверхности редактора или дизайна, но не в других местах в среде Visual Studio.

#### <a name="hyperlinks-to-help-topics"></a>Гиперссылки, чтобы помочь темы
 Гиперссылки могут использоваться для выполнения действия, навигации в рамках IDE или запуска Справки в браузере. Подробнее о языке и кнопках 07.10.01 и гиперссылках для визуальных и плановых инструкций читайте в [материале](../../extensibility/ux-guidelines/ui-text-and-help-for-visual-studio.md#BKMK_UITextAndTerminology) «Руководство по визуальным и макетным технологиям».

#### <a name="help--buttons-in-dialog-title-bars-deprecated"></a>Кнопки справки «Помощь» в барах заголовков диалогов (унипраженные)
 По большей части, кнопки Справка «Помощь»? Темы uI больше не являются частью нашей модели документов, и поэтому может не быть актуальной темы для ссылки. По сути, кнопка заголовка бар был то же самое, что F1 Помощь, и это больше не требуется в диалогах. В некоторых случаях это все еще может быть использовано в качестве индикатора наличия более концептуальной или процедурной информации, хотя гиперссылки чаще используются в более новых uI.

##### <a name="dialogs-created-through-the-environment"></a>Диалоги, созданные через окружающую среду
 Многие диалоги оболочки создаются с помощью функции **VBDialogBoxParam.** Эта общая функция была обновлена, чтобы помочь в перемещении кнопки **справки** из диалога **в?** кнопка при сохранении архитектуры, которая является обратной совместимой и расширяемой.

 В частности, функция **VBDialogBoxParam** смотрит на шаблон диалога для кнопки, идентификатор которой **IDHELP** (9) или этикетка **Справка** или **&Помощь.** Если найдена кнопка справки, она скрыта и **WS_EX_CONTEXTHELP** стиль добавляется в диалог, который **помещает?** кнопка в заголовке диалога.

 Когда диалог создается, он толкает диалог proc на стек и вызывает диалог с предварительной обработкой диалог proc под названием **DialogPreProc.** Когда **?** кнопка нажата, она отправляет **WM_SYSCOMMAND** **SC_CONTEXTHELP** в диалог. **DialogProProc** фиксирует эту команду и изменяет ее на **WM_HELP** сообщение, которое передается исходной диалоговой proc.

 В большинстве созданных сред диалогов есть кнопка справки в диалоге. При отображении диалога кнопка справки автоматически скрыта и только **кнопка ?** кнопка работает. Если? **?** кнопка когда-либо удаляется или изменяется в Windows, это решение позволяет быстро вернуться к исходным кнопкам справки.

 Это решение делает четыре предположения, которые могут вызвать ошибки:

- Кнопка помощи диалога — **IDHELP** (9).

- Диалог выглядит правильно, когда кнопка справки скрыта.

- Диалог не заменяет его winproc.

- Диалог не встроен в другой диалог.

  Если ваш диалог находится в пределах msenv и не использует **VBDialogBoxParam,** исследуйте использование **VBDialogBoxParam** перед реализацией собственного обработчика.

##### <a name="dialogs-created-through-other-packages"></a>Диалоги, созданные с помощью других пакетов
 Вы можете реализовать свое собственное решение для диалогов, которые находятся за пределами msenv. Для общего класса диалога в VSPackage рассмотрите возможность перемещения кнопки в заглавный бар или реализации обработчика в каждом диалоге. Следующий код представляет собой скелет реализации, которая поможет вам начать работу:

```
struct DLGPROCITEM
{
    FARPROC proc; // The info used to create the dialog.
    DLGPROCITEM* procPrev;
};

DLGPROCITEM* g_dlgProcStack = NULL;

// A dialog starter/wrapper function is used to push the new
// dialog proc to the top of our dialog proc stack.

int SomeDialogStarterFunction(hinst, id, proc, etc)
{
    if (g_dlgProcStack == NULL)
    {
        g_dlgProcStack = new DLGPROCITEM;
        g_dlgProcStack->procPrev = NULL;
    }
    else
    {
        DLGPROCITEM* procItem = new DLGPROCITEM;
        g_dlgProcStack->procPrev = g_dlgProcStack;
        g_dlgProcStack = procItem;
    }
}

// Pop this dialog proc off the dialog proc stack.

DialogBoxIndirectParam...(...)
{
    DLGPROCITEM* procItem = g_dlgProcStack->procPrev;
    delete g_dlgProcStack;
    g_dlgProcStack = procItem;
}

// A wrapper dialog procedure will allow us to capture the
// SC_CONTEXTHELP button on the title bar from Windows and
// forward it as a simple WM_HELP message back to the dialog.

INT_PTR CALLBACK DialogPreProc(HWND hwndDlg, UINT uMsg,
    WPARAM wParam, LPARAM lParam)
{
    if (uMsg == WM_SYSCOMMAND && wParam == SC_CONTEXTHELP)
    {
        uMsg = WM_HELP;
        wParam = 0;
        lParam = 0;
    }
    return CallWindowProc((WNDPROC)g_dlgProcStack->proc,
        hwndDlg, uMsg, wParam, lParam);
}
```

##### <a name="help-buttons-in-managed-code"></a>Кнопки помощи в управляемом коде
 Преодоление поведения кнопки поддержки заголовка окна по умолчанию легко в управляемом коде. Ниже приводится полное демо-приложение, которое демонстрирует такое поведение. В сущности, вам нужно переопределить метод **WndProc** вашей формы, а затем отстрелить запросы помощи F1 при перехвате **SC_CONTEXTHELP** сообщения.

```
using System;
using System.Windows.Forms;

public class HelpForm : Form
{
    private const int SC_CONTEXTHELP = 0xF180;
    private const int WM_SYSCOMMAND = 0x0112;

    public HelpForm()
    {
        this.ClientSize = new System.Drawing.Size(300, 250);
        this.HelpButton = true;
        this.MaximizeBox = false;
        this.MinimizeBox = false;
        this.Name = "HelpForm";
        this.Text = "Help Form";
    }

    protected override void WndProc(ref Message m)
    {
        if (m.Msg == WM_SYSCOMMAND && SC_CONTEXTHELP == (int)m.WParam)
            ShowHelp();
        else
            base.WndProc(ref m);
    }

    private void ShowHelp()
    {
        MessageBox.Show("F1 Help goes here.");
    }

     [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.EnableRTLMirroring();
        Application.Run(new HelpForm());
    }
}
```

## <a name="see-also"></a>См. также:
 [Шрифты и форматирование для визуальной студии](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md) [Layout для визуальных](../../extensibility/ux-guidelines/layout-for-visual-studio.md) [уведомлений студии и прогресс для визуальной студии](../../extensibility/ux-guidelines/notifications-and-progress-for-visual-studio.md)
