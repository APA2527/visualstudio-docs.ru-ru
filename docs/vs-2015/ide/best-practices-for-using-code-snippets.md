---
title: Рекомендации по использованию фрагментов кода | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-general
ms.topic: conceptual
helpviewer_keywords:
- code snippets, best practices
- code snippets, security
ms.assetid: a293ec17-4dd7-4a99-8eeb-99f44a822a8b
caps.latest.revision: 26
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: 75c1e08125e67dc5a76d2e62d22f010abd22f418
ms.sourcegitcommit: 75807551ea14c5a37aa07dd93a170b02fc67bc8c
ms.translationtype: MTE95
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2019
ms.locfileid: "67823433"
---
# <a name="best-practices-for-using-code-snippets"></a>Рекомендации по использованию фрагментов кода
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Код во фрагменте показывает лишь самый общий способ выполнения некоторой задачи. Для большинства приложений этот код следует изменить в соответствии с конкретными потребностями.  
  
## <a name="handling-exceptions"></a>Обработка исключений  
 Обычно блоки Try…Catch фрагмента кода перехватывают и передают все исключения. Это может оказаться ненужным для вашего проекта. Для каждого исключения имеется несколько способов реагирования. Примеры см. в разделах [Практическое руководство. Обработка исключений с помощью блока try-catch (руководство по программированию на C#)](https://msdn.microsoft.com/library/ca8e3773-980e-4767-8633-7408540e9818) и [Оператор Try...Catch...Finally](https://msdn.microsoft.com/library/d6488026-ccb3-42b8-a810-0d97b9d6472b).  
  
## <a name="file-locations"></a>Расположения файлов  
 Настраивая расположения файлов под приложения, нужно обдумать следующее:  
  
- Поиск доступного места. У пользователей может не быть доступа к папке "Program Files" на компьютере, поэтому хранение файлов вместе с файлами приложения может оказаться невозможным.  
  
- Поиск безопасного расположения. Хранение файлов в корневой папке (C:\\) не является безопасным. Для данных приложения рекомендуем использовать папку \Application Data. Для хранения данных отдельных пользователей приложение может создать файл для каждого из них в папке \My Documents.  
  
- Использование допустимого имени. Элементы управления <xref:System.Windows.Forms.OpenFileDialog> и <xref:System.Windows.Forms.SaveFileDialog> можно использовать для снижения вероятности возникновения недопустимых имен файлов. Имейте в виду, что в перерыве между тем временем, когда пользователь выбирает файл, и тем, когда код обрабатывает файл, этот файл может быть удален. Кроме того, у пользователя может не быть достаточных разрешений для записи в файл.  
  
## <a name="security"></a>Безопасность  
 То, насколько безопасен фрагмент кода, зависит от места его использования в исходном коде и изменения после добавления в код. Следующий список содержит несколько областей, которые необходимо учитывать.  
  
- Доступ к файлам и базы данных  
  
- Управление доступом для кода  
  
- Защита ресурсов (таких как журналы событий, реестр)  
  
- Хранение секретов  
  
- Проверка входных данных  
  
- Передача данных в технологии создания скриптов  
  
  Дополнительные сведения см. в разделе [Защита приложений](../ide/securing-applications.md).  
  
## <a name="downloaded-code-snippets"></a>Скачанные фрагменты кода  
 Сами по себе фрагменты кода IntelliSense, установленные Visual Studio, не представляют угрозу для безопасности. Однако они могут создавать такую угрозу в приложении. К фрагментам кода, скачанным из Интернета, следует относиться так же, как и к любому скачанному содержимому — с особой осторожностью.  
  
- Скачивайте фрагменты только с сайтов, которым вы доверяете, и используйте новейшее антивирусное программное обеспечение.  
  
- Откройте все скачанные файлы фрагментов кода в Блокноте или редакторе XML Visual Studio и внимательно проверьте их перед установкой. Ищите следующие проблемы:  
  
  - Фрагмент кода может повредить систему при его выполнении. Внимательно прочитайте исходный код перед его запуском.  

  - Справочный блок с URL-адресами в файле фрагмента может содержать URL-адреса, выполняющие вредоносный файл скрипта или отображающие нежелательный веб-сайт.  

  - Фрагмент может содержать ссылки, которые автоматически добавляются в проект и могут быть загружены из любой точки в системе. Эти ссылки могли быть скачаны на ваш компьютер оттуда же, откуда и сам фрагмент кода. Фрагмент может вызвать метод по ссылке, который выполняет вредоносный код. Для защиты от таких атак просмотрите блоки импорта и ссылок в файле фрагмента кода.  
  
## <a name="see-also"></a>См. также  
 [Фрагменты кода IntelliSense в Visual Basic](https://msdn.microsoft.com/library/ffdde4c9-8141-4906-b09b-15181357a643)   
 [Защита приложений](../ide/securing-applications.md)   
 [Фрагменты кода](../ide/code-snippets.md)
