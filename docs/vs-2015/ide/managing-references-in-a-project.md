---
title: Управление ссылками в проекте | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-general
ms.topic: conceptual
f1_keywords:
- vs.ProjectPropertiesReferencePaths
- cs.ProjectPropertiesReferencePaths
helpviewer_keywords:
- Visual C# projects, references
- referencing objects, project references
- external component references
- referencing namespaces
- Visual Basic projects, references
- referencing components, external components
- Web references, types of project references
- namespaces [Visual Studio], referencing
- COM components, referencing
- objects [Visual Studio], referencing
ms.assetid: 05d1c51b-44f3-4973-8a11-6c919b08ad62
caps.latest.revision: 55
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: e4ac17ba5bc828e7974ced9519728aa5de15db94
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: MTE95
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63424542"
---
# <a name="managing-references-in-a-project"></a>Управление ссылками в проекте
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Перед написанием кода для внешних компонентов или подключенных служб необходимо включить в проект ссылки на них. По сути, ссылка — это запись в файле проекта, которая содержит сведения, необходимые Visual Studio для поиска компонента или службы.  
  
 Чтобы добавить ссылку, в обозревателе решений щелкните правой кнопкой мыши узел «Ссылки» и выберите команду **Добавить ссылку**. Для получения дополнительной информации см. [Практическое руководство. Добавление и удаление ссылок с помощью диспетчера ссылок](../ide/how-to-add-or-remove-references-by-using-the-reference-manager.md).  
  
 ![Добавление ссылки в Visual C&#43;&#43;](../ide/media/vs2015-cpp-add-reference.png "vs2015_cpp_add_reference")  
  
 Вы можете создать ссылку на следующие типы компонентов или служб:  
  
- ссылки на приложение Магазина Windows;  
  
- библиотеки классов или сборки .NET Framework;  
  
- компоненты COM  
  
- другие сборки или библиотеки классов проектов в том же решении;  
  
- веб-службы XML  
  
## <a name="windows-store-app-references"></a>ссылки на приложение Магазина Windows;  
  
### <a name="project-references"></a>Ссылки проекта  
 Проекты универсальной платформы Windows (UWP), предназначенные для Windows 10, могут создавать ссылки на другие проекты UWP в решении либо на двоичные файлы или проекты Магазина Windows, ориентированные на [!INCLUDE[win81](../includes/win81-md.md)], при условии, что эти проекты не используют интерфейсы API, которые являются устаревшими в Windows 10. Более подробную информацию см. в разделе [Перенос приложения из среды выполнения Windows 8 в UWP](https://msdn.microsoft.com/library/windows/apps/dn954974.aspx).  
  
 Если вы решили переориентировать проекты [!INCLUDE[win81](../includes/win81-md.md)] на Windows 10, см. раздел [Перенос, миграция и обновление проектов Visual Studio](../porting/porting-migrating-and-upgrading-visual-studio-projects.md)  
  
### <a name="extension-sdk-references"></a>Справочник по пакетам SDK расширений  
 Проекты Visual Basic, C#, C++ и JavaScript Магазина Windows, предназначенные для UWP, могут ссылаться на пакеты SDK расширений, предназначенные для [!INCLUDE[win81](../includes/win81-md.md)], при условии, что эти пакеты SDK расширений не используют API, которые являются устаревшими в Windows 10. Проверьте сайт поставщика пакета SDK расширений, чтобы выяснить, могут ли на него ссылаться проекты Магазина Windows, предназначенные для UWP.  
  
 Если выяснится, что пакет SDK расширений, на который ссылается ваше приложение, не поддерживается, то вы должны выполнить следующие действия.  
  
1. Посмотреть имя проекта, который вызывает ошибку. Платформа, для которой предназначен этот проект, указывается в скобках рядом с именем проекта. Например, **MyProjectName (Windows 8.1)** означает, что проект **MyProjectName** предназначен для платформы [!INCLUDE[win81](../includes/win81-md.md)].  
  
2. Перейдите на сайт поставщика неподдерживаемого пакета SDK расширений и установите версию пакета SDK расширений с зависимостями, совместимыми с версией платформы, для которой предназначен ваш проект.  
  
    > [!NOTE]
    > Чтобы узнать, имеет ли пакет SDK расширений зависимости от других пакетов SDK расширений, перезапустите Visual Studio, создайте новый проект C# Магазина Windows, щелкните правой кнопкой мыши этот проект, выберите **Добавить ссылку**, перейдите на вкладку **Windows** , а затем перейдите на вложенную вкладку **Расширения** , выберите пакет SDK расширений и посмотрите на правую панель в **диспетчере ссылок**. Если этот пакет имеет зависимости, они будут перечислены в этой панели.  
  
    > [!IMPORTANT]
    > Если проект предназначен для Windows 10 и установленный на предыдущем шаге пакет SDK расширений имеет зависимость от пакета среды выполнения Microsoft Visual C++, то совместимой с Windows 10 версией этого пакета является v14.0, которая устанавливается вместе с Visual Studio 2015.  
  
3. Если установленный на предыдущем шаге пакет SDK расширений имеет зависимости от других пакетов SDK расширений, перейдите на сайты поставщиков, являющихся владельцами зависимостей, и установите версии этих зависимостей, совместимые с версией платформы, для которой предназначен ваш проект.  
  
4. Перезапустите Visual Studio и откройте ваше приложение.  
  
5. Щелкните правой кнопкой мыши узел **Ссылки** в проекте, который вызвал ошибку, и выберите **Добавить ссылку**  
  
6. Откройте вкладку **Windows** , а затем вложенную вкладку **Расширения** , после чего снимите флажки для пакетов SDK расширений и установите флажки для новых пакетов SDK расширений. Нажмите кнопку **ОК**.  
  
## <a name="adding-a-reference-at-design-time"></a>Добавление ссылки во время разработки  
 При создании ссылки на сборку в проекте [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] ищет сборку в следующих расположениях:  
  
- Каталог текущего проекта. (Можно найти эти сборки, используя вкладку **Обзор** .)  
  
- Другие каталоги проектов в одном решении. (Вы можете найти эти сборки на вкладке **Проекты** .)  
  
> [!NOTE]
> Все проекты содержат неявную ссылку на библиотеку mscorlib. Проекты Visual Basic содержат неявную ссылку на `Microsoft.VisualBasic`.  
>   
> Все проекты в Visual Studio содержат неявную ссылку на `System.Core`, даже если параметр `System.Core` удален из списка ссылок.  
  
## <a name="references-to-shared-components-at-run-time"></a>Ссылки на общие компоненты во время выполнения  
 Во время выполнения компоненты должны быть в выходном пути проекта или в [Global Assembly Cache](http://msdn.microsoft.com/library/cf5eacd0-d3ec-4879-b6da-5fd5e4372202) (GAC). Если проект содержит ссылку на объект, который не находится ни в одном из этих расположений, необходимо скопировать ссылку на выходной путь проекта во время сборки проекта. Свойство <xref:Microsoft.VisualStudio.VCProjectEngine.VCProjectReference.CopyLocal%2A> указывает, следует ли делать копию. Если значение **True**, ссылка копируется в каталог проекта во время сборки проекта. Если значение **False**, ссылка не копируется.  
  
 При развертывании приложения, которое содержит ссылку на пользовательский компонент, зарегистрированный в GAC, компонент не будет развернут в приложении независимо от параметра <xref:Microsoft.VisualStudio.VCProjectEngine.VCProjectReference.CopyLocal%2A> . В более ранних версиях [!INCLUDE[vsprvs](../includes/vsprvs-md.md)]можно было задать свойство <xref:Microsoft.VisualStudio.VCProjectEngine.VCProjectReference.CopyLocal%2A> в ссылке, чтобы обеспечить развертывание сборки. Теперь необходимо вручную добавить сборку в папку \Bin. Далее весь пользовательский код будет тщательно проверен, что снизит вероятность публикации неизвестного пользовательского кода.  
  
 По умолчанию для свойства <xref:Microsoft.VisualStudio.VCProjectEngine.VCProjectReference.CopyLocal%2A> задается значение **False** , если сборка или компонент находится в глобальном кэше сборок или является компонентом платформы. В противном случае задается значение **True**. Ссылки проектов на проекты всегда имеют значение **True**.  
  
## <a name="referencing-a-project-or-assembly-that-targets-a-different-version-of-the-net-framework"></a>Ссылка на проект или сборку, которая ссылается на другую версию .NET Framework  
 Разработчики могут создавать приложения, которые ссылаются на проекты или сборки, предназначенные для другой версии платформы .NET Framework. Например, разработчик может создать приложение, предназначенное для [!INCLUDE[net_client_v40_long](../includes/net-client-v40-long-md.md)] и ссылающееся на сборку, которая предназначена для [!INCLUDE[dnprdnext](../includes/dnprdnext-md.md)]. При создании проекта, предназначенного для более ранней версии [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)], установка в этом проекте ссылки на проект или сборку для [!INCLUDE[net_client_v40_long](../includes/net-client-v40-long-md.md)] или для платформы .NET Framework версии 4 невозможна.  
  
 Дополнительные сведения см. в разделе [Указание конкретной версии или профиля .NET Framework](../ide/targeting-a-specific-dotnet-framework-version.md).  
  
## <a name="project-to-project-references"></a>Ссылки проектов на проекты  
 Ссылки проектов на проекты — это ссылки на проекты, которые содержат сборки. Они создаются на вкладке **Проект** . Visual Studio может найти сборку, если задан путь к проекту.  
  
 Если имеется проект, создающий сборку, необходимо сослаться на него и не использовать ссылку на файл (см. ниже). Преимущество ссылки проекта на проект состоит в том, что она создает зависимость между проектами в системе сборки. Зависимый проект будет собран, если он был изменен с момента последней сборки ссылающегося проекта. Ссылка на файл не создает зависимость сборки, поэтому можно собрать ссылающийся проект, не создавая зависимый, и ссылка может устареть. (То есть проект может ссылаться на ранее собранную версию проекта.) Это может привести к тому, что в каталоге bin потребуется несколько версий одной библиотеки DLL, что невозможно. При возникновении этого конфликта вы увидите сообщение: [Предупреждение. Невозможно скопировать зависимость "file" из проекта "project" в каталог выполнения, поскольку она перезапишет ссылку "file"](../misc/warning-the-dependency-file-in-project-project-cannot-be-copied.md). Дополнительные сведения см. в разделах [Устранение неполадок из-за неработающих ссылок](../ide/troubleshooting-broken-references.md) и [Практическое руководство. Создание и удаление зависимостей проектов](../ide/how-to-create-and-remove-project-dependencies.md).  
  
> [!NOTE]
> Ссылка на файл вместо ссылки проекта на проект создается, если целевая версия .NET Framework одного проекта — 4.5, а целевая версия другого проекта — 2, 3, 3.5 или 4.0.  
  
## <a name="file-references"></a>Ссылки на файлы  
 Ссылки на файлы — это прямые ссылки на сборки вне контекста проекта Visual Studio. Они создаются на вкладке **Обзор** **диспетчера ссылок**. Ссылку на файл следует использовать в случае, если имеется лишь сборка или компонент, а проект, который создает ее в качестве выходных данных, отсутствует.  
  
## <a name="see-also"></a>См. также раздел  
 [Troubleshooting Broken References](../ide/troubleshooting-broken-references.md)   
 [Программирование с использованием сборок](http://msdn.microsoft.com/library/25918b15-701d-42c7-95fc-c290d08648d6)   
 [How to: Add or Remove References By Using the Reference Manager](../ide/how-to-add-or-remove-references-by-using-the-reference-manager.md)
