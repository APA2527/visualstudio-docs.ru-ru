---
title: Пошаговое руководство. Создание простого приложения с помощью Visual C# или Visual Basic | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-general
ms.topic: conceptual
ms.assetid: f84339c7-d617-4f56-bfcd-af2215c347ba
caps.latest.revision: 21
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: d5e41dbf3422374add68e351da1e4b703772a3a4
ms.sourcegitcommit: bad28e99214cf62cfbd1222e8cb5ded1997d7ff0
ms.translationtype: MTE95
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2019
ms.locfileid: "74296862"
---
# <a name="walkthrough-create-a-simple-application-with-visual-c-or-visual-basic"></a>Пошаговое руководство. Создание простого приложения с помощью Visual C# или Visual Basic
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Выполняя данное пошаговое руководство, вы ознакомитесь со многими инструментами, диалоговыми окнами и конструкторами, которые можно использовать для создания приложений с помощью Visual Studio. Вам предстоит создать простое приложение типа “Hello, World”, разработать пользовательский интерфейс, добавить код и отладить ошибки, одновременно приобретая навыки работы в интегрированной среде разработки (IDE).

 В этом разделе содержатся следующие подразделы.

 [Настройка интегрированной среды разработки (IDE)](../ide/walkthrough-create-a-simple-application-with-visual-csharp-or-visual-basic.md#BKMK_ConfigureIDE)

 [Создание простого приложения](../ide/walkthrough-create-a-simple-application-with-visual-csharp-or-visual-basic.md#BKMK_CreateApp)

 [Отладка и тестирование приложения](../ide/walkthrough-create-a-simple-application-with-visual-csharp-or-visual-basic.md#BKMK_DebugTest)

> [!NOTE]
> Это пошаговое руководство основано на выпуске Visual Studio Professional, который содержит шаблон приложений WPF, на базе которого вы сможете создать проект для данного руководства. Этот шаблон также входит в состав Visual Studio Express для Windows Desktop, но отсутствует в Visual Studio Express для Windows и Visual Studio Express для Web. Вводные сведения об использовании Visual Studio Express для Windows см. в [центре разработки приложений для Магазина Windows](https://msdn.microsoft.com/windows/apps/br229519). Вводные сведения об использовании Visual Studio Express для Web см. в разделе [Get Started with ASP.NET](https://dotnet.microsoft.com/learn/aspnet/hello-world-tutorial/intro)(Начало работы с ASP.NET). Кроме того, ваш выпуск Visual Studio и используемые параметры определяют имена и расположения некоторых элементов пользовательского интерфейса. Дополнительные сведения см. в разделе [Настройка параметров разработки в Visual Studio](https://msdn.microsoft.com/22c4debb-4e31-47a8-8f19-16f328d7dcd3).

## <a name="BKMK_ConfigureIDE"></a> Настройка интегрированной среды разработки (IDE)
 При первом запуске Visual Studio будет предложено войти в это приложение с использованием учетной записи Майкрософт: [Sign into Visual Studio](https://devblogs.microsoft.com/visualstudio/welcome-sign-in-to-visual-studio/)(Вход в Visual Studio). Необязательно входить сразу, можно сделать это позже.

 После запуска Visual Studio далее необходимо выбрать сочетание предопределенных параметров интегрированной среды разработки. Каждое сочетание параметров было разработано так, чтобы сделать разработку приложений более простой.

 Это пошаговое руководство предполагает, что действуют **Обычные параметры разработки**, что соответствует минимальному объему настройки интегрированной среды разработки. Если вы уже выбрали C# или Visual Basic (подходит любой вариант), нет необходимости изменять свои настройки.  Если вы хотите изменить настройки, можно воспользоваться **Мастером импорта и экспорта параметров**. Дополнительные сведения см. в разделе [Настройка параметров разработки в Visual Studio](https://msdn.microsoft.com/22c4debb-4e31-47a8-8f19-16f328d7dcd3).

 После открытия Visual Studio вы увидите окна инструментов, меню и панели инструментов, а также основную область окна. Окна инструментов закреплены в левой и правой частях окна приложения, а панель **Быстрый запуск**, строка меню и стандартная панель инструментов закреплены в верхней его части. В центре окна приложения находится **Начальная страница**. При загрузке решения или проекта редакторы и конструкторы отображаются в области **Начальной страницы** . При разработке приложения чаще всего используется именно эта область.

 Рисунок 2. Интегрированная среда разработки Visual Studio

 ![Интегрированная среда разработки, в которой установлены общие параметры](../ide/media/exploreide-idewithgeneralsettings.png "|::ref1::|")

 С помощью диалогового окна **Параметры** можно дополнительно настроить Visual Studio, например изменить в редакторе начертание и размер шрифта текста или изменить цветовую тему интегрированной среды разработки. В зависимости от примененного сочетания параметров некоторые элементы в этом диалоговом окне могут не отображаться автоматически. Чтобы отображались все возможные параметры, установите флажок **Показать все параметры** .

 Рисунок 3. Диалоговое окно "Параметры"

 ![Диалоговое окно "Параметры" с флажком "Показать все параметры"](../ide/media/exploreide-optionsdialogbox.png "|::ref2::|")

 В этом примере вам предстоит изменить цветовую тему интегрированной среды разработки со светлой на темную.  При желании можно сразу перейти к созданию проекта.

#### <a name="to-change-the-color-theme-of-the-ide"></a>Изменение цветовой темы интегрированной среды разработки

1. Откройте диалоговое окно **Параметры** , выбрав в меню **Сервис** вверху пункт **Параметры...** .

    ![Команда "Параметры" в меню "Сервис"](../ide/media/exploreide-toolsoptionsmenu.png "|::ref3::|")

2. Измените **Цветовую тему** на **Темную**, а затем щелкните **ОК**.

    ![Выбрана темная цветовая тема](../ide/media/exploreide-darkthemeoptionsdlgbox.png "|::ref4::|")

   Цвета в Visual Studio должны соответствовать следующему рисунку:

   ![Интегрированная среда разработки с примененной темной темой](../ide/media/exploreide-darkthemeide.png "|::ref5::|")

   На изображениях в остальной части этого пошагового руководства используется светлая тема. Дополнительные сведения о настройке IDE см. в разделе [Настройка параметров разработки в Visual Studio](https://msdn.microsoft.com/22c4debb-4e31-47a8-8f19-16f328d7dcd3).

## <a name="BKMK_CreateApp"></a> Создание простого приложения

### <a name="create-the-project"></a>Создание проекта
 При создании приложения в Visual Studio необходимо сначала создать проект и решение. Этот пример демонстрирует создание решения Windows Presentation Foundation.

##### <a name="to-create-the-wpf-project"></a>Создание проекта WPF

1. Создайте новый проект. В меню последовательно выберите пункты **Файл**, **Создать**, **Проект...** .

    ![В строке меню выберите "Файл", "Создать", "Проект"](../ide/media/exploreide-filenewproject.png "|::ref6::|")

    Кроме того, можно ввести **Создать проект** в окне **Быстрый запуск** , чтобы выполнить то же самое действие.

    ![В поле "Быстрый запуск" укажите новый проект](../ide/media/exploreide-quicklaunchnewprojectsmall.png "|::ref7::|")

2. Выберите шаблон приложения WPF Visual Basic или Visual C# , воспользовавшись, например, путем по меню в левой области **Установлены**, **Шаблоны**, **Visual C#** , **Windows**, а затем выбрав «Приложение WPF» в средней области.  В нижней части диалогового окна нового проекта назовите проект HelloWPFApp.

    ![Создание проекта WPF Visual Basic, HelloWPFApp](../ide/media/exploreide-newprojectvb.png "|::ref8::|")

    OR

    ![Создание проекта Visual C&#35; WPF, HelloWPFApp](../ide/media/exploreide-newprojectcsharp.png "|::ref9::|")

   Visual Studio создает решение и проект HelloWPFApp, и **Обозреватель решений** показывает различные файлы. Конструктор WPF отображает представление конструирования и представление XAML файла MainWindow.xaml в одном разделенном представлении. Сдвигая разделитель, можно делать любое из представлений больше или меньше.  Можно выбрать для просмотра только визуальное представление или только представление XAML. (Дополнительные сведения см. в разделе [Конструктор WPF для разработчиков Windows Forms](https://msdn.microsoft.com/47ad0909-e89b-4996-b4ac-874d929f94ca).) В **Обозревателе решений**отображаются следующие элементы.

   Рисунок 5. Элементы проекта

   ![Обозреватель решений с добавленными файлами HelloWPFApp](../ide/media/exploreide-hellowpfappfiles.png "|::ref10::|")

   После создания проекта его можно настраивать. С помощью окна **Свойства** (в меню **Вид** ) можно отображать и изменять параметры элементов проекта, элементов управления и других элементов в приложении. С помощью свойств проекта и страниц свойств можно отображать и изменять параметры проектов и решений.

##### <a name="to-change-the-name-of-mainwindowxaml"></a>Изменение имени MainWindow.xaml

1. В следующей процедуре вы дадите MainWindow более конкретное имя. В **Обозревателе решений**выберите файл MainWindow.xaml. Должно отображаться окно **Свойства** , но если его нет, выберите в меню **Вид** пункт **Окно свойств** . Измените значение свойства **Имя файла** на `Greetings.xaml`.

    ![Окно свойств с выделенным именем файла](../ide/media/exploreide-filenameinpropertieswindow.png "|::ref11::|")

    **Обозреватель решений** показывает, что файл теперь называется Greetings.xaml, и если развернуть узел MainWindow.xaml (переместив курсор на узел и нажав клавишу стрелки вправо), то видно, что файл MainWindow.xaml.vb (или MainWindow.xaml.cs) теперь называется Greetings.xaml.vb (или Greetings.xaml.cs). Этот файл с текстом программы вложен в узел файла .xaml, что означает их тесную связь.

   > [!WARNING]
   > Это изменение вызовет ошибку; сведения по ее отладке и исправлению будут предоставлены позднее.

2. В **Обозревателе решений**откройте файл Greetings.xaml в представлении конструктора (путем нажатия клавиши ВВОД при выбранном узле) и выберите заголовок окна с помощью мыши.

3. В окне **Свойства** измените значение свойства **Заголовок** на `Greetings`.

   Заголовок окна для MainWindow.xaml теперь содержит текст Greetings.

### <a name="design-the-user-interface-ui"></a>Конструирование пользовательского интерфейса (ИП)
 В приложение будет добавлено три типа элементов управления: элемент управления TextBlock, два элемента управления RadioButton, и элемент управления Button.

##### <a name="to-add-a-textblock-control"></a>Добавление элемента управления TextBlock

1. Откройте окно **Панель элементов** , выбрав в меню **Вид** пункт **Панель элементов** .

2. На **Панели элементов**найдите элемент управления TextBlock.

    ![Панель элементов с выделенным элементом управления TextBlock](../ide/media/exploreide-textblocktoolbox.png "|::ref12::|")

3. Добавьте элемент управления TextBlock на поверхность разработки, выбрав элемент управления TextBlock и перетащив его на поверхность.  Отцентрируйте этот элемент в верхней части окна.

   Окно должно выглядеть так, как показано на следующем рисунке:

   Рисунок 7. Окно Greetings с элементом управления TextBlock

   ![Элемент управления TextBlock в форме Greetings](../ide/media/exploreide-greetingswithtextblockonly.png "|::ref13::|")

   Разметка XAML должна выглядеть приблизительно так, как показано ниже:

```
<TextBlock HorizontalAlignment="Center" TextWrapping="Wrap" VerticalAlignment="Center" RenderTransformOrigin="4.08,2.312" Margin="237,57,221,238"><Run Text="TextBlock"/><InlineUIContainer><TextBlock TextWrapping="Wrap" Text="TextBlock"/>
```

##### <a name="to-customize-the-text-in-the-text-block"></a>Настройка текста в текстовом блоке

1. В представлении XAML найдите разметку для TextBlock и измените атрибут Text: `Text=”Select a message option and then choose the Display button.”`

2. Если в элементе управления TextBlock не отображается весь текст в представлении конструирования, увеличьте элемент TextBlock (используя маркеры на краях).

3. Сохраните изменения, нажав клавиши Ctrl-s или с помощью меню **Файл** .

   Следующий шаг — добавить в форму два элемента управления [RadioButton](https://msdn.microsoft.com/library/6c9ba847-eab7-4bba-9c74-6b56ef72067b).

##### <a name="to-add-radio-buttons"></a>Добавление переключателей

1. На **Панели элементов**найдите элемент управления RadioButton.

    ![Окно панели элементов с выбранным элементом управления RadioButton](../ide/media/exploreide-radiobuttontoolbox.png "|::ref14::|")

2. Добавьте два элемента управления RadioButton на поверхность разработки, выбрав элемент RadioButton и дважды перетащив его на поверхность, и переместите кнопки (выбрав их и используя клавиши со стрелками), чтобы кнопки отображались рядом и под элементом управления TextBlock.

    Окно должно выглядеть следующим образом:

    Рисунок 8. элементы управления RadioButton в окне Greetings.

    ![Форма Greetings с блоком текста и двумя переключателями](../ide/media/exploreide-greetingswithradiobuttons.png "|::ref15::|")

3. В окне **Свойства** для левого элемента управления RadioButton измените свойство **Имя** (свойство в верхней части окна **Свойства** ), задав ему значение `RadioButton1`.  Убедитесь, что выбран элемент управления RadioButton и в форме нет фоновой сетки; поле «Тип» в окне свойств под полем «Имя» должно иметь значение «RadioButton».

4. В окне **Свойства** для правого элемента управления RadioButton измените свойство **Имя** на `RadioButton2`и сохраните изменения, нажав клавиши Ctrl-s или с помощью меню **Файл** .  Перед изменением и сохранением убедитесь, что выбран элемент управления RadioButton.

   Теперь можно добавить отображаемый текст для каждого элемента управления RadioButton. Следующая процедура обновляет свойство **Content** элемента управления RadioButton.

##### <a name="to-add-display-text-for-each-radio-button"></a>Добавление отображаемого текста для каждого переключателя

1. Откройте контекстное меню элемента управления RadioButton1 (выбрав его и нажав правую кнопку мыши), выберите команду **Изменить текст**, а затем введите `Hello`.

2. Откройте контекстное меню элемента управления RadioButton2 (выбрав его и нажав правую кнопку мыши), выберите команду **Изменить текст**, а затем введите `Goodbye`.

   Последний элемент пользовательского интерфейса, который вам предстоит добавить, — это [Button](https://msdn.microsoft.com/library/a9d8f5a5-c98c-463e-808a-5a4e63173098).

##### <a name="to-add-the-button-control"></a>Добавление элемента управления Button

1. В **Панели инструментов**найдите элемент управления **Кнопка** и добавьте его на поверхность разработки под элементами управления RadioButton, выбрав кнопку и перетащив ее на форму в представлении конструирования.

2. В представлении XAML измените значение свойства **Содержимое** элемента управления «Кнопка» с `Content=”Button”` на `Content=”Display”`и сохраните изменения (используя Ctrl-s или меню **Файл** ).

    Разметка должна быть аналогична разметке, приведенной в следующем примере: `<Button Content="Display" HorizontalAlignment="Left" VerticalAlignment="Top" Width="75" Margin="215,204,0,0"/>`

   Окно должно выглядеть так, как показано на следующем рисунке.

   Рисунок 9. Окончательный пользовательский интерфейс Greetings

   ![Форма Greetings с метками элементов управления](../ide/media/exploreide-greetingswithconrollabels.png "|::ref16::|")

### <a name="add-code-to-the-display-button"></a>Добавление кода к кнопке Display
 После запуска приложения окно сообщения появится только тогда, когда пользователь сначала выберет переключатель, а затем нажмет кнопку **Display** . Одно окно сообщения появится для Hello, и другое — для Goodbye. Для создания такого поведения добавьте код в событие Button_Click в файле Greetings.xaml.vb или Greetings.xaml.cs.

##### <a name="add-code-to-display-message-boxes"></a>Добавление кода для отображения окон сообщений

1. На поверхности разработки дважды щелкните кнопку **Display** .

     Будет открыт файл Greetings.xaml.vb или Greetings.xaml.cs, а курсор будет установлен в событии Button_Click. Также можно добавить обработчик событий щелчка следующим образом (если во вставленном коде какие-либо имена подчеркнуты красной волнистой линией, то, возможно, не были выбраны и переименованы элементы управления RadioButton на поверхности разработки):

     Для Visual Basic обработчик событий должен выглядеть следующим образом:

    ```vb
    Private Sub Button_Click_1(sender As Object, e As RoutedEventArgs)

    End Sub
    ```

     Для Visual C# обработчик события должен выглядеть следующим образом:

    ```csharp
    private void Button_Click_1(object sender, RoutedEventArgs e)
    {

    }
    ```

2. Для Visual Basic введите следующий код:

    ```vb
    If RadioButton1.IsChecked = True Then
        MessageBox.Show("Hello.")
    Else RadioButton2.IsChecked = True
        MessageBox.Show("Goodbye.")
    End If

    ```

     Для Visual C# введите следующий код:

    ```
    if (RadioButton1.IsChecked == true)
    {
        MessageBox.Show("Hello.");
    }
    else
    {
        RadioButton2.IsChecked = true;
        MessageBox.Show("Goodbye.");
    }
    ```

3. Сохраните приложение.

## <a name="BKMK_DebugTest"></a> Отладка и тестирование приложения
 После этого вам предстоит отладить приложение для выявления ошибок и тестирования того, что оба окна сообщений отображаются правильно. Приведенные ниже инструкции описывают, как выполнить сборку и запустить отладчик (дополнительные сведения см. в разделах [Сборка приложения WPF (WPF)](https://msdn.microsoft.com/library/a58696fd-bdad-4b55-9759-136dfdf8b91c) и [Сборка WPF](../debugger/debugging-wpf.md)).

### <a name="find-and-fix-errors"></a>Поиск и исправление ошибок
 На этом шаге вам предстоит найти ошибку, которую мы намеренно допустили ранее, изменив имя файла XAML главного окна.

##### <a name="to-start-debugging-and-find-the-error"></a>Начало отладки и поиск ошибки

1. Запустите отладчик, выбрав **Отладка**, затем **Начать отладку**.

    ![Команда "Начать отладку" в меню "Отладка"](../ide/media/exploreide-startdebugging.png "|::ref17::|")

    Появится диалоговое окно, показывающее, что произошло исключение IOException "Не удалось обнаружить ресурс ‘mainwindow.xaml’".

2. Нажмите кнопку **ОК** , а затем остановите отладчик.

    ![Команда "Остановить отладку" в меню "Отладка"](../ide/media/exploreide-stopdebugging.png "|::ref18::|")

   Файл Mainwindow.xaml был переименован в Greetings.xaml в начале этого пошагового руководства, но код по-прежнему ссылается на файл Mainwindow.xaml как на начальный универсальный код ресурса (URI) для приложения, поэтому проект не может быть запущен.

##### <a name="to-specify-greetingsxaml-as-the-startup-uri"></a>Задание Greetings.xaml в качестве начального универсального кода ресурса (URI)

1. В **Обозревателе решений**откройте файл App.xaml (в проекте C#) или файл Application.xaml (в проекте Visual Basic) в представлении XAML (его невозможно открыть в представлении конструирования), выбрав файл и нажав клавишу ВВОД или дважды щелкнув его.

2. Измените `StartupUri="MainWindow.xaml"` на `StartupUri="Greetings.xaml"`и сохраните изменения, нажав Ctrl-s.

   Запустите отладчик снова (клавишей F5). Должно появиться окно Greetings приложения.

### <a name="to-debug-with-breakpoints"></a>Отладка с точками останова
 Добавление некоторых точек останова позволяет тестировать код во время отладки. Для добавления точки останова можно выбрать в меню **Отладка** пункт **Точка останова** или щелкнуть в левой области редактора рядом со строкой кода, на которой требуется приостановить выполнение.

##### <a name="to-add-breakpoints"></a>Добавление точек останова

1. Откройте файл Greetings.xaml.vb или Greetings.xaml.cs и выделите следующею строку: `MessageBox.Show("Hello.")`

2. Добавьте точку останова, выбрав меню **Отладка**, затем — **Точка останова**.

     ![Команда "Точка останова" в меню "Отладка"](../ide/media/exploreide-togglebreakpoint.png "|::ref19::|")

     Рядом со строкой кода в крайнем левом поле окна редактора появится красный кружок.

3. Выделите следующую строку: `MessageBox.Show("Goodbye.")`.

4. Нажмите клавишу F9, чтобы добавить точку останова, затем нажмите клавишу F5, чтобы начать отладку.

5. В окне **Greetings** выберите переключатель **Hello** и нажмите кнопку **Display** .

     Строка `MessageBox.Show("Hello.")` выделяется желтым цветом. В нижней части интегрированной среды разработки окна «Видимые», «Локальные» и «Контрольные значения» закреплены вместе на левой стороне, а окна «Стек вызовов», «Точки останова», «Команда», «Интерпретация» и окно вывода закреплены вместе на правой стороне.

6. В меню **Отладка**выберите **Шаг с выходом**.

     Приложение возобновит выполнение, и появится окно сообщения со словом "Hello".

7. Нажмите кнопку **ОК** в окне сообщения, чтобы закрыть его.

8. В окне **Greetings** выберите переключатель **Goodbye** и нажмите кнопку **Display** .

     Строка `MessageBox.Show("Goodbye.")` выделяется желтым цветом.

9. Нажмите клавишу F5, чтобы продолжить отладку. Когда появится окно сообщения, нажмите в нем кнопку **ОК** , чтобы закрыть его.

10. Нажмите комбинацию клавиш SHIFT + F5 (нажмите сначала клавишу SHIFT и, удерживая ее нажатой, нажмите клавишу F5), чтобы остановить отладку.

11. В меню **Отладка**выберите **Выключить все точки останова**.

### <a name="build-a-release-version-of-the-application"></a>Сборка окончательной версии приложения
 Теперь, когда вы проверили, что все работает, можно подготовить окончательную сборку приложения.

##### <a name="to-clean-the-solution-files-and-build-a-release-version"></a>Очистка файлов решения и сборка окончательной версии

1. Выберите в главном меню **Сборка**и **Очистить решение** для удаления промежуточных файлов и выходных файлов, которые были созданы в ходе предыдущих сборок.  Это не является обязательным, но очищает результаты отладочной сборки.

    ![Команда "Очистить решение" в меню "Сборка"](../ide/media/exploreide-cleansolution.png "|::ref20::|")

2. Измените конфигурацию сборки для HelloWPFApp с **Отладка** на **Выпуск** с помощью раскрывающегося списка на панели инструментов (сейчас это «Отладка»).

    ![Панель инструментов "Стандартная" с выбранной конфигурацией "Выпуск"](../ide/media/exploreide-releaseversion.png "|::ref21::|")

3. Постройте решение, выбрав **Сборка**, затем **Собрать решение** или нажмите клавишу F6.

    ![Команда "Собрать решение" в меню "Сборка"](../ide/media/exploreide-buildsolution.png "|::ref22::|")

   Поздравляем с завершением этого пошагового руководства! Построенный EXE-файл находится в каталоге решения и проекта (... \HelloWPFApp\HelloWPFApp\bin\Release\\). Чтобы изучить больше примеров, см. статью [Примеры Visual Studio](../ide/visual-studio-samples.md).

## <a name="see-also"></a>См. также
 [Новые возможности Visual studio 2015](../what-s-new-in-visual-studio-2015.md) Приступая [к разработке с помощью](../ide/get-started-developing-with-visual-studio.md) [советов по повышению производительности](../ide/productivity-tips-for-visual-studio.md) Visual Studio
