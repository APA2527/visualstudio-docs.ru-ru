---
title: Добавление ссылок в диспетчере ссылок
ms.date: 04/11/2018
ms.topic: conceptual
f1_keywords:
- VS.ReferenceManager
helpviewer_keywords:
- C# projects, references
- references [Visual Studio], adding
- assemblies [Visual Studio], references
- Visual Basic projects, references
- project references, adding
- referencing components, adding references
- project references, removing
- referencing assemblies
- referencing components, removing references
- references [Visual Studio], removing
- referencing components, assemblies not listed
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 1b26c700e90189882f850d4bda1d47fb6f54c025
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62548159"
---
# <a name="how-to-add-or-remove-references-by-using-the-reference-manager"></a>Как выполнить Добавление и удаление ссылок с помощью диспетчера ссылок

Диалоговое окно **Диспетчер ссылок** позволяет добавлять ссылки на компоненты, которые разработали вы, корпорация Майкрософт или другая организация, а также управлять этими ссылками. При разработке универсального приложения Windows ваш проект автоматически ссылается на все правильные библиотеки DLL пакета SDK Windows. При разработке приложения .NET ваш проект автоматически ссылается на *mscorlib.dll*. Некоторые API .NET представлены в компонентах, которые необходимо добавить вручную. Ссылки на компоненты COM или пользовательские компоненты необходимо добавить вручную.

## <a name="reference-manager-dialog-box"></a>Диалоговое окно "Диспетчер ссылок"

В левой части диалогового окна **Диспетчер ссылок** отображаются различные категории в зависимости от типа проекта:

- **Сборки** с подгруппами **Платформа** и **Расширения**.

- **COM** содержит список всех COM-компонентов, ссылки на которые можно добавить.

- **Решение** с подгруппой **Проекты**.

- **Windows** с подгруппами **Ядро** и **Расширения**. Для просмотра ссылок в Windows SDK и пакетах SDK расширений можно использовать **Обозреватель объектов**.

- **Обзор** с подгруппой **последних ссылок**.

## <a name="add-a-reference"></a>Добавление ссылки

1. В **обозревателе решений** щелкните правой кнопкой мыши узел **Ссылки** или **Зависимости** и выберите команду **Добавить ссылку**. Вы также можете щелкнуть узел проекта правой кнопкой мыши и выбрать пункт **Добавить** > **Ссылка**.

   Будет открыт **Диспетчер ссылок** со списком доступных ссылок по группам.

2. Укажите ссылки, которые требуется добавить, а затем нажмите кнопку **ОК**.

## <a name="assemblies-tab"></a>Вкладка "Сборки"

На вкладке **Сборки** перечислены все сборки .NET Framework, которые доступны для ссылки. Вкладка **Сборки** не содержит никаких сборки из глобального кэша сборок (GAC), так как сборки в глобальном кэше сборок являются частью среды выполнения. При развертывании или копировании приложения, содержащего ссылку на сборку, зарегистрированную в глобальном кэше сборок, сборка не будет развернута или скопирована вместе с приложением, вне зависимости от значения свойства **Копировать локально**. Дополнительные сведения см. в статье [Управление ссылками в проекте](../ide/managing-references-in-a-project.md).

При добавлении вручную ссылки на любое из пространств имен EnvDTE (<xref:EnvDTE>, <xref:EnvDTE80>, <xref:EnvDTE90>, <xref:EnvDTE90a> или <xref:EnvDTE100>) установите в окне **Свойства** для свойства ссылки **Внедрить типы взаимодействия** значение **False**. Задание для этого свойства значения **True** может привести к проблемам сборки, так как некоторые свойства EnvDTE не допускают внедрения.

Все проекты классических приложений содержат неявную ссылку на библиотеку **mscorlib**. Проекты [!INCLUDE[vbprvb](../code-quality/includes/vbprvb_md.md)] содержат неявную ссылку на библиотеку <xref:Microsoft.VisualBasic>. Все проекты содержат неявную ссылку на **System.Core**, даже если она была удалена из списка ссылок.

Если тип проекта не поддерживает сборки, эта вкладка не отображается в диалоговом окне **Диспетчер ссылок**.

Вкладка **Сборки** состоит из двух подразделов.

1. В разделе **Платформа** перечислены все сборки, из которых состоит целевая платформа.

    Проекты приложений для Магазина Windows 8.x по умолчанию содержат ссылки на все сборки в целевом профиле [!INCLUDE[net_win8_profile](../ide/includes/net_win8_profile_md.md)] при создании проекта. В управляемых проектах доступный только для чтения узел в папке **Ссылки** в **Обозревателе решений** содержит ссылку на всю платформу .NET Framework. Соответственно, на вкладке **Платформа** не будут указаны никакие сборки из .NET Framework, а вместо них будет отображаться следующее сообщение: "Ссылки на все сборки .NET Framework уже заданы. С помощью обозревателя объектов исследуйте ссылки в Framework". Для проектов классических приложений на вкладке **Платформа** перечислены сборки из целевой версии .NET Framework, и пользователь должен добавить ссылки, которые требуются приложению.

2. В разделе **Расширения** перечислены все сборки, разработанные внешними поставщиками компонентов и элементов управления для расширения целевой версии .NET Framework. В зависимости от назначения пользовательского приложения эти сборки могут понадобиться ему.

   Список **расширений** состоит из сборок, зарегистрированных в следующих местах:

   32-разрядный компьютер:
   - `HKEY_CURRENT_USER\SOFTWARE\Microsoft\[Target Framework Identifier]\v[Target Framework Version]\AssemblyFoldersEx\[UserComponentName]\@default=[Disk location of assemblies]`
   - `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\[Target Framework Identifier]\v[Target Framework Version]\AssemblyFoldersEx\[UserComponentName]\@default=[Disk location of assemblies]`

   64-разрядный компьютер:
   - `HKEY_CURRENT_USER\SOFTWARE\Wow6432Node\Microsoft\[Target Framework Identifier]\v[Target Framework Version]\AssemblyFoldersEx\[UserComponentName]\@default=[Disk location of assemblies]`
   - `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\[Target Framework Identifier]\v[Target Framework Version]\AssemblyFoldersEx\[UserComponentName]\@default=[Disk location of assemblies]`

   И более старые версии [идентификатор требуемой версии .NET Framework]

   Например, если проект нацелен на .NET Framework 4 на 32-разрядных компьютерах, в списке **Расширения** будут указаны сборки, зарегистрированные в *\Microsoft\.NETFramework\v4.0\AssemblyFoldersEx*, *\Microsoft\.NETFramework\v3.5\AssemblyFoldersEx*, *\Microsoft\.NETFramework\v3.0\AssemblyFoldersEx* и *\Microsoft\.NETFramework\v2.0\AssemblyFoldersEx*.

Некоторые компоненты в списке могут не отображаться в зависимости от версии .NET Framework проекта. Это может произойти в следующих случаях.

- Компонент, использующий новую версию платформы .NET Framework, не совместим с проектом, нацеленным на более раннюю версию платформы .NET Framework.

    Сведения об изменении целевой версии .NET Framework для проекта см. в разделе [Практическое руководство. определить целевую версию .NET Framework](../ide/how-to-target-a-version-of-the-dotnet-framework.md).

- Компонент, использующий [!INCLUDE[net_v40_short](../code-quality/includes/net_v40_short_md.md)], несовместим с проектом, нацеленным на [!INCLUDE[net_v45](../ide/includes/net_v45_md.md)].

    При создании нового приложения некоторые проекты нацелены на [!INCLUDE[net_v45](../ide/includes/net_v45_md.md)] по умолчанию.

Не следует добавлять ссылки на выходные файлы другого проекта того же решения, поскольку это может привести к ошибкам компиляции. Вместо этого следует создавать ссылки между проектами, используя вкладку **Проекты** диалогового окна **Добавление ссылки**. Это позволит упростить коллективную разработку за счет более эффективного управления библиотеками классов, создаваемыми в проектах. Дополнительные сведения см. в статье [Устранение неполадок неработающих ссылок](../ide/troubleshooting-broken-references.md).

> [!NOTE]
> В Visual Studio 2015 ссылка на файл создается вместо ссылки на проект, если целевой версией платформы .NET Framework для одного проекта является версия 4.5, а для другого проекта — версия 2, 3, 3.5 или 4.0.

### <a name="to-display-an-assembly-in-the-add-reference-dialog-box"></a>Чтобы отобразить сборку в диалоговом окне "Добавление ссылки"

- Переместите или скопируйте сборку в одно из следующих расположений.

   - Каталог текущего проекта. (Можно найти эти сборки, используя вкладку **Обзор** .)

   - Другие каталоги проектов в одном решении. (Можно найти эти сборки, используя вкладку **Проекты**.)

    \- или -

- Установите раздел реестра, определяющий положение отображаемых сборок.

   Для 32-разрядной операционной системы добавьте один из следующих разделов реестра.

   - `[HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework\<VersionMinimum>\AssemblyFoldersEx\MyAssemblies]@="<AssemblyLocation>"`

   - `[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\<VersionMinimum>\AssemblyFoldersEx\MyAssemblies]@="<AssemblyLocation>"`

   Для 64-разрядной операционной системы добавьте один из следующих разделов реестра в 32-разрядный куст реестра.

   - `[HKEY_CURRENT_USER\SOFTWARE\Wow6432Node\Microsoft\.NETFramework\<VersionMinimum>\AssemblyFoldersEx\MyAssemblies]@="<AssemblyLocation>"`

   - `[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\.NETFramework\<VersionMinimum>\AssemblyFoldersEx\MyAssemblies]@="<AssemblyLocation>"`

   *\<VersionMinimum\>*  — это минимальная допустимая версия платформы .NET Framework. Если *\<VersionMinimum\>*  — v3.0, папки, указанные в *AssemblyFoldersEx*, относятся к проектам, предназначенным для платформы .NET Framework 3.0 и более поздних версий.

   *\<AssemblyLocation\>*  — это каталог сборок, которые требуется отображать в диалоговом окне **Добавить ссылку**, например *C:\MyAssemblies*.

   Создание раздела реестра в узле `HKEY_LOCAL_MACHINE` позволяет всем пользователям видеть сборки в указанном расположении в диалоговом окне **Добавить ссылку**. Создание раздела реестра в узле `HKEY_CURRENT_USER` влияет только на настройки для текущего пользователя.

   Снова откройте диалоговое окно **Добавление ссылки**. Эти сборки должны отображаться на вкладке **.NET**. Если это не так, убедитесь, что сборки расположены в указанном каталоге *AssemblyLocation*, перезапустите Visual Studio и повторите попытку.

## <a name="projects-tab"></a>Вкладка "Проекты"

На вкладке **Проекты** указываются все совместимые проекты в текущем решении (в подразделе **Решение**).

Проект может ссылаться на другой проект, предназначенный для другой версии .NET Framework. Например, можно создать проект, который нацелен на [!INCLUDE[net_v40_short](../code-quality/includes/net_v40_short_md.md)], но ссылается на сборку, собранную для .NET Framework 2. Но проект .NET Framework 2 не может ссылаться на проект [!INCLUDE[net_v40_short](../code-quality/includes/net_v40_short_md.md)]. Дополнительные сведения см. в статье [Обзор настройки для различных версий](../ide/visual-studio-multi-targeting-overview.md).

Проект, нацеленный на [!INCLUDE[net_v40_short](../code-quality/includes/net_v40_short_md.md)], несовместим с проектом, нацеленным на [!INCLUDE[net_client_v40_long](../deployment/includes/net_client_v40_long_md.md)].

Создается ссылка на файл вместо ссылки на проект, если один проект нацелен на .NET Framework 4, а второй проект — на более раннюю версию.

В проект, нацеленный на [!INCLUDE[net_win8_profile](../ide/includes/net_win8_profile_md.md)], нельзя добавить ссылку на проект, нацеленный на .NET Framework более ранней версии, и наоборот.

## <a name="universal-windows-tab"></a>Вкладка "Универсальная платформа Windows"

Вкладка **Универсальная платформа Windows** содержит список всех пакетов SDK, относящихся к платформам, на которых работают операционные системы Windows.
Эта вкладка имеет две подгруппы: **Ядро** и **Расширения**.

### <a name="core-subgroup"></a>Подгруппа "Ядро"

Проекты универсального приложения для Windows по умолчанию имеют ссылку на пакет SDK универсальной платформы Windows. Соответственно, в подгруппе **Ядро** в **диспетчере ссылок** не перечисляются никакие сборки из пакета SDK универсальной платформы Windows.

### <a name="extensions-subgroup"></a>Подгруппа "Расширения"

В разделе **Расширения** перечислены пользовательские пакеты SDK, расширяющие целевую платформу Windows.

Пакет SDK — это коллекция файлов, которая обрабатывается Visual Studio как единый компонент. На вкладке **Расширения** пакеты SDK, относящиеся к проекту, из которого было открыто диалоговое окно **Диспетчер ссылок**, указываются как отдельные записи. При добавлении в проект все содержимое SDK используется Visual Studio таким образом, что пользователю не нужно принимать никаких дополнительных мер для добавления содержимого SDK в IntelliSense, на панель элементов, в конструкторы, обозреватель объектов, средства сборки, развертывания, отладки и упаковки.

Сведения об отображении SDK на вкладке **Расширения** см. в статье [Создание средств разработки программного обеспечения](../extensibility/creating-a-software-development-kit.md).

> [!NOTE]
> Если проект ссылается на пакет SDK, зависящий от другого пакета SDK, Visual Studio не будет использовать второй пакет SDK, пока вы вручную не зададите ссылку на него. Когда пользователь выбирает пакет SDK на вкладке **Расширения**, открывается диалоговое окно **Диспетчер ссылок**, которое помогает определить зависимости SDK, перечислив их в области сведений.

Если тип проекта не поддерживает расширения, эта вкладка не отображается в диалоговом окне **Диспетчер ссылок**.

## <a name="com-tab"></a>Вкладка COM

Вкладка **COM** содержит список всех COM-компонентов, ссылки на которые можно добавить. Если необходимо добавить ссылку на зарегистрированную DLL-библиотеку COM, содержащую внутренний манифест, сначала необходимо отменить регистрацию DLL-библиотеки. В противном случае среда разработки Visual Studio добавить ссылку как элемент управления ActiveX, а не как библиотеку DLL с машинным кодом.

Если тип проекта не поддерживает COM, эта вкладка не отображается в диалоговом окне **Диспетчер ссылок**.

## <a name="browse-button"></a>Кнопка "Обзор"

Кнопка **Обзор** позволяет осуществлять поиск компонента в файловой системе.

Проект может ссылаться на компонент, нацеленный на другую версию .NET Framework. Например, можно создать приложение для .NET Framework 4.7, ссылающееся на компонент для .NET Framework 4. Дополнительные сведения см. в статье [Обзор настройки для различных версий](../ide/visual-studio-multi-targeting-overview.md).

Не следует добавлять ссылки на выходные файлы другого проекта того же решения, поскольку это может привести к ошибкам компиляции. Вместо этого следует создавать ссылки между проектами, используя вкладку **Решение** диалогового окна **Диспетчер ссылок**. Это позволит упростить коллективную разработку за счет более эффективного управления библиотеками классов, создаваемыми в проектах. Дополнительные сведения см. в статье [Устранение неполадок неработающих ссылок](../ide/troubleshooting-broken-references.md).

Невозможно добавить SDK в проект с помощью кнопки "Обзор". С помощью кнопки "Обзор" можно добавить в проект только файл (например, сборку или файл *WinMD*).

При указании ссылки на файл WinMD предполагается, что файлы *\<имя_файла>.winmd*, *\<имя_файла>.dll* и *\<имя_файла>.pri* находятся рядом друг с другом. При указании ссылки на файл WinMD в следующих сценариях неполный набор файлов копируется в выходной каталог проекта и, следовательно, происходят сбои сборки и выполнения.

- **Компонент на базе машинного кода**. Проект на базе машинного кода создает по одному файлу WinMD для каждого не связанного с другими набора пространств имен и по одному файлу DLL с реализацией. Файлы WinMD будут иметь разнородные имена. При указании ссылки на такой файл компонента на базе машинного кода MSBuild не определит, что файлы WinMD с разнородными именами относятся к одному компоненту. Следовательно, будут скопированы только файлы *\<имя_файла>.dll* и *\<имя_файла>.winmd* с одинаковыми именами и возникнут ошибки времени выполнения. Чтобы обойти эту проблему, нужно создать пакет SDK расширения. Дополнительные сведения см. в статье [Создание средств разработки программного обеспечения](../extensibility/creating-a-software-development-kit.md).

- **Использование элементов управления**. Элемент управления XAML состоит по меньшей мере из следующих файлов: *\<имя_файла>.winmd*, *\<имя_файла>.dll*, *\<имя_файла>.pri*, *\<имя_XAML>.xaml* и *\<имя_изображения>.jpg*. Когда проект будет собран, файлы ресурсов, связанные со ссылкой на файл, не будут скопированы в выходной каталог проекта, а будут скопированы только файлы *\<имя_файла>.winmd*, *\<FileName>.dll* и *\<имя_файла>.pri*. При этом в журнал будет занесена ошибка сборки, указывающая пользователю на отсутствующие ресурсы *\<имя_XAML>.xaml* и *\<имя_изображения>.jpg*. Чтобы сборка прошла успешно, пользователь должен вручную скопировать эти файлы ресурсов в выходную папку проекта для сборки и отладки (выполнения). Для решения этой проблемы создайте пакет SDK расширения, следуя инструкциям в статье [Создание средств разработки программного обеспечения](../extensibility/creating-a-software-development-kit.md), или измените файл проекта, добавив в него следующее свойство:

    ```xml
    <PropertyGroup>
       <GenerateLibraryOutput>True</GenerateLibraryOutput>
    </PropertyGroup>
    ```

    > [!NOTE]
    > При добавлении этого свойства сборка может выполняться медленнее.

## <a name="recent"></a>Последние

Элементы **Сборки**, **COM**, **Windows** и **Обзор** поддерживают вкладку **Последние**, содержащую список компонентов, которые были недавно добавлены в проекты.

## <a name="search"></a>Поиск

Панель поиска в диалоговом окне **Диспетчер ссылок** работает с текущей активной вкладкой. Например, если пользователь вводит в области поиска запрос "System", когда открыта вкладка **Решение**, поиск не вернет результаты, если решение не содержит проекта, в имени которого есть слово "System".

## <a name="see-also"></a>См. также

- [Управление ссылками в проекте](../ide/managing-references-in-a-project.md)