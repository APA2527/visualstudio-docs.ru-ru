---
title: Фрагменты кода
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- vs.ExpansionManagerImport
- vs.codesnippetmanager
helpviewer_keywords:
- surround with
- code snippets
author: jillre
ms.author: jillfra
manager: jillfra
dev_langs:
- CSharp
- VB
- CPP
ms.workload:
- multiple
ms.openlocfilehash: 09f6e2e9b4b89c7e6fd1fe9a342d4fd05b12e7a9
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72747981"
---
# <a name="code-snippets"></a>Фрагменты кода

Фрагменты кода — это небольшие блоки многократно используемого кода, которые можно вставлять в файл кода с помощью команды контекстного меню или сочетания клавиш. Они обычно содержат часто используемый код, например конструкции `try-finally` или `if-else`, но могут также использоваться и для вставки целых классов или методов.

> [!NOTE]
> Этот раздел относится к Visual Studio в Windows. Информацию о Visual Studio для Mac см. в статье [Фрагменты кода (Visual Studio для Mac)](/visualstudio/mac/snippets).

Фрагменты кода доступны для различных языков, включая C#, C++, Visual Basic, XML и T-SQL. Чтобы просмотреть все доступные установленные фрагменты кода для языка, откройте **Диспетчер фрагментов кода** из меню **Сервис** (или нажмите клавиши **CTRL**+**K**, **CTRL**+**B**) и выберите требуемый язык в расположенном сверху раскрывающемся меню.

![Диалоговое окно "Диспетчер фрагментов кода"](media/code-snippets-manager.png)

Существует несколько общих способов для обращения к фрагментам кода.

- В строке меню выберите **Правка** > **IntelliSense** > **Вставить фрагмент кода**.

- Щелкните правой кнопкой мыши или вызовите контекстное меню в редакторе кода, выберите **Фрагмент кода** > **Вставить фрагмент кода**.

- На клавиатуре нажмите клавиши **CTRL**+**K**,**CTRL**+**X**.

## <a name="expansion-snippets-and-surround-with-snippets"></a>Фрагменты расширения и фрагменты окружения

В Visual Studio существует два типа фрагментов кода: фрагменты расширения, которые добавляются в указанное курсором место и могут заменить собой ярлык фрагмента, и фрагменты окружения (только в C# и C++), которые добавляются вокруг выделенного блока кода.

Пример кода расширения. В C# ярлык TRYF служит для вставки блока TRY-FINALLY:

```csharp
try
{

}
finally
{

}
```

Чтобы вставить этот фрагмент, выберите в контекстном меню окна кода **Вставить фрагмент кода** и **Visual C#** , после чего введите `tryf` и нажмите клавишу **TAB**. Либо можно ввести `tryf` и два раза нажать клавишу **TAB**.

Пример фрагмента окружения. В C++ ярлык `if` может использоваться для вставки фрагмента или для добавления фрагмента обрамления. Если выбрать строку кода (например, `return FALSE;`) и последовательно выбрать команды **Разместить во фрагменте** > **if**, фрагмент кода будет развернут около этой строки:

```cpp
if (true)
{
    return FALSE;
}
```

## <a name="snippet-replacement-parameters"></a>Параметры замены фрагмента кода

Фрагменты кода могут содержать параметры замены, представляющие собой заполнители, которые необходимо заменить на конкретные значения при написании кода. В предыдущем примере `true` — это параметр замены, который будет заменен на подходящее условие. При замене изменения повторяются для каждого вхождения одного и того же параметра в фрагменте.

Например, в Visual Basic есть фрагмент кода, который вставляет свойство. Чтобы вставить фрагмент кода, выберите **Фрагмент кода...**  > **Вставить фрагмент кода** в контекстном меню в файле кода Visual Basic. Выберите **Шаблоны кода** > **Свойства, процедуры, события** > **Определить свойство**.

![Меню фрагментов кода для команды "Определить свойство"](media/code-snippets-vb-property.png)

Вставлен следующий код:

```vb
Private newPropertyValue As String
Public Property NewProperty() As String
    Get
        Return newPropertyValue
    End Get
    Set(ByVal value As String)
        newPropertyValue = value
    End Set
End Property
```

Если изменить `newPropertyValue` на `m_property`, изменяется каждое вхождение `newPropertyValue`. Если изменить `String` на `Int` в объявлении свойства, то значение метода SET также изменится на `Int`.

## <a name="see-also"></a>См. также

- [Пошаговое руководство: Создание фрагмента кода](../ide/walkthrough-creating-a-code-snippet.md)
- [Практическое руководство. Распространение фрагментов кода](../ide/how-to-distribute-code-snippets.md)
- [Рекомендации по использованию фрагментов кода](../ide/best-practices-for-using-code-snippets.md)
- [Устранение неполадок, связанных с использованием фрагментов кода](../ide/troubleshooting-snippets.md)
- [Фрагменты кода C#](../ide/visual-csharp-code-snippets.md)
- [Фрагменты кода C++](../ide/visual-cpp-code-snippets.md)
- [Справочник по схеме фрагментов кода](../ide/code-snippets-schema-reference.md)
- [Фрагменты кода (Visual Studio для Mac)](/visualstudio/mac/snippets)
