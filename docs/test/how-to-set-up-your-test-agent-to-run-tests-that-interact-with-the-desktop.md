---
title: Настройка агента тестирования
ms.date: 09/18/2018
ms.topic: conceptual
helpviewer_keywords:
- agents, configuring for interaction with desktop
ms.assetid: 3a94dd07-6d17-402c-ae8f-7947143755c9
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: dc00598595ee3e3d958562682900bde9aad2a353
ms.sourcegitcommit: 5d1b2895d3a249c6bea30eb12b0ad7c0f0862d85
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80880186"
---
# <a name="how-to-set-up-your-test-agent-to-run-tests-that-interact-with-the-desktop"></a>Практическое руководство. Настройка агента тестирования для выполнения тестов, взаимодействующих с рабочим столом

::: moniker range="vs-2017"
Если требуется выполнить автоматические тесты, которые взаимодействуют с рабочим столом, настройте свой агент для запуска в виде процесса, а не службы. Например, если необходимо выполнить закодированный тест пользовательского интерфейса удаленно с помощью контроллера и агента тестирования или выполнить тест с перенаправлением видеозаписи в процессе его выполнения, следует настроить агент как процесс. Если агенты назначаются ролям в параметрах тестирования с помощью Visual Studio или в среде с помощью Microsoft Test Manager, нужно изменить настройку агентов, назначенных ролям, которые должны взаимодействовать с рабочим столом.
::: moniker-end
::: moniker range=">=vs-2019"
Если требуется выполнить автоматические тесты, которые взаимодействуют с рабочим столом, настройте свой агент для запуска в виде процесса, а не службы. Например, если необходимо выполнить закодированный тест пользовательского интерфейса удаленно с помощью контроллера и агента тестирования или выполнить тест с перенаправлением видеозаписи в процессе его выполнения, следует настроить агент как процесс. При назначении агентам ролей в параметрах тестирования с помощью Visual Studio необходимо изменить настройку для всех агентов, которым назначены роли для взаимодействия с рабочим столом.
::: moniker-end

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

::: moniker range="vs-2017"
> [!WARNING]
> При использовании Microsoft Test Manager для настройки лабораторной среды этот компонент устанавливает агент тестирования. В **мастере создания среды** можно указать, что необходимо настроить одну из ролей для выполнения закодированных тестов пользовательского интерфейса.
:::moniker-end

> [!IMPORTANT]
> Компьютер, на котором выполняется агент, для которого требуется запустить закодированные тесты пользовательского интерфейса, не может быть заблокирован и не может иметь активную заставку.

Если выполняемые закодированные тесты пользовательского интерфейса запускают браузер, для запуска используется учетная запись службы агента тестирования. Данная учетная запись службы должна совпадать с учетной записью активного пользователя этого компьютера. При использовании другой учетной записи пользователя браузер не будет запущен.

> [!IMPORTANT]
> Если выполняемые закодированные тесты пользовательского интерфейса запускают браузер как часть определения построения, для запуска используется учетная запись службы агента тестирования. Данная учетная запись службы должна совпадать с учетной записью активного пользователя этого компьютера. При использовании другой учетной записи пользователя браузер не будет запущен.

Следующая процедура используется для настройки агентов, назначенных роли, выполняющей задачу, которая требует взаимодействия с рабочим столом.

## <a name="to-set-up-an-agent-to-run-as-a-process"></a>Настройка агента для выполнения в качестве процесса

1. Чтобы настроить установленный агент тестирования для запуска в виде процесса, откройте **Пуск** > **Средство настройки агента тестирования**.

   Откроется диалоговое окно **Настройка агента тестирования**.

   ![Настройка агента тестирования для Visual Studio](media/configure-test-agent.png)

2. Выберите **Интерактивный процесс**. Агент тестирования будет запущен как процесс, а не как служба. Нажмите кнопку **Далее**.

3. Введите имя и пароль пользователя, который будет запускать процесс агента тестирования.

   > [!NOTE]
   > - Пользователь, добавляемый для запуска процесса, также должен быть добавлен как член группы TeamTestAgentService на компьютере контроллера тестирования данного агента. Если этот пользователь является текущим, после добавления этого пользователя на компьютере контроллера тестирования необходимо выйти из системы или перезагрузить компьютер.
   > - Пароли NULL для учетных записей пользователей не поддерживаются.
   > - Если необходимо использовать IntelliTrace или адаптер данных и диагностики эмуляции сети, учетная запись должна принадлежать к группе администраторов. Если на компьютере, где выполняется агент тестирования, установлена ОС с учетной записью пользователя с минимальными правами, требуется работать от имени администратора (с повышенными правами). Если имя пользователя агента отсутствует в службе агента, будет предпринята попытка добавить его, для чего требуются соответствующие разрешения на контроллере тестирования.
   > - Пользователь, который пытается использовать контроллер тестирования, должен принадлежать к учетной записи пользователей контроллера тестирования. В противном случае ему не удастся запускать тесты с помощью этого контроллера.

4. Чтобы убедиться, что компьютер, на котором размещен агент тестирования, может выполнять тесты после перезагрузки, можно настроить компьютер для автоматического входа пользователя агента тестирования в систему. Выберите параметр **Автоматический вход**. Это позволит сохранить имя пользователя и пароль в зашифрованной форме в реестре.

   > [!NOTE]
   > При подключении к лабораторной среде с помощью удаленного рабочего стола или гостевого подключения могут часто возникать непредвиденные отсоединения. Одна из возможных причин потери соединения заключается в том, что машина может быть настроена на автоматический вход в сеть.

5. Чтобы убедиться, что заставка выключена, поскольку может мешать автоматическим тестам, взаимодействующим с рабочим столом, выберите **Обеспечить отключение программы-заставки**.

   > [!WARNING]
   > При автоматическом входе или отключении заставки есть вероятность угрозы безопасности. Включая автоматический вход, вы разрешаете другим пользователям включать компьютер и использовать учетную запись автоматического входа. Если отключить заставку, компьютер может не отобразить запрос для ввода учетных данных для разблокирования компьютера. Это позволит любому, находящемуся рядом, получить доступ к компьютеру. Если эти функции включаются, необходимо предотвратить возможный физический доступ посторонних к компьютеру. Например, расположите компьютеры в закрываемой лаборатории. Снятие флажка **Обеспечить отключение программы-заставки** не приводит к включению заставки.

   Чтобы вернуть запуск агента в качестве службы, воспользуйтесь тем же средством, но выберите **Служба**.

6. Чтобы применить изменения, выберите **Применить параметры**.

   На экране появляется диалоговое окно **Сводка по конфигурации**, в котором приводятся сведения о состоянии каждого этапа настройки агента тестирования.

7. Чтобы закрыть диалоговое окно **Сводка по конфигурации**, нажмите кнопку **Закрыть**. Затем нажмите кнопку **Закрыть** еще раз, чтобы закрыть **средство настройки агента тестирования**.

   > [!NOTE]
   > Если агент тестирования выполняется как процесс, в области уведомлений отображается соответствующий значок. Он указывает на состояние агента тестирования. С помощью данного средства можно запустить, остановить или перезапустить агент, если он выполняется в качестве процесса. Для запуска агента тестирования в виде процесса (если он еще не запущен), выберите **Пуск** > **Visual Studio** > **Агент тестирования Microsoft Visual Studio**.

   ::: moniker range="vs-2017"
   Если контроллер этого агента тестирования зарегистрирован в Team Foundation Server, состояние агента тестирования, выполняющегося в качестве интерактивного процесса, будет отображаться в представлении **Контроллеры** в **центре лабораторий** для Microsoft Test Manager. В списке перед именем этого агента будет стоять звездочка, обозначающая, что агент выполняется в качестве интерактивного процесса. Чтобы перезапустить этот агент тестирования, нужно использовать средство, работающее на компьютере агента тестирования, а не в представлении **Контроллеры**.
   ::: moniker-end

## <a name="see-also"></a>См. также

- [Установка и настройка агентов тестирования](../test/lab-management/install-configure-test-agents.md)
