---
title: API нагрузочного теста
ms.date: 10/19/2016
ms.topic: conceptual
helpviewer_keywords:
- code, load tests
- plug-ins, load test
- APIs, load tests
ms.assetid: e15567bc-1f21-4feb-b81d-f17ba35cfde5
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: 47707e0430d51a754f7e458ebf68e08124c1e7b5
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62821500"
---
# <a name="how-to-use-the-load-test-api"></a>Как выполнить Использование API-интерфейса нагрузочного теста

Visual Studio поддерживает подключаемые модули нагрузочных тестов, которые могут управлять нагрузочными тестами или расширять их возможности. Подключаемые модули нагрузочных тестов представляют собой пользовательские классы, которые реализуют интерфейс <xref:Microsoft.VisualStudio.TestTools.LoadTesting.ILoadTestPlugin>, содержащийся в пространстве имен <xref:Microsoft.VisualStudio.TestTools.LoadTesting>. Подключаемые модули нагрузочных тестов позволяют осуществлять пользовательское управление нагрузочными тестами, например прерывать выполнение теста при достижении порога счетчиков или ошибок. Чтобы получить или установить параметры нагрузочного теста из пользовательского кода, используйте свойства класса <xref:Microsoft.VisualStudio.TestTools.LoadTesting.LoadTest>. Чтобы присоединить делегаты для отправки уведомлений при выполнении нагрузочного теста, используйте события класса <xref:Microsoft.VisualStudio.TestTools.LoadTesting.LoadTest>.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

> [!TIP]
> Для просмотра пространства имен <xref:Microsoft.VisualStudio.TestTools.LoadTesting> используется обозреватель объектов. Редакторы Visual C# и Visual Basic предоставляют поддержку IntelliSense для создания кода с помощью классов из этого пространства имен.

Можно также создавать подключаемые модули для веб-тестов производительности. Дополнительные сведения см. в разделе [Как Создание подключаемого модуля веб-теста производительности](../test/how-to-create-a-web-performance-test-plug-in.md) и [Практическое руководство. Создание подключаемого модуля уровня запроса](../test/how-to-create-a-request-level-plug-in.md).

## <a name="to-use-the-loadtesting-namespace"></a>Использование пространства имен LoadTesting

1. Откройте проект веб-тестов производительности и нагрузочных тестов, содержащий нагрузочный тест.

2. Добавьте проект библиотеки классов Visual C# или Visual Basic в тестовое решение.

3. Добавьте ссылку на проект библиотеки классов в проект веб-тестов производительности и нагрузочных тестов.

4. Добавьте ссылку на DLL-библиотеку Microsoft.VisualStudio.QualityTools.LoadTestFramework в проект библиотеки классов.

5. В файл класса, расположенный в проекте библиотеки классов, добавьте оператор `using` для пространства имен <xref:Microsoft.VisualStudio.TestTools.LoadTesting>.

6. Создайте открытый класс, реализующий интерфейс <xref:Microsoft.VisualStudio.TestTools.LoadTesting.ILoadTestPlugin>.

7. Выполните построение проекта.

8. Добавьте новый подключаемый модуль нагрузочных тестов с помощью редактора тестовой нагрузки:

    1. Щелкните правой кнопкой мыши корневой узел нагрузочного теста и выберите команду **Добавить подключаемый модуль нагрузочных тестов**.

    2. Откроется диалоговое окно **Добавить подключаемый модуль нагрузочных тестов**.

    3. В области **Свойства выбранного подключаемого модуля** задайте начальные значения для подключаемого модуля, которые будут использоваться во время выполнения.

        > [!NOTE]
        > С помощью подключаемых модулей можно предоставить доступ к произвольному количеству свойств. Их необходимо сделать общедоступными, задаваемыми и относящимися к базовому типу, например к целочисленному, логическому или строковому. Кроме того, свойства подключаемого модуля нагрузочных тестов можно изменить позже в окне **Свойства**.

9. Запустите нагрузочный тест.

     Реализацию интерфейса <xref:Microsoft.VisualStudio.TestTools.LoadTesting.ILoadTestPlugin> см. в разделе [Практическое руководство. Создание подключаемого модуля нагрузочных тестов](../test/how-to-create-a-load-test-plug-in.md).

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualStudio.TestTools.LoadTesting>
- [Создание пользовательского кода и подключаемых модулей для нагрузочных тестов](../test/create-custom-code-and-plug-ins-for-load-tests.md)
- [Практическое руководство. Использование интерфейса API веб-теста производительности](../test/how-to-use-the-web-performance-test-api.md)
- [Практическое руководство. Создание подключаемого модуля нагрузочных тестов](../test/how-to-create-a-load-test-plug-in.md)