---
title: Управление контроллерами и агентами тестирования
description: Узнайте о типичных проблемах, которые могут возникать при работе с контроллерами и агентами тестирования в Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 10/20/2016
ms.topic: troubleshooting
helpviewer_keywords:
- load tests, test controllers
- load tests, troubleshooting
- load tests, test agents
- troubleshooting, test controllers and agents in load tests
ms.assetid: 77329348-3a5d-43de-b6cb-90f93296a081
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.openlocfilehash: 8d9cae19736c9578f812e5e5fcd60dd9c6092e96
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99838286"
---
# <a name="strategies-for-troubleshooting-test-controllers-and-test-agents-in-load-tests"></a>Стратегии устранения неполадок контроллеров и агентов тестирования в нагрузочных тестах

Эта статья описывает типичные проблемы, которые могут возникать при работе с контроллерами и агентами тестирования в Visual Studio.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

## <a name="unable-to-collect-performance-counters-on-test-agent-computer"></a>Не удается собрать счетчики производительности на компьютере агента тестирования

Во время выполнения нагрузочного теста при попытке подключения к компьютеру агента тестирования и сбора счетчиков производительности возможно возникновение ряда ошибок. Служба удаленного реестра — это служба, обеспечивающая предоставление данных о счетчиках производительности на удаленный компьютер. В некоторых операционных системах служба удаленного реестра не запускается автоматически. Чтобы устранить эту проблему, запустите службу удаленного реестра вручную.

> [!NOTE]
> Служба удаленного реестра доступна в **Панели управления**. Выберите пункт **Администрирование**, а затем **Службы**.

Другой причиной этой проблемы является отсутствие достаточных разрешений для чтения данных счетчиков производительности. При локальных выполнениях тестов учетная запись пользователя должна принадлежать группе опытных пользователей (или выше) или группе пользователей системного монитора. При удаленных выполнениях тестов учетная запись, настроенная для контроллера, должна принадлежать группе опытных пользователей (или выше) или группе пользователей системного монитора.

## <a name="set-the-logging-level-on-a-test-controller-computer"></a>Установка уровня ведения журнала на компьютере контроллера тестирования

На компьютере контроллера тестирования можно управлять уровнем ведения журнала. Это полезно при выявлении причины проблемы во время выполнения нагрузочного теста в среде.

### <a name="to-set-the-logging-level-on-a-test-controller-computer"></a>Установка уровня ведения журнала на компьютере контроллера тестирования

1. Остановите службу контроллера тестирования. В командной строке введите `net stop vsttcontroller`.

2. Откройте файл *QTController.exe.config*. Этот файл расположен в каталоге установки контроллера.

3. Измените запись для параметра `EqtTraceLevel` в разделе диагностики системы файла. Код должен выглядеть примерно следующим образом:

    ```xml
    <system.diagnostics>
        <trace autoflush="true" indentsize="4">
            <listeners>
                <add name="myListener" type="System.Diagnostics.TextWriterTraceListener" initializeData="d:\VSTestHost.log" />
            </listeners>
        </trace>
        <switches>
            <!-- You must use integral values for "value":
                    0 = off,
                    1 = error,
                    2 = warn,
                    3 = info,
                    4 = verbose. -->
            <add name="EqtTraceLevel" value="4" />
        </switches>
    </system.diagnostics>
    ```

4. Сохраните файл.

5. Запустите службу контроллера. В командной строке введите `net start vsttcontroller`.

Это применимо к контроллеру тестирования, службе агента тестирования и процессу агента тестирования. При диагностике проблемы целесообразно включить ведение журнала во всех трех процессах. Процедура по установке уровня журнала одинакова для всех процессов (см. описание установки для контроллера тестирования). Чтобы установить уровни ведения журнала для службы агента тестирования и процесса агента, используйте указанные ниже файлы конфигурации.

- Служба контроллера *QTController.exe.config*

- Служба агента *QTAgentService.exe.config*

- Процесс адаптера обработки данных агента для 32-разрядной архитектуры *QTDCAgent(32).exe.config*

- Процесс адаптера обработки данных агента для 64-разрядной архитектуры *QTDCAgent(64).exe.config*

- Процесс агента тестирования для 32-разрядной архитектуры *QTAgent(32).exe.config*

- Процесс агента тестирования для 64-разрядной архитектуры *QTAgent(64).exe.config*

## <a name="bind-a-test-controller-to-a-network-adapter"></a>Привязка контроллера тестирования к сетевому адаптеру

При попытке установки агента тестирования может появиться следующее сообщение об ошибке.

**Ошибка 8110. Невозможно подключиться к указанному компьютеру контроллера или получить доступ к объекту контроллера.**

Эта ошибка может быть вызвана установкой контроллера тестирования на компьютер с несколькими сетевыми адаптерами.

> [!NOTE]
> Кроме того, проблема может возникнуть при выполнении теста даже при успешной установке агентов тестирования.

Для исправления этой ошибки необходимо привязать контроллер тестирования к одному из сетевых адаптеров. В контроллере тестирования следует задать свойство `BindTo`, а затем изменить агент тестирования так, чтобы он был связан с контроллером тестирования не по имени, а по IP-адресу. Эти действия представлены в следующей процедуре.

### <a name="to-obtain-the-ip-address-of-the-network-adapter"></a>Получение IP-адреса сетевого адаптера

1. Нажмите кнопку **Пуск** и выберите команду **Выполнить**.

     Откроется диалоговое окно **Выполнить**.

2. Введите команду `cmd` и нажмите кнопку **ОК**.

     Открывается окно командной строки.

3. Введите `ipconfig /all`.

     Будут отображены IP-адреса для сетевых адаптеров. Запишите IP-адрес сетевого адаптера, к которому требуется привязать контроллер.

### <a name="to-bind-a-test-controller-to-a-network-adapter"></a>Для привязки контроллера тестирования к сетевому адаптеру выполните следующие действия.

1. Остановите службу контроллера тестирования. В командной строке введите `net stop vsttcontroller`.

2. Откройте файл *QTController.exe.config*. Этот файл находится в папке *%ProgramFiles(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\IDE*.

3. К параметрам приложения добавьте запись для свойства `BindTo`. Укажите IP-адрес сетевого адаптера, к которому требуется привязать контроллер. Код должен выглядеть примерно следующим образом:

    ```xml
    <appSettings>
        <add key="LogSizeLimitInMegs" value="20" />
        <add key="AgentSyncTimeoutInSeconds" value="120" />
        <add key="ControllerServicePort" value="6901" />
        <add key="ControllerUsersGroup" value="TeamTestControllerUsers" />
        <add key="ControllerAdminsGroup" value="TeamTestControllerAdmins" />
        <add key="CreateTraceListener" value="no" />
        <add key="BindTo" value="<YOUR IP ADDRESS>" />
    </appSettings>
    ```

4. Сохраните файл.

5. Запустите службу контроллера тестирования. В командной строке введите `net start vsttcontroller`.

### <a name="to-connect-a-test-agent-to-a-bound-controller"></a>Для подключения агента тестирования к связанному контроллеру выполните следующие действия.

- Еще раз запустите установку агента тестирования. На этот раз вместо имени контроллера тестирования укажите его IP-адрес.

Это применимо к контроллеру тестирования, службе агента тестирования и процессу агента тестирования. Свойство `BindTo` следует установить для каждого процесса, выполняющегося на компьютере с несколькими сетевыми адаптерами. Процедура по установке свойства `BindTo` одинакова для всех процессов (см. описание установки для контроллера тестирования). Чтобы установить уровни ведения журнала для службы агента тестирования и процесса агента тестирования, используйте файлы конфигурации, указанные в разделе [Установка уровня ведения журнала на компьютере контроллера тестирования](#set-the-logging-level-on-a-test-controller-computer).

## <a name="see-also"></a>См. также раздел

- [Контроллеры и агенты тестирования](../test/configure-test-agents-and-controllers-for-load-tests.md)
