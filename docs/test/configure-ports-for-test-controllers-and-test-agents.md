---
title: Настройка портов для контроллеров и агентов тестирования
description: Сведения о том, как изменить входящие порты по умолчанию, используемые контроллером тестирования, агентом тестирования и клиентом, для избежания конфликтов с другим программным обеспечением.
ms.custom: SEO-VS-2020
ms.date: 10/19/2016
ms.topic: how-to
helpviewer_keywords:
- firewalls, configuring for test agents
- firewalls, configuring for test controllers
- test agents, firewalls
- test controllers, firewalls
- agents, firewalls
- controllers, firewalls
ms.assetid: 211edbd7-9fe4-4251-ba85-8bec4363261b
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.openlocfilehash: 78c6dd0f9ffa89f7b1a2ac7ac7a2344b67a47970
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99868053"
---
# <a name="configure-ports-for-test-controllers-and-test-agents"></a>Настройка портов для контроллеров и агентов тестирования

Можно изменить входящие порты по умолчанию, используемые контроллером тестирования, агентом тестирования и клиентом. Такая необходимость может возникнуть при попытке использовать контроллер тестирования, агент тестирования или клиент совместно с каким-либо другим программным обеспечением, вызывающим конфликт портов. Еще одна причина для смены портов — ограничения брандмауэра между контроллером тестирования и клиентом. В этом случае можно вручную задать порт, чтобы контроллер тестирования мог передавать результаты клиенту, минуя брандмауэр.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

На нижеприведенной иллюстрации показаны точки подключения между контроллером тестирования, агентом тестирования и клиентом. На ней показаны порты, используемые для входящих и исходящих подключений, а также ограничения системы безопасности, распространяющиеся на эти порты.

![Порты и безопасность контроллера и агента тестирования](../test/media/test-controller-agent-firewall.png)

## <a name="incoming-connections"></a>Входящие подключения

Контроллер тестирования по умолчанию использует порт 6901, а агент тестирования — порт 6910. Клиент по умолчанию использует случайный порт, который служит для получения результатов тестирования от контроллера. Для всех входящих подключений контроллер тестирований проверяет подлинность вызывающей стороны, а также ее принадлежность к определенной группе безопасности.

- **Контроллер тестирования**. Входящие подключения осуществляются через TCP-порт 6901. При необходимости входящий порт можно изменить. Дополнительные сведения см. в разделе [Настройка входящих портов](#configure-the-incoming-ports).

    Контроллер тестирования должен иметь возможность создания исходящих подключений к агентам тестирования и к клиенту.

    > [!NOTE]
    > Для контроллера тестирования должно быть открыто входящее подключение **Общий доступ к файлам и принтерам**.

- **Агент тестирования**. Входящие подключения осуществляются через TCP-порт 6910. При необходимости входящий порт можно изменить. Дополнительные сведения см. в разделе [Настройка входящих портов](#configure-the-incoming-ports).

   Агент тестирования должен иметь возможность создания исходящих подключений к контроллеру тестирования.

- **Клиент**. По умолчанию для входящих подключений используется случайный TCP-порт. При необходимости входящий порт можно изменить. Дополнительные сведения см. в разделе [Настройка входящих портов](#configure-the-incoming-ports).

   При первой попытке подключения контроллера тестирования к клиенту может появиться уведомление брандмауэра.

   В Windows Server 2008 предупреждения брандмауэра по умолчанию отключены. Чтобы принимать входящие подключения, необходимо вручную добавить исключения брандмауэра для клиентских программ (*devenv.exe*, *mstest.exe*, *mlm.exe*).

## <a name="outgoing-connections"></a>Исходящие подключения

Для всех исходящих подключений используются случайные TCP-порты.

- **Контроллер тестирования**. Контроллер тестирования должен иметь возможность создания исходящих подключений к агентам и к клиенту.

- **Агент тестирования**. Агент тестирования должен иметь возможность создания исходящих подключений к контроллеру.

- **Клиент**. Клиент должен иметь возможность создания исходящих подключений к контроллеру.

## <a name="configure-the-incoming-ports"></a>Настройка входящих портов

Выполните следующие инструкции, чтобы настроить порты для контроллера и агентов тестирования.

- **Служба контроллера**. Чтобы изменить номер порта, измените значение в файле *%ProgramFiles(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\QTCcontroller.exe.config*:

    ```xml
    <appSettings>
      <add key="ControllerServicePort" value="6901"/>
    </appSettings>
    ```

- **Служба агента**. Чтобы изменить номер порта, измените значение в файле *%ProgramFiles(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\QTAgentService.exe.config*:

    ```xml
    <appSettings>
      <add key="AgentServicePort" value="6910"/>
    </appSettings>
    ```

- **Клиент**. С помощью редактора реестра добавьте следующие значения **(DWORD)** . Клиент будет использовать для получения данных от контроллера тестирования один из номеров из указанного диапазона:

     **HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\VisualStudio\12.0\EnterpriseTools\QualityTools\ListenPortRange\PortRangeStart**

     **HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\VisualStudio\12.0\EnterpriseTools\QualityTools\ListenPortRange\PortRangeEnd**

## <a name="see-also"></a>См. также раздел

- [Установка и настройка агентов тестирования](../test/lab-management/install-configure-test-agents.md)
