---
title: Использование платформы модульного тестирования Майкрософт для C++
ms.date: 06/13/2019
ms.topic: conceptual
ms.author: mblome
manager: markl
ms.workload:
- cplusplus
author: mikeblome
ms.openlocfilehash: bcd75724e5124c280d5c3e54bfe870041c432790
ms.sourcegitcommit: ab06cde69d862440b4277bcd9bf02e7b50593a1b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "67132129"
---
# <a name="use-the-microsoft-unit-testing-framework-for-c-in-visual-studio"></a>Использование платформы модульного тестирования Майкрософт для C++ в Visual Studio

Платформа модульного тестирования Майкрософт для C++ включена по умолчанию в рабочую нагрузку **Разработка классических приложений на C++** .

## <a name="separate_project"></a> Создание модульных тестов в отдельном проекте

Как правило, тестовый код запускается в отдельном проекте в том же решении, что и тестируемый код. Инструкции по созданию и настройке тестового проекта см. в статье [Создание модульных тестов для C/C++](writing-unit-tests-for-c-cpp.md).

## <a name="same_project"></a> Создание модульных тестов в том же проекте

В некоторых случаях, например при тестировании функций в библиотеке DLL, которые не экспортируются, может потребоваться создать тесты в том же проекте, что и тестируемая программа. Чтобы создать модульные тесты в том же проекте, выполните указанные ниже действия.

1. Измените свойства проекта так, чтобы он включал заголовки и файлы библиотек, которые необходимы для модульного тестирования.

   1. В **обозревателе решений** щелкните правой кнопкой мыши узел проекта тестируемой программы, а затем выберите пункты **Свойства** > **Свойства конфигурации** > **Каталоги VC++** .

   2. Щелкните стрелку вниз в следующих строках и выберите **\<Изменить>** . Добавьте следующие пути:

      | Каталог | Свойство. |
      |-| - |
      | **Каталоги включаемых файлов** | **$(VCInstallDir)Auxiliary\VS\UnitTest\include** |
      | **Каталоги библиотек** | **$(VCInstallDir)Auxiliary\VS\UnitTest\lib** |

2. Добавьте файл модульного тестирования С++:

   - Щелкните правой кнопкой мыши узел проекта в **обозревателе решений** и последовательно выберите **Добавить** > **Новый элемент** > **Файл C++ (.cpp)** .

## <a name="write-the-tests"></a>Написание тестов

В каждом *CPP*-файле с тестовыми классами должен быть заголовок CppUnitTest.h и оператор using для `using namespace Microsoft::VisualStudio::CppUnitTestFramework`. Тестовый проект уже настроен. Кроме того, он включает определение пространства имен и класс TEST_CLASS с методом TEST_METHOD, чтобы вы могли сразу приступить к работе. Вы можете изменить имя пространства имен, а также имена в скобках в макросах класса и метода.

Для инициализации модулей, классов и методов теста, а также для очистки ресурсов по завершении тестов определены специальные макросы. Эти макросы создают код, который выполняется перед первым обращением к классу или методу и после последней проверки. Дополнительные сведения см. в разделе [Инициализация и очистка](microsoft-visualstudio-testtools-cppunittestframework-api-reference.md#Initialize_and_cleanup).

Для определения условий теста используйте статические методы в классе [Assert](microsoft-visualstudio-testtools-cppunittestframework-api-reference.md#general_asserts). Используйте класс [Logger](microsoft-visualstudio-testtools-cppunittestframework-api-reference.md#logger) для вывода сообщений в **окне вывода**. Добавление атрибутов в методы теста

## <a name="run-the-tests"></a>Запуск тестов

1. В меню **Тест** выберите пункт **Windows** > , а затем пункт **Обозреватель тестов**.

1. Если в окне видны не все тесты, выполните сборку тестового проекта, щелкнув его узел в **обозревателе решений** правой кнопкой мыши и выбрав пункт **Сборка** или **Перестроить**.

1. В **обозревателе тестов** нажмите **Запустить все** или выберите тесты, которые следует запустить. Щелкните тест правой кнопкой мыши, чтобы получить доступ к другим командам, включая запуск в режиме отладки с включенными точками останова.

1. В **окне вывода** выберите в раскрывающемся списке пункт **Тесты**, чтобы просмотреть сообщения, полученные от класса `Logger`:

   ![Окно вывода C++ с сообщениями теста](media/cpp-test-output-window.png)

## <a name="define-traits-to-enable-grouping"></a>Определение признаков для группирования

Для методов теста можно определять признаки, с помощью которых можно классифицировать и группировать тесты в **обозревателе тестов**. Чтобы определить признак, используйте макрос `TEST_METHOD_ATTRIBUTE` . Например, чтобы определить признак с именем `TEST_MY_TRAIT`, выполните следующее.

```cpp
#define TEST_MY_TRAIT(traitValue) TEST_METHOD_ATTRIBUTE(L"MyTrait", traitValue)
```

 Для использования определенных признаков в модульных тестах введите все указанное ниже.

```cpp
BEGIN_TEST_METHOD_ATTRIBUTE(Method1)
    TEST_OWNER(L"OwnerName")
    TEST_PRIORITY(1)
    TEST_MY_TRAIT(L"thisTraitValue")
END_TEST_METHOD_ATTRIBUTE()

TEST_METHOD(Method1)
{
    Logger::WriteMessage("In Method1");
    Assert::AreEqual(0, 0);
}
```

### <a name="c-trait-attribute-macros"></a>Макросы атрибута признака C++

В `CppUnitTest.h` имеются указанные ниже предварительно определенные признаки. Дополнительные сведения см. в разделе [Справочные материалы по API платформы модульного тестирования Майкрософт для C++](microsoft-visualstudio-testtools-cppunittestframework-api-reference.md).

|Макрос|ОПИСАНИЕ|
|-|-----------------|
|`TEST_METHOD_ATTRIBUTE(attributeName, attributeValue)`|Используйте макрос TEST_METHOD_ATTRIBUTE, чтобы определить признак.|
|`TEST_OWNER(ownerAlias)`|Стандартный признак "Владелец" позволяет указать владельца метода теста.|
|`TEST_PRIORITY(priority)`|Стандартный признак "Приоритет" служит для назначения относительного приоритета методам теста.|

## <a name="see-also"></a>См. также

- [Краткое руководство. Разработка на основе тестирования с помощью обозревателя тестов](../test/quick-start-test-driven-development-with-test-explorer.md)
