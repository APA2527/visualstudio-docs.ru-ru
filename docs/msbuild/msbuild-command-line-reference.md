---
title: Справочник по командной строке MSBuild | Документация Майкрософт
description: Узнайте, как использовать командную строку MSBuild.exe для создания файла проекта или решения, и какие параметры можно включить.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: reference
dev_langs:
- VB
- CSharp
- C++
- jsharp
helpviewer_keywords:
- MSBuild, msbuild.exe
- MSBuild, command line reference
- msbuild.exe
ms.assetid: edaa65ec-ab8a-42a1-84cb-d76d5b2f4584
author: ghogen
ms.author: ghogen
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: dcb11fd9bfec3fc2818751dd74ba3c0ac4dd12d3
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99919155"
---
# <a name="msbuild-command-line-reference"></a>Справочник по командной строке MSBuild

При использовании *MSBuild.exe* для создания файла проекта или решения можно включить несколько переключателей для указания различных аспектов процесса.

Каждый переключатель доступен в двух формах: -switch и /switch. В документации показана только форма -switch. Регистр в параметрах не учитывается. При запуске MSBuild из оболочки, отличной от командной строки Windows, список аргументов для параметра (разделенных точкой с запятой или запятыми) может потребовать одинарные или двойные кавычки, чтобы гарантировать передачу списков в MSBuild вместо их интерпретации оболочкой.

## <a name="syntax"></a>Синтаксис

```cmd
MSBuild.exe [Switches] [ProjectFile]
```

## <a name="arguments"></a>Аргументы

|Аргумент|Описание|
|--------------|-----------------|
|`ProjectFile`|Создает целевые объекты в указанном файле проекта. Если не указать файл проекта, MSBuild выполнит поиск расширения имени файла, который заканчивается на *proj*, и использует этот файл в текущем рабочем каталоге. Можно также указать файл решения Visual Studio для этого аргумента.|

## <a name="switches"></a>Переключатели

|Параметр|Краткая форма|Описание|
|------------|----------------|-----------------|
|-detailedSummary|-ds|Показывать подробные сведения о созданных конфигурациях и их запланированное использование в узлах в конце журнала сборки.|
|-graphBuild[:`True` или `False`]|-graph[:`True` или `False`]|Указывает MSBuild создать и построить граф проекта. Построение графа включает определение ссылок проекта для образования зависимостей. Построение этого графа включает попытку сборки ссылок проекта до проектов, ссылающихся на них, в отличие от традиционного графика MSBuild. Требуется MSBuild 16 или более поздней версии.|
|-help|/? или -h|Отобразить сведения об использовании. Ниже представлен пример команды.<br /><br /> `msbuild.exe -?`|
|-ignoreProjectExtensions: `extensions`|-ignore: `extensions`|Игнорировать указанные расширения при определении создаваемого файла проекта. Используйте точку с запятой или запятую для разделения нескольких расширений, как показано в следующем примере:<br /><br /> `-ignoreprojectextensions:.vcproj,.sln`|
|-interactive[:`True` или `False`]|-|Указывает, что действия в сборке могут взаимодействовать с пользователем.  Не используйте этот аргумент в автоматизированном сценарии, когда взаимодействие не ожидается. Указание параметра -interactive аналогично указанию параметра -interactive:true.  Используйте параметр, чтобы переопределить значение, переданное из файла ответов.
|-isolateProjects[:`True` или `False`]|-isolate[:`True` или `False`]|Указывает MSBuild собрать каждый проект изолированно. Это более строгий режим MSBuild, так как он требует, чтобы граф проекта был доступен для статического обнаружения во время оценки, но он может улучшить планирование и сократить нагрузку на память при построении большого набора проектов.|
|-maxCpuCount[:`number`]|-m[:`number`]|Указывает максимальное количество параллельных процессов для использования при создании. Если переключатель не указан, значение по умолчанию равно 1. При включении этого переключателя без указания значения MSBuild будет использовать указанное количество процессоров в компьютере. Дополнительные сведения см. в разделе [Параллельное построение нескольких проектов](../msbuild/building-multiple-projects-in-parallel-with-msbuild.md).<br /><br /> В следующем примере MSBuild использует для создания три процесса MSBuild, что позволяет создать три проекта одновременно:<br /><br /> `msbuild myproject.proj -maxcpucount:3`|
|-noAutoResponse|-noautorsp|Не включать какие-либо файлы *MSBuild.rsp* автоматически.|
|-nodeReuse:`value`|-nr:`value`|Включить или отключить повторное использование узлов MSBuild. Можно указать следующие значения:<br /><br /> -   **True**. Узлы сохраняются после создания, чтобы последующие сборки могли использовать их (по умолчанию).<br />-   **False**. Узлы не сохраняются после создания.<br /><br /> Узел соответствует выполняющемуся проекту. Если добавить переключатель **-maxcpucount**, несколько узлов могут выполняться одновременно.|
|-nologo||Не отображать загрузочный баннер или сообщение об авторских правах.|
|<a name="preprocess"></a> -preprocess[:`filepath`]|-pp[:`filepath`]|Создать один сводный файл проекта, встроив все файлы, которые будут импортированы во время создания, с отмеченными границами. Этот переключатель можно использовать для более простого определения импортируемых файлов, расположения, из которого выполняется импорт, и файлов, участвующих в сборке. При использовании этого переключателя проект не создается.<br /><br /> Если вы укажете `filepath`, сводный файл проекта выведет данные в файл. В противном случае выходные данные появятся в окне консоли.<br /><br /> Сведения об использовании элемента `Import` для вставки файла проекта в другой файл проекта см. в разделах [Элемент Import (MSBuild)](../msbuild/import-element-msbuild.md) и [Практическое руководство. Использование одного и того же целевого объекта в нескольких файлах проектов](../msbuild/how-to-use-the-same-target-in-multiple-project-files.md).|
|-outputResultsCache[:cacheFile]|-orc[:cacheFile]|Файл кэша вывода, куда MSBuild запишет содержимое кэша результатов сборки в конце сборки. При установке этого параметра также включаются изолированные сборки (-isolate).|
|-profileEvaluation:`<file>`|-|Профилирует оценку MSBuild и записывает результат в указанный файл. Если указанный файл имеет расширение MD, результат создается в формате Markdown. В противном случае создается файл с разделением табуляцией.|
|-property:`name`=`value`|-p:`name`=`value`|Задать или переопределить указанные свойства уровня проекта, где `name` является именем свойства, а `value` — значением свойства. Укажите каждое свойство отдельно или используйте точку с запятой или запятую для разделения нескольких свойств, как показано в следующем примере:<br /><br /> `-property:WarningLevel=2;OutDir=bin\Debug`|
|-restore|-r|Запустите целевой объект `Restore` до построения фактических целевых объектов.|
|-restoreProperty:`name=value`|-rp:`name=value`|Задавайте или переопределяйте эти свойства на уровне проекта только во время восстановления и не используйте свойства, указанные в аргументе -property. `name` — это имя свойства, а `value` — значение свойства. Используйте точку с запятой или запятую для разделения нескольких свойств или укажите каждое свойство отдельно.|
|-target:`targets`|-t:`targets`|Создать указанные целевые объекты в проекте. Укажите каждый целевой объект отдельно или используйте точку с запятой или запятую для разделения нескольких целевых объектов, как показано в следующем примере.<br /><br /> `-target:PrepareResources;Compile`<br /><br /> Если с помощью этого переключателя указать какие-либо целевые объекты, они запустятся вместо целевых объектов в атрибуте `DefaultTargets` в файле проекта. Дополнительные сведения см. в статьях [Порядок сборки целевого объекта](../msbuild/target-build-order.md) и [Практическое руководство. Выбор целевого объекта для первой сборки](../msbuild/how-to-specify-which-target-to-build-first.md).<br /><br /> Целевой объект — это группа задач. Дополнительные сведения см. в разделе [Целевые объекты](../msbuild/msbuild-targets.md).|
|-targets[:`file`]|-ts[:`file`]|Записать список доступных целевых объектов в указанный файл (или на устройство вывода, если файл не задан). При этом процесс сборки фактически не выполняется.|
|-toolsVersion:`version`|-tv:`version`|Указывает версию набора инструментов, который используется для создания проекта, как показано в следующем примере:`-toolsversion:3.5`.<br /><br /> С помощью этого параметра можно собрать проект и указать версию, которая отличается от версии, указанной в [элементе Project (MSBuild)](../msbuild/project-element-msbuild.md). Дополнительные сведения см. в статье [Переопределение параметров ToolsVersion](../msbuild/overriding-toolsversion-settings.md).<br /><br /> Для MSBuild 4.5 можно указать следующие значения `version`: 2.0, 3.5 и 4.0. При выборе версии 4.0 свойство сборки `VisualStudioVersion` указывает, какой вспомогательный набор инструментов следует использовать. Дополнительные сведения см. в разделе о вспомогательных наборах инструментов статьи [Toolset (ToolsVersion)](../msbuild/msbuild-toolset-toolsversion.md) (Набор инструментов ToolsVersion).<br /><br /> Набор инструментов состоит из задач, целей и средств, используемых для создания приложения. Средства включают компиляторы *csc.exe* и *vbc.exe*. Дополнительные сведения о наборах инструментов см. в статьях [Набор инструментов ToolsVersion](../msbuild/msbuild-toolset-toolsversion.md), [Стандартные и настраиваемые конфигурации набора инструментов](../msbuild/standard-and-custom-toolset-configurations.md) и [Настройка для различных версий](../msbuild/msbuild-multitargeting-overview.md). **Примечание.**  Версия набора инструментов отличается от версии целевой платформы (требуемой версии .NET Framework, для которой создается проект). Дополнительные сведения см. в статье [Целевая рабочая среда и целевая платформа](../msbuild/msbuild-target-framework-and-target-platform.md).|
|-validate:[`schema`]|-val[`schema`]|Проверить файл проекта и, если проверка прошла успешно, создать проект.<br /><br /> Если не указать `schema`, проект проверяется по схеме, заданной по умолчанию.<br /><br /> При указании `schema` проект проверяется по указанной вами схеме.<br /><br /> Примером является следующий параметр: `-validate:MyExtendedBuildSchema.xsd`.|
|-verbosity:`level`|-v:`level`|Указывает объем сведений, отображаемый в журнале сборки. Каждое средство ведения журнала отображает события, в соответствии с уровнем детализации, заданным для этого средства ведения журнала.<br /><br /> Можно указать следующие уровни детализации: `q[uiet]`, `m[inimal]`, `n[ormal]` (по умолчанию), `d[etailed]` и `diag[nostic]`.<br /><br /> Примером является следующий параметр: `-verbosity:quiet`.
|-version|-ver|Отобразить только сведения о версии. Проект не создается.|
|@`file`||Вставить параметры командной строки из текстового файла. Если имеется несколько файлов, можно указать их отдельно. Дополнительные сведения см. в статье [Файлы ответов MSBuild](../msbuild/msbuild-response-files.md).|
|-warnAsError[:`code`[`;code2`]|-err[`:code`[`;code2`]|Список кодов предупреждений, которые обрабатываются как ошибки.  Для разделения нескольких кодов предупреждений используйте точку с запятой или запятую. Чтобы обрабатывать все предупреждения как ошибки, используйте параметр без значений. Если предупреждение рассматривается как ошибка, целевой объект продолжит выполняться так, как если бы это было предупреждение, но общая сборка завершается ошибкой.<br/><br/>Пример: `-err:MSB4130`|
|-warnAsMessage[:`code`[`;code2`]|-noWarn[:`code`[`;code2`]|Список кодов предупреждений, которые обрабатываются как сообщения с низким уровнем важности.  Для разделения нескольких кодов предупреждений используйте точку с запятой или запятую.<br/><br/>Пример: `-noWarn:MSB3026`|

### <a name="switches-for-loggers"></a>Параметры для средств ведения журнала

|Параметр|Краткая форма|Описание|
|------------|----------------|-----------------|
|-binaryLogger[:[LogFile=]`output.binlog`<br/>[;ProjectImports=[None,Embed,ZipFile]]]|-bl|Сериализует все события сборки в сжатый двоичный файл. По умолчанию файл находится в текущем каталоге и с именем *msbuild.binlog*. Двоичный журнал является подробным описанием процесса сборки, который можно впоследствии применять для воссоздания текстовых журналов и использования другими инструментами анализа. Двоичный журнал обычно в 10–20 раз меньше самого детализированного текстового журнала уровня диагностики, но он содержит больше информации.<br /><br />Средство ведения двоичного журнала по умолчанию собирает исходный текст файлов проекта, включая все импортированные проекты и целевые файлы, найденные во время сборки. Это поведение контролируется обязательным параметром `ProjectImports`:<br /><br /> -   **ProjectImports=None**. Не объединять импортируемые пространства имен проекта.<br /> -   **ProjectImports=Embed**. Внедрить импортируемые пространства имен проекта в файл журнала (по умолчанию).<br /> -   **ProjectImports=ZipFile**. Сохранить файлы проекта в *\<output>.projectimports.zip*, где \<output> — имя, совпадающее с именем двоичного файла журнала.<br /><br />Значение по умолчанию для ProjectImports — "Embed".<br />**Примечание.** Средство ведения журнала не собирает исходные файлы, отличные от MSBuild, например *.cs*, *.cpp* и т. д.<br />Файл *.binlog* можно "воспроизвести", передав его в *msbuild.exe* в качестве аргумента, а не решения или проекта. Другие средства ведения журнала будут получать сведения, содержащиеся в файле журнала, как если бы выполнялась исходная сборка. Дополнительные сведения о двоичном журнале и способах его использования можно найти на следующей странице: https://github.com/Microsoft/msbuild/wiki/Binary-Log <br /><br />**Примеры**:<br /> -   `-bl`<br /> -    `-bl:output.binlog`<br /> -   `-bl:output.binlog;ProjectImports=None`<br /> -   `-bl:output.binlog;ProjectImports=ZipFile`<br /> -   `-bl:..\..\custom.binlog`<br /> -   `-binaryLogger`|
|-consoleLoggerParameters:<br /><br /> `parameters`|-clp:`parameters`|Передать указанные параметры в средство ведения журнала консоли, в окне консоли которого отображаются сведения о сборке. Можно задать следующие параметры:<br /><br /> -   **PerformanceSummary**. Отобразить время, затраченное на выполнение задач, целей и проектов.<br />-   **Summary**. Показать сводку ошибок и предупреждений в конце.<br />-   **NoSummary**. Не показывать сводку ошибок и предупреждений в конце.<br />-   **ErrorsOnly**. Показать только ошибки.<br />-   **WarningsOnly**. Показать только предупреждения.<br />-   **NoItemAndPropertyList**. Не показывать список элементов и свойств, появляющийся в начале каждой сборки проекта, если значение уровня детализации — `diagnostic`.<br />-   **ShowCommandLine**. Показать сообщения `TaskCommandLineEvent`.<br />-   **ShowTimestamp**. Показывать метку времени в качестве префикса для любого сообщения.<br />-   **ShowEventId**. Показать идентификатор события для каждого запущенного события, завершенного события и сообщения.<br />-   **ForceNoAlign**. Не выравнивать текст по размеру буфера консоли.<br />-   **DisableConsoleColor**. Использовать цвета консоли по умолчанию для всех сообщений журнала.<br />-   **DisableMPLogging**. Отключить многопроцессорное ведение журнала выходных данных в режиме, отличном от многопроцессорного.<br />-   **EnableMPLogging**. Включить многопроцессорное ведение журнала даже при работе в режиме, отличном от многопроцессорного. Такое ведение журнала включено по умолчанию.<br />-   **Verbosity**. Переопределяет параметр **-verbosity**, заданный для этого средства ведения журнала.<br /><br /> Используйте точку с запятой для разделения нескольких параметров, как показано в следующем примере.<br /><br /> `-consoleloggerparameters:PerformanceSummary;NoSummary -verbosity:minimal`<br/><br/> Средство ведения журнала консоли по умолчанию имеет обычную детализацию и включает `Summary`.|
|-distributedFileLogger|-dfl|Записывать выходные данные сборки каждого узла MSBuild в собственный файл. Первоначальным расположением этих файлов является текущий каталог. По умолчанию файлам присваиваются имена *MSBuild\<NodeId>.log*. Чтобы указать расположение файлов и другие параметры для средства ведения журнала fileLogger, используйте переключатель **-fileLoggerParameters**.<br /><br /> Если вы укажете имя для файла журнала с помощью переключателя **-fileLoggerParameters**, распределенное средство ведения журнала будет использовать это имя как шаблон, добавляя к нему значение идентификатора узла при создании файлов журнала для каждого узла.|
|-distributedLogger:<br /><br /> `central logger`*<br /><br /> `forwarding logger`|-dl:`central logger`*`forwarding logger`|Вести журнал событий из MSBuild, присоединяя разные экземпляры журнала к каждому узлу. Чтобы указать несколько средств ведения журнала, укажите отдельно каждое из них.<br /><br /> Синтаксис средства ведения журнала позволяет указать средство ведения журнала. Синтаксис средства ведения журнала представлен ниже в описании переключателя **-logger**.<br /><br /> В следующих примерах демонстрируется использование этого переключателя.<br /><br /> `-dl:XMLLogger,MyLogger,Version=1.0.2,Culture=neutral`<br /><br /> `-dl:MyLogger,C:\My.dll*ForwardingLogger,C:\Logger.dll`|
|-fileLogger<br /><br /> *[число]*|-fl[`number`]|Записать выходные данные сборки в один файл в текущем каталоге. Если не указать `number`, выходной файл будет назван *msbuild.log*. Если указать `number`, именем выходного файла будет *msbuild\<n>.log*, где \<n> — `number`. Значение `Number` может быть цифрой от 1 до 9.<br /><br /> Чтобы указать расположение файлов и другие параметры для средства ведения журнала fileLogger, используйте переключатель **-fileLoggerParameters**.|
|-fileLoggerParameters[number]:<br /><br /> `parameters`|-flp[ `number`]: `parameters`|Указывает любые дополнительные параметры для средства ведения журнала файла и распределенного средства ведения журнала файла. Наличие этого параметра подразумевает, что присутствует и соответствующий параметр — **filelogger[** `number` **]** . Значение `Number` может быть цифрой от 1 до 9.<br /><br /> Можно использовать все параметры, которые указаны для **-consoleloggerparameters**. Также можно использовать один или несколько следующих параметров:<br /><br /> -   **LogFile**. Путь к файлу журнала, в который записывается журнал сборки. Распределенное средство ведение журнала файла добавляет этот путь к именам файлов журнала.<br />-   **Append**. Определяет, добавляется ли журнал сборки в файл журнала или перезаписывает его. Если задать переключатель, журнал сборки добавляется в файл журнала. Если переключатель отсутствует, содержимое существующего файла журнала перезаписывается.<br />     Пример: `msbuild myfile.proj -flp:FileLogger,Microsoft.Build;logfile=MyLog.log;append`<br />     Если явным образом указать значение `true` или `false`, то журнал добавляется независимо от параметра. Если переключатель добавления не указан, журнал будет перезаписан.<br />     В этом случае файл перезаписывается: `msbuild myfile.proj -flp:FileLogger,Microsoft.Build;logfile=MyLog.log`.<br />     В этом случае файл добавляется: `msbuild myfile.proj -flp:FileLogger,Microsoft.Build;logfile=MyLog.log;append=true`.<br />     В этом случае файл добавляется: `msbuild myfile.proj -flp:FileLogger,Microsoft.Build;logfile=MyLog.log;append=false`.<br />-   **Encoding**. Указывает кодировку для файла (например, UTF-8, Юникод или ASCII).<br /><br /> В следующем примере создаются отдельные файлы журнала для предупреждений и ошибок.<br /><br /> `-flp1:logfile=errors.txt;errorsonly -flp2:logfile=warnings.txt;warningsonly`<br /><br /> Ниже приведены примеры других возможностей.<br /><br /> `-fileLoggerParameters:LogFile=MyLog.log;Append; Verbosity=diagnostic;Encoding=UTF-8`<br /><br /> `-flp:Summary;Verbosity=minimal;LogFile=msbuild.sum`<br /><br /> `-flp1:warningsonly;logfile=msbuild.wrn`<br /><br /> `-flp2:errorsonly;logfile=msbuild.err`|
|-logger:<br /><br /> `logger`|-l:`logger`|Задает средство ведения журнала для записи событий MSBuild. Чтобы указать несколько средств ведения журнала, укажите отдельно каждое из них.<br /><br /> Используйте следующий синтаксис для `logger`: `[``LoggerClass``,]``LoggerAssembly``[;``LoggerParameters``]`.<br /><br /> Используйте следующий синтаксис для `LoggerClass`: `[``PartialOrFullNamespace``.]``LoggerClassName`.<br /><br /> Если сборка содержит ровно одно средство ведения журнала, его класс указывать не нужно.<br /><br /> Используйте следующий синтаксис для `LoggerAssembly`: `{``AssemblyName``[,``StrongName``] &#124;` `AssemblyFile``}`.<br /><br /> Параметры средства ведения журнала являются необязательными и передаются в него точно по мере их ввода.<br /><br /> В следующих примерах используется переключатель **-logger**.<br /><br /> `-logger:XMLLogger,MyLogger,Version=1.0.2,Culture=neutral`<br /><br /> `-logger:XMLLogger,C:\Loggers\MyLogger.dll;OutputAsHTML`|
|-noConsoleLogger|-noconlog|Отключить средство ведения журнала консоли по умолчанию и не записывать события на консоль.|

## <a name="example-1"></a>Пример 1

 В следующем примере создается целевой объект `rebuild` проекта *MyProject.proj*.

```cmd
MSBuild.exe MyProject.proj -t:rebuild
```

## <a name="example-2"></a>Пример 2

 Файл *MSBuild.exe* можно использовать для выполнения более сложных сборок. Например, можно использовать его для создания конкретных целевых объектов определенных проектов в решении. В следующем примере повторно создается проект `NotInSolutionFolder` и удаляется проект `InSolutionFolder`, который находится в папке решения *Новая_папка*.

```cmd
msbuild SlnFolders.sln -t:NotInSolutionfolder:Rebuild;NewFolder\InSolutionFolder:Clean
```

## <a name="see-also"></a>См. также

- [Справочные сведения о MSBuild](../msbuild/msbuild-reference.md)
- [Общие свойства проектов MSBuild](../msbuild/common-msbuild-project-properties.md)
