---
title: Функция SccgetCommandOptions (ru) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccGetCommandOptions
helpviewer_keywords:
- SccGetCommandOptions function
ms.assetid: bbe4aa4e-b4b0-403e-b7a0-5dd6eb24e5a9
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: eeefa26422476ca40e782df3ff35eee9d429a149
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80700832"
---
# <a name="sccgetcommandoptions-function"></a>Функция SccgetCommandOptions
Эта функция подсказывает пользователю расширенные параметры для данной команды.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccGetCommandOptions(
   LPVOID pvContext,
   HWND hWnd,
   enum SCCCOMMAND iCommand,
   LPCMDOPTS* ppvOptions
);
```

### <a name="parameters"></a>Параметры
 pvКонтекст

(в) Структура контекста управления исходным элементом.

 Hwnd

(в) Ручка к окну IDE, которую плагин управления исходным элементом может использоваться в качестве родительского элемента для любых диалоговых коробок, которые она предоставляет.

 Icommand

(в) Команда, для которой запрашиваются расширенные параметры (см. [код команды](../extensibility/command-code-enumerator.md) для возможных значений).

 ppvOptions

(в) Структура опции (также `NULL`может быть).

## <a name="return-value"></a>Возвращаемое значение
 Ожидается, что внедрение этой функции элемента управления исходным элементом вернет одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Успешно.|
|SCC_I_ADV_SUPPORT|Плагин управления исходным элементом поддерживает расширенные параметры команды.|
|SCC_I_OPERATIONCANCELED|Пользователь отменил диалоговый ящик для подключаемых **опционов** управления исходным элементом.|
|SCC_E_OPTNOTSUPPORTED|Плагин управления исходным элементом не поддерживает эту операцию.|
|SCC_E_ISCHECKEDOUT|Не удается выполнить эту операцию в файле, который в настоящее время выявляется.|
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления исходным кодом, вероятно, из-за проблем с сетью или раздором. Рекомендуется повторная попытка.|
|SCC_E_NONSPECIFICERROR|Неспецифический сбой.|

## <a name="remarks"></a>Примечания
 IDE вызывает эту функцию в `ppvOptions` = `NULL` первый раз, чтобы определить, поддерживает ли плагин управления исходным управлением функцию расширенных опций для указанной команды. Если плагин поддерживает функцию для этой команды, IDE вызывает эту функцию снова, когда пользователь запрашивает расширенные параметры (обычно реализованные `ppvOptions` в качестве `NULL` **кнопки Advanced** в диалоговом поле) и поставляет указатель, не относящемся к нулю, к указателю. Плагин хранит любые расширенные опции, указанные пользователем в частной `ppvOptions`структуре, и возвращает указатель на эту структуру в. Затем эта структура передается всем другим функциям API-кода управления исходным элементом, которые должны знать о ней, включая последующие вызовы функции. `SccGetCommandOptions`

 Пример может помочь прояснить эту ситуацию.

 Пользователь выбирает команду **Get,** а IDE отображает поле **диалога Get.** IDE вызывает `SccGetCommandOptions` функцию `iCommand` с `SCC_COMMAND_GET` `ppvOptions` набором `NULL`и установить на . Это интерпретируется плагином управления исходным источником как вопрос: «Есть ли у вас какие-либо расширенные варианты для этой команды?» Если плагин возвращается, `SCC_I_ADV_SUPPORT`IDE отображает **расширенную** кнопку в поле **Get** диалог.

 В первый раз пользователь нажимает **кнопку** `SccGetCommandOptions` Расширенный, `NULL` IDE снова`NULL``ppvOptions` вызывает функцию, на этот раз с не-что указывает на указатель. Плагин отображает свой собственный диалоговой ящик **Get Options,** подсказывает пользователю информацию, помещает эту информацию в `ppvOptions`свою собственную структуру и возвращает указатель на эту структуру в.

 Если пользователь нажимает **Расширенный** снова в том же `SccGetCommandOptions` диалоговом `ppvOptions`поле, IDE вызывает функцию снова без изменения, так что структура передается обратно в плагин. Это позволяет плагину репрефировать свой диалоговый ящик на значения, которые пользователь установил ранее. Плагин изменяет структуру на месте перед возвращением.

 Наконец, когда пользователь нажимает **OK** в поле **диалога** IDE, IDE вызывает [SccGet](../extensibility/sccget-function.md), проходя структуру, возвращенную в `ppvOptions` том, что содержит расширенные параметры.

> [!NOTE]
> Команда `SCC_COMMAND_OPTIONS` используется, когда IDE отображает диалоговое окно **Options,** которое позволяет пользователю устанавливать настройки, которые контролируют работу интеграции. Если плагин управления исходным элементом хочет предоставить свой собственный диалоговый ящик предпочтений, он может отображать его с кнопки **Advanced** в диалоговом поле IDE. Плагин несет полную ответственность за получение и сохранение этой информации; IDE не использует его и не изменяет его.

## <a name="see-also"></a>См. также
- [Функции API управления исходным элементом](../extensibility/source-control-plug-in-api-functions.md)
- [Командный код](../extensibility/command-code-enumerator.md)
