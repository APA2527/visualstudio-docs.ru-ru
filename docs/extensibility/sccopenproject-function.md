---
title: Функция Сккопенпрожект | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccOpenProject
helpviewer_keywords:
- SccOpenProject function
ms.assetid: d609510b-660a-46d7-b93d-2406df20434d
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: a6aa4a715f8d1b87aa831f6a315f07a19e5d4f46
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72721054"
---
# <a name="sccopenproject-function"></a>Функция SccOpenProject
Эта функция открывает существующий проект системы управления версиями или создает новый.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccOpenProject (
   LPVOID        pvContext,
   HWND          hWnd,
   LPSTR         lpUser,
   LPCSTR        lpProjName,
   LPCSTR        lpLocalProjPath,
   LPSTR         lpAuxProjPath,
   LPCSTR        lpComment,
   LPTEXTOUTPROC lpTextOutProc,
   LONG          dwFlags
);
```

#### <a name="parameters"></a>Параметры
 пвконтекст

окне Структура контекста подключаемого модуля системы управления версиями.

 hWnd

окне Обработчик окна интегрированной среды разработки, который может использоваться подключаемым модулем системы управления версиями в качестве родительского для любых предоставляемых им диалоговых окон.

 лпусер

[вход, выход] Имя пользователя (не превышать SCC_USER_SIZE, включая знак завершения NULL).

 лппрожнаме

окне Строка, идентифицирующая имя проекта.

 лплокалпрожпас

окне Путь к рабочей папке проекта.

 лпаукспрожпас

[вход, выход] Необязательная вспомогательная строка, идентифицирующая проект (не превышать SCC_AUXPATH_SIZE, включая знак завершения NULL).

 лпкоммент

окне Закомментируйте новый проект, который создается.

 лптекстаутпрок

окне Необязательная функция обратного вызова для вывода текста из подключаемого модуля системы управления версиями.

 dwFlags

окне Сигнализирует, нужно ли создать новый проект, если проект неизвестен для подключаемого модуля системы управления версиями. Значение может быть сочетанием `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN.`

## <a name="return-value"></a>Возвращаемое значение
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:

|значения|Описание|
|-----------|-----------------|
|SCC_OK|Открытие проекта завершено успешно.|
|SCC_E_INITIALIZEFAILED|Не удалось инициализировать проект.|
|SCC_E_INVALIDUSER|Пользователь не смог войти в систему управления версиями.|
|SCC_E_COULDNOTCREATEPROJECT|Проект не существовал до вызова.  установлен флаг `SCC_OPT_CREATEIFNEW`, но не удалось создать проект.|
|SCC_E_PROJSYNTAXERR|Недопустимый синтаксис проекта.|
|SCC_E_UNKNOWNPROJECT|Проект неизвестен для подключаемого модуля системы управления версиями, а флаг `SCC_OPT_CREATEIFNEW` не установлен.|
|SCC_E_INVALIDFILEPATH|Недопустимый или непригодный к использованию путь к файлу.|
|SCC_E_NOTAUTHORIZED|Пользователю не разрешено выполнять эту операцию.|
|SCC_E_ACCESSFAILURE|Возникла проблема при доступе к системе управления версиями, возможно, из-за проблем с сетью или состязаниями. Рекомендуется повторить попытку.|
|SCC_E_NONSPECFICERROR|Неконкретный сбой; система управления версиями не инициализирована.|

## <a name="remarks"></a>Заметки
 Интегрированная среда разработки может передать имя пользователя (`lpUser`) или просто передать указатель на пустую строку. При наличии имени пользователя подключаемый модуль системы управления версиями должен использовать его по умолчанию. Однако если имя не было передано или если не удалось выполнить вход с указанным именем, подключаемый модуль должен предложить пользователю войти в систему и вернуть допустимое имя в `lpUser` при получении допустимого `.` входа, так как подключаемый модуль может изменить строку имени пользователя. , интегрированная среда разработки всегда выделяет буфер размера (`SCC_USER_LEN` + 1 или SCC_USER_SIZE, который включает пробел для терминатора null).

> [!NOTE]
> Первое действие, которое может потребоваться интегрированной среде разработки, может быть вызовом функции `SccOpenProject` или [сккжетпрожпас](../extensibility/sccgetprojpath-function.md). По этой причине оба они имеют идентичный параметр `lpUser`.

 `lpAuxProjPath` и `lpProjName` считываются из файла решения или возвращаются из вызова функции `SccGetProjPath`. Эти параметры содержат строки, которые подключаемый модуль системы управления версиями связывает с проектом и имеют смысл только для подключаемого модуля. Если в файле решения нет таких строк, и пользователю не было предложено просмотреть (возвращающую строку с помощью функции `SccGetProjPath`), среда IDE передает пустые строки как для `lpAuxProjPath`, так и для `lpProjName` и ожидает обновления этих значений подключаемым модулем при появлении функция возвращает значение.

 `lpTextOutProc` — это указатель на функцию обратного вызова, предоставляемую интегрированной средой разработки в подключаемый модуль системы управления версиями для отображения выходных данных результатов команды. Эта функция обратного вызова подробно описывается в [лптекстаутпрок](../extensibility/lptextoutproc.md).

> [!NOTE]
> Если подключаемый модуль системы управления версиями планирует использовать это преимущество, он должен установить флаг `SCC_CAP_TEXTOUT` в [скЦинитиализе](../extensibility/sccinitialize-function.md). Если этот флаг не был установлен или интегрированная среда разработки не поддерживает эту функцию, `lpTextOutProc` будет `NULL`.

 Параметр `dwFlags` определяет результат в случае, если открываемый проект в настоящее время не существует. Он состоит из двух битфлагс, `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN`. Если открываемый проект уже существует, функция просто открывает проект и возвращает `SCC_OK`. Если проект не существует и флаг `SCC_OP_CREATEIFNEW` включен, подключаемый модуль системы управления версиями может создать проект в системе управления версиями, открыть его и вернуть `SCC_OK`. Если проект не существует и флаг `SCC_OP_CREATEIFNEW` выключен, подключаемый модуль должен проверить наличие флага `SCC_OP_SILENTOPEN`. Если этот флаг не включен, подключаемый модуль может запросить у пользователя имя проекта. Если этот флаг включен, подключаемый модуль должен просто возвращать `SCC_E_UNKNOWNPROJECT`.

## <a name="calling-order"></a>Порядок вызова
 В обычном процессе события [скЦинитиализе](../extensibility/sccinitialize-function.md) будет вызываться первым, чтобы открыть сеанс системы управления версиями. Сеанс может состоять из вызова `SccOpenProject`, за которым следуют другие вызовы функции API подключаемого модуля системы управления версиями и завершаются вызовом [сккклосепрожект](../extensibility/scccloseproject-function.md). Такие сеансы могут повторяться несколько раз до вызова [сккунинитиализе](../extensibility/sccuninitialize-function.md) .

 Если подключаемый модуль системы управления версиями устанавливает `SCC_CAP_REENTRANT` бит в `SccInitialize`, то описанная выше последовательность сеансов может повторяться несколько раз в параллельном режиме. Разные структуры `pvContext` отписывают разные сеансы, в которых каждый `pvContext` связан с одним открытым проектом за раз. На основе параметра `pvContext` подключаемый модуль может определить, на какой проект ссылается какой-либо конкретный вызов. Если бит возможности `SCC_CAP_REENTRANT` не задан, подключаемые модули системы управления версиями нонринтрант ограничены возможностью работы с несколькими проектами.

> [!NOTE]
> Бит `SCC_CAP_REENTRANT` был представлен в версии 1,1 API подключаемого модуля системы управления версиями. Он не задан или не учитывается в версии 1,0, а все подключаемые модули системы управления версиями версии 1,0 считаются нонринтрант.

## <a name="see-also"></a>См. также
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccCloseProject](../extensibility/scccloseproject-function.md)
- [SccGetProjPath](../extensibility/sccgetprojpath-function.md)
- [SccInitialize](../extensibility/sccinitialize-function.md)
- [SccUninitialize](../extensibility/sccuninitialize-function.md)
- [Ограничения длины строки](../extensibility/restrictions-on-string-lengths.md)
- [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)