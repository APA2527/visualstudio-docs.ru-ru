---
title: Функция SccOpenProject (англ.) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccOpenProject
helpviewer_keywords:
- SccOpenProject function
ms.assetid: d609510b-660a-46d7-b93d-2406df20434d
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: fbf566e593bb1ddbc31c70de1570d746a14fbdcf
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80700571"
---
# <a name="sccopenproject-function"></a>Функция SccOpenProject
Эта функция открывает существующий проект управления исходным источником или создает новый.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccOpenProject (
   LPVOID        pvContext,
   HWND          hWnd,
   LPSTR         lpUser,
   LPCSTR        lpProjName,
   LPCSTR        lpLocalProjPath,
   LPSTR         lpAuxProjPath,
   LPCSTR        lpComment,
   LPTEXTOUTPROC lpTextOutProc,
   LONG          dwFlags
);
```

#### <a name="parameters"></a>Параметры
 pvКонтекст

(в) Структура контекста управления исходным элементом.

 Hwnd

(в) Ручка к окну IDE, которую плагин управления исходным элементом может использоваться в качестве родительского элемента для любых диалоговых коробок, которые она предоставляет.

 lpUser

(в, вне) Имя пользователя (не превыситSCC_USER_SIZE, включая терминатор NULL).

 lpProjName

(в) Строка, идентифицирующая название проекта.

 lpLocalProjPath

(в) Путь к рабочей папке для проекта.

 lpAuxProjPath

(в, вне) Дополнительная вспомогательная строка, идентифицирующая проект (не превышающей SCC_AUXPATH_SIZE, включая терминатор NULL).

 lpКомментарий

(в) Комментарий к новому проекту, который создается.

 lpTextOutProc

(в) Дополнительная функция обратного вызова для отображения вывода текста из плагина управления исходным управлением.

 dwFlags

(в) Сигналы о том, нужно ли создавать новый проект, если проект неизвестен плагину управления исходным управлением. Значение может быть `SCC_OP_CREATEIFNEW` сочетанием и`SCC_OP_SILENTOPEN.`

## <a name="return-value"></a>Возвращаемое значение
 Ожидается, что внедрение этой функции элемента управления исходным элементом вернет одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Успех в открытии проекта.|
|SCC_E_INITIALIZEFAILED|Проект не может быть инициализирован.|
|SCC_E_INVALIDUSER|Пользователь не может войти в систему управления исходным источником.|
|SCC_E_COULDNOTCREATEPROJECT|Проект не существовал до вызова;  `SCC_OPT_CREATEIFNEW` флаг был установлен, но проект не мог быть создан.|
|SCC_E_PROJSYNTAXERR|Недействительный синтаксис проекта.|
|SCC_E_UNKNOWNPROJECT|Проект неизвестен плагину управления исходным `SCC_OPT_CREATEIFNEW` элементом, и флаг не был установлен.|
|SCC_E_INVALIDFILEPATH|Недействительный или непригодный для вхлых путей файла.|
|SCC_E_NOTAUTHORIZED|Пользователю не разрешается выполнять эту операцию.|
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления исходным кодом, вероятно, из-за проблем с сетью или раздором. Рекомендуется повторная попытка.|
|SCC_E_NONSPECFICERROR|Неспецифический сбой; система управления источниками не была инициализирована.|

## <a name="remarks"></a>Примечания
 IDE может передаваться в`lpUser`имени пользователя (), или он может просто передать в указатель на пустую строку. Если есть имя пользователя, плагин управления исходным элементом должен использовать его по умолчанию. Однако, если имя не было передано, или если логин не удалось с данным именем, плагин `lpUser` должен побудить пользователя`.` войти в систему и будет возвращать действительное имя, когда он`SCC_USER_LEN`получает действительный логин, потому что плагин может изменить строку имени пользователя, IDE всегда будет выделять буфер размера (No 1 или SCC_USER_SIZE, который включает в себя пространство для нулевой терминатор).

> [!NOTE]
> Первым действием, необходимое для выполнения IDE, `SccOpenProject` может быть вызов в функцию или [SccGetProjPath.](../extensibility/sccgetprojpath-function.md) По этой причине оба они `lpUser` имеют одинаковый параметр.

 `lpAuxProjPath`и`lpProjName` считываются из файла решения, или `SccGetProjPath` они возвращаются из вызова в функцию. Эти параметры содержат строки, которые связывает плагин источника с проектом, и имеют значение только для плагина. Если такие строки не находятся в файле решения и пользователю не было `SccGetProjPath` предложено просмотреть (что вернуло бы строку через функцию), IDE передает пустые строки для обоих `lpAuxProjPath` и, `lpProjName`и ожидает, что эти значения будут обновлены плагином, когда эта функция возвращается.

 `lpTextOutProc`является указателем на функцию обратного вызова, предоставляемую IDE плагину управления исходным управлением с целью отображения вывода результатов команды. Эта функция обратного вызова подробно описана в [LPTEXTOUTPROC.](../extensibility/lptextoutproc.md)

> [!NOTE]
> Если плагин управления исходным элементом намеревается воспользоваться `SCC_CAP_TEXTOUT` этим, он должен установить флаг в [SccInitialize.](../extensibility/sccinitialize-function.md) Если этот флаг не был установлен, или если IDE не поддерживает эту функцию, `lpTextOutProc` будет `NULL`.

 Параметр `dwFlags` контролирует результат в случае, если проект, который открывается, в настоящее время не существует. Он состоит из двух `SCC_OP_CREATEIFNEW` `SCC_OP_SILENTOPEN`битфлагов, и . Если открываемый проект уже существует, функция `SCC_OK`просто открывает проект и возвращается. Если проект не существует, `SCC_OP_CREATEIFNEW` и если флаг на, плагин управления исходным кодом может создать проект `SCC_OK`в системе управления исходным кодом, открыть его, и вернуться . Если проект не существует, и `SCC_OP_CREATEIFNEW` если флаг выключен, плагин должен `SCC_OP_SILENTOPEN` проверить на флаг. Если этот флаг не гонит, плагин может побудить пользователя назвать имя проекта. Если этот флаг гона, плагин `SCC_E_UNKNOWNPROJECT`должен просто вернуться.

## <a name="calling-order"></a>Заказ вызова
 При нормальном ходе событий [Scc Initialize](../extensibility/sccinitialize-function.md) будет сначала вызван для открытия сеанса управления исходным кодом. Сеанс может состоять из `SccOpenProject`вызова, а затем других вызовов функции API управления исходным элементом и прекращаться с вызовом в [SccCloseProject.](../extensibility/scccloseproject-function.md) Такие сеансы могут быть повторены несколько раз, прежде чем [SccUninitialize](../extensibility/sccuninitialize-function.md) называется.

 Если плагин управления исходным `SCC_CAP_REENTRANT` элементом устанавливает бит, `SccInitialize`то вышеупомянутая последовательность сессии может быть повторена много раз параллельно. Различные `pvContext` структуры отслеживают различные `pvContext` сеансы, в которых каждый из них связан с одним открытым проектом одновременно. На основе`pvContext` параметра плагин может определить, на какой проект ссылается в каком-либо конкретном вызове. Если бит `SCC_CAP_REENTRANT` возможностей не установлен, плагины управления исходными данными ограничены в возможности работы с несколькими проектами.

> [!NOTE]
> Бит `SCC_CAP_REENTRANT` был представлен в версии 1.1 API подключаемого элемента управления исходным управлением. Он не установлен или игнорируется в версии 1.0, и все плагины управления исходным управлением 1.0 считаются нереукторанами.

## <a name="see-also"></a>См. также
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccCloseProject](../extensibility/scccloseproject-function.md)
- [SccGetProjPath](../extensibility/sccgetprojpath-function.md)
- [SccInitialize](../extensibility/sccinitialize-function.md)
- [SccUninitialize](../extensibility/sccuninitialize-function.md)
- [Ограничения длины строки](../extensibility/restrictions-on-string-lengths.md)
- [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)
