---
title: Управление сопоставлениями файлов Side-by-Side | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- verbs, setting default
ms.assetid: 9b6df3bc-d15c-4a5d-9015-948a806193b7
author: gregvanl
ms.author: gregvanl
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: f6cd0ac349d332f7e07d4f0ce6e5567cb5deb63c
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62907257"
---
# <a name="manage-side-by-side-file-associations"></a>Управление сопоставлениями файлов side-by-side

Если пакет VSPackage предоставляет сопоставления файлов, необходимо решить, как обрабатывать side-by-side установок, в котором на конкретную версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] должны вызываться для открытия файла. Несовместимые форматы файлов комплексной проблему.

Пользователи ожидают, что новая версия продукта для обеспечения совместимости с более ранними версиями, таким образом, чтобы существующие файлы могут загружаться в новой версии без потери данных. В идеальном случае VSPackage можно как загрузить и сохранить в форматах, более ранних версий. Если это не так, следует предлагать выполнить обновление до новой версии пакета VSPackage формат файла. Недостатком этого подхода является то, что обновленный файл невозможно открыть в более ранней версии.

Чтобы избежать этой проблемы, можно изменить расширения условий несовместимые форматы файлов. Например, первой версии VSPackage может использовать расширение, *.mypkg10*и версии 2 может использовать расширение, *.mypkg20*. Это различие определяет VSPackage, который открывает определенный файл. При добавлении новых пакетов VSPackage в список программ, которые связаны с расширением старого, пользователи могут щелкните правой кнопкой мыши файл и выберите Открыть его в новой VSPackage. На этом этапе VSPackage могут предлагать обновления файла в новый формат или откройте файл и поддерживать совместимость с предыдущими версиями пакета VSPackage.

> [!NOTE]
> Вы можете объединить эти подходы. Например можно предложить обратной совместимости, загрузив старый файл и предлагать обновить формат файла, когда пользователь сохраняет его.

## <a name="face-the-problem"></a>Сталкиваются с этой проблемой

Если требуется несколько пакетов VSPackage side-by-side использовать то же самое расширение, необходимо выбрать версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] , связанном с расширением. Ниже приведены два варианта:

- Откройте файл в последнюю версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] установлен на компьютере пользователя.

   В этом случае установщик отвечает за определение последнюю версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] включительно, в записи реестра для сопоставления файлов. В пакет установщика Windows, можно включить настраиваемые действия, чтобы задать свойство, указывающее последнюю версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].

  > [!NOTE]
  > В данном контексте «latest» означает «последнюю поддерживаемую версию.» Эти записи не может автоматически определить одной из следующих версий [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]. Записи в [обнаружение требования к системе](../extensibility/internals/detecting-system-requirements.md) и в [команды, должен быть запуска после установки](../extensibility/internals/commands-that-must-be-run-after-installation.md) похожи на те из них, представленные здесь и необходимы для поддержки дополнительных версий [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].

   Следующие строки в таблице CustomAction свойства DEVENV_EXE_LATEST как свойство, задаваемое AppSearch и RegLocator таблицы, описанные в [команды, которые должны выполняться после установки](../extensibility/internals/commands-that-must-be-run-after-installation.md). Строки в таблице InstallExecuteSequence запланировать пользовательские действия в начале последовательности execute. Значения в столбец марки условия работы логики:

  - Visual Studio .NET 2002 является последней версией, если он присутствует только в версии.

  - Visual Studio .NET 2003 является последней версией, только в том случае, если он присутствует и [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] отсутствует.

  - [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] является последней версией, если он присутствует только в версии.

    Конечным результатом является то, что DEVENV_EXE_LATEST содержит путь к последней версии devenv.exe.

  **Строки таблицы CustomAction, определить последнюю версию Visual Studio**

  |Действие|Тип|Source|целевого объекта|
  |------------|----------|------------|------------|
  |CA_SetDevenvLatest_2002|51|DEVENV_EXE_LATEST|[DEVENV_EXE_2002]|
  |CA_SetDevenvLatest_2003|51|DEVENV_EXE_LATEST|[DEVENV_EXE_2003]|
  |CA_SetDevenvLatest_2005|51|DEVENV_EXE_LATEST|[DEVENV_EXE_2005]|

  **Строки таблицы InstallExecuteSequence, определить последнюю версию Visual Studio**

  |Действие|Условие|Sequence|
  |------------|---------------|--------------|
  |CA_SetDevenvLatest_2002|DEVENV_EXE_2002 AND NOT (DEVENV_EXE_2003 ИЛИ DEVENV_EXE_2005)|410|
  |CA_SetDevenvLatest_2003|DEVENV_EXE_2003 И НЕ DEVENV_EXE_2005|420|
  |CA_SetDevenvLatest_2005|DEVENV_EXE_2005|430|

   Можно использовать свойство DEVENV_EXE_LATEST в таблице реестра пакета установщика Windows для записи **HKEY_CLASSES_ROOT*ProgId*ShellOpenCommand** значение ключа по умолчанию, [DEVENV_EXE_LATEST] «%1»

- Запустите программу Общие средства запуска, которая может сделать лучший выбор из доступных версий пакета VSPackage.

   Разработчики [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] выбирают этот подход, чтобы обрабатывать сложные требования несколько форматов решений и проектов, возникающие в результате многих версиях операционной системы [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]. При таком подходе зарегистрируйте средство запуска программы, как обработчик расширений. Средство запуска проверяет файл и решает, какую версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] и VSPackage может обрабатывать конкретного файла. Например, если пользователь открывает файл, который был сохранен на конкретную версию пакета VSPackage, средство запуска можно запустить этот пакет VSPackage в соответствующей версии [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]. Кроме того пользователь может настроить средство запуска всегда запускается последней версии. Средство запуска также могут предлагать обновить формат файла. Если формат файла содержит номер версии, средство запуска может уведомляет пользователя, если формат файла — начиная с версии более поздней, чем один или несколько из установленных пакетов VSPackage.

   Средство запуска должно быть в компоненте установщика Windows, который совместно со всеми версиями пакета VSPackage. Этот процесс гарантирует, что последняя версия всегда устанавливается и не удаляется, пока не будут удалены все версии VSPackage. Таким образом сопоставления файлов и другим записям реестра, запуск компонента сохраняются даже в случае удаления одной версии VSPackage.

## <a name="uninstall-and-file-associations"></a>Удалите и сопоставления файлов

Удаление пакета VSPackage, который записывает записи реестра для сопоставления файлов удаляет сопоставления файлов. Таким образом у расширения есть нет связанных программ. Установщик Windows не «recover» записи реестра, которые были добавлены при установке VSPackage. Ниже приведены некоторые способы, чтобы исправить сопоставления файлов пользователя.

- Использование компонента общего запуска как описано выше.

- Пользователю следует запустить восстановление версии VSPackage, который пользователь хочет сопоставление файлов.

- Укажите отдельный исполняемую программу, которая перезапишет соответствующие записи в реестр.

- Укажите параметры страницы или диалогового окна окно настроек, позволяет пользователям выбрать сопоставления файлов и освободить потеряны ассоциации. Попросите пользователей запустить ее после удаления.

## <a name="see-also"></a>См. также

- [Регистрация расширений имен файлов для развертываний side-by-side](../extensibility/registering-file-name-extensions-for-side-by-side-deployments.md)
- [Регистрация команд для расширений имен файлов](../extensibility/registering-verbs-for-file-name-extensions.md)