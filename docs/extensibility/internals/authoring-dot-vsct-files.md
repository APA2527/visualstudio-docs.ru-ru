---
title: Работы. Файлы vsct | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- VSCT files, manual authoring
ms.assetid: e9f715dc-12b7-439b-bdf3-f3dc75e62f1c
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 82960de02c43a7c4002e189d573a914bb2a73f20
ms.sourcegitcommit: 40bd5b27f247a07c2e2514acb293b23d6ce03c29
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2019
ms.locfileid: "73186653"
---
# <a name="author-vsct-files"></a>Файлы Author. vsct
В этом документе показано, как создать файл *vsct* для добавления пунктов меню, панелей инструментов и других элементов пользовательского интерфейса в интегрированную среду разработки (IDE) Visual Studio. Используйте эти шаги при добавлении элементов пользовательского интерфейса в пакет Visual Studio (VSPackage), в котором еще нет *vsct* -файла.

 Для новых проектов рекомендуется использовать шаблон пакета Visual Studio, так как он создает *vsct* -файл, который в зависимости от выбранных параметров уже содержит необходимые элементы для команды меню, окна инструментов или пользовательского редактора. Этот *vsct* файл можно изменить в соответствии с требованиями пакета VSPackage. Дополнительные сведения об изменении *vsct* -файла см. в примерах в разделе [Расширение меню и команд](../../extensibility/extending-menus-and-commands.md).

## <a name="author-the-file"></a>Создание файла
 Создайте *vsct* -файл на следующих этапах: создание структуры для файлов и ресурсов, объявление элементов пользовательского интерфейса, размещение элементов пользовательского интерфейса в интегрированной среде разработки и добавление любых специализированных поведений.

### <a name="file-structure"></a>Структура файла
 Базовая структура *vsct* -файла — это корневой элемент [коммандтабле](../../extensibility/commandtable-element.md) , который содержит элемент [Commands](../../extensibility/commands-element.md) и элемент [SYMBOLS](../../extensibility/symbols-element.md) .

#### <a name="to-create-the-file-structure"></a>Создание файловой структуры

1. Добавьте *vsct* -файл в проект, выполнив действия, описанные в разделе [как создать vsct-файл](../../extensibility/internals/how-to-create-a-dot-vsct-file.md).

2. Добавьте необходимые пространства имен в элемент `CommandTable`, как показано в следующем примере:

    ```xml
    <CommandTable xmlns="http://schemas.microsoft.com/VisualStudio/2005-10-18/CommandTable"
        xmlns:xs="http://www.w3.org/2001/XMLSchema">

    ```

3. В элементе `CommandTable` добавьте элемент `Commands` для размещения всех пользовательских меню, панелей инструментов, групп команд и команд. Чтобы можно было загрузить пользовательские элементы пользовательского интерфейса, элементу `Commands` должен быть присвоен атрибут `Package` имени пакета.

     После элемента `Commands` добавьте элемент `Symbols`, чтобы определить идентификаторы GUID для пакета, а также имена и идентификаторы команд для элементов пользовательского интерфейса.

### <a name="include-visual-studio-resources"></a>Включить ресурсы Visual Studio
 Используйте элемент [extern](../../extensibility/extern-element.md) для доступа к файлам, которые определяют команды Visual Studio, и меню, необходимых для размещения элементов пользовательского интерфейса в интегрированной среде разработки. Если вы будете использовать команды, определенные за пределами пакета, используйте элемент [уседкоммандс](../../extensibility/usedcommands-element.md) для информирования Visual Studio.

#### <a name="to-include-visual-studio-resources"></a>Включение ресурсов Visual Studio

1. В верхней части элемента `CommandTable` добавьте один элемент `Extern` для каждого внешнего файла, на который будет ссылаться, и задайте для атрибута `href` имя файла. Чтобы получить доступ к ресурсам Visual Studio, вы можете ссылаться на следующие файлы заголовков:

   - *Стдидкмд. h*: определяет идентификаторы для всех команд, предоставляемых Visual Studio.

   - *Всшлидс. h*: содержит идентификаторы команд для меню Visual Studio.

2. Если пакет вызывает любые команды, определенные Visual Studio или другими пакетами, добавьте элемент `UsedCommands` после элемента `Commands`. Заполните этот элемент элементом [уседкомманд](../../extensibility/usedcommand-element.md) для каждой вызываемой команды, которая не является частью пакета. Задайте для атрибутов `guid` и `id` элементов `UsedCommand` значения GUID и ИДЕНТИФИКАТОРы команд для вызова.

   Дополнительные сведения о поиске идентификаторов GUID и идентификаторов команд Visual Studio см. в разделе [идентификаторы GUID и идентификаторы команд Visual Studio](../../extensibility/internals/guids-and-ids-of-visual-studio-commands.md). Для вызова команд из других пакетов используйте идентификатор GUID и идентификатор команды, как определено в файле *. vsct* для этих пакетов.

### <a name="declare-ui-elements"></a>Объявление элементов пользовательского интерфейса
 Объявите все новые элементы пользовательского интерфейса в разделе `Symbols` файла *vsct* .

#### <a name="to-declare-ui-elements"></a>Объявление элементов пользовательского интерфейса

1. В элементе `Symbols` добавьте три элемента [GuidSymbol](../../extensibility/guidsymbol-element.md) . Каждый элемент `GuidSymbol` имеет атрибут `name` и атрибут `value`. Задайте атрибут `name`, чтобы он отражал назначение элемента. Атрибут `value` принимает идентификатор GUID. (Чтобы создать GUID, в меню **Сервис** выберите команду **Создать GUID**, а затем выберите **Формат реестра**.)

     Первый элемент `GuidSymbol` представляет пакет, и обычно не имеет дочерних элементов. Второй элемент `GuidSymbol` представляет набор команд и содержит все символы, определяющие меню, группы и команды. Третий элемент `GuidSymbol` представляет ваше хранилище образов и содержит символы для всех значков команд. Если у вас нет команд, использующих значки, можно опустить третий элемент `GuidSymbol`.

2. В элементе `GuidSymbol`, представляющем набор команд, добавьте один или несколько элементов [IDSymbol](../../extensibility/idsymbol-element.md) . Каждый из них представляет меню, панель инструментов, группу или команду, добавляемую в пользовательский интерфейс.

     Для каждого элемента `IDSymbol` задайте для атрибута `name` имя, которое будет использоваться для ссылки на соответствующее меню, группу или команду, а затем установите для элемента `value` шестнадцатеричное число, которое будет представлять идентификатор команды. Ни один из двух элементов `IDSymbol`, имеющих один и тот же родительский элемент, не может иметь одно и то же значение.

3. Если для любого из элементов пользовательского интерфейса требуются значки, добавьте элемент `IDSymbol` для каждого значка в элемент `GuidSymbol`, представляющий хранилище изображений.

### <a name="put-ui-elements-in-the-ide"></a>Размещение элементов пользовательского интерфейса в интегрированной среде разработки
 Элементы [меню](../../extensibility/menus-element.md), [группы](../../extensibility/groups-element.md)и [кнопки](../../extensibility/buttons-element.md) содержат определения всех меню, групп и команд, определенных в пакете. Размещение этих меню, групп и команд в интегрированной среде разработки либо с помощью [родительского](../../extensibility/parent-element.md) элемента, который является частью определения элемента пользовательского интерфейса, либо с помощью элемента [CommandPlacement](../../extensibility/commandplacement-element.md) , определенного в других местах.

 Каждый элемент `Menu`, `Group`и `Button` имеет атрибут `guid` и атрибут `id`. Всегда задавайте атрибут `guid` в соответствии с именем элемента `GuidSymbol`, представляющего набор команд, и задайте для атрибута `id` имя элемента `IDSymbol`, представляющего меню, группу или команду в разделе `Symbols`.

#### <a name="to-define-ui-elements"></a>Определение элементов пользовательского интерфейса

1. При определении новых меню, подменю, контекстных меню или панелей инструментов добавьте элемент `Menus` в элемент `Commands`. Затем для каждого создаваемого меню добавьте элемент [меню](../../extensibility/menu-element.md) в элемент `Menus`.

    Задайте атрибуты `guid` и `id` элемента `Menu`, а затем задайте для атрибута `type` нужный тип меню. Вы также можете задать атрибут `priority`, чтобы установить относительное расположение меню в родительской группе.

   > [!NOTE]
   > Атрибут `priority` не применяется к панелям инструментов и контекстным меню.

2. Все команды в интегрированной среде разработки Visual Studio должны размещаться в группах команд, которые являются прямыми дочерними элементами меню и панелей инструментов. При добавлении новых меню или панелей инструментов в интегрированную среду разработки они должны содержать новые группы команд. Вы также можете добавлять группы команд в существующие меню и панели инструментов для визуального группирования команд.

    При добавлении новых групп команд необходимо сначала создать элемент `Groups`, а затем добавить в него элемент [группы](../../extensibility/group-element.md) для каждой группы команд.

    Задайте атрибуты `guid` и `id` каждого элемента `Group`, а затем установите атрибут `priority`, чтобы установить относительное расположение группы в родительском меню. Дополнительные сведения см. в разделе [Создание многократно используемых групп кнопок](../../extensibility/creating-reusable-groups-of-buttons.md).

3. При добавлении новых команд в интегрированную среду разработки добавьте элемент `Buttons` в элемент `Commands`. Затем для каждой команды добавьте элемент [Button](../../extensibility/button-element.md) в элемент `Buttons`.

   1. Задайте атрибуты `guid` и `id` каждого элемента `Button`, а затем задайте для атрибута `type` нужный тип кнопки. Вы также можете задать атрибут `priority`, чтобы установить относительное расположение команды в родительской группе.

       > [!NOTE]
       > Используйте `type="button"` для стандартных команд меню и кнопок на панелях инструментов.

   2. В элементе `Button` добавьте элемент [Strings](../../extensibility/strings-element.md) , содержащий элемент [ButtonText](../../extensibility/buttontext-element.md) и элемент [CommandName](../../extensibility/commandname-element.md) . Элемент `ButtonText` предоставляет текстовую метку для элемента меню или подсказку для кнопки панели инструментов. Элемент `CommandName` предоставляет имя команды для использования в команде.

   3. Если команда будет иметь значок, создайте элемент [Icon](../../extensibility/icon-element.md) в элементе `Button` и задайте для его `guid` и `id` атрибуты элементу `Bitmap` для значка.

       > [!NOTE]
       > Кнопки панели инструментов должны иметь значки.

   Дополнительные сведения см. в разделе [команды MenuCommand и олеменукоммандс](/visualstudio/extensibility/menucommands-vs-olemenucommands?view=vs-2015).

4. Если какой-либо из команд требует значков, добавьте элемент [Bitmaps](../../extensibility/bitmaps-element.md) в элемент `Commands`. Затем для каждого значка добавьте элемент [Bitmap](../../extensibility/bitmap-element.md) в элемент `Bitmaps`. Здесь указывается расположение ресурса точечного рисунка. Дополнительные сведения см. [в разделе Добавление значков в команды меню](../../extensibility/adding-icons-to-menu-commands.md).

   Для правильного размещения большинства меню, групп и команд можно использовать родительскую структуру. Для очень больших наборов команд, а также если меню, группа или команда должны отображаться в нескольких местах, рекомендуется указать размещение команд.

#### <a name="to-rely-on-parenting-to-place-ui-elements-in-the-ide"></a>Полагаться на родительский элемент для размещения элементов пользовательского интерфейса в интегрированной среде разработки

1. Для типичного родительского объекта создайте элемент `Parent` в каждом элементе `Menu`, `Group`и `Command`, определенном в пакете.

    Целью элемента `Parent` является меню или группа, которые будут содержать меню, группу или команду.

   1. Присвойте атрибуту `guid` имя элемента `GuidSymbol`, определяющего набор команд. Если целевой элемент не является частью пакета, используйте GUID для этого набора команд, как определено в соответствующем *vsct* -файле.

   2. Установите атрибут `id` в соответствии с атрибутом `id` целевого меню или группы. Список меню и групп, предоставляемых Visual Studio, см. в разделе [идентификаторы GUID и идентификаторы меню Visual Studio](../../extensibility/internals/guids-and-ids-of-visual-studio-menus.md) , идентификаторы [GUID и идентификаторы панелей инструментов Visual Studio](../../extensibility/internals/guids-and-ids-of-visual-studio-toolbars.md).

   При наличии большого количества элементов пользовательского интерфейса для размещения в интегрированной среде разработки или при наличии элементов, которые должны отображаться в нескольких местах, определите их размещение в элементе [CommandPlacements](../../extensibility/commandplacements-element.md) , как показано в следующих шагах.

#### <a name="to-use-command-placement-to-place-ui-elements-in-the-ide"></a>Использование размещения команд для размещения элементов пользовательского интерфейса в интегрированной среде разработки

1. После элемента `Commands` добавьте элемент `CommandPlacements`.

2. В элементе `CommandPlacements` добавьте элемент `CommandPlacement` для каждого меню, группы или команды для размещения.

    Каждый элемент `CommandPlacement` или `Parent` помещает одно меню, группу или команду в одно расположение IDE. У элемента пользовательского интерфейса может быть только один родительский элемент, но может быть несколько командных размещений. Чтобы поместить элемент пользовательского интерфейса в несколько расположений, добавьте элемент `CommandPlacement` для каждого расположения.

3. Задайте `guid` и `id` атрибуты каждого элемента `CommandPlacement` в меню или группе размещения, точно так же, как для элемента `Parent`. Можно также задать атрибут `priority`, чтобы установить относительное расположение элемента пользовательского интерфейса.

   Размещение можно смешивать путем наследования и размещения команд. Однако для очень больших наборов команд рекомендуется использовать только размещение команд.

### <a name="add-specialized-behaviors"></a>Добавление специализированных поведений
 Элемент [CommandFlag](../../extensibility/command-flag-element.md) можно использовать для изменения поведения меню и команд, например для изменения их внешнего вида и видимости. Можно также повлиять на видимость команды с помощью элемента [висибилитиконстраинтс](../../extensibility/visibilityconstraints-element.md) или добавить сочетания клавиш с помощью элемента [сочетания клавиш](../../extensibility/keybindings-element.md) . Некоторые виды меню и команд уже имеют специализированные поведения, встроенные в.

#### <a name="to-add-specialized-behaviors"></a>Добавление специализированных поведений

1. Чтобы сделать элемент пользовательского интерфейса видимым только в определенных контекстах пользовательского интерфейса, например при загрузке решения, используйте ограничения видимости.

   1. После элемента `Commands` добавьте элемент `VisibilityConstraints`.

   2. Для каждого элемента пользовательского интерфейса, который необходимо ограничить, добавьте элемент [висибилититем](../../extensibility/visibilityitem-element.md) .

   3. Для каждого элемента `VisibilityItem` Установите атрибуты `guid` и `id` меню, группе или команде, а затем установите атрибут `context` в нужный контекст пользовательского интерфейса, как определено в классе <xref:Microsoft.VisualStudio.Shell.Interop.UIContextGuids80>.

2. Чтобы задать видимость или доступность элемента пользовательского интерфейса в коде, используйте один или несколько следующих флагов команды:

   - `DefaultDisabled`

   - `DefaultInvisible`

   - `DynamicItemStart`

   - `DynamicVisibility`

   - `NoShowOnMenuController`

   - `NotInTBList`

   Дополнительные сведения см. в описании элемента [CommandFlag](../../extensibility/command-flag-element.md) .

3. Чтобы изменить способ отображения элемента или динамически изменить его внешний вид, используйте один или несколько следующих флагов команды:

   - `AlwaysCreate`

   - `CommandWellOnly`

   - `DefaultDocked`

   - `DontCache`

   - `DynamicItemStart`

   - `FixMenuController`

   - `IconAndText`

   - `Pict`

   - `StretchHorizontally`

   - `TextMenuUseButton`

   - `TextChanges`

   - `TextOnly`

   Дополнительные сведения см. в описании элемента [CommandFlag](../../extensibility/command-flag-element.md) .

4. Чтобы изменить способ реагирования элемента при получении команд, используйте один или несколько следующих флагов команды:

   - `AllowParams`

   - `CaseSensitive`

   - `CommandWellOnly`

   - `FilterKeys`

   - `NoAutoComplete`

   - `NoButtonCustomize`

   - `NoKeyCustomize`

   - `NoToolbarClose`

   - `PostExec`

   - `RouteToDocs`

   - `TextIsAnchorCommand`

   Дополнительные сведения см. в описании элемента [CommandFlag](../../extensibility/command-flag-element.md) .

5. Чтобы присоединить заданное меню сочетание клавиш к меню или элементу меню, добавьте символ амперсанда (&) в элемент `ButtonText` для меню или пункта меню. Символ, следующий за амперсандом, является активным сочетанием клавиш при открытом родительском меню.

6. Чтобы присоединить независимое от меню сочетание клавиш к команде, используйте элемент [сочетания клавиш](../../extensibility/keybindings-element.md) . Дополнительные сведения см. в описании элемента [настраиваемое сочетание клавиш](../../extensibility/keybinding-element.md) .

7. Чтобы локализовать текст меню, используйте элемент `LocCanonicalName`. Дополнительные сведения см. в элементе [Strings](../../extensibility/strings-element.md) .

   Некоторые типы меню и кнопок включают специализированные поведения. В следующем списке описаны некоторые специализированные типы меню и кнопок. Для других типов см. Описание атрибутов `types` в [меню](../../extensibility/menu-element.md), [кнопке](../../extensibility/button-element.md)и элементах [со списком](../../extensibility/combo-element.md) .

   - Поле со списком: поле со списком — это раскрывающийся список, который можно использовать на панели инструментов. Чтобы добавить поля со списком в пользовательский интерфейс, создайте элемент [КомБОС](../../extensibility/combos-element.md) в элементе `Commands`. Затем добавьте к элементу `Combos` элемент `Combo` для каждого добавляемого поля со списком. `Combo` элементы имеют те же атрибуты и дочерние элементы, что и `Button` элементов, а также атрибуты `DefaultWidth` и `idCommandList`. Атрибут `DefaultWidth` задает ширину в пикселях, а атрибут `idCommandList` указывает на идентификатор команды, используемый для заполнения поля со списком.

   - Контроллер меню. контроллер меню — это кнопка со стрелкой рядом с ней. При нажатии стрелки открывается список. Чтобы добавить контроллер меню в пользовательский интерфейс, создайте элемент `Menu` и задайте для его атрибута `type` значение `MenuController` или `MenuControllerLatched`в зависимости от желаемого поведения. Чтобы заполнить контроллер меню, установите его в качестве родителя элемента `Group`. Контроллер меню отобразит все дочерние элементы этой группы в раскрывающемся списке.

## <a name="see-also"></a>См. также
- [Расширение меню и команд](../../extensibility/extending-menus-and-commands.md)
- [Файлы таблицы команд Visual Studio (. vsct)](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md)
- [Справочник по XML-схеме VSCT](../../extensibility/vsct-xml-schema-reference.md)