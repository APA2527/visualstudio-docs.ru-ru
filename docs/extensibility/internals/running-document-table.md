---
title: Запуск таблицы документов | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- read locks
- running document table (RDT), IVsDocumentLockHolder interface
- running document table (RDT)
- running document table (RDT), edit locks
- document data objects, running document table
ms.assetid: bbec74f3-dd8e-48ad-99c1-2df503c15f5a
author: gregvanl
ms.author: gregvanl
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 093c2e33b8fe3918c280bb68dabda54808cc5e3a
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62859189"
---
# <a name="running-document-table"></a>Запуск таблицы документов
Интегрированная среда разработки поддерживает список всех открытых документов во внутренней структуре вызывается в таблице выполняющихся документов (RDT). Этот список включает все открытые документы в памяти независимо от ли эти документы момент редактируется. Документ является любой элемент, который сохранен, включая файлы в проекте или в файле основного проекта (например, файл с расширением VCXPROJ).

## <a name="elements-of-the-running-document-table"></a>Элементы запуск таблицы документов
 В таблице выполняющихся документов содержит следующие записи.

|Элемент|Описание|
|-------------|-----------------|
|Моникер документа|Строка, однозначно определяющее объект данных документа. Это будет абсолютный путь к файлу для система проектов, которая управляет файлами (например, C:\MyProject\MyFile). Эта строка также используется для проектов, сохраненные в хранилищах, отличных от файловых систем, например хранимые процедуры в базе данных. В этом случае система проекта может изобрести уникальная строка, она способна распознавать и возможно синтаксический анализ для определения способа сохранения документа.|
|Владелец иерархии|Объект иерархии, который является владельцем документа, представленные как <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> интерфейс.|
|Идентификатор элемента|Идентификатор элемента для конкретного элемента в иерархии. Это значение является уникальным среди всех документов в иерархии, которому принадлежит этот документ, но это значение не обязательно быть уникальным в пределах иерархии.|
|Объект данных документа|Как минимум, это `IUnknown`<br /><br /> . Интегрированная среда разработки не требует любой определенный интерфейс, помимо `IUnknown` интерфейс для объекта данных документа специализированный редактор. Тем не менее, для стандартного редактора Реализация редактора <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistDocData2> интерфейс, необходимый для обработки вызовов сохраняемости файлов из проекта. Дополнительные сведения см. в разделе [Сохранение стандартного документа](../../extensibility/internals/saving-a-standard-document.md).|
|Флаги|Флаги, определяющие, сохраняется ли документ ли применять блокировку чтения или редактирования и т. д., можно указать, когда элементы добавляются в RDT. Дополнительные сведения см. в описании перечисления <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS>.|
|Изменить число блокировок|Число блокировок правки. Блокировку редактирования означает, что некоторые редактора документ открыт для редактирования. Когда число блокировок правки переходит к нулю, пользователю предлагается сохранить документ, если он был изменен. Например, каждый раз при открытии документа в редакторе с помощью **новое окно** команды блокировку редактирования добавляется для этого документа в RDT. Чтобы блокировку редактирования задать документ должен иметь иерархии или элемента идентификатор.|
|Число блокировок чтения|Число блокировок чтения. Блокировка чтения указывает, что документ был прочитан через какой-либо механизм, таких как мастер. Блокировка чтения содержит документ в RDT в активном состоянии при, указывающее, что документ не может редактироваться. Можно задать блокировку чтения, даже в том случае, если документ не имеет иерархии или элемента идентификатор. Эта функция позволяет открыть документ в памяти и введите его в RDT без документа, принадлежащими любой иерархии. Эта функция используется редко.|
|Держатель блокировки|Экземпляр <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> интерфейс. Держатель блокировки реализуется посредством функции, такие как мастеров, открывать и редактировать документы вне редактора. Держатель блокировки позволяет функцию добавить блокировку редактирования документа, чтобы предотвратить закрывается, хотя она по-прежнему редактируется документ. Как правило, изменение блокировки добавляются только с помощью окон документа (т. е редакторы).|

 Каждая запись в RDT имеет уникальную иерархию или идентификатор элемента, связанные с ним, которая обычно соответствует один узел в проекте. Все документы, доступные для редактирования обычно принадлежащих иерархии. Записи, сделанные в RDT управления какой проект, или, точнее — иерархию, в данный момент владеет редактируемого объекта данных документа. Используя информацию в RDT, интегрированной среды разработки может препятствовать документа, открытого с более одного проекта за раз.

 Иерархии также управляет постоянного хранения данных и использует информацию в RDT для обновления **Сохранить** и **Сохранить как** диалоговым окнам. Когда пользователи изменить документ, а затем нажмите **выхода** команду **файл** меню интегрированной среды разработки предлагается с **сохранить изменения** диалоговое окно, чтобы показать все проекты и элементы проектов, которые изменяются в настоящее время. Это позволяет пользователям выбирать, какие документы для сохранения. Список документов, чтобы сохранить (то есть эти документы, в которых изменения) создается из RDT. Все элементы, которые вы ожидаете увидеть в **сохранить изменения** диалоговое окно при выходе из приложения должны иметь записей в RDT. RDT координирует документы сохраняются и ли пользователю предлагается о сохранения операцию с использованием значений, указанных в записи флаги для каждого документа. Дополнительные сведения о RDT-флаги, см. в разделе <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS> перечисления.

## <a name="edit-locks-and-read-locks"></a>Изменение блокировок и блокировок чтения
 Блокировок правки и блокировок чтения находятся в RDT. Увеличивает окно документа и уменьшает блокировку редактирования. Таким образом когда пользователь открывает новое окно документа, редактирования счетчик блокировок увеличивается на единицу. Когда число блокировок правки достигает нуля, иерархии получил сигнал к сохраняются или сохранить данные для соответствующего документа. Иерархии, затем можно сохранить данные любым способом, включая сохранение в формате или в качестве элемента в репозитории. Можно использовать <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.LockDocument%2A> метод в <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable> интерфейс для добавления блокировок правки и блокировок, чтения и <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.UnlockDocument%2A> метод для удаления этих блокировок.

 Как правило при создании экземпляра окна документа редактора, окна автоматически добавляет блокировку редактирования для документа в RDT. Тем не менее, если создать пользовательское представление документа, не используйте стандартный документ (то есть он не реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsWindowFrame> интерфейса), то необходимо задать собственные блокировку редактирования. Например с помощью мастера без открытия в редакторе редактируется документ. Чтобы блокировка документов должен открываться в мастерах и похожих сущностей, необходимо реализовать эти сущности <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> интерфейс. Чтобы зарегистрировать ваш держатель блокировки документа, вызвать <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.RegisterDocumentLockHolder%2A> и передайте в вашей <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> реализации. Это добавляет вашей держатель блокировки документа в RDT. Другой сценарий для реализации держатель блокировки документа — Если при открытии документа через окно специальных инструментов. В этом случае вы не сможете у окна инструментов при закрытии документа. Однако по регистрации в качестве держателя блокировки документа в RDT, интегрированной среды разработки может вызывать вашу реализацию <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder.CloseDocumentHolder%2A> метод для закрытия документа запроса.

## <a name="other-uses-of-the-running-document-table"></a>Другие варианты применения запуск таблицы документов
 Других сущностей в интегрированной среде разработки использовать RDT для получения сведений о документах. Например диспетчера системы управления версиями использует RDT для перезагрузки документа в редакторе после он получает последнюю версию файла в системе. Для этого диспетчера системы управления версиями ищет файлы в RDT, чтобы увидеть, если любой из них открыты. Если они являются, а затем диспетчера системы управления версиями сначала проверяет, что иерархия реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistHierarchyItem2.ReloadItem%2A> метод. Если проект не реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistHierarchyItem2.ReloadItem%2A> метод, то источник элемента управления проверки диспетчера реализацию <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistDocData2.ReloadDocData%2A> метод в объекте данных документа напрямую.

 Интегрированная среда разработки также использует RDT для resurface (переместить на передний план) открытого документа, если пользователь запрашивает этого документа. Дополнительные сведения см. в разделе [отображение файлов с помощью команды откройте файл](../../extensibility/internals/displaying-files-by-using-the-open-file-command.md). Чтобы определить, открыт ли файл в RDT, выполните одно из следующих.

- Запрос моникер документа (то есть полный путь к документу) узнать, открыт ли элемент.

- Используйте идентификатор иерархия или элемент для попросите система проектов путь полный документ, а затем найдите элемент в RDT.

## <a name="see-also"></a>См. также
- [Использование RDT_ReadLock](../../extensibility/internals/rdt-readlock-usage.md)
- [Сохранение состояния и запуск таблицы документов](../../extensibility/internals/persistence-and-the-running-document-table.md)