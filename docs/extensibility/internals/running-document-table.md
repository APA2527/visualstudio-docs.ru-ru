---
title: Запуск таблицы документов (ru) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- read locks
- running document table (RDT), IVsDocumentLockHolder interface
- running document table (RDT)
- running document table (RDT), edit locks
- document data objects, running document table
ms.assetid: bbec74f3-dd8e-48ad-99c1-2df503c15f5a
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 9e6aa882921786b1592922372581beae8c4c2443
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80705558"
---
# <a name="running-document-table"></a>Запуск таблицы документов
IDE ведет список всех открытых в настоящее время документов во внутренней структуре, называемой таблицею работающих документов (RDT). Этот список включает в себя все открытые документы в памяти, независимо от того, эти документы в настоящее время редактируются. Документ — это любой элемент, который сохраняется, включая файлы в проекте или основной файл проекта (например, файл .vcxproj).

## <a name="elements-of-the-running-document-table"></a>Элементы таблицы «Бегущий документ»
 Таблица ходовых документов содержит следующие записи.

|Элемент|Описание|
|-------------|-----------------|
|Кличка документов|Строка, которая однозначно идентифицирует объект данных документа. Это будет абсолютный путь файла для проектной системы, управляющей файлами (например, C:«MyProject»MyFile). Эта строка также используется для проектов, сохраненных в магазинах, не вных файловых системах, таких как сохраненные процедуры в базе данных. В этом случае проектная система может изобрести уникальную строку, которую она может распознать и, возможно, разобрать, чтобы определить, как хранить документ.|
|Владелец иерархии|Объект иерархии, владеющий документом, <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> представленный интерфейсом.|
|Идентификатор элемента|Идентификатор элемента для конкретного элемента в иерархии. Это значение является уникальным среди всех документов в иерархии, которая владеет этим документом, но это значение не гарантируется уникальным в различных иерархиях.|
|Объект данных документа|Как минимум, это`IUnknown`<br /><br /> . IDE не требует какого-либо `IUnknown` конкретного интерфейса за пределами интерфейса для объекта данных документа пользовательского редактора. Однако для стандартного редактора реализация <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistDocData2> интерфейса редактора требуется для обработки вызовов сохранения файлов из проекта. Для получения дополнительной информации [см.](../../extensibility/internals/saving-a-standard-document.md)|
|Флаги|Флаги, контролирующие, сохраняется ли документ, применяется ли блокировка чтения или редакта и т.д., могут быть указаны при добавлении записей в RDT. Дополнительные сведения см. в описании перечисления <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS>.|
|Редит Локграф|Граф редикт-замков. Блокировка редактирования указывает на то, что у редактора есть документ, открытый для редактирования. Когда количество блокировок изменения переходит к нулю, пользователю предлагается сохранить документ, если он был изменен. Например, при открытии документа в редакторе с помощью команды **New Window** для этого документа в RDT добавляется блокировка редактируемого. Для установки блокировки элемента должно быть установлено, документ должен иметь иерархию или идентификатор элемента.|
|Читать Локграф|Граф прочитанных замков. Блокировка чтения указывает на то, что документ считывается через некоторый механизм, например мастер. Блокировка чтения содержит документ, живой в RDT, указывая при этом, что документ не может быть отредактирован. Можно установить блокировку чтения, даже если документ не имеет иерархии или идентификатора элемента. Эта функция позволяет открыть документ в памяти и ввести его в RDT без документа, принадлежащего какой-либо иерархии. Эта функция используется редко.|
|Держатель блокировки|Экземпляр <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> интерфейса. Держатель блокировки реализован такими функциями, как мастера, которые открывают и редактируют документы за пределами редактора. Держатель блокировки позволяет функции добавлять блокировку редактирования в документ, чтобы предотвратить блокировку документа, пока он еще редактируется. Обычно блокировки редактов добавляются только окнами документов (т.е. редакторами).|

 Каждая запись в RDT имеет уникальную иерархию или идентификатор элемента, связанный с ней, который обычно соответствует одному узлам в проекте. Все документы, доступные для редактирования, обычно принадлежат иерархии. Записи, сделанные в управлении RDT, какой проект, или, точнее, какая иерархия, в настоящее время владеет редактируемым объектом данных документа. Используя информацию в RDT, IDE может предотвратить открытие документа более чем одним проектом одновременно.

 Иерархия также контролирует сохранение данных и использует информацию в RDT для обновления диалоговых коробок **Сохранить** и **Сохранить.** Когда пользователи изменяют документ, а затем выбирают команду **Exit** из меню **файла,** IDE предлагает им с помощью диалогового окна **Сохранить изменения,** чтобы показать им все проекты и элементы проекта, которые в настоящее время изменены. Это позволяет пользователям выбирать, какой из документов сохранить. Список документов для сохранения (т.е. те документы, которые имеют изменения) генерируется из RDT. Любые элементы, которые вы ожидаете увидеть в диалоговом окне **сохранения изменений** при выходе из приложения, должны иметь записи в RDT. RDT координирует, какие документы сохраняются и предлагается ли пользователю операции сохранения с использованием значений, указанных в записи Флаги для каждого документа. Для получения дополнительной информации о <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS> флагах RDT см.

## <a name="edit-locks-and-read-locks"></a>Редит замки и прочитайте замки
 Редификационные замки и считываемые замки находятся в RDT. Приращения окна документа и декреты блокировки редитификации. Таким образом, когда пользователь открывает новое окно документа, количество блокировок отослаивается по одному. Когда число блокировок edit достигает нуля, иерархия сигнализирует о сохранении или сохранении данных для связанного документа. Иерархия может сохранять данные любым способом, включая сохранение в качестве файла или элемента в репозитории. Вы можете <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.LockDocument%2A> использовать метод <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable> в интерфейсе, чтобы добавить блокировки <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.UnlockDocument%2A> для удаления и чтения, а также метод удаления этих блокировок.

 Обычно, когда окно документа для редактора мгновенно, оконная рамка автоматически добавляет блокировку редактируемого документа в RDT. Однако, если вы создаете пользовательский вид документа, который не использует стандартное <xref:Microsoft.VisualStudio.Shell.Interop.IVsWindowFrame> окно документа (т.е. он не реализует интерфейс), то вам нужно установить свой собственный блокировку редитативных. Например, в мастере документ редактируется без открытия в редакторе. Для того, чтобы блокировки документов были открыты мастерами и <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> аналогичными объектами, эти сущности должны реализовать интерфейс. Чтобы зарегистрировать владельца блокировки <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.RegisterDocumentLockHolder%2A> документа, позвоните <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> по методу и пройдите в реализации. Это добавляет держатель блокировки документа в RDT. Другой сценарий для реализации держателя блокировки документа — если вы открываете документ через специальное окно инструмента. В этом случае окно инструмента не может закрыть документ. Однако, зарегистрировавшись в качестве держателя блокировки документа в <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder.CloseDocumentHolder%2A> RDT, IDE может вызвать вашу реализацию метода, чтобы вызвать закрытие документа.

## <a name="other-uses-of-the-running-document-table"></a>Другие виды использования таблицы «Запуск документов»
 Другие организации IDE используют RDT для получения информации о документах. Например, диспетчер управления источниками использует RDT, чтобы сообщить системе о перезагрузке документа в редакторе после получения новейшей версии файла. Для этого менеджер управления источниками просматривает файлы в RDT, чтобы увидеть, если какой-либо из них открыты. Если они есть, то менеджер управления исходным источником сначала <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistHierarchyItem2.ReloadItem%2A> проверяет, что иерархия реализует метод. Если проект не реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistHierarchyItem2.ReloadItem%2A> метод, то менеджер управления исходным <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistDocData2.ReloadDocData%2A> элементом проверяет реализацию метода на объекте данных документа напрямую.

 IDE также использует RDT для повторного появления (приведения на фронт) открытого документа, если пользователь запрашивает этот документ. Для получения дополнительной [информации](../../extensibility/internals/displaying-files-by-using-the-open-file-command.md)см. Чтобы определить, является ли файл открыт в RDT, сделайте следующее.

- Запрос на имя документа (т.е. полный путь документа), чтобы узнать, открыт ли элемент.

- Используйте идентификатор иерархии или элемента, чтобы запросить у проектной системы полный путь документа, а затем посмотреть элемент в RDT.

## <a name="see-also"></a>См. также
- [Использование RDT_ReadLock](../../extensibility/internals/rdt-readlock-usage.md)
- [Сохранение состояния и запуск таблицы документов](../../extensibility/internals/persistence-and-the-running-document-table.md)
