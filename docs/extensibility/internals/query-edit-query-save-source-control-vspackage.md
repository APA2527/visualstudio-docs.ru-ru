---
title: Запрос на изменение запроса Save (пакет VSPackage системы управления версиями) | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- QEQS events
- Query Edit Query Save events
- source control packages, Query Edit Query Save events
ms.assetid: c360d2ad-fe42-4d65-899d-d1588cc8a322
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: be12297bdaeb112d7421b02da1153ed62d6d14f8
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72724773"
---
# <a name="query-edit-query-save-source-control-vspackage"></a>Изменение и сохранение запроса (пакет VSPackage системы управления версиями)
[!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] редакторы могут транслировать события сохранения запроса на изменение (QEQS). Заглушка системы управления версиями [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] реализует службу QEQS, чтобы она была получателем событий QEQS. Затем эти события делегируются в текущий активный пакет VSPackage системы управления версиями. Активный пакет VSPackage для системы управления версиями реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2> и его методы. Методы интерфейса `IVsQueryEditQuerySave2` обычно вызываются непосредственно перед тем, как документ будет изменен в первый раз и непосредственно перед сохранением документа.

## <a name="queryeditquerysave-events"></a>События Куередиткуерисаве
 Пакет VSPackage системы управления версиями должен выполнять обработку событий QEQS, реализуя интерфейс `IVsQueryEditQuerySave2` и необходимые методы. Ниже приведено краткое описание двух методов, которые пакет VSPackage должен реализовать как минимум. Фактическая реализация должна соответствовать логике модели системы управления версиями.

### <a name="queryeditfiles-method"></a>Метод Куередитфилес
 @No__t_0 вызывается, когда какой-либо проект или редактор желает изменить файл. В идеале этот метод вызывается *перед* изменением файла и при сохранении файла. При вызове метод `IVsQueryEditQuerySave2::QueryEditFiles` проверяет, находятся ли заданные файлы в системе управления версиями, нужно ли их извлечь и можно ли их перезагрузить. Если обстоятельства не позволяют изменять файлы, метод `IVsQueryEditQuerySave2::QueryEditFiles` указывает вызывающей программе отменить изменение. Также возможно, что вызывающий объект может указать режим вызова. В режиме "без уведомления" Этот метод принимает действия только в том случае, если он не вызывает отображения пользовательского интерфейса. Если пользовательский интерфейс недоступен, должен быть возвращен флаг, указывающий на проблему.

 Метод ведет себя в транзакционном режиме; то есть, если изменение отменено для одного файла, изменение отменяется для всех файлов. И наоборот, если изменение разрешено, оно разрешается для всех файлов. Если этот метод позволяет изменить один раз для заданного набора файлов, он должен всегда разрешать изменение в последующих вызовах для одного и того же набора файлов. Цикл Allow-Edit сохраняется до тех пор, пока файлы не будут закрыты, сохранены и загружены. до изменения атрибутов (свойств); или до изменения пакета системы управления версиями. Варианты реализации метода `IVsQueryEditQuerySave2::QueryEditFiles` включают в себя несколько файлов, Специальные файлы, отмену от пользователя и изменения в памяти.

### <a name="querysavefiles-method"></a>Метод Куерисавефилес
 @No__t_0 вызывается, когда какой-либо проект или редактор должен сохранить набор файлов. При вызове метод `IVsQueryEditQuerySave2::QuerySaveFiles` проверяет, доступны ли заданные файлы только для чтения, а также они находятся в системе управления версиями. Если файлы необходимо извлечь, вызов делегируется пакету управления версиями. Если обстоятельства препятствуют сохранению файлов, метод `IVsQueryEditQuerySave2::QuerySaveFiles` должен сообщить редактору о необходимости отмены сохранения. Как и в случае с методом `IVsQueryEditQuerySave2::QueryEditFiles`, вызывающий объект может указать режим вызова. В режиме "без уведомления" Этот метод принимает действия только в том случае, если он не вызывает отображения пользовательского интерфейса. Если пользовательский интерфейс недоступен, должен быть возвращен флаг, указывающий на проблему.

 Этот метод должен вести себя в транзакционном режиме; то есть, если сохранение отменено для одного файла, сохранение отменяется для всех файлов. И наоборот, если сохранение разрешено, оно должно быть разрешено для всех файлов. Как и в случае с методом `IVsQueryEditQuerySave2::QueryEditFiles`, варианты реализации `IVsQueryEditQuerySave2::QuerySaveFiles` метода включают несколько файлов, Специальные файлы, отмену от пользователя и изменения в памяти.

## <a name="see-also"></a>См. также
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2>