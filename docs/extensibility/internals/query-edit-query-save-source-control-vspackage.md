---
title: Запрос Edit Запрос Сохранить (Источник управления VSPackage) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- QEQS events
- Query Edit Query Save events
- source control packages, Query Edit Query Save events
ms.assetid: c360d2ad-fe42-4d65-899d-d1588cc8a322
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: c09ac0cb4f51b8f2484b95d403ff6d0445631479
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80705959"
---
# <a name="query-edit-query-save-source-control-vspackage"></a>Изменение и сохранение запроса (пакет VSPackage системы управления версиями)
[!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]редакторы могут транслировать события Query Edit Query Save. [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]Заглушка Управления источниками реализует службу «ЗЕСС», так что она является получателем событий. Эти события затем делегируются в текущий активный элемент управления исходом VSPackage. Активный элемент управления исходным <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2> источником VSPackage реализует и его методы. Методы `IVsQueryEditQuerySave2` интерфейса обычно вызываются непосредственно перед тем, как документ редактируется в первый раз и непосредственно перед сохранением документа.

## <a name="queryeditquerysave-events"></a>События, которые необходимо сделать в ЗаквидкуириЕвские события
 Управление исходным элементом VSPackage должно обрабатывать события, `IVsQueryEditQuerySave2` связанные с квистом, реализуя интерфейс и необходимые методы. Ниже приводится краткое описание двух методов, которые VSPackage должен реализовать как минимум. Фактическая реализация должна соответствовать логике модели управления исходным источником.

### <a name="queryeditfiles-method"></a>Метод queryEditFiles
 Вызывается, <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2.QueryEditFiles%2A> когда какой-либо проект или редактор хочет изменить файл. В идеале этот метод вызывается *до* изменения файла и сохранения файла. При вызове `IVsQueryEditQuerySave2::QueryEditFiles` метод проверяет, находятся ли данные файлы под контролем источника, нужно ли их проверять и можно ли их перезагрузить. Если обстоятельства не позволяют ли т.д. отменять файлы, `IVsQueryEditQuerySave2::QueryEditFiles` метод говорит программе вызовов об отмене изменения. Кроме того, абонент может указать режим вызова. В режиме «молчаливый» этот метод принимает меры только в том случае, если он не вызывает появления какого-либо uI. Если uI неизбежен, флаг должен быть возвращен, чтобы указать проблему.

 Метод ведет себя транзакционным образом; то есть, если отогнание от него в одном файле, отодвилость для всех файлов отменяется. И наоборот, если это разрешено, то все файлы разрешены. Если этот метод позволяет редактировать один раз для данного набора файлов, он всегда должен позволять редактировать последующие вызовы для одного и того же набора файлов. Цикл "Раздевка- испуг" продолжается до тех пор, пока файлы не будут закрыты, сохранены и перезагружены; до тех пор, пока их атрибуты (свойства) не изменятся; или до тех пор, пока пакет управления исходным ресурсом не будет изменен. Случаи, которые следует `IVsQueryEditQuerySave2::QueryEditFiles` учитывать при реализации метода, включают несколько файлов, специальные файлы, отмену от пользователя и внесение в память.

### <a name="querysavefiles-method"></a>Метод querySaveFiles
 Вызывается, <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2.QuerySaveFiles%2A> когда какой-либо проект или редактор должен сохранить набор файлов. При вызове `IVsQueryEditQuerySave2::QuerySaveFiles` метод проверяет, читаются ли данные файлы только для чтения и находятся ли они под контролем источника. Если файлы должны быть проверены, вызов делегируется пакету управления исходным ресурсом. Если обстоятельства препятствуют сохранению `IVsQueryEditQuerySave2::QuerySaveFiles` файлов, метод должен сказать редактору об отмене сохранения. Как и `IVsQueryEditQuerySave2::QueryEditFiles` в режиме метода, абонент может указать режим вызова. В режиме «молчаливый» этот метод принимает меры только в том случае, если он не вызывает появления какого-либо uI. Если uI неизбежен, флаг должен быть возвращен, чтобы указать проблему.

 Этот метод должен вести себя транзакционным образом; то есть, если сохранение отменено в одном файле, сохранение аннулируется для всех файлов. И наоборот, если сохранение разрешено, оно должно быть разрешено для всех файлов. Как и `IVsQueryEditQuerySave2::QueryEditFiles` в случае с методом, кейсы, которые следует учитывать при реализации `IVsQueryEditQuerySave2::QuerySaveFiles` метода, включают несколько файлов, специальные файлы, отмену от пользователя и внесение в память.

## <a name="see-also"></a>См. также
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2>
