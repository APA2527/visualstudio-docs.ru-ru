---
title: Запросить изменение запроса сохранить (пакет VSPackage управления версиями) | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- QEQS events
- Query Edit Query Save events
- source control packages, Query Edit Query Save events
ms.assetid: c360d2ad-fe42-4d65-899d-d1588cc8a322
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: d3bffdac79a9f4274fbd6465c33e8659caf9d1f6
ms.sourcegitcommit: 40d612240dc5bea418cd27fdacdf85ea177e2df3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2019
ms.locfileid: "66341453"
---
# <a name="query-edit-query-save-source-control-vspackage"></a>Изменение и сохранение запроса (пакет VSPackage системы управления версиями)
[!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] редакторы могут производить широковещательную рассылку событий запроса изменить запрос сохранить (QEQS). [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Заглушкой системы управления версиями реализует службу QEQS, так как это получателя событий QEQS. Затем эти события делегируются управления текущий активный источник пакета VSPackage. Active систему управления версиями, VSPackage реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2> и его методы. Методы `IVsQueryEditQuerySave2` интерфейса обычно называется непосредственно перед редактировании документа в первый раз, и сразу же в том случае, перед сохранением документа.

## <a name="queryeditquerysave-events"></a>QueryEditQuerySave события
 Пакет VSPackage системы управления версиями необходимо обрабатывать события QEQS путем реализации `IVsQueryEditQuerySave2` интерфейс и необходимые методы. Ниже приводится краткое описание из двух способов, которые VSPackage должен реализовать по меньшей мере. Фактическую реализацию должен соответствовать логике модель управления исходным кодом.

### <a name="queryeditfiles-method"></a>Метод QueryEditFiles
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2.QueryEditFiles%2A> Вызывается, когда любой проект или редактор хочет изменить файл. В идеальном случае этот метод вызывается *перед* файл будет изменен, при сохранении файла. При вызове `IVsQueryEditQuerySave2::QueryEditFiles` метод проверяет, являются ли заданные файлы в системе управления версиями, они должны быть извлечены и ли они были перезагружены. Если обстоятельства запретить быть доступными для редактирования файлов `IVsQueryEditQuerySave2::QueryEditFiles` метод сообщает вызывающей программе, чтобы отменить изменения. Это также позволяет вызывающему объекту указать режим проверки вызова. В режиме «автоматический» этот метод выполняет действие, только в том случае, если это не вызывает любой пользовательский Интерфейс для отображения. Если пользовательский Интерфейс неизбежна, флаг должен быть возвращен для указывают на неполадку.

 Поведение метода в виде транзакций; то есть если Правка отменяется на один файл, редактирования отменяется для всех файлов. И наоборот Если редактирование разрешено, допускается для всех файлов. Если этот метод позволяет редактирования один раз для заданного набора файлов, его необходимо всегда разрешать изменение при последующих вызовах для одного набора файлов. Разрешить изменение цикл продолжается, пока не закрыт, сохранен и перезагружен; файлы пока не измените их атрибутов (свойств); или пока не будет изменен пакет системы управления версиями. Варианты, которые следует учитывать при реализации `IVsQueryEditQuerySave2::QueryEditFiles` метод включают несколько файлов, специальные файлы, Отмена из пользователя и изменения в памяти.

### <a name="querysavefiles-method"></a>Метод QuerySaveFiles
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2.QuerySaveFiles%2A> Вызывается, когда любой проект или редактор необходимо для сохранения набора файлов. При вызове `IVsQueryEditQuerySave2::QuerySaveFiles` метод проверяет, если заданные файлы доступны только для чтения и являются ли они в системе управления версиями. Если файлы нужно извлечь, вызов делегируется пакет системы управления версиями. Если обстоятельства файлы были сохранены, `IVsQueryEditQuerySave2::QuerySaveFiles` метод должен сообщить редактору, сохранение будет отменено. Как и в `IVsQueryEditQuerySave2::QueryEditFiles` метод, возможна вызывающему объекту указать режим проверки вызова. В режиме «автоматический» этот метод выполняет действие, только в том случае, если это не вызывает любой пользовательский Интерфейс для отображения. Если пользовательский Интерфейс неизбежна, флаг должен быть возвращен для указывают на неполадку.

 Этот метод должен вести себя в виде транзакций; то есть если сохранения отменяется на один файл, сохранения отменяется для всех файлов. И наоборот Если разрешено сохранения, ему должно быть разрешено для всех файлов. Как и в `IVsQueryEditQuerySave2::QueryEditFiles` метод, случаи, которые следует учитывать при реализации `IVsQueryEditQuerySave2::QuerySaveFiles` метод включают несколько файлов, специальные файлы, Отмена из пользователя и изменения в памяти.

## <a name="see-also"></a>См. также
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2>