---
title: Архитектура пакета VSPackage в системе управления версиями | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- source control packages, architecture
ms.assetid: 453125fc-23dc-49b1-8476-94581f05e6c7
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 9484aabd0080b0a44d75a8a5f6d90d9217d74b8e
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72723353"
---
# <a name="source-control-vspackage-architecture"></a>Архитектура пакета VSPackage системы управления версиями
Пакет управления версиями — это VSPackage, использующий службы, предоставляемые [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] интегрированной средой разработки. В случае возврата пакет управления версиями предоставляет свои функциональные возможности в качестве службы управления версиями. Кроме того, пакет управления версиями является более универсальным вариантом, чем подключаемый модуль системы управления версиями для интеграции системы управления версиями в [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].

 Подключаемый модуль системы управления версиями, реализующий интерфейс API подключаемого модуля системы управления версиями, придерживается определенного контракта. Например, подключаемый модуль не может заменить пользовательский интерфейс по умолчанию [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Кроме того, интерфейс API подключаемого модуля системы управления версиями не позволяет подключаемому модулю реализовать собственную модель управления версиями. Однако пакет управления версиями имеет оба этих ограничения. Пакет управления версиями имеет полный контроль над процессом управления версиями [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] пользователем. Кроме того, пакет управления версиями может использовать собственную модель и логику системы управления версиями, а также может определять все пользовательские интерфейсы, связанные с системой управления версиями.

## <a name="source-control-package-components"></a>Компоненты пакета управления версиями
 Как показано на схеме архитектуры, компонент [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] с именем заглушки системы управления версиями — это VSPackage, который интегрирует пакет управления версиями с [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].

 Заглушка системы управления версиями обрабатывает следующие задачи.

- Предоставляет общий пользовательский интерфейс, необходимый для регистрации пакета управления версиями.

- Загружает пакет управления версиями.

- Устанавливает пакет управления версиями как активный или неактивный.

  Заглушка системы управления версиями ищет активную службу для пакета управления версиями и направляет все входящие вызовы служб из IDE в этот пакет.

  Пакет адаптера системы управления версиями — это специальный пакет управления версиями, который [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] предоставляет. Этот пакет является центральным компонентом для поддержки подключаемых модулей системы управления версиями на основе API подключаемого модуля системы управления версиями. Если подключаемый модуль системы управления версиями является активным подключаемым модулем, заглушка системы управления версиями отправляет свои события в пакет адаптера системы управления версиями. В свою очередь, пакет адаптера системы управления версиями взаимодействует с подключаемым модулем системы управления версиями с помощью API подключаемого модуля системы управления версиями, а также предоставляет пользовательский интерфейс по умолчанию, который является общим для всех подключаемых модулей системы управления версиями.

  С другой стороны, если пакет управления версиями является активным, заглушка системы управления версиями напрямую взаимодействует с пакетом, используя [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] интерфейсы пакета управления версиями. Пакет управления версиями отвечает за размещение собственного пользовательского интерфейса системы управления версиями.

  ![График архитектуры системы управления версиями](../../extensibility/internals/media/vsipsccarch.gif "всипсккарч")

  Для пакета управления версиями [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] не предоставляет код системы управления версиями или API для интеграции. Сравните это с подходом, описанным в статьи [Создание подключаемого модуля системы](../../extensibility/internals/creating-a-source-control-plug-in.md) управления версиями, где подключаемый модуль системы управления версиями должен реализовывать жесткий набор функций и обратных вызовов.

  Как и пакеты VSPackage, пакет управления версиями — это COM-объект, который можно создать с помощью `CoCreateInstance`. Пакет VSPackage делает его доступным для [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] IDE, реализуя <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>. После создания экземпляра VSPackage получает указатель сайта и интерфейс <xref:Microsoft.VisualStudio.OLE.Interop.IServiceProvider>, который предоставляет VSPackage доступ к доступным службам и интерфейсам в интегрированной среде разработки.

  Написание пакета управления версиями на основе VSPackage требует более продвинутого опыта программирования, чем написание подключаемого модуля на основе API для подключаемого модуля системы управления версиями.

## <a name="see-also"></a>См. также
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>
- [Начало работы](../../extensibility/internals/getting-started-with-source-control-vspackages.md)