---
title: Архитектура управления источниками VSPackage (ru) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- source control packages, architecture
ms.assetid: 453125fc-23dc-49b1-8476-94581f05e6c7
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: d6e62aa9e2d725e982f0605e2721f0bfeb3cc5ee
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80705084"
---
# <a name="source-control-vspackage-architecture"></a>Архитектура пакета VSPackage системы управления версиями
Пакет управления исходным элементом — это [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] VSPackage, который использует услуги, предоставляемые IDE. В свою очередь, пакет управления исходным сообщением предоставляет свою функциональность в качестве службы управления исходным сообщением. Кроме того, пакет управления исходным управлением является более универсальной альтернативой, чем [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]плагин управления исходным управлением для интеграции управления исходным источником в.

 Подключаемый плагин, который реализует API подключаемых источников, соблюдает строгий контракт. Например, плагин не может [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] заменить пользовательский интерфейс по умолчанию (UI). Кроме того, API для подключаемых источников не позволяет плагину реализовать собственную модель управления исходным управлением. Однако пакет управления исходным управлением преодолевает оба этих ограничения. Пакет управления исходным элементом имеет полный [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] контроль над опытом управления исходным элементом пользователя. Кроме того, пакет управления исходным интерфейсом может использовать свою собственную модель управления исходным управлением и логику, а также определять все пользовательские интерфейсы, связанные с управлением исходным использовачтой.

## <a name="source-control-package-components"></a>Компоненты пакета «Источник-Контроль»
 Как показано на диаграмме [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] архитектуры, компонент под названием Source Control Stub является [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]VSPackage, который интегрирует пакет управления исходным управлением с .

 Source Control Stub обрабатывает следующие задачи.

- Обеспечивает общий uii, необходимый для регистрации пакетов исходного контроля.

- Загружает пакет управления исходным элементом.

- Устанавливает пакет управления исходным элементом как активный/неактивный.

  Source Control Stub ищет активную службу для пакета управления исходным движением и направляет все входящие вызовы службы от IDE к этому пакету.

  Пакет адаптеров управления исходным управлением [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] представляет собой специальный пакет управления исходным элементом, который обеспечивает. Этот пакет является центральным компонентом для поддержки плагинов управления исходным управлением на основе API подключаемых систем управления исходным управлением. Когда плагин управления исходным элементом является активным плагином, Зак в Управление источника отправляет свои события в пакет адаптера управления исходным управлением. В свою очередь, пакет адаптера управления исходным управлением общается с плагином управления исходным элементом с помощью API-интерфейса управления исходным управлением, а также предоставляет интерфейс по умолчанию, который является общим для всех плагинов управления исходным управлением.

  С другой стороны, когда пакет исходного контроля является активным пакетом, с другой стороны, Зак в управлении исходным управлением напрямую общается с пакетом, используя интерфейсы пакета [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] управления исходным управлением. Пакет управления исходным элементом отвечает за размещение собственного uI управления исходным управлением.

  ![График архитектуры системы управления версиями](../../extensibility/internals/media/vsipsccarch.gif "ВСИПСКАРХ")

  Для пакета управления исходным кодом не [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] поставляются код управления исходным кодом или API для интеграции. Сравните это с подходом, изложенным в [создании подключаемого ключа управления,](../../extensibility/internals/creating-a-source-control-plug-in.md) где плагин управления исходным элементом должен реализовать жесткий набор функций и обратных вызовов.

  Как и любой VSPackage, пакет управления исходным элементом `CoCreateInstance`является объектом COM, который может быть создан с помощью . VSPackage делает себя доступным [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] для IDE <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>путем реализации . Когда экземпляр был создан, VSPackage получает указатель <xref:Microsoft.VisualStudio.OLE.Interop.IServiceProvider> сайта и интерфейс, который обеспечивает VSPackage доступ к имеющимся услугам и интерфейсам в IDE.

  Написание пакета управления исходным кодом на основе VSPackage требует более передовых знаний в области программирования, чем написание плагина на основе API на основе API.

## <a name="see-also"></a>См. также
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>
- [Начало работы](../../extensibility/internals/getting-started-with-source-control-vspackages.md)
