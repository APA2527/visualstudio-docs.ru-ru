---
title: Отображение файлов с помощью команды Open File (ru) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- project types, supporting Open File command
- Open File command
- persistence, supporting Open File command
ms.assetid: 4fff0576-b2f3-4f17-9769-930f926f273c
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: cc18442c55b6989c4d8668e1425fdd62a2d4b1b6
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80708597"
---
# <a name="display-files-by-using-the-open-file-command"></a>Отображение файлов с помощью команды Open File
Следующие шаги описывают, как IDE обрабатывает команду **Open File,** [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]которая доступна в меню **файла** в . В шагах также описывается, как проекты должны реагировать на вызовы, исходимые из этой команды.

 Когда пользователь нажимает на команду **Open File** в меню **файла** и выбирает файл из окна диалога **Open File,** происходит следующий процесс:

1. Используя таблицу запущенных документов, IDE определяет, открыт ли файл в проекте.

    - Если файл открыт, IDE всплывает в окне.

    - Если файл не открыт, IDE <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.IsDocumentInProject%2A> призывает задать запрос каждому проекту, чтобы определить, какой проект может открыть файл.

        > [!NOTE]
        > При реализации <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.IsDocumentInProject%2A>проекта укажите приоритетное значение, которое указывает уровень, на котором проект открывает файл. Приоритетные значения приведены <xref:Microsoft.VisualStudio.Shell.Interop.VSDOCUMENTPRIORITY> в перечислении.

2. Каждый проект отвечает на уровне приоритета, который указывает на важность, которую он придает проекту для открытия файла.

3. IDE использует следующие критерии для определения того, какой проект открывает файл:

    - Проект, который отвечает с наивысшим приоритетом ()`DP_Intrinsic`открывает файл. Если с этим приоритетом отвечает несколько проектов, первый проект, ответивнающий на этот запрос, открывает файл.

    - Если ни один проект не`DP_Intrinsic`отвечает с наивысшим приоритетом (), но все проекты отвечают с одинаковым, более низким приоритетом, активный проект открывает файл. Если проект не активен, первый проект, ответивный, открывает файл.

    - Если ни один проект не`DP_Unsupported`претендует на право собственности на файл (), проект «Разные файлы» открывает файл.

         При создании экземпляра проекта «Разные файлы» проект всегда отвечает `DP_CanAddAsExternal`значением . Это значение указывает на то, что проект может открыть файл. Этот проект используется для размещения открытых файлов, которые не в ходят ни в одном другом проекте. Перечень элементов в этом проекте не сохраняется; этот проект виден в **Solution Explorer** только тогда, когда он используется для открытия файла.

         Если проект «Разные файлы» не указывает на то, что он может открыть файл, экземпляр проекта не создан. В этом случае IDE создает экземпляр проекта «Разные файлы» и сообщает проекту об открытии файла.

4. Как только IDE определяет, какой проект открывает <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.OpenItem%2A> файл, он вызывает метод по этому проекту.

5. Затем проект имеет возможность открытия файла с помощью конкретного редактора проекта или стандартного редактора. Для получения дополнительной информации [см. Как: Открыть конкретные редакторы проектов](../../extensibility/how-to-open-project-specific-editors.md) и [как: Открыть стандартные редакторы](../../extensibility/how-to-open-standard-editors.md), соответственно.

## <a name="see-also"></a>См. также
- [Отображение файлов с помощью команды Open With](../../extensibility/internals/displaying-files-by-using-the-open-with-command.md)
- [Откройте и сохраните элементы проекта](../../extensibility/internals/opening-and-saving-project-items.md)
- [Как: Открыть редакторы для конкретных проектов](../../extensibility/how-to-open-project-specific-editors.md)
- [Как: Открытые стандартные редакторы](../../extensibility/how-to-open-standard-editors.md)
