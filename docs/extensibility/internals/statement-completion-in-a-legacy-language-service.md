---
title: Завершение выполнения заявления в службе языка наследия (ru) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- statement completion
- language services, statement completion
ms.assetid: 617439dc-3f0e-4e5f-b346-3e4e7fcf3c1b
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: bbeb360cf5bc0f74d6b2d9b93086382dd35da988
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80704941"
---
# <a name="statement-completion-in-a-legacy-language-service"></a>Завершение операторов в языковой службе прежних версий
Завершение выполнения заявления — это процесс, с помощью которого языковая служба помогает пользователям закончить ключевое слово или элемент языка, который они начали вводить в основной редактор. В этой теме обсуждается, как работает завершение выписки и как реализовать его в языковой службе.

 Устаревшие языковые службы реализуются как часть VSPackage, но новый способ реализации функций языкового сервиса заключается в использовании расширений MEF. Чтобы узнать больше о новом способе завершения выполнения оператора, смотрите [Пошаговая работа: Отображение завершения оператора](../../extensibility/walkthrough-displaying-statement-completion.md).

> [!NOTE]
> Мы рекомендуем вам начать использовать новый API редактора как можно скорее. Это повысит производительность вашего языкового сервиса и позволит вам воспользоваться новыми функциями редактора.

## <a name="implementing-statement-completion"></a>Завершение выполнения заявления
 В главном редакторе завершение оператора активирует специальный uii, который в интерактивном режиме помогает вам легче и быстро писать код. Завершение выполнения заявления помогает, отображая соответствующие объекты или классы, когда они необходимы, что позволяет избежать необходимости запоминать определенные элементы или искать их в теме справки.

 Для завершения выполнения оператора язык должен иметь триггер завершения оператора, который можно разобрать. Например, [!INCLUDE[vbprvb](../../code-quality/includes/vbprvb_md.md)] использует оператора точек (.) при [!INCLUDE[vcprvc](../../code-quality/includes/vcprvc_md.md)] использовании оператора стрелка (->). Языковая служба может использовать несколько триггеров для инициирования завершения оператора. Эти триггеры запрограммированы в командном фильтре.

## <a name="command-filters-and-triggers"></a>Командные фильтры и триггеры
 Командные фильтры перехватывают случаи вашего триггера или триггеров. Чтобы добавить командный фильтр в <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> представление, реализуйте интерфейс <xref:Microsoft.VisualStudio.TextManager.Interop.IVsTextView.AddCommandFilter%2A> и прикрепите его к представлению, позвонив в метод. Вы можете использовать один<xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget>и тот же командный фильтр () для всех аспектов службы языка, таких как завершение оператора, маркеры ошибок и советы по методу. Для получения дополнительной [информации см.](../../extensibility/internals/intercepting-legacy-language-service-commands.md)

 Когда триггер вводится в редактор - в частности, текстовый <xref:Microsoft.VisualStudio.TextManager.Interop.IVsTextView.UpdateCompletionStatus%2A> буфер - ваша языковая служба затем вызывает метод. Это заставляет редактора поднимать пользовательский интерфейс, чтобы пользователь мог выбрать из кандидатов на завершение работы оператора. Этот метод требует <xref:Microsoft.VisualStudio.TextManager.Interop.IVsCompletionSet> реализации <xref:Microsoft.VisualStudio.TextManager.Interop.UpdateCompletionFlags> и флаги в качестве параметров. Список элементов завершения отображается в поле списка прокрутки. По мере того как пользователь продолжает печатать, выбор в поле списка обновляется, чтобы отразить ближайший матч с последними символами, набранным. Основной редактор реализует uI для завершения оператора, но <xref:Microsoft.VisualStudio.TextManager.Interop.IVsCompletionSet> языковая служба должна реализовать интерфейс для определения набора элементов завершения кандидата для оператора.

## <a name="see-also"></a>См. также
- [Перехват команд языковой службы прежних версий](../../extensibility/internals/intercepting-legacy-language-service-commands.md)
