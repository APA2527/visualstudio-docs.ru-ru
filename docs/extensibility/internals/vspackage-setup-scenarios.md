---
title: Сценарии установки VSPackage | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- VSPackages, deployment considerations
author: gregvanl
ms.author: gregvanl
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 7a8c8d0501222616ad97b745ce69e102ebd54835
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62857251"
---
# <a name="vspackage-setup-scenarios"></a>Сценарии установки VSPackage

Очень важно для разработки VSPackage установщик для обеспечения гибкости. Например может понадобиться в будущем выпуске исправления безопасности, или можно изменить бизнес-стратегии, которые требуют поддержки тщательного управления версиями side-by-side.

В [поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md), можно узнать преимущества и проблемы с поддержкой установок side-by-side [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] с совместно используемой или side-by-side установок VSPackage. Короче говоря, пакеты VSPackage side-by-side дают наибольшую гибкость для поддержки новых возможностей [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].

Сценарии, рассмотренные в этом разделе не только выбранные параметры, но они представлены в виде рекомендации.

## <a name="components-privacy-and-sharing"></a>Компоненты, конфиденциальности и управления доступом

### <a name="make-your-components-independent"></a>Создание независимых компонентов

После идентификации и заполнить компонента, назначить `GUID`и развернуть компонент, нельзя изменить его композиции. При изменении компонента композиции, итоговый компонент должен быть компонента с новым `GUID`. Учитывая эти факты, наибольшую гибкость управления версиями является обеспечиваемый что делает каждый компонент независимые, проводить более единицы. Дополнительные сведения о правила, управляющие компоненты, см. в разделе [изменения кода компонент](/windows/desktop/Msi/changing-the-component-code) и [что произойдет, если компонент правила разбиваются?](/windows/desktop/Msi/what-happens-if-the-component-rules-are-broken).

### <a name="do-not-mix-shared-and-private-resources-in-a-component"></a>Не следует смешивать общие и закрытые ресурсы в компоненте

Подсчет ссылок происходит на уровне компонента. Следовательно смешение общие и закрытые ресурсы в одном компоненте делает невозможным обновление частного ресурсы, такие как исполняемого файла, без также перезаписи общих ресурсов. Этот сценарий создает проблемы обратной совместимости и запрещает создание возможностей side-by-side.

Например, значения реестра, используемый для регистрации VSPackage с [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] должны храниться в компоненте отдельно от тому, который используется для регистрации VSPackage с помощью Visual Studio. Общие файлы или значения реестра перейдите в еще один компонент.

## <a name="scenario-1-shared-vspackage"></a>Сценарий 1. Общий VSPackage

В этом случае общие VSPackage (единый двоичный файл, который поддерживает несколько версий Visual Studio поставляется в пакет установщика Windows. Регистрация с каждой версией Visual Studio осуществляется с возможностью выбора пользователем функции. Это также означает, что при назначении для разделения функций каждого компонента могут быть выбраны для установки или удаления, поместить пользователя в элементе управления интеграции VSPackage в разных версиях [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. (См. в разделе [возможности установщика Windows](/windows/desktop/Msi/windows-installer-features) Дополнительные сведения об использовании функций в пакеты установщика Windows.)

![Установщик VS Shared VSPackage](../../extensibility/internals/media/vs_sharedpackage.gif "VS_SharedPackage")

Как показано на рисунке, общие компоненты становятся частью Feat_Common компонента, который всегда устанавливается. Благодаря функции Feat_VS2002 и Feat_VS2003 видимым, пользователи могут выбирать во время установки в какие версии Visual Studio, они хотят интегрировать VSPackage. Пользователи также могут использовать режим обслуживания установщика Windows для добавления или удаления компонентов, который в данном случае добавляет или удаляет сведения о регистрации VSPackage из разных версий Visual Studio.

> [!NOTE]
> Установка компонента отображаемый столбец 0 скрывает его. Значение столбца низкого уровня, например 1, гарантирует, что он будет всегда установлен. Дополнительные сведения см. в разделе [installlevel, ОЗНАЧАЮТ свойство](/windows/desktop/Msi/installlevel) и [таблицы компонентов](/windows/desktop/Msi/feature-table).

## <a name="scenario-2-shared-vspackage-update"></a>Сценарий 2. Общие обновления пакета VSPackage

В этом случае поставляется обновленную версию установщика VSPackage в сценарии 1. Для целей обсуждения обновление добавляет поддержку для Visual Studio, но оно может также быть проще исправление системы безопасности или исправления пакета обновления. Правила установщика Windows для установки новых компонентов требуют, что компоненты без изменений в системе не копируются повторно. В этом случае система с версии 1.0 уже присутствует перезапишет обновляемого компонента Comp_MyVSPackage.dll и позволить пользователям выбирать для добавления новой функции Feat_VS2005 с его компонентом Comp_VS2005_Reg.

> [!CAUTION]
> Каждый раз, когда VSPackage является общим для нескольких версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)], очень важно, что в последующих выпусках пакета VSPackage обеспечить обратную совместимость с предыдущих версий Visual Studio. Там, где невозможно обеспечить обратную совместимость, необходимо использовать пакеты VSPackage side-by-side, закрытым. Дополнительные сведения см. в разделе [поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md).

![VS Shared VS с обновлением пакета установщика](../../extensibility/internals/media/vs_sharedpackageupdate.gif "VS_SharedPackageUpdate")

Этот сценарий представлен новый установщик VSPackage, использование преимуществ поддержки установщика Windows для промежуточных обновлений. Пользователи просто установить версию 1.1, и его обновление версии 1.0. Тем не менее не обязательно иметь версии 1.0 в системе. Тот же установщик будет установить версию 1.1, в системе, не версии 1.0. Для предоставления промежуточных обновлений таким образом удобен тем, что нет необходимости проходить через работу по разработке обновления установщик и установщик full продукта. Один установщик выполняет оба задания. Исправление безопасности или пакетом обновления могут вместо этого воспользуйтесь преимуществами исправлений установщика Windows. Дополнительные сведения см. в разделе [Установка исправлений и обновлений](/windows/desktop/Msi/patching-and-upgrades).

## <a name="scenario-3-side-by-side-vspackage"></a>Сценарий 3. Side-by-Side VSPackage

Этот сценарий предоставляет два установщика VSPackage — один для каждой версии Visual Studio .NET 2003 и Visual Studio. Каждый установщик устанавливает side-by-side, или private, пакет VSPackage (тот, который специально созданных и установленных для определенной версии Visual Studio). Каждый пакет VSPackage имеет свой собственный компонент. Следовательно, каждый можно по отдельности обслуживаться с исправлениями или обслуживания выпусков. Так как библиотеки DLL VSPackage теперь конкретной версии, можно безопасно для включения сведений о его регистрации в том же компоненте, где находится библиотека DLL.

![Установщик пакета VS Side-by-Side VS](../../extensibility/internals/media/vs_sbys_package.gif "VS_SbyS_Package")

Каждый установщик также включает код, который совместно используется два установщика. Если общий код установки в общую папку, при установке оба файла MSI-файла будет установлена общий код только один раз. Второй установщик просто увеличивает значение счетчика ссылок на компонент. Счетчик ссылок гарантирует, что если удаляется один из пакетов VSPackage, общий код будут действовать для других VSPackage. Если также удаляется второй VSPackage, общий код будут удалены.

## <a name="scenario-4-side-by-side-vspackage-update"></a>Сценарий 4. Обновление пакета VSPackage Side-by-Side

В этом случае VSPackage для Visual Studio страдал уязвимость системы безопасности и вам нужно выполнить обновление. Как и в сценарии 2 можно создать новый MSI-файл, который обновляет существующую установку включают исправление безопасности, а также развертывание новых установок с исправлением безопасности уже на месте.

В этом случае VSPackage — это управляемый пакет VSPackage, установлены в глобальный кэш сборок (GAC). При перестроении он включает исправление безопасности, необходимо изменить часть номера версии, номера версии сборки. Сведения о регистрации для нового номера версии сборки заменяет предыдущую версию, вызывая [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] для загрузки предопределенной сборки.

![Установщик обновления пакета VS Side-by-Side VS](../../extensibility/internals/media/vs_sbys_packageupdate.gif "VS_SbyS_PackageUpdate")

Дополнительные сведения о развертывании side-by-side сборок см. в разделе [Упрощение развертывания и решению осложнения с библиотеками DLL в .NET Framework](https://msdn.microsoft.com/library/ms973843.aspx).

## <a name="see-also"></a>См. также

- [Установщик Windows](/windows/desktop/Msi/windows-installer-portal)
- [Поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md)