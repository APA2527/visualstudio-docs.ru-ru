---
title: Команды конструктора | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- commands
- commands, implementation
ms.assetid: 097108c3-f758-4b87-89d6-b32d12d9041a
author: gregvanl
ms.author: gregvanl
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: c176a558d7d5956c1d41593f5d0cc71184a9a820
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62861697"
---
# <a name="command-design"></a>Конструктор команд
При добавлении команды VSPackage, необходимо указать которых может отображаться, когда он становится доступен, и способ их обработки.

## <a name="define-commands"></a>Определение команд
 Чтобы определить новые команды, включают таблицы команд Visual Studio (*.vsct*) файл в проект VSPackage. Если вы создали VSPackage с помощью шаблона пакета Visual Studio, проект содержит один из этих файлов. Дополнительные сведения см. в разделе [Visual Studio командные table (.vsct) файлы](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md).

 Visual Studio объединяет все *.vsct* файлах его находит, таким образом, чтобы его можно отобразить команды. Поскольку эти файлы отличаются от двоичных VSPackage, загрузить пакет, чтобы найти команды имеет Visual Studio. Дополнительные сведения см. в разделе [как пакеты VSPackage добавить элементы пользовательского интерфейса](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).

 Visual Studio использует <xref:Microsoft.VisualStudio.Shell.ProvideMenuResourceAttribute> атрибута регистрации для определения ресурсов меню и команд. Дополнительные сведения см. в разделе [реализации команды](../../extensibility/internals/command-implementation.md).

 Команды можно изменить во время выполнения в несколько разных способов. Они могут отображаться или скрыты, включить или отключить. Их можно отобразить значки или другим текстовым или содержать разные значения. Большое количество настройки может быть выполнена, прежде чем Visual Studio загружает VSPackage. Дополнительные сведения см. в разделе [как пакеты VSPackage добавить элементы пользовательского интерфейса](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).

## <a name="command-handlers"></a>Обработчики команд
 При создании команды необходимо указать обработчик событий, чтобы выполнить команду. Если пользователь выбирает команду, она будет направляться соответствующим образом. Маршрутизации команды означает, что отправляется правильный пакет VSPackage, чтобы включить или отключить его, скрыть или отобразить ее и выполните его, если пользователь выбирает для этого. Дополнительные сведения см. в разделе [алгоритм маршрутизации команд](../../extensibility/internals/command-routing-algorithm.md).

## <a name="visual-studio-command-environment"></a>Команда среды Visual Studio
 Visual Studio можно разместить любое количество пакетов VSPackage, а каждый вносить свой вклад в свой собственный набор команд. Среде отображает только команды, которые подходят для текущей задачи. Дополнительные сведения см. в разделе [команды доступности](../../extensibility/internals/command-availability.md) и [объекты контекста выбора](../../extensibility/internals/selection-context-objects.md).

 Пакет VSPackage, который определяет новые команды, меню, панели инструментов или контекстного меню сведения его команды для Visual Studio во время установки с помощью записи реестра, которые ссылаются на ресурсы в собственных или управляемых сборках. Каждый ресурс, затем ссылается на ресурс двоичные данные (*.cto*) файл, который создается при компиляции таблицы команд Visual Studio (*.vsct*) файла. Это позволяет Visual Studio для предоставления наборов объединенных команд, меню и панелей инструментов без необходимости загружать каждого установленного пакета VSPackage.

### <a name="command-organization"></a>Команда организации
 Среде помещает команды, группы, приоритет и меню.

- Группы — это логические наборы связанных команд, например, **Вырезать**, **копирования**, и **вставить** группы команд. Группы — это команды, отображаемые в меню.

- Приоритет определяет порядок, в котором отображаются отдельные команды в группе, в меню.

- Меню действуют как контейнеры для группы.

  Среде предопределяет некоторые команды, группы и меню. Дополнительные сведения см. в разделе [размещение команды, группы и панель инструментов по умолчанию](../../extensibility/internals/default-command-group-and-toolbar-placement.md).

  Команды могут быть назначены основную группу. Основная группа управляет расположением команды в структуре главного меню и в **Настройка** диалоговое окно. Команда может встречаться в нескольких группах; Например команда может быть в главном меню, в контекстном меню и на панели инструментов. Дополнительные сведения см. в разделе [как пакеты VSPackage добавить элементы пользовательского интерфейса](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).

### <a name="command-routing"></a>Маршрутизация команд
 Процесс маршрутизации команд для пакетов VSPackage и вызова отличается от процесса вызова методов экземпляров объектов.

 Среде направляет команды последовательно из корневого (local) контекста команды, который основывается на текущее выделение, самый внешний контекст (используется глобально). Первый контекст, который способен выполнить команду является тот, который обрабатывает его. Дополнительные сведения см. в разделе [алгоритм маршрутизации команд](../../extensibility/internals/command-routing-algorithm.md).

 В большинстве случаев среде обрабатывает команды с помощью <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейс. Так как схема маршрутизации команд включает множество разные объекты для обработки команд, <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> может быть реализован любым количеством объектов; они включают элементы управления Microsoft ActiveX, окно представления реализаций, объекты документа, иерархий проектов и VSPackage сами объекты (для глобальных команд). В некоторых случаях специализированные, например, маршрутизация команд в иерархии, <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> интерфейс должен быть реализован.

## <a name="related-topics"></a>См. также

|Заголовок|Описание|
|-----------|-----------------|
|[Реализация команды](../../extensibility/internals/command-implementation.md)|В этой статье описывается реализация команд в VSPackage.|
|[Доступность команд](../../extensibility/internals/command-availability.md)|Описывается, как Visual Studio контекст определяет, какие команды доступны.|
|[Алгоритм маршрутизации команд](../../extensibility/internals/command-routing-algorithm.md)|Описывает, как архитектура маршрутизации команды Visual Studio позволяет команд для обработки в разных пакетов VSPackage.|
|[Рекомендации по размещению команд](../../extensibility/internals/command-placement-guidelines.md)|Предлагает методы для позиционирования команд в среде Visual Studio.|
|[Как добавить элементы пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md)|Описывает, как пакеты VSPackage могут лучше всего использовать архитектуры команды Visual Studio.|
|[Место размещения по умолчанию команды, группы и панель инструментов](../../extensibility/internals/default-command-group-and-toolbar-placement.md)|Описывает, как пакеты VSPackages могут лучше всего использовать команды, которые включены в Visual Studio.|
|[Управление пакетов VSPackage](../../extensibility/managing-vspackages.md)|Описывает, как Visual Studio загружает пакеты VSPackage.|
|[Visual Studio командные файлы table (.vsct)](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md)|Предоставляет сведения о формате XML *.vsct* файлов, которые используются для описания макета и внешнего вида команды в пакеты VSPackage.|