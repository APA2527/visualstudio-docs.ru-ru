---
title: Страницы свойств Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- configuration options, changing properties
- property pages
- property pages, changing configuration options
ms.assetid: b9b3e6e8-1e30-4c89-9862-330265dcf38c
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: ac788f51bcdc52cd39469a272909890333c5016b
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80706058"
---
# <a name="property-pages"></a>Страницы свойств
Пользователи могут просматривать и изменять зависящие от конфигурации и -независимые свойства проекта с помощью страниц свойств. Кнопка **Страницы свойств** включена в окне **Свойств** или на панели инструментов Solution Explorer для объектов, которые обеспечивают представление страницы свойства выбранного объекта. Страницы свойств создаются средой и доступны для решений и проектов. Однако они также могут быть доступны для элементов проекта, которые используют зависящие от конфигурации свойства. Эта возможность может использоваться, когда файлы в проекте требуют различных настроек компилятора для правильной сборки.

## <a name="using-property-pages"></a>Использование страниц свойств
 Если страница свойств уже отображается и выбор изменяется (например, от решения к проекту), информация, отображаемые на страницах, изменяется для отображения свойств для нового выбора. Если на объекте нет свойств, поддерживающих страницы свойств, страница свойств пуста.

 При выборе нескольких объектов страница свойств отображает пересечение свойств для всех выбранных элементов. Если выбранный элемент не содержит зависящих от конфигурации свойств и кнопка **Страницы свойств** на панели инструментов Solution Explorer нажата, сфокусируйте изменения в окне свойств. Для получения дополнительной информации, относящейся к окну свойства и выбор, [см.](../../extensibility/internals/extending-properties.md)

 Если свойства отображаются для нескольких объектов и вы изменяете значение на странице свойств, все значения для объектов устанавливаются в новое значение, даже если они изначально были разными, и страница была пустой при отображении свойств отдельного объекта.

 Есть два общих типа диалоговых коробок [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] **ProjectProperty Pages,** доступных в . В первом, например, для проектов Visual Basic страницы свойств отображаются с помощью формата поля, как показано на следующем скриншоте. Во втором, показанном позже в этом разделе, на странице свойств размещаетсетку свойств, аналогичную той, что находится в окне свойств.

 ![Страницы визуальных базовых свойств](../../extensibility/internals/media/vsvbproppages.gif "vsVBPropPages") Диалоговое поле Project Property Pages с форматом поля и структурой дерева

 Структура дерева в диалоговом поле Страниц <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy>ы свойств не построена с использованием. Среда, основанная на названии уровня, <xref:Microsoft.VisualStudio.Shell.Interop.IVsPropertyPage> передаваемом ему <xref:Microsoft.VisualStudio.OLE.Interop.ISpecifyPropertyPages> интерфейсами, строит его.

 На страницах [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Property доступны только две категории верхнего уровня:

- Общие свойства, которые отображают независимую от конфигурации информацию для выбранного объекта или объектов. В результате, когда выбрана одна из подкатегорий Common Properties, параметры настройки, платформы и менеджера конфигурации в верхней части окна диалога недоступны.

- Параметры конфигурации, содержащие зависящие от конфигурации сведения, относящиеся к параметрам отладизации, оптимизации и сборки для решения или проекта.

  Вы не можете создать какие-либо дополнительные категории верхнего уровня, но `IVsPropertyPage`вы можете отказаться от отображения одной или другой в вашей реализации. Если, например, у вас нет каких-либо независях от конфигурации свойств для отображения объекта, вы можете отказаться от отображения категории Common Properties. Вы отображаете `ISpecifyPropertyPages` общие свойства, если реализованы из объекта просмотра `ISpecifyPropertyPages` объекта и свойства конфигурации `IVsCfg` `IVsProjectCfg`при реализации в объекте конфигурации (объект реализации, и связанных с ними интерфейсов).

  Каждая категория, отображаемые в категории верхнего уровня, представляет собой отдельную страницу свойств. Записи категории и подкатегории, доступные в `ISpecifyPropertyPages` диалоговом поле, определяются вашей реализацией и `IVsPropertyPage`.

  `IDispatch`объекты для элементов в контейнере выбора, которые `ISpecifyPropertyPages` имеют свойства, которые должны отображаться на страницах свойств, реализуются для перечисления списка идентифицировать класс. Идентифицированные идентифицировать класс передаются как переменные `ISpecifyPropertyPages` и используются для мгновенного воспроизведения страниц свойств. Список идентифицированных идентифицировать класс также передается `IVsPropertyPage` для создания структуры дерева слева от диалогового окна. Страницы свойств затем передают `IDispatch` информацию обратно `ISpecifyPropertyPages` объекту, который реализует и заполняет информацию для каждой страницы.

  Свойства объекта просмотра извлекаются `IDispatch` с помощью каждого объекта в контейнере выбора.

  Реализация `Help::DisplayTopicFromF1Keyword` в VSPackage обеспечивает функциональность для кнопки справки.

  Для получения дополнительной `IDispatch` `ISpecifyPropertyPages`информации, смотрите и в библиотеке MSDN.

  Второй тип страниц свойств, отображаемых в образцах, содержит форму сетки свойств, как показано на следующем скриншоте.

  ![Страницы свойств VC](../../extensibility/internals/media/vsvcproppages.gif "vsVCPropPages") Диалоговая коробка Страниц свойств с сеткой свойств

  Интерфейсы `IVSMDPropertyBrowser` и `IVSMDPropertyGrid` (объявленные в vsmanaged.h) используются для создания и заполнения сетки свойств в поле или окне диалогового окна.

  Архитектура проектов значительно изменилась по [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]сравнению с прошлыми версиями . В частности, изменилось представление о том, какой проект активен. В [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)], нет концепции активного проекта. В предыдущих средах разработки активным проектом был проект, который сборка и развертывание команд будет по умолчанию, независимо от контекста. Теперь решение контролирует и арбитрирует, к каким проектам применяются и новые команды.

  То, что раньше было активным проектом, теперь фиксируется одним из трех различных способов:

- Проект стартапа

   Вы можете указать проект или проекты со страницы свойств решения, которая будет запущена, когда пользователь нажимает F5 или выбирает Run из меню сборки. Это работает в порядке, аналогичном старому активному проекту в том смысле, что его название отображается в Solution Explorer жирным шрифтом.

   Вы можете получить проект запуска в качестве свойства в `DTE.Solution.SolutionBuild.StartupProjects`модели автоматизации, позвонив в систему автоматизации. В VSPackage вы называете <xref:Microsoft.VisualStudio.Shell.Interop.IVsSolutionBuildManager2.get_StartupProject%2A> <xref:Microsoft.VisualStudio.Shell.Interop.IVsSolutionBuildManager2.get_StartupProject%2A> или методы. `IVsSolutionBuildManager`доступен в качестве `QueryService` услуги по SID_SVsSolutionBuildManager. Для получения дополнительной информации [Solution Configuration](../../extensibility/internals/solution-configuration.md) [см.](../../extensibility/internals/project-configuration-object.md)

- Конфигурация сборки активных решений

   [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]имеет активную конфигурацию решения, доступную `DTE.Solution.SolutionBuild.ActiveConfiguration`в модели автоматизации путем реализации. Конфигурация решения — это коллекция, содержащая одну конфигурацию проекта для каждого проекта в решении (каждый проект может иметь несколько конфигураций на нескольких платформах с разными именами). Для получения дополнительной информации, касающейся страниц свойств решения, [см.](../../extensibility/internals/solution-configuration.md)

- Проект, выбранный в настоящее время

   Реализация <xref:Microsoft.VisualStudio.Shell.Interop.IVsMonitorSelection.GetCurrentSelection%2A> метода для извлечения иерархии проекта и выбранного элемента проекта или элементов. От DTE, вы `SelectedItems.SelectedItem.Project` использовали `SelectedItems.SelectedItem.ProjectItem` бы и методы. В основных [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] документах есть примерный код.

## <a name="see-also"></a>См. также
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsPropertyPage>
- [Управление параметрами конфигурации](../../extensibility/internals/managing-configuration-options.md)
- [Объект конфигурации проекта](../../extensibility/internals/project-configuration-object.md)
- [Конфигурация решения](../../extensibility/internals/solution-configuration.md)
