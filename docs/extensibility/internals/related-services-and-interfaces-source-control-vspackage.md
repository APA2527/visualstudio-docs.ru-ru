---
title: Похожие службы и интерфейсы (Управление источником VSPackage) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- source control packages, interfaces
- interfaces, source control packages
ms.assetid: 3e96e838-5675-46bb-99cf-40d420086038
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 533f1bf4fcfbaebb25ec10908abf4a46ddacd521
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80705626"
---
# <a name="related-services-and-interfaces-source-control-vspackage"></a>Связанные службы и интерфейсы (пакет VSPackage системы управления версиями)
В этом разделе перечислены все интерфейсы управления [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)]исходным элементом VSPackage в . Управление исходным элементом VSPackage реализует некоторые из этих интерфейсов и использует другие для выполнения задач управления исходным источником.

## <a name="interfaces-implemented-by-and-for-source-control-vspackages"></a>Интерфейсы, реализованные vsPackages управления ими и для источника
 Следующие интерфейсы описаны [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)]в , и управление исходным элементом VSPackage реализует подмножество из них в зависимости от желаемого набора функций. Некоторые интерфейсы помечены по мере необходимости и должны быть реализованы каждым элементом управления vsPackage.

 Для тех интерфейсов, которые пакет [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] не реализует, обеспечивает реализацию по умолчанию. Обратите внимание, что реализация по умолчанию предназначена для случая, когда не зарегистрирован VSPackage и ни один проект не контролируется. Правильно письменный элемент управления исходным интерфейсом VSPackage реализует все необходимые интерфейсы, а не оставляет его для реализации этих интерфейсов по умолчанию.

 Управление источником VSPackage должно реализовать частную службу, которая инкапсулирует некоторые или все следующие интерфейсы.

 Интерфейсы:

- Требуется: соответствующая сущность (управление исходным элементом VSPackage, Source Control Stub, проект) должна реализовать интерфейс.

- Рекомендуемая: Сущность должна реализовать этот интерфейс; в противном случае функциональность управления исходным источником может быть ограничена.

- Дополнительно: сущность может реализовать этот интерфейс, чтобы обеспечить более богатый набор функций.

| Интерфейс | Назначение | Реализовано | Реализовать? |
| - | - |--------------------------|-------------|
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2> | Редакторы называют этот интерфейс перед изменением или сохранением файла. Управление источником VSPackage может проверить файл или отказать в операции, если проверка не удается. | Управление источником VSPackage | Рекомендуемая |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccManager2> | Этот интерфейс обеспечивает базовую функциональность управления исходными источниками для проектов, таких как регистрация и нерегистрация проектов с исходным управлением и предоставление поддержки для основных глифов управления исходным источником. | Управление источником VSPackage | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccProject2> | Этот интерфейс получен от <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> использования <xref:System.Runtime.InteropServices.Marshal.QueryInterface%2A> функции, или просто литья `IVsSccProject2`объекта реализации. `IVsHierarchy` Он используется для получения файлов под контролем источника в проекте или для информирования проекта о текущем состоянии управления исходным ресурсом или местоположении. | Проект | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccProvider> | Модуль интеграции использует этот интерфейс для настройки текущего активного VSPackage. | Управление источником VSPackage | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsTrackProjectDocuments2> | Этот интерфейс основан на модели подписки. Любой VSPackage может сигнализировать о том, что он хочет получать события документа и быть консультирован оболочкой о событиях, которые вот-вот произойдут. Он реализуется и [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]обрабатывается, который, в `IVsTrackProjectDocumentsEvents2` свою очередь, передает события реализации VSPackage. | Заглушка управления источником | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsTrackProjectDocuments3> | Этот интерфейс обеспечивает пакетную обработку, синхронизированные операции `OnQueryAddFiles` чтения/записи и продвинутый метод. | Заглушка управления источником | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsTrackProjectDocumentsEvents2> | **Исследователь решений** и проекты называют этот интерфейс при добавлении новых файлов в проекты или при переименовании или удалении файлов и папок из проектов. Управление исходного кода VSPackage может проверить файл проекта или отменить операцию. | Управление источником VSPackage | Рекомендуемая |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsTrackProjectDocumentsEvents3> | **Исследователь решений** и проекты называют этот интерфейс в ответ на звонки, сделанные на методы интерфейса IVstrackProjectDocuments3. Управление исходным кодом VSPackage может отслеживать пакетированные операции, синхронизировать операции `OnQueryAddFiles` чтения/записи и работать с более продвинутым методом. | Управление источником VSPackage | Рекомендуемая |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccEnlistmentPathTranslation> | Этот интерфейс обеспечивает поддержку управления набором для веб-проектов. | Управление источником VSPackage | Рекомендуемая |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccManagerTooltip> | Этот интерфейс используется для получения ToolTips для файлов, управляемых исходным интерфейсом в проектах. | Управление источником VSPackage | Необязательный |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccOpenFromSourceControl> | Этот интерфейс обеспечивает поддержку расширения пространства имен. | Управление источником VSPackage | Необязательный |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccControlNewSolution> | VSPackage использует этот интерфейс для интеграции расширения пространства имен в **новые,** **открытые,** или **Сохранить** диалоговые поля. Следовательно, проекты могут быть автоматически добавлены к управлению исходным элементом при создании или добавлены в элемент управления исходным источником при операции сохранения. | Управление источником VSPackage | Необязательный |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccGlyphs> | VSPackage использует этот интерфейс для определения дополнительных глифов в качестве глифов управления исходным управлением для узлов в **Solution Explorer.** | Управление источником VSPackage | Необязательный |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccAddWebProjectFromSourceControl> | В диалоговом поле **Add** для веб-проектов используется этот интерфейс. Он предоставляет методы для просмотра местоположения управления исходным источником и для открытия веб-проекта, ранее добавленного в репозиторий управления исходным управлением в этом месте. | Управление источником VSPackage | Рекомендуемая |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsAsynchOpenFromScc> | Этот интерфейс обеспечивает поддержку асинхронной (фоновой) загрузки проектов из управления исходным ресурсом. | Управление источником VSPackage | Необязательный |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsAsynchOpenFromSccProjectEvents> | Этот интерфейс позволяет проектам наблюдать за ходом асинхронной загрузки, инициированной <xref:Microsoft.VisualStudio.Shell.Interop.IVsAsynchOpenFromScc>. | Проект | Необязательный |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccToolsOptions> | Этот интерфейс позволяет IDE задать запрос активного управления исходным элементом VSPackage. IDE запрашивает значение параметров управления исходным источником, которые имеют значение, даже если нет активного управления исходным ресурсом VSPackage зарегистрировано. Этот интерфейс реализован и [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]обрабатывается . | Заглушка управления источником | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsRegisterScciProvider> | Этот интерфейс используется при регистрации управления исходным элементом VSPackage. | Заглушка управления источником | Обязательно |
| <xref:EnvDTE.SourceControl> | Этот интерфейс используется в автоматизации. Таким образом, он предоставляет только функции, которые могут быть выполнены без отображения какого-либо uI. | Управление источником VSPackage | Необязательный |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistSolutionProps> | Этот интерфейс используется для сохранения параметров управления исходным источником в файле решения (.sln). Настройки включают в себя местоположение управления исходом и флаги состояния управления исходом. | Управление источником VSPackage | Рекомендуемая |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistSolutionOpts> | Этот интерфейс используется для сохранения параметров управления исходным источником в файле опций решения (.suo). Это может включать в себя определенные параметры управления исходным ресурсом, такие как местоположение текущего пользователя в наборе. | Управление источником VSPackage | Рекомендуемая |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSolutionEvents3> | Этот интерфейс используется для мониторинга событий для выполнения таких операций, как проверка файлов проекта перед закрытием решений или получение новых файлов из элемента управления исходным источником при открытии проекта. | Управление источником VSPackage | Рекомендуемая |

## <a name="see-also"></a>См. также
- [Элементы проектирования](../../extensibility/internals/source-control-vspackage-design-elements.md)
