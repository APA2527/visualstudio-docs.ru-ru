---
title: 'Как: Установка подключаемого подключения к источнику управления (ru) Документы Майкрософт'
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- installation [Visual Studio SDK], source control plug-ins
- source control plug-ins, installing
ms.assetid: 9e2e01d9-7beb-42b2-99b2-86995578afda
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 9c0ac87aec3d6ac2532909772238e020e33bf78f
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80707991"
---
# <a name="how-to-install-a-source-control-plug-in"></a>Как: Установка плагина управления исходным элементом
Создание плагина управления исходным элементом включает в себя три этапа:

1. Создайте DLL с функциями, определенными в разделе API API управления исходным управлением.

2. Реализация функций, определяемых API-элементом управления исходным элементом. При [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] вызове на него, сделать интерфейсы и диалоговые коробки доступны из плагина.

3. Зарегистрируйте DLL, сделав соответствующие записи реестра.

## <a name="integration-with-visual-studio"></a>Интеграция с Visual Studio
 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]поддерживает плагины управления исходным управлением, которые соответствуют API-разъему управления исходным элементом.

### <a name="register-the-source-control-plug-in"></a>Регистрация плагина управления исходным элементом
 Прежде чем запущенная интегрированная среда разработки (IDE) может войти в систему управления исходным источником, она должна сначала найти плагин DLL управления исходным газом, который экспортирует API.

#### <a name="to-register-the-source-control-plug-in-dll"></a>Для регистрации плагина управления исходным элементом DLL

1. Добавьте две записи под **ключHKEY_LOCAL_MACHINE** в подключку **SOFTWARE,** которая определяет подключку названия вашей компании, за которой следует подключка названия продукта. Шаблон: **HKEY_LOCAL_MACHINE именем\\\<компании \\ \<software \\ \<>название продукта>значение входа>. **  =  *value* Две записи всегда называются **SCCServerName** и **SCCServerPath**. Каждая из них является обычной строкой.

    Например, если ваша компания называется Microsoft, а ваш продукт управления исходным источником называется SourceSafe, то этот путь реестра будет **HKEY_LOCAL_MACHINE»SOFTWARE-Microsoft-SourceSafe**. В этом подключке первая запись, **SCCServerName,** представляет собой читаемую для пользователя строку, именуя ваш продукт. Вторая запись, **SCCServerPath**, это полный путь к плагину управления исходным элементом DLL, к которому должен подключиться IDE. Ниже приводится пример записей реестра:

   |Запись в реестр образца|Образец значения|
   |---------------------------|------------------|
   |HKEY_LOCAL_MACHINE-SOFTWARE-Microsoft-SourceSafe|Microsoft Visual SourceSafe|
   |HKEY_LOCAL_MACHINE-ПРОГРАММНО-ФОМС-Microsoft-ИсточникБезопасный|*c: звс.-вин32*|

   > [!NOTE]
   > SCCServerPath — это полный путь к плагину SourceSafe. Ваш плагин управления исходным элементом будет использовать различные названия компаний и продуктов, но те же пути входа в реестр.

2. Следующие дополнительные записи реестра могут быть использованы для изменения поведения плагина управления исходным управлением. Эти записи идут в том же подключке, что и **SccServerName** и **SccServerPath.**

   - Запись **HideInVisualStudioregistry** может быть использована, если вы не хотите, чтобы ваш источник управления [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]плагином появится в списке **подключаемых списков.** Эта запись также повлияет на автоматическое переключение на плагин управления исходным управлением. Одним из возможных применений для этой записи является, если вы поставляете пакет управления исходным источником, который заменяет плагин управления исходным управлением, но вы хотите, чтобы пользователю было легче перейти от использования плагина управления исходным управлением в пакет управления исходным управлением. Когда пакет управления исходным источником установлен, он устанавливает эту запись реестра, которая скрывает плагин.

      **HideInVisualStudio** является значениеd DWORD и установлен на *1,* чтобы скрыть плагин или *0,* чтобы показать плагин. Если запись реестра не отображается, поведение по умолчанию означает отображее плагина.

   - Запись в реестр **DisableSccManager** может быть использована для отсутсвия или сокрытия **сервера управления источниками запуска \<>** вариантменю, который обычно отображается под меню Управления **исходом файла.** > **Source Control** Выбор этого варианта меню вызывает функцию [SccRunScc.](../../extensibility/sccrunscc-function.md) Плагин управления исходным элементом может не поддерживать внешнюю программу, и поэтому вы можете отключить или даже скрыть опцию меню **запуска.**

      **DisableSccManager** является значением DWORD и установлен на *0,* чтобы позволить **серверу управления источниками запуска \<>** вариант меню, установить *1,* чтобы отключить опцию меню, и установить на *2,* чтобы скрыть вариант меню. Если эта запись реестра не отображается, поведение по умолчанию означает отображить опцию меню.

   | Запись в реестре образцов | Образец значения |
   | - |--------------|
   | HKEY_LOCAL_MACHINE-SOFTWARE-Microsoft-SourceSafe-HideinVisualStudio | 1 |
   | HKEY_LOCAL_MACHINE-ПРОГРАММНО-Microsoft-SourceSafe-DisableSccManager | 1 |

3. Добавьте подключку, **SourceCodeControlProvider**, под **HKEY_LOCAL_MACHINE** ключом в подключке **SOFTWARE.**

    В соответствии с этим подключом, запись в реестр **ProviderRegKey** устанавливается на строку, которая представляет собой подключку, которую вы разместили в реестре в шаге 1. Шаблон **HKEY_LOCAL_MACHINE»SOFTWARE-SourceCodeControlProvider-ProviderRegKey** = *SOFTWARE\\<\> \\ название компании\><название продукта.*

    Ниже приводится пример содержимого для этого подключаемого ключа.

   |Параметр реестра|Образец значения|
   |--------------------|------------------|
   |HKEY_LOCAL_MACHINE-SOFTWARE-SourceCodeControlProvider-ProviderRegKey|SOFTWARE-Microsoft-SourceSafe|

   > [!NOTE]
   > Плагин управления исходным элементом будет использовать одни и те же подключки и имена входа, но значение будет отличаться.

4. Создайте подключку под названием **InstalledSCCProviders** под подключкой **SourceCodeControlProvider,** а затем поместите одну запись под этим подключкой.

    Название этой записи — это читаемое пользователем имя поставщика (то же самое, что и значение, указанное для записи SCCServerName), а значение является, еще раз, подключкой, созданной в шаге 1. Шаблон: **HKEY_LOCAL_MACHINE-SOFTWARE-SourceCodeControlProviders-InstalledSCCProviders\\<\>отображение имени** = *SOFTWARE\\<название\> \\ компании<название\>продукта.*

    Пример:

   |Запись в реестре образцов|Образец значения|
   |---------------------------|------------------|
   |HKEY_LOCAL_MACHINE-SOFTWARE-SourceCodeControlProvider-InstalledSCCProviders-Microsoft Visual SourceSafe|SOFTWARE-Microsoft-SourceSafe|

   > [!NOTE]
   > Таким образом, могут быть зарегистрированы несколько плагинов управления исходным управлением. Вот как [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] находит все установленные подключаемые API-подключаемые модули на основе управления исходным управлением.

## <a name="how-an-ide-locates-the-dll"></a>Как IDE находит DLL
 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] IDE имеет два способа поиска плагина DLL управления исходным элементом:

- Найдите плагин управления исходным элементом по умолчанию и подключитесь к нему бесшумно.

- Найдите все зарегистрированные плагины управления исходным управлением, из которых пользователь выбирает один.

  Чтобы найти DLL в первый способ, IDE выглядит под **HKEY_LOCAL_MACHINE»Software-SourceCodeControlProvider** подключки для входа **ProviderRegKey**. Значение этой записи указывает на другой подключьку. IDE затем ищет запись под названием **SccServerPath** в том, что второй подключки под **HKEY_LOCAL_MACHINE**. Значение этой записи указывает IDE на DLL.

> [!NOTE]
> IDE не загружает DLL с относительных путей (например, *. .*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Необходимо указать полный путь к DLL (например, *c: «Поставщики»NewProvider.DLL).* Это укрепляет безопасность IDE, предотвращая загрузку несанкционированных или олицетворений плагинов DLL.

 Чтобы найти DLL во втором случае, IDE выглядит под **HKEY_LOCAL_MACHINE»Software-SourceCodeControlProviders-InstalledSCCProviders** подключку для всех записей. Каждая запись имеет имя и значение. IDE отображает список этих имен пользователю. Когда пользователь выбирает имя, IDE находит значение для выбранного имени, которое указывает на подключку. IDE ищет запись под названием **SccServerPath** в этом подключке под **HKEY_LOCAL_MACHINE**. Значение этого входа указывает IDE на правильный DLL.

 Плагин управления исходным элементом должен поддерживать оба способа поиска DLL и, следовательно, наборы **ProviderRegKey**, перезаписи любых предыдущих параметров. Что еще более важно, он должен добавить себя в список **InstalledSccProviders,** чтобы пользователь мог иметь выбор, какой элемент управления источниками плагин для использования.

> [!NOTE]
> Поскольку **используется HKEY_LOCAL_MACHINE** ключ, только один плагин управления исходным элементом может быть зарегистрирован в [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] качестве плагина управления исходным элементом по умолчанию на данной машине (однако, позволяет пользователям определить, какой плагин управления исходным управлением они хотят на самом деле использовать для конкретного решения). Во время процесса установки проверьте, установлен ли плагин управления исходным ключом; если это так, спросите пользователя, следует ли установить новый плагин управления исходным источником устанавливается в качестве по умолчанию. Во время неустановки, не удаляйте другие подключи реестра, которые являются общими для всех плагинов управления исходным кодом в **HKEY_LOCAL_MACHINE-SOFTWARE-SourceCodeControlProvider;** удалите только ваш конкретный подключку SCC.

## <a name="how-the-ide-detects-version-1213-support"></a>Как IDE обнаруживает поддержку версии 1.2/1.3
 Как [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] обнаружить, поддерживает ли плагин подключаемый API версии 1.2 и 1.3 функциональность Управления источниками? Чтобы объявить расширенные возможности, плагин управления исходным элементом должен реализовать соответствующую функцию:

 Во-первых, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] проверяете возвращенное значение, позвонив в [SccGetVersion.](../../extensibility/sccgetversion-function.md) Она должна быть больше или равна 1,2.

 Далее, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] определяет, поддерживается ли конкретная `lpSccCaps` новая возможность путем изучения аргумента на [SccInitialize](../../extensibility/sccinitialize-function.md).

 Если оба этих условия будут выполнены, можно назвать новые функции, поддерживаемые в версиях 1.2 и 1.3.

## <a name="see-also"></a>См. также
- [Начало работы с плагинами управления исходными источниками](../../extensibility/internals/getting-started-with-source-control-plug-ins.md)
