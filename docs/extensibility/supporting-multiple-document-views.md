---
title: Поддержка нескольких просмотров документов (ru) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- editors [Visual Studio SDK], custom - multiple document views
ms.assetid: c7ec2366-91c4-477f-908d-e89068bdb3e3
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: a952414fa7156d80675564e519e556ccedd524a3
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80699540"
---
# <a name="supporting-multiple-document-views"></a>Поддержка представления нескольких документов
Можно предоставить более одного представления документа, создав отдельные данные документа и объекты представления документов для редактора. Некоторые случаи, в которых дополнительное представление документа было бы полезно:

- Новая поддержка окна: Вы хотите, чтобы редактор предоставил два или более представлений одного и того же типа, чтобы пользователь, у которого уже открыто окно в редакторе, мог открыть новое окно, выбрав команду **«Новое окно»** из меню **«Окно».**

- Поддержка представления формы и кода: Вы хотите, чтобы редактор предоставлял представления различных типов. [!INCLUDE[vbprvb](../code-quality/includes/vbprvb_md.md)], например, обеспечивает как представление формы, так и представление кода.

  Для получения дополнительной информации об этом см. процедуру CreateEditorInstance в файле EditorFactory.cs в пользовательском проекте редактора, созданном шаблоном пакета Visual Studio. Для получения дополнительной информации об этом проекте [см.](../extensibility/walkthrough-creating-a-custom-editor.md)

## <a name="synchronizing-views"></a>Синхронизация представлений
 При реализации нескольких представлений объект данных документа отвечает за синхронизацию всех представлений с данными. Интерфейсы обработки событий можно <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> использовать для синхронизации нескольких представлений с данными.

 Если объект не <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> используется для синхронизации нескольких представлений, необходимо реализовать собственную систему событий для обработки изменений, внесенных в объект данных документа. Можно использовать различные уровни детализации, чтобы поддерживать несколько представлений в актуальном состоянии. С параметром максимальной детализации при вводе в одном представлении другие представления обновляются немедленно. При минимальной детализации другие представления не обновляются до тех пор, пока они не будут активированы.

## <a name="determining-whether-document-data-is-already-open"></a>Определение того, открыты ли данные документов, уже открыты
 Таблица ходовых документов (RDT) в интегрированной среде разработки (IDE) помогает отслеживать, открыты ли данные для документа, как показано на следующей диаграмме.

 ![Графический ДокументДатаВью](../extensibility/media/docdataview.gif "Докдатавью") Несколько просмотров

 По умолчанию каждое представление (объект представления документа)<xref:Microsoft.VisualStudio.Shell.Interop.IVsWindowFrame>содержится в собственной оконной раме (). Однако, как уже отмечалось, данные документов могут отображаться в нескольких представлениях. Для этого Visual Studio проверяет RDT, чтобы определить, является ли документ, о котором идет речь, уже открыт в редакторе. Когда IDE <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory.CreateEditorInstance%2A> призывает создать редактор, не-NULL значение `punkDocDataExisting` возвращается в параметре указывает, что документ уже открыт в другом редакторе. Для получения дополнительной информации о том, как функционирует RDT, [см.](../extensibility/internals/running-document-table.md)

 В <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory> своей реализации изучите `punkDocDataExisting` возвращенный объект данных документа, чтобы определить, подходят ли данные документа для редактора. (Например, только HTML-данные должны отображаться html-редактором.) Если это уместно, то фабрика редакторов должна предоставить второе представление для данных. Если `punkDocDataExisting` параметр `NULL`не является, возможно либо, что объект данных документа открыт в другом редакторе, либо, более вероятно, что данные документа уже открыты в другом представлении с тем же редактором. Если данные документа открыты в другом редакторе, который фабрика редактора не поддерживает, Visual Studio не открывает фабрику редакторов. Для получения дополнительной информации [см.](../extensibility/how-to-attach-views-to-document-data.md)
