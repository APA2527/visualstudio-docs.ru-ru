---
title: Функция SccSetOption | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccSetOption
helpviewer_keywords:
- SccSetOption function
ms.assetid: 4b5e6666-c24c-438a-a9df-9c52f58f8175
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: bf9d700facfedc83d9eb12e96b854de7d4e9c181
ms.sourcegitcommit: 40d612240dc5bea418cd27fdacdf85ea177e2df3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2019
ms.locfileid: "66338572"
---
# <a name="sccsetoption-function"></a>Функция SccSetOption
Эта функция задает параметры, управляющие поведением подключаемый модуль системы управления версиями.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccSetOption(
   LPVOID pvContext,
   LONG   nOption,
   LONG   dwVal
);
```

#### <a name="parameters"></a>Параметры
 pvContext

[in] Структура подключаемого модуля контекста исходного элемента управления.

 nOption

[in] Параметр, которое должно быть задано.

 dwVal

[in] Настройки для параметра.

## <a name="return-value"></a>Возвращаемое значение
 Подключаемый модуль реализации элемента управления источника этой функции должен возвращать одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Параметр был успешно установлен.|
|SCC_I_SHARESUBPROJOK|Возвращается, если `nOption` был `SCC_OPT_SHARESUBPROJ` и подключаемый модуль системы управления версиями позволяет интегрированной среды разработки указать папку назначения.|
|SCC_E_OPNOTSUPPORTED|Параметр не установлен и не следует полагаться на.|

## <a name="remarks"></a>Примечания
 Интегрированная среда разработки вызывает эту функцию для управления поведением подключаемый модуль системы управления версиями. Первый параметр, `nOption`, указывает значение, которое должно быть задано, а для второго, `dwVal`, указывает, что делать с этим значением. Подключаемый модуль сохраняет эти данные, связанные с `pvContext``,` , эту функцию необходимо вызывать в интегрированной среде разработки после вызова метода [SccInitialize](../extensibility/sccinitialize-function.md) (но не обязательно после каждого вызова [SccOpenProject](../extensibility/sccopenproject-function.md)).

 Сводка параметров и их значения.

|`nOption`|`dwValue`|Описание|
|---------------|---------------|-----------------|
|`SCC_OPT_EVENTQUEUE`|`SCC_OPT_EQ_DISABLE`<br /><br /> `SCC_OPT_EQ_ENABLE`|Включает или отключает фоновую очереди событий.|
|`SCC_OPT_USERDATA`|Произвольное значение|Указывает значение пользователя должны быть переданы [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md) функцию обратного вызова.|
|`SCC_OPT_HASCANCELMODE`|`SCC_OPT_HCM_NO`<br /><br /> `SCC_OPT_HCM_YES`|Указывает интегрированной среды разработки в настоящее время поддерживает ли отмену операции.|
|`SCC_OPT_NAMECHANGEPFN`|Указатель на [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md) функцию обратного вызова|Задает указатель на функцию обратного вызова для изменения имени.|
|`SCC_OPT_SCCCHECKOUTONLY`|`SCC_OPT_SCO_NO`<br /><br /> `SCC_OPT_SCO_YES`|Указывает, разрешает ли интегрированной среды разработки проверка его файлы вручную (через пользовательский интерфейс элемента управления источника) или ли они должны быть извлечены только с помощью подключаемого модуля системы управления версиями.|
|`SCC_OPT_SHARESUBPROJ`|Н/Д|Если подключаемый модуль системы управления версиями позволяет интегрированной среды разработки указать папку локального проекта, подключаемый модуль возвращает `SCC_I_SHARESUBPROJOK`.|

## <a name="sccopteventqueue"></a>SCC_OPT_EVENTQUEUE
 Если `nOption` является `SCC_OPT_EVENTQUEUE`, интегрированной среды разработки отключение (или повторном включении) фоновой обработки. Например во время компиляции, системы управления версиями, подключаемый модуль для остановки обработки при простое каких дать интегрированной среды разработки. После компиляции он снова включаются фоновой обработки, чтобы поддерживать актуальность plug в очередь событий. Соответствующий `SCC_OPT_EVENTQUEUE` значение `nOption`, существует два возможных значения для `dwVal`, а именно, `SCC_OPT_EQ_ENABLE` и `SCC_OPT_EQ_DISABLE`.

## <a name="sccopthascancelmode"></a>SCC_OPT_HASCANCELMODE
 Если значение для `nOption` является `SCC_OPT_HASCANCELMODE`, интегрированная среда разработки позволяет пользователям отменить длительных операций. Установка `dwVal` для `SCC_OPT_HCM_NO` (по умолчанию) указывает, что интегрированная среда разработки имеет режим без "Отмена". Подключаемый модуль системы управления версиями должна обеспечивать собственную кнопку "Отмена", если он хочет, чтобы пользователь, чтобы иметь возможность отменить. `SCC_OPT_HCM_YES` Указывает, что интегрированная среда разработки предоставляет возможность отменить операцию, так что SCC подключаемый модуль не требуется отображать собственные кнопки "Отмена". Если задает интегрированной среды разработки `dwVal` для `SCC_OPT_HCM_YES`, он готов реагировать на `SCC_MSG_STATUS` и `DOCANCEL` сообщения, отправляемые `lpTextOutProc` функцию обратного вызова (см. в разделе [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)). Если интегрированная среда разработки не задал этой переменной, подключаемый модуль не следует отправлять эти два сообщения.

## <a name="sccoptnamechangepfn"></a>SCC_OPT_NAMECHANGEPFN
 Если задано значение nOption `SCC_OPT_NAMECHANGEPFN`и в исходном подключаемый модуль системы управления и интегрированной среды разработки разрешить, подключаемый модуль можно фактически переименовать или переместить файл во время операции управления версиями. `dwVal` Будет указано значение указателя функции типа [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md). Во время операции управления версиями подключаемый модуль можно вызвать эту функцию, передавая три параметра. Это старое имя файла, новое имя (с абсолютным путем) этого файла и указатель на сведения, с сортировкой по релевантности в интегрированную среду разработки (с абсолютным путем). Интегрированная среда разработки отправляет в этот последний указатель путем вызова `SccSetOption` с `nOption` присвоено `SCC_OPT_USERDATA`, с помощью `dwVal` указывает на данные. Поддержка этой функции является необязательным. Подключаемые VSSCI-что использует эту возможность необходимо инициализировать его функция указатель и пользователем данных переменных в `NULL`, и она не должна вызывать функцией переименования, если он присвоен один. Оно также должно быть готово для хранения значения, заданным или изменить его в ответ на новый вызов `SccSetOption`. Это не происходит в середине операции команды управления версиями, но это может произойти между командами.

## <a name="sccoptscccheckoutonly"></a>SCC_OPT_SCCCHECKOUTONLY
 Если задано значение nOption `SCC_OPT_SCCCHECKOUTONLY`, интегрированной среды разработки указывает, что файлы в текущем открытом проекте следует никогда не получить для изменения вручную через пользовательский интерфейс системы управления версиями. Вместо этого файлы должны быть извлечен только через систему управления версиями подключаемого модуля в системе управления интегрированной среды разработки. Если `dwValue` присваивается `SCC_OPT_SCO_NO`, это означает, что файлы должны рассматриваться обычно подключаемым модулем и может быть извлечен через пользовательский Интерфейс системы управления версиями. Если `dwValue` присваивается `SCC_OPT_SCO_YES`, то только подключаемого модуля разрешается для извлечения файлов и не должны вызываться пользовательского интерфейса системы управления версиями. Это необходимо для ситуаций, где интегрированной среды разработки, могут иметь «псевдо files», имеющие смысл для извлечения только с помощью интегрированной среды разработки.

## <a name="sccoptsharesubproj"></a>SCC_OPT_SHARESUBPROJ
 Если`nOption` присваивается `SCC_OPT_SHARESUBPROJ`, интегрированной среды разработки тестирует ли подключаемый модуль системы управления версиями можно использовать указанную папку локального, при добавлении файлов из системы управления версиями. Значение `dwVal` параметр не имеет значения в этом случае. Если подключаемый модуль позволяет интегрированной среды разработки указать локальную целевую папку, куда будет добавлен файлы из источника управления [SccAddFromScc](../extensibility/sccaddfromscc-function.md) вызывается, то подключаемый модуль должен возвращать `SCC_I_SHARESUBPROJOK` при `SccSetOption` функция вызывается. Интегрированная среда разработки использует `lplpFileNames` параметр `SccAddFromScc` функцию для передачи в целевой папке. Подключаемый модуль использует конечной папки для размещения файлов, добавленных из системы управления версиями. Если подключаемый модуль не возвращает `SCC_I_SHARESUBPROJOK` при `SCC_OPT_SHARESUBPROJ` параметр установлен, интегрированной среды разработки предполагает, что подключаемый модуль является возможность добавлять файлы только в текущей локальной папке.

## <a name="see-also"></a>См. также
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccInitialize](../extensibility/sccinitialize-function.md)
- [SccOpenProject](../extensibility/sccopenproject-function.md)
- [SccAddFilesFromSCC](../extensibility/sccaddfromscc-function.md)
- [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)
- [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md)