---
title: Функция SccSetOption Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccSetOption
helpviewer_keywords:
- SccSetOption function
ms.assetid: 4b5e6666-c24c-438a-a9df-9c52f58f8175
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 1adcbb47e9fce7037fe8942326e8836ade51e3eb
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80700313"
---
# <a name="sccsetoption-function"></a>Функция SccSetOption
Эта функция устанавливает параметры, которые контролируют поведение плагина управления исходным элементом.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccSetOption(
   LPVOID pvContext,
   LONG   nOption,
   LONG   dwVal
);
```

#### <a name="parameters"></a>Параметры
 pvКонтекст

(в) Структура контекста управления исходным элементом.

 nOption

(в) Опция, которая устанавливается.

 dwVal

(в) Настройки опции.

## <a name="return-value"></a>Возвращаемое значение
 Ожидается, что внедрение этой функции элемента управления исходным элементом вернет одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Опция была успешно установлена.|
|SCC_I_SHARESUBPROJOK|Возвращается, если `nOption` был `SCC_OPT_SHARESUBPROJ` и плагин управления исходным кодом позволяет IDE установить папку назначения.|
|SCC_E_OPNOTSUPPORTED|Этот вариант не был установлен и не следует полагаться.|

## <a name="remarks"></a>Примечания
 IDE вызывает эту функцию для управления поведением плагина управления исходным управлением. Первый параметр, `nOption`указывает значение, которое устанавливается, в то время как второй, указывает, `dwVal`что делать с этим значением. Плагин хранит эту информацию, `pvContext``,` связанную с так IDE должны позвонить по этой функции после вызова [SccInitialize](../extensibility/sccinitialize-function.md) (но не обязательно после каждого звонка в [SccOpenProject).](../extensibility/sccopenproject-function.md)

 Резюме вариантов и их ценностей:

|`nOption`|`dwValue`|Описание|
|---------------|---------------|-----------------|
|`SCC_OPT_EVENTQUEUE`|`SCC_OPT_EQ_DISABLE`<br /><br /> `SCC_OPT_EQ_ENABLE`|Включает/отстраняет фоновое событие в очереди.|
|`SCC_OPT_USERDATA`|Произвольное значение|Определяет значение пользователя, которое должно быть передано функции обратного вызова [OPTNAMECHANGEPFN.](../extensibility/optnamechangepfn.md)|
|`SCC_OPT_HASCANCELMODE`|`SCC_OPT_HCM_NO`<br /><br /> `SCC_OPT_HCM_YES`|Указывает, поддерживает ли IDE в настоящее время отмену операции.|
|`SCC_OPT_NAMECHANGEPFN`|Указатель на функцию обратного вызова [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md)|Устанавливает указатель на функцию обратного вызова с изменением имени.|
|`SCC_OPT_SCCCHECKOUTONLY`|`SCC_OPT_SCO_NO`<br /><br /> `SCC_OPT_SCO_YES`|Указывает, позволяет ли IDE проверять свои файлы вручную (через пользовательский интерфейс управления исходным элементом) или же они должны быть проверены только через плагин управления исходным управлением.|
|`SCC_OPT_SHARESUBPROJ`|Недоступно|Если плагин управления исходным элементом позволяет IDE указать локальную `SCC_I_SHARESUBPROJOK`папку проекта, плагин возвращается.|

## <a name="scc_opt_eventqueue"></a>SCC_OPT_EVENTQUEUE
 Если `nOption` `SCC_OPT_EVENTQUEUE`это так, то IDE отключает (или повторно обеспечивает) фоновую обработку. Например, во время компиляции IDE может поручить плагину управления исходным управлением прекратить обработку на простое. После компиляции, это будет повторно включить фоновую обработку, чтобы держать очередь события плагина в актуальном состоянии. В `SCC_OPT_EVENTQUEUE` соответствии `nOption`со значением, Есть `dwVal`два возможных `SCC_OPT_EQ_ENABLE` `SCC_OPT_EQ_DISABLE`значения, а именно, и .

## <a name="scc_opt_hascancelmode"></a>SCC_OPT_HASCANCELMODE
 Если значение `nOption` для `SCC_OPT_HASCANCELMODE`является, IDE позволяет пользователям отменить длительные операции. `dwVal` Настройка `SCC_OPT_HCM_NO` (по умолчанию) указывает на то, что режим отмены IDE не имеет. Плагин управления исходным элементом должен предложить свою собственную кнопку Отмена, если он хочет, чтобы пользователь мог отменить. `SCC_OPT_HCM_YES`указывает на то, что IDE предоставляет возможность отменить операцию, поэтому плагин SCC не нуждается в отображении собственной кнопки «Отмена». Если IDE `dwVal` `SCC_OPT_HCM_YES`устанавливается на, он `SCC_MSG_STATUS` готов `DOCANCEL` реагировать `lpTextOutProc` и сообщения, отправленные на функцию обратного вызова (см. [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)). Если IDE не устанавливает эту переменную, плагин не должен отправлять эти два сообщения.

## <a name="scc_opt_namechangepfn"></a>SCC_OPT_NAMECHANGEPFN
 Если nOption настроен `SCC_OPT_NAMECHANGEPFN`на , и как подключаемый модуль управления исходным управлением, так и IDE позволяют это, плагин может фактически переименовать или переместить файл во время операции управления исходным движением. Будет `dwVal` установлен на функцию указателя типа [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md). Во время операции управления исходным источником плагин может вызвать эту функцию, пройдя по трем параметрам. Это старое имя (с полностью квалифицированным способом) файла, новое имя (с полностью квалифицированным способом) этого файла и указатель на информацию, которая имеет отношение к IDE. IDE посылает в этом последнем `SccSetOption` указатель, позвонив с `nOption` `SCC_OPT_USERDATA`набором, с `dwVal` указывая на данные. Поддержка этой функции не является обязательной. Плагин VSSCI, который использует эту способность, должен инициализировать свою функцию указателя и переменные пользовательских `NULL`данных, и он не должен вызывать функцию переименования, если она не была дана. Он также должен быть готов держать значение, что было дано или `SccSetOption`изменить его в ответ на новый призыв к . Это не произойдет в середине операции командного управления исходным источником, но это может произойти между командами.

## <a name="scc_opt_scccheckoutonly"></a>SCC_OPT_SCCCHECKOUTONLY
 Если nOption настроен `SCC_OPT_SCCCHECKOUTONLY`на, IDE указывает на то, что файлы в настоящее время открытый проект никогда не должны быть проверены вручную через пользовательский интерфейс системы управления исходным кодом. Вместо этого файлы должны быть проверены только через плагин управления исходным управлением под контролем IDE. Если `dwValue` установлен `SCC_OPT_SCO_NO`на, это означает, что файлы должны рассматриваться нормально плагина и могут быть проверены через чат управления исходным ресурсом. Если `dwValue` установлен `SCC_OPT_SCO_YES`на , то только плагин допускается, чтобы проверить файлы, и uI системы управления исходным элементом не должны вызываться. Это касается ситуаций, когда в IDE могут быть «псевдофайлы», которые имеют смысл проверить только через IDE.

## <a name="scc_opt_sharesubproj"></a>SCC_OPT_SHARESUBPROJ
 Если`nOption` настроен `SCC_OPT_SHARESUBPROJ`на то, IDE тестирует, может ли плагин управления исходным управлением использовать указанную локальную папку при добавлении файлов из исходного элемента. Значение `dwVal` параметра в данном случае не имеет значения. Если плагин позволяет IDE указать папку локального назначения, где файлы будут добавлены из элемента управления исходным кодом `SccSetOption` при вызове [SccAddFromScc,](../extensibility/sccaddfromscc-function.md) то плагин должен вернуться `SCC_I_SHARESUBPROJOK` при вызове функции. Затем IDE использует `lplpFileNames` параметр `SccAddFromScc` функции для передачи в папку назначения. Плагин использует папку назначения для размещения файлов, добавленных из исходного элемента. Если плагин не возвращается `SCC_I_SHARESUBPROJOK` `SCC_OPT_SHARESUBPROJ` при установке опции, IDE предполагает, что плагин может добавлять файлы только в текущей локальной папке.

## <a name="see-also"></a>См. также
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccInitialize](../extensibility/sccinitialize-function.md)
- [SccOpenProject](../extensibility/sccopenproject-function.md)
- [SccAddFilesFromSCC](../extensibility/sccaddfromscc-function.md)
- [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)
- [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md)
