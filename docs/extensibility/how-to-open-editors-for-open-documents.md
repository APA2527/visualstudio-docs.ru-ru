---
title: 'Как: Открыть редакторы для открытых документов (ru) Документы Майкрософт'
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- editors [Visual Studio SDK], opening for open documents
ms.assetid: 1a0fa49c-efa4-4dcc-bdc0-299b7052acdc
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 03d0986573ac0d53427f6490370be2bfa1c4cbe7
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80710917"
---
# <a name="how-to-open-editors-for-open-documents"></a>Как: Открыть редакторы для открытых документов
Перед тем, как проект открывает окно документа, проект сначала должен определить, открыт ли файл в окне документа для другого редактора. Файл может быть открыт как в специальном редакторе проекта, либо [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]в одном из стандартных редакторов, зарегистрированных на .

## <a name="open-a-project-specific-editor"></a>Открытие редактора, специфичного для проекта
 Используйте следующую процедуру, чтобы открыть свой редактор для файла, который уже открыт.

### <a name="to-open-a-project-specific-editor-for-an-open-file"></a>Открытие редактора для открытого файла для конкретного проекта

1. Вызовите метод <xref:Microsoft.VisualStudio.Shell.Interop.IVsUIShellOpenDocument.IsDocumentOpen%2A> .

    Этот вызов возвращает указатели в иерархию документа, элемент иерархии и оконную раму, если это необходимо.

2. Если документ открыт, проект должен проверить, существует ли только объект данных документа или присутствует объект представления документа.

   - Если объект представления документа существует, и это представление предназначено для другого элемента иерархии или иерархии, проект использует указатель на оконную раму представления для повторного появления существующего окна.

   - Если объект представления документа существует, и это представление предназначено для той же иерархии и элемента иерархии, проект может открыть второе представление, если он может прикрепить к базовому объекту данных документа. В противном случае проект должен использовать указатель на оконную раму представления для повторного появления существующего окна.

   - Если существует только объект данных документа, проект должен определить, может ли он использовать объект данных документа для своего представления. Если объект данных документа совместим, выполните шаги, обсуждаемые в [Open a project-специфическом редакторе.](../extensibility/how-to-open-project-specific-editors.md)

     Если объект данных документа не совместим, пользователю должна быть отображана ошибка, указывают на то, что файл в настоящее время используется. Эта ошибка должна отображаться только в временных случаях, например, когда файл компилируется в то же время [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] пользователь пытается открыть файл с помощью редактора, кроме основного текстового редактора. Основной текстовый редактор может обмениваться объектом данных документов с компилятором.

3. Если документ не открыт из-за того, что нет объекта представления данных документа или объекта представления документа, выполните этапы в [Open a project-specific editor.](../extensibility/how-to-open-project-specific-editors.md)

## <a name="open-a-standard-editor"></a>Открыть стандартный редактор
 Используйте следующую процедуру, чтобы открыть стандартный редактор для файла, который уже открыт.

### <a name="to-open-a-standard-editor-for-an-open-file"></a>Открытие стандартного редактора для открытого файла

1. Вызовите процедуру <xref:Microsoft.VisualStudio.Shell.Interop.IVsUIShellOpenDocument.OpenStandardEditor%2A>.

     Этот метод сначала проверяет, что документ еще <xref:Microsoft.VisualStudio.Shell.Interop.IVsUIShellOpenDocument.IsDocumentOpen%2A>не открыт по вызову. Если документ уже открыт, то всплывает окно его редактора.

2. Если документ не открыт, то выполните шаги в [Как: Открыть стандартные редакторы](../extensibility/how-to-open-standard-editors.md).

## <a name="see-also"></a>См. также
- [Открыть и сохранить элементы проекта](../extensibility/internals/opening-and-saving-project-items.md)
- [Как: Открыть редакторы для конкретных проектов](../extensibility/how-to-open-project-specific-editors.md)
- [Как: Открытые стандартные редакторы](../extensibility/how-to-open-standard-editors.md)
