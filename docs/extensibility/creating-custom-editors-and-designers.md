---
title: Создание пользовательских редакторов и дизайнеров (ru) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- designers [Visual Studio SDK]
- editors [Visual Studio SDK], custom
ms.assetid: b6a5e8b2-0ae1-4fc3-812d-09d40051b435
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: b9f56b82225e1e40782b6753bea03d3c1780f596
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80739474"
---
# <a name="create-custom-editors-and-designers"></a>Создание пользовательских редакторов и дизайнеров

Интегрированная среда разработки Visual Studio (IDE) может размещать различные типы редакторов:

- Основной редактор Visual Studio

- Пользовательские редакторы

- Внешние редакторы

- Конструкторы

Следующая информация поможет вам выбрать тип редактора вам нужно.

## <a name="types-of-editor"></a>Типы редакторов

Для получения информации о главном редакторе Visual Studio [см.](../extensibility/extending-the-editor-and-language-services.md)

### <a name="custom-editors"></a>Пользовательские редакторы
 Пользовательский редактор предназначен для работы в специализированных условиях. Например, можно создать редактора, функция которого заключается в чтении и записи данных в определенный репозиторий, например на сервере Обмена Майкрософт. Выберите пользовательский редактор, если вы хотите редактор, который работает только с типом проекта, или если вы хотите редактор, который имеет только несколько конкретных команд. Обратите внимание, однако, что пользователи не смогут [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] использовать пользовательский редактор для редицировать стандартные проекты.

 Пользовательский редактор может использовать фабрику редакторов и добавлять информацию о редакторе в реестр. Тем не менее, тип проекта, связанный с пользовательским редактором, может мгновенно настроить редактор другими способами.

 Пользовательский редактор может использовать либо активацию на месте, либо упрощенное встраивание для реализации представления.

### <a name="external-editors"></a>Внешние редакторы
 Внешние редакторы — это редакторы, которые не интегрированы в Visual Studio, такие как Microsoft Word, Notepad или Microsoft FrontPage. Вы можете позвонить такому редактору, если, например, вы передаете ему текст из вашего VSPackage. Внешние редакторы регистрируются и могут быть использованы за пределами Visual Studio. Когда вы звоните внешнему редактору, и он может быть встроен в окно хоста, то он появляется в окне iDE. Если нет, то IDE создает отдельное окно для него.

 Метод <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.IsDocumentInProject%2A> устанавливает приоритет документа с <xref:Microsoft.VisualStudio.Shell.Interop.VSDOCUMENTPRIORITY> помощью перечисления. Если `DP_External` значение указано, файл может быть открыт внешним редактором.

## <a name="editor-design-decisions"></a>Решения по проектированию редактора
 Следующие вопросы дизайна помогут вам выбрать тип редактора, наиболее подходящий для вашего приложения:

- Сохранит ли приложение свои данные в файлах или нет? Если он будет сохранять свои данные в файлах, будут ли они в пользовательском или стандартном формате?

   Если вы используете стандартный формат файла, другие типы проектов в дополнение к проекту смогут открывать и читать/писать данные к ним. Однако, если вы используете пользовательский формат файла, только ваш тип проекта сможет открывать и читать/записывать данные к ним.

   Если ваш проект использует файлы, то вы должны настроить стандартный редактор. Если проект не использует файлы, а скорее использует элементы в базе данных или другом репозитории, то следует создать пользовательский редактор.

- Нужно ли вашему редактору размещать элементы управления ActiveX?

   Если ваш редактор размещает элементы управления ActiveX, реализуйте редактор активации на месте, как указано в [активации In-place.](/visualstudio/misc/in-place-activation?view=vs-2015) Если он не размещает элементы управления ActiveX, либо используйте [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] упрощенный редактор встраивания, либо настройте редактор по умолчанию.

- Будет ли ваш редактор поддерживать несколько просмотров? Вы должны поддерживать несколько представлений, если вы хотите, чтобы представления редактора были видны одновременно с редактором по умолчанию.

   Если редактору необходимо поддерживать несколько представлений, данные документа и объекты представления документов для редактора должны быть отдельными объектами. Для получения дополнительной информации [см.](../extensibility/supporting-multiple-document-views.md)

   Если редактор поддерживает несколько представлений, [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] планируется ли использовать<xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> реализацию буфера текста (объект) основного редактора для объекта данных документа? То есть, вы хотите поддерживать свой обзор редактора [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] бок о бок с основным редактором? Способность сделать это является основой формы дизайнера.

- Если вам нужно разместить внешний редактор, может [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]ли редактор быть встроен внутрь?

   Если он может быть встроен, следует создать окно хоста <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.IsDocumentInProject%2A> для внешнего <xref:Microsoft.VisualStudio.Shell.Interop.VSDOCUMENTPRIORITY> редактора, а `DP_External`затем вызвать метод и установить значение перечисления. Если редактор не может быть встроен, IDE автоматически создаст отдельное окно для него.

## <a name="in-this-section"></a>В этом разделе

[Прохождение: Создание пользовательского редактора](../extensibility/walkthrough-creating-a-custom-editor.md)\
Объясняет, как создать пользовательский редактор.

[Прохождение: Добавление функций в пользовательский редактор](../extensibility/walkthrough-adding-features-to-a-custom-editor.md)\
Объясняет, как добавить функции в пользовательский редактор.

[Инициализация конструктора и конфигурация метаданных](../extensibility/designer-initialization-and-metadata-configuration.md)\
Объясняет, как инициализировать дизайнера.

[Поставка отменить поддержку для дизайнеров](../extensibility/supplying-undo-support-to-designers.md)\
Объясняет, как обеспечить отменить поддержку для дизайнеров.

[Синтаксис раскраски в пользовательских редакторов](../extensibility/syntax-coloring-in-custom-editors.md)\
Объясняет разницу между окраской синтаксиса в основном редакторе и пользовательских редакторах.

[Данные документов и представление документов в пользовательских редакторах](../extensibility/document-data-and-document-view-in-custom-editors.md)\
Объясняет, как реализовать данные документов и представления документов в пользовательских редакторах.

## <a name="related-sections"></a>См. также

[Устаревшие интерфейсы в редакторе](/visualstudio/extensibility/legacy-interfaces-in-the-editor?view=vs-2015)\
Объясняет, как получить доступ к основному редактору с помощью наследного API.

[Разработка устаревшего языкового сервиса](../extensibility/internals/developing-a-legacy-language-service.md)\
Объясняет, как реализовать языковую службу.

[Расширить другие части Визуальной студии](../extensibility/extending-other-parts-of-visual-studio.md)\
Объясняет, как создать элементы uI, которые соответствуют остальной части [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory>
