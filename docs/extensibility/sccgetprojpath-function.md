---
title: Функция SccGetProjPath | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccGetProjPath
helpviewer_keywords:
- SccGetProjPath function
ms.assetid: 1079847e-d45f-4cb8-9d92-1e01ce5d08f6
author: gregvanl
ms.author: gregvanl
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: abc7ecf0bb35f61785041d03f871409bbe499854
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63434599"
---
# <a name="sccgetprojpath-function"></a>Функция SccGetProjPath
Эта функция запрашивает у пользователя путь к проекту, который представляет собой строку, имеет смысл только для подключаемого модуля системы управления версиями. Вызывается, когда пользователь:

- Создание нового проекта

- При добавлении существующего проекта в систему управления версиями

- Предпринимается попытка найти существующий проект управления версиями

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccGetProjPath (
   LPVOID pvContext,
   HWND   hWnd,
   LPSTR  lpUser,
   LPSTR  lpProjName,
   LPSTR  lpLocalPath,
   LPSTR  lpAuxProjPath,
   BOOL   bAllowChangePath,
   LPBOOL pbNew
);
```

### <a name="parameters"></a>Параметры
 pvContext

[in] Структура подключаемого модуля контекста исходного элемента управления.

 hWnd

[in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для любой диалоговых окон, которые он предоставляет.

 lpUser

[in, out] Имя пользователя (не превышая ресурсов SCC_USER_SIZE, включая символ конца строки)

 lpProjName

[in, out] Имя проекта интегрированной среды разработки, рабочая область проекта или файл makefile (не превышая ресурсов SCC_PRJPATH_SIZE, включая символ конца строки NULL).

 lpLocalPath

[in, out] Рабочий путь проекта. Если `bAllowChangePath` является `TRUE`, подключаемый модуль системы управления версиями можно изменить эту строку (не превышая ресурсов _MAX_PATH, включая знак завершения null).

 lpAuxProjPath

[in, out] Буфер для пути возвращаемого проекта (не превышая ресурсов SCC_PRJPATH_SIZE, включая символ конца строки NULL).

 bAllowChangePath

[in] Если это `TRUE`, подключаемый модуль системы управления версиями можно запрашивать и изменять `lpLocalPath` строка.

 pbNew

[in, out] Ожидается значение указывает, следует ли создать новый проект. Значение, возвращаемое означает успешную Создание проекта:

|Входящий|Интерпретация|
|--------------|--------------------|
|true|Пользователь может создать новый проект.|
|false|Пользователь не может создать новый проект.|

|Исходящий|Интерпретация|
|--------------|--------------------|
|true|Был создан новый проект.|
|false|Был выбран существующий проект.|

## <a name="return-value"></a>Возвращаемое значение
 Подключаемый модуль реализации элемента управления источника этой функции должен возвращать одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Проект был успешно создан или извлечь.|
|SCC_I_OPERATIONCANCELED|Операция была отменена.|
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления версиями, возможно, из-за проблемы с сетью или конфликтов.|
|SCC_E_CONNECTIONFAILURE|Возникла проблема при попытке подключения к системе управления версиями.|
|SCC_E_NONSPECIFICERROR|Произошла неизвестная ошибка.|

## <a name="remarks"></a>Примечания
 Эта функция предназначена для интегрированной среды разработки для получения параметров `lpProjName` и `lpAuxProjPath`. После подключаемый модуль системы управления версиями запрашивает у пользователя эти сведения, он передает эти две строки обратно в интегрированной среде разработки. Интегрированной среды разработки, сохраняет эти строки в файле решения и передает их [SccOpenProject](../extensibility/sccopenproject-function.md) каждый раз, когда пользователь открывает этот проект. Эти строки включите подключаемый модуль для отслеживания сведений, связанных с проектом.

 При первом вызове функции, `lpAuxProjPath` присваивается пустая строка. `lProjName` также может быть пустым, или он может содержать имя проекта интегрированной среды разработки, которое может использовать или игнорировать подключаемый модуль системы управления версиями. Если функция успешно возвращает, подключаемый модуль возвращает два соответствующих строк. Интегрированной среды разработки не делает предположений о следующих строк, не будет использовать их и не позволит пользователю изменять их. Если пользователь хочет изменить параметры, интегрированная среда разработки будет вызывать `SccGetProjPath` еще раз, передавая в те же значения получала предшествовавшее время. Это дает подключаемый модуль полный контроль над эти две строки.

 Для `lpUser`, интегрированной среды разработки может передать имя пользователя, или он может просто передать указатель на пустую строку. Если имя пользователя, подключаемый модуль системы управления версиями следует использовать по умолчанию. Тем не менее, если имя не было передано или произошел сбой при входе с заданным именем, подключаемый модуль должен запросить пользователя для входа и передайте имя обратно в `lpUser` при получении действительного имени входа. Поскольку подключаемый модуль может изменить эту строку, IDE всегда будет выделять буфер размером (`SCC_USER_LEN`+ 1).

> [!NOTE]
> Первое действие, выполняющий интегрированной среды разработки может быть либо вызов `SccOpenProject` функции или `SccGetProjPath` функции. Таким образом, у них совпадают `lpUser` параметр, позволяющий системы управления версиями, подключаемый модуль для входа пользователя в любой момент. Даже если возврат из функции указывает на сбой, подключаемый модуль, необходимо указать эту строку с недопустимым именем для входа.

 `lpLocalPath` — Это каталог, где пользователь удерживает проекта. Он может быть пустой строкой. Если каталог, не определенных в настоящий момент (как в случае пользователь, пытающийся загрузили проект из системы управления версиями) и если `bAllowChangePath` является `TRUE`, подключаемый модуль системы управления версиями можно запрашивать ввода данных пользователем или другим методом разместить его владельцем в строку `lpLocalPath`. Если `bAllowChangePath` является `FALSE`, подключаемый модуль не изменяйте строки, так как пользователь уже работает в указанном каталоге.

 Если пользователь создает новый проект, чтобы поместить в системе управления версиями, подключаемый модуль системы управления версиями может не создает его в системе управления версиями во время `SccGetProjPath` вызывается. Вместо этого он передает строки вместе с ненулевое значение для `pbNew`, указывающее, что проект будет создан в системе управления версиями.

 Например, если пользователь в **новый проект** мастер в Visual Studio добавляет свой проект в систему управления версиями, Visual Studio вызывает эту функцию и подключаемый модуль определяет, разрешается ли для создания нового проекта в системе управления версиями для содержать проект Visual Studio. Если пользователь нажимает кнопку **отменить** перед завершением мастера, никогда не создается проект. Если пользователь нажимает кнопку **ОК**, Visual Studio вызывает `SccOpenProject`, передавая `SCC_OPT_CREATEIFNEW`, и в этот момент создается проект системы управления версиями.

## <a name="see-also"></a>См. также
- [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)
- [SccOpenProject](../extensibility/sccopenproject-function.md)