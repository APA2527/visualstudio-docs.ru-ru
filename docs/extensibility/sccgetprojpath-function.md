---
title: Функция SccGetProjPath Документы Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccGetProjPath
helpviewer_keywords:
- SccGetProjPath function
ms.assetid: 1079847e-d45f-4cb8-9d92-1e01ce5d08f6
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 281787da3499c081fbbe6f59b7b8175a4dbf24d7
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80700703"
---
# <a name="sccgetprojpath-function"></a>Функция SccGetProjPath
Эта функция подсказывает пользователю для пути проекта, который является строкой, которая имеет значение только для плагина управления исходным управлением. Он вызывается, когда пользователь:

- Создание нового проекта

- Добавление существующего проекта в управление версиями

- Попытка найти существующий проект управления версиями

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccGetProjPath (
   LPVOID pvContext,
   HWND   hWnd,
   LPSTR  lpUser,
   LPSTR  lpProjName,
   LPSTR  lpLocalPath,
   LPSTR  lpAuxProjPath,
   BOOL   bAllowChangePath,
   LPBOOL pbNew
);
```

### <a name="parameters"></a>Параметры
 pvКонтекст

(в) Структура контекста управления исходным элементом.

 Hwnd

(в) Ручка к окну IDE, которую плагин управления исходным элементом может использоваться в качестве родительского элемента для любых диалоговых коробок, которые она предоставляет.

 lpUser

(в, вне) Имя пользователя (не превышать SCC_USER_SIZE, включая терминатор NULL)

 lpProjName

(в, вне) Название проекта IDE, рабочее пространство проекта или makefile (не превышают SCC_PRJPATH_SIZE, включая терминатор NULL).

 lpLocalPath

(в, вне) Проект работает. Если `bAllowChangePath` `TRUE`есть, плагин управления исходным элементом может изменить эту строку (не превышать _MAX_PATH, включая нулевую терминатор).

 lpAuxProjPath

(в, вне) Буфер для возвращенного пути проекта (не превышают SCC_PRJPATH_SIZE, включая терминатор NULL).

 bAllowChangePath

(в) Если это `TRUE`так, то плагин управления исходным `lpLocalPath` элементом может подсказывать и изменять строку.

 pbNew

(в, вне) Значение, поступаюе в указывает, следует ли создать новый проект. Возврат стоимости указывает на успех создания проекта:

|Входящие|Интерпретация|
|--------------|--------------------|
|TRUE|Пользователь может создать новый проект.|
|FALSE|Пользователь не может создать новый проект.|

|Исходящие|Интерпретация|
|--------------|--------------------|
|TRUE|Был создан новый проект.|
|FALSE|Был выбран существующий проект.|

## <a name="return-value"></a>Возвращаемое значение
 Ожидается, что внедрение этой функции элемента управления исходным элементом вернет одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Проект был успешно создан или извлечен.|
|SCC_I_OPERATIONCANCELED|Операция была отменена.|
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления исходным кодом, вероятно, из-за проблем с сетью или раздором.|
|SCC_E_CONNECTIONFAILURE|Возникла проблема при подключении к системе управления исходным источником.|
|SCC_E_NONSPECIFICERROR|Произошла неизвестная ошибка.|

## <a name="remarks"></a>Примечания
 Цель этой функции для IDE приобрести `lpProjName` параметры `lpAuxProjPath`и . После того, как плагин управления исходным источником подскажет пользователю эту информацию, он передает эти две строки обратно в IDE. IDE сохраняет эти строки в файле решения и передает их [SccOpenProject](../extensibility/sccopenproject-function.md) всякий раз, когда пользователь открывает этот проект. Эти строки позволяют плагину отслеживать информацию, связанную с проектом.

 Когда функция сначала вызывается, `lpAuxProjPath` устанавливается на пустую строку. `lProjName`также может быть пустым или содержать название проекта IDE, которое плагин управления исходным источником может использовать или игнорировать. Когда функция успешно возвращается, плагин возвращает две соответствующие строки. IDE не делает никаких предположений об этих строках, не будет использовать их и не позволит пользователю изменять их. Если пользователь хочет изменить настройки, IDE `SccGetProjPath` будет звонить снова, передавая те же значения, которые он получил в предыдущий раз. Это дает плагин полный контроль над этими двумя строками.

 Для, `lpUser`IDE может пройти в имени пользователя, или он может просто передать в указатель на пустую строку. Если есть имя пользователя, плагин управления исходным элементом должен использовать его по умолчанию. Однако, если имя не было передано или если логин не удалось с данном именем, плагин `lpUser` должен побудить пользователя для входа и передать имя обратно, когда он получает действительный логин. Поскольку плагин может изменить эту строку, IDE всегда`SCC_USER_LEN`будет выделять буфер размера (No1).

> [!NOTE]
> Первым действием, выполняемым IDE, может `SccOpenProject` быть `SccGetProjPath` вызов либо к функции, либо к функции. Таким образом, оба они `lpUser` имеют идентичный параметр, который позволяет плагин управления исходным временем для входа пользователя в любое время. Даже если возврат от функции указывает на сбой, плагин должен заполнить эту строку действительным именем входа.

 `lpLocalPath`— это каталог, в котором пользователь ведет проект. Это может быть пустая строка. Если в настоящее время нет каталога (как в случае с пользователем, пытающимся `bAllowChangePath` `TRUE`загрузить проект из системы управления исходным элементом), и если это так, то плагин управления исходным управлением может побудить пользователя к входе или использовать какой-либо другой метод для размещения собственной строки в. `lpLocalPath` Если `bAllowChangePath` `FALSE`есть, плагин не должен менять строку, так как пользователь уже работает в указанном каталоге.

 Если пользователь создает новый проект, который будет поставлен под управление источника, плагин управления исходным `SccGetProjPath` элементом может фактически не создать его в системе управления исходным источником в момент вызова. Вместо этого он передает строку вместе с `pbNew`ненулевом значением для, указывающим на то, что проект будет создан в системе управления исходным источником.

 Например, если пользователь в мастере **Нового Проекта** в Visual Studio добавляет свой проект к управлению исходом, Visual Studio называет эту функцию, и плагин определяет, можно ли создать новый проект в системе управления исходным источником для сдерживания проекта Visual Studio. Если пользователь нажимает **На кнопку «Отмена»** перед завершением мастера, проект никогда не создается. Если пользователь нажимает **OK,** Visual Studio звонки, `SccOpenProject`проходя в `SCC_OPT_CREATEIFNEW`, и источник контролируемых проект создается в это время.

## <a name="see-also"></a>См. также
- [Функции API управления исходным элементом](../extensibility/source-control-plug-in-api-functions.md)
- [SccOpenProject](../extensibility/sccopenproject-function.md)
