---
title: Помощники SDK для отладки (ru) Документы Майкрософт
ms.date: 11/04/2016
ms.topic: reference
helpviewer_keywords:
- dbgmetric.lib
- registry, Debugging SDK
- Debugging SDK, registry locations
- dbgmetric.h
- metrics [Debugging SDK]
ms.assetid: 80a52e93-4a04-4ab2-8adc-a7847c2dc20b
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 9edb7c508fdea6736a71c0f70c0d2ff305d4a399
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80713654"
---
# <a name="sdk-helpers-for-debugging"></a>Вспомогательные пакеты SDK для отладки
Эти функции и декларации являются глобальными функциями помощника для реализации отладочных двигателей, оценщиков экспресс-выражений и поставщиков символов в СЗ.

> [!NOTE]
> В настоящее время нет управляемых версий этих функций и деклараций.

## <a name="overview"></a>Обзор
 Для того, чтобы отладить двигатели, оценщики экспрессий и поставщиков символов, которые будут использоваться Visual Studio, они должны быть зарегистрированы. Это делается путем установки подключ реестра и записей, иначе известный как "установка метрик". Следующие глобальные функции предназначены для облегчения процесса обновления этих показателей. Ознакомьтесь с разделом о местоположении реестра, чтобы узнать расположение каждого подключаемого ключа реестра, обновляемого этими функциями.

## <a name="general-metric-functions"></a>Общие метрические функции
 Это общие функции, используемые двигателями отладки. Специализированные функции для оценщиков экспрессий и поставщиков символов будут подробно описаны позже.

### <a name="getmetric-method"></a>Метод GetMetric
 Извлекает метрическое значение из реестра.

```cpp
HRESULT GetMetric(
   LPCWSTR pszMachine,
   LPCWSTR pszType,
   REFGUID guidSection,
   LPCWSTR pszMetric,
   DWORD * pdwValue,
   LPCWSTR pszAltRoot
);
```

|Параметр|Описание|
|---------------|-----------------|
|pszMachine|(в) Название возможно удаленной машины, регистр которой`NULL` будет написан (означает местная машина).|
|pszType|(в) Один из типов метрик.|
|guidSection|(в) GUID конкретного двигателя, оценщика, исключения и т.д. При этом определяется подраздел под метрическим типом для определенного элемента.|
|pszMetric|(в) Метрика, которая будет получена. Это соответствует конкретному названию значения.|
|pdwValue|(в) Место хранения значения из метрики. Есть несколько вкусов GetMetric, которые могут вернуть DWORD (как в этом примере), BSTR, GUID, или массив GUIDs.|
|pszAltRoot|(в) Альтернативный корень реестра для использования. Установить `NULL` для использования по умолчанию.|

### <a name="setmetric-method"></a>Метод SetMetric
 Устанавливает указанное значение метрики в реестре.

```cpp
HRESULT SetMetric(
         LPCWSTR pszType,
         REFGUID guidSection,
         LPCWSTR pszMetric,
   const DWORD   dwValue,
         bool    fUserSpecific,
         LPCWSTR pszAltRoot
);
```

|Параметр|Описание|
|---------------|-----------------|
|pszType|(в) Один из типов метрик.|
|guidSection|(в) GUID конкретного двигателя, оценщика, исключения и т.д. При этом определяется подраздел под метрическим типом для определенного элемента.|
|pszMetric|(в) Метрика, которая будет получена. Это соответствует конкретному названию значения.|
|dwValue|(в) Место хранения значения в метрике. Есть несколько вкусов SetMetric, которые могут хранить DWORD (в этом примере), BSTR, GUID, или массив GUIDs.|
|fUserSpecific|(в) ПРАВДА, если метрика является специфическим для пользователя, и если она должна быть написана в улей пользователя, а не локальная машина улей.|
|pszAltRoot|(в) Альтернативный корень реестра для использования. Установить `NULL` для использования по умолчанию.|

### <a name="removemetric-method"></a>УдалитьМетрический метод
 Удаляет указанную метрику из реестра.

```cpp
HRESULT RemoveMetric(
   LPCWSTR pszType,
   REFGUID guidSection,
   LPCWSTR pszMetric,
   LPCWSTR pszAltRoot
);
```

|Параметр|Описание|
|---------------|-----------------|
|pszType|(в) Один из типов метрик.|
|guidSection|(в) GUID конкретного двигателя, оценщика, исключения и т.д. При этом определяется подраздел под метрическим типом для определенного элемента.|
|pszMetric|(в) Метрика, которая будет удалена. Это соответствует конкретному названию значения.|
|pszAltRoot|(в) Альтернативный корень реестра для использования. Установить `NULL` для использования по умолчанию.|

### <a name="enummetricsections-method"></a>Метод EnumMetricSections
 Перечисляет различные метрические разделы в реестре.

```cpp
HRESULT EnumMetricSections(
   LPCWSTR pszMachine,
   LPCWSTR pszType,
   GUID *  rgguidSections,
   DWORD * pdwSize,
   LPCWSTR pszAltRoot
);
```

|Параметр|Описание|
|---------------|-----------------|
|pszMachine|(в) Название возможно удаленной машины, регистр которой`NULL` будет написан (означает местная машина).|
|pszType|(в) Один из типов метрик.|
|rgguidSections|(в, вне) Предварительно распределенный массив GUIDs, которые должны быть заполнены.|
|pdwSize|(в) Максимальное количество GUID, которые могут `rgguidSections` храниться в массиве.|
|pszAltRoot|(в) Альтернативный корень реестра для использования. Установить `NULL` для использования по умолчанию.|

## <a name="expression-evaluator-functions"></a>Функции оценки экспрессии

|Функция|Описание|
|--------------|-----------------|
|GetEEMetric|Извлекает метрическое значение из реестра.|
|SetEEMetric|Устанавливает указанное значение метрики в реестре.|
|УдалитьEEEMetric|Удаляет указанную метрику из реестра.|
|GetEEMetricFile|Получает имя файла из указанной метрики и загружает его, возвращая содержимое файла в строку.|

## <a name="exception-functions"></a>Функции исключения

|Функция|Описание|
|--------------|-----------------|
|GetExceptionMetric|Извлекает метрическое значение из реестра.|
|SetExceptionMetric|Устанавливает указанное значение метрики в реестре.|
|УдалитьExceptionMetric|Удаляет указанную метрику из реестра.|
|RemoveAllExceptionMetrics|Удаляет все метрики исключения из реестра.|

## <a name="symbol-provider-functions"></a>Функции поставщика символов

|Функция|Описание|
|--------------|-----------------|
|GetSPMetric|Извлекает метрическое значение из реестра.|
|SetSPMetric|Устанавливает указанное значение метрики в реестре.|
|УдалитьSPMetric|Удаляет указанную метрику из реестра.|

## <a name="enumeration-functions"></a>Функции перечисления

|Функция|Описание|
|--------------|-----------------|
|EnumMetricSections|Перечисляет все метрики для определенного типа метрики.|
|EnumDebugEngine|Перечисляет зарегистрированные двигатели отладки.|
|EnumEEs|Перечисляет зарегистрированных оценщиков выражений.|
|EnumExceptionMetrics|Перечисляет все метрики исключений.|

## <a name="metric-definitions"></a>Определения метрик
 Эти определения могут быть использованы для предопределенных имен метрик. Имена соответствуют различным ключам реестра и именам значений и определяются как широкие строки символов: например, `extern LPCWSTR metrictypeEngine`.

|Предопределенные типы метрики|Описание: Базовый ключ для ....|
|-----------------------------|---------------------------------------|
|metrictypeEngine|Все показатели отладки двигателя.|
|метрикиПортпоставщик|Все показатели поставщика портов.|
|metrictypeИсключение|Все метрики исключения.|
|metricttypeEEExtension|Все расширения оценки выражения.|

|Свойства двигателя отугружена|Описание|
|-----------------------------|-----------------|
|metricAddressBP|Установите на nonzero, чтобы указать поддержку точек разрыва адреса.|
|metricAlwaysLoadLocal|Установите на nonzero для того, чтобы всегда загружать отладку двигателя локально.|
|metricLoadIndebuggeeSession|НЕ ИСПОЛЬЗУЕТСЯ|
|metricLoadedByDebuggee|Установить в nonzero, чтобы указать, что отладка двигателя всегда будет загружен с или программы отладки.|
|metricAttach|Установите nonzero для обозначения поддержки вложения в существующие программы.|
|metricCallSTACKBP|Установите на nonzero, чтобы указать поддержку моментов разрыва стека вызовов.|
|метрическиеУсловныеBP|Установите на nonzero, чтобы указать поддержку для настройки условных точек разрыва.|
|metricDataBP|Установите nonzero для обозначения поддержки настройки точек разрыва на изменениях в данных.|
|metricDisassembly|Установите на nonzero, чтобы указать поддержку для производства объявления разборки.|
|metricDumpWriting|Установить в nonzero, чтобы указать поддержку для написания дампа (сброс памяти на выходное устройство).|
|metricENC|Установите nonzero, чтобы указать поддержку для edit and Continue. **Примечание:**  Пользовательский отладка двигателя никогда не должны установить это или всегда должны установить его на 0.|
|metricExceptions|Установите на nonzero для обозначения поддержки исключений.|
|metricФункцияBP|Установить nonzero для обозначения поддержки названных точек разрыва (точки разрыва, которые ломаются при вызове определенного имени функции).|
|metricHitCountBP|Установить nonzero, чтобы указать поддержку настройки "точка удара" точки разрыва (брейк-пойнты, которые срабатывают только после попадания определенное количество раз).|
|metricJITDebug|Установить nonzero для указания поддержки для отладки (отладчик запускается, когда происходит исключение в запущенном процессе).|
|metricMemory|НЕ ИСПОЛЬЗУЕТСЯ|
|metricPortSupplier|Установите это в CLSID поставщика порта, если он реализован.|
|metricRegisters|НЕ ИСПОЛЬЗУЕТСЯ|
|metricSetNextStatement|Установите nonzero для обозначения поддержки для настройки следующего оператора (который пропускает выполнение промежуточных инструкций).|
|metricSuspendThread|Установите на nonzero для обозначения поддержки приостановки выполнения потока.|
|metricWarnIfNoСимволы|Установите nonzero, чтобы указать, что пользователь должен быть уведомлен, если нет символов.|
|metricProgramProvider|Установите это в CLSID поставщика программы.|
|metricAlwaysLoadProgramProviderLocal|Установите это на nonzero, чтобы указать, что поставщик программы всегда должен быть загружен локально.|
|metricEngineCanWatchProcess|Установите это в nonzero, чтобы указать, что отладка двигателя будет следить за событиями процесса, а не поставщиком программы.|
|metricRemoteDebugging|Установите это на nonzero, чтобы указать поддержку удаленной отладки.|
|metricEncUseNativeBuilder|Установите это на nonzero, чтобы указать, что менеджер по исправлению и продолжению должен использовать encbuild.dll отладки для создания для edit and Continue. **Примечание:**  Пользовательский отладка двигателя никогда не должны установить это или всегда должны установить его на 0.|
|metricLoadUnderWOW64|Установите это на nonzero, чтобы указать, что отладка двигателя должны быть загружены в процессе отладки под WOW при отладке 64-битного процесса; в противном случае, отладка двигателя будет загружена в процессе Visual Studio (который работает под WOW64).|
|metricLoadProgramProviderUnderWOW64|Установите это на nonzero, чтобы указать, что поставщик программы должен быть загружен в процессе отладки при отладке 64-битного процесса под WOW; в противном случае он будет загружен в процессе Visual Studio.|
|metricStopOnExceptionCrossingManagedBoundary|Установите это на nonzero, чтобы указать, что процесс должен прекратиться, если необработанное исключение брошено через управляемые/неуправляемые границы кода.|
|metricAutoSelectPriority|Установите это в приоритет для автоматического выбора двигателя отладки (более высокие значения равно более высокий приоритет).|
|metricAutoSelectНесовместимыйСписок|Ключ реестра, содержащий записи, которые указывают GUIDs для отладки двигателей, которые будут проигнорированы в автоматическом отборе. Эти записи являются числом (0, 1, 2 и так далее) с GUID выражается как строка.|
|метрикиНесовместимыйСписок|Ключ реестра, содержащий записи, которые указывают GUIDдля для отладки двигателей, которые несовместимы с этим движком отладки.|
|metricDisableJITOptimization|Установите это на nonzero, чтобы указать, что точно в срок оптимизации (для управляемого кода) должны быть отключены во время отладки.|

|Свойства оценки экспрессии|Описание|
|-------------------------------------|-----------------|
|metricEngine|Это удерживает количество отладок двигателей, поддерживающих указанный оценщик выражения.|
|metricPreloadModules|Установите это на nonzero, чтобы указать, что модули должны быть предварительно загружены, когда оценщик выражения запущен против программы.|
|metricThisObjectName|Установите это в "это" имя объекта.|

|Свойства расширения выражения|Описание|
| - |-----------------|
|metricExtensionDll|Название dll, который поддерживает это расширение.|
|metricExtensionRegistersПоддерживается|Список регистров поддерживается.|
|metricExtensionRegistersEntryPoint|Точка входа для доступа к регистрам.|
|metricExtensionTypesSupported|Список поддерживаемых типов.|
|metricExtensionTypesEntryPoint|Точка входа для доступа к типам.|

|Свойства порт-поставщика|Описание|
|------------------------------|-----------------|
|metricPortPickerCLSID|CLSID сборщика портов (диалоговое окно, которое пользователь может использовать для выбора портов и добавления портов для использования для отладки).|
|metricDisallowUserEnteredPorts|Nonzero, если введенные пользователем порты не могут быть добавлены к поставщику порта (это делает поле диалога портового сбора по существу только для чтения).|
|metricPidBase|Идентификатор базового процесса, используемый поставщиком порта при распределении идентификаторов процесса.|

|Предопределенные типы магазинов SP|Описание|
|-------------------------------|-----------------|
|storetypeFile|Символы хранятся в отдельном файле.|
|хирандыМетаданные|Символы хранятся как метаданные в сборке.|

|Разное свойство|Описание|
|------------------------------|-----------------|
|metricShowNonUserCode|Установите это в nonzero, чтобы показать код nonuser.|
|metricJustMyCodeStepping|Установите это на nonzero, чтобы указать, что шаг может произойти только в коде пользователя.|
|метрикиCLSID|CLSID для объекта определенного метрического типа.|
|metricName|Удобное для пользователя имя объекта определенного типа метрики.|
|metricLanguage|Имя языка.|

## <a name="registry-locations"></a>Местонахождение реестра
 Метрики считываются и записываются `VisualStudio` в реестр, в частности в подключке.

> [!NOTE]
> Большую часть времени метрики будут написаны на HKEY_LOCAL_MACHINE ключ. Тем не менее, иногда HKEY_CURRENT_USER будет ключевым местом назначения. Dbgmetric.lib обрабатывает оба ключа. При получении метрики, он ищет HKEY_CURRENT_USER сначала, а затем HKEY_LOCAL_MACHINE. При настройке метрики параметр определяет, какой ключ верхнего уровня для использования.

 *(ключ реестра)*\

 `Software`\

 `Microsoft`\

 `VisualStudio`\

 *(корень версии)*\

 *(метрический корень)*\

 *(метрика типа)*\

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

|Заполнитель|Описание|
|-----------------|-----------------|
|*(ключ реестра)*|`HKEY_CURRENT_USER` или `HKEY_LOCAL_MACHINE`.|
|*(корень версии)*|Версия Visual Studio `7.0`(например, `7.1`, `8.0`, или ). Тем не менее, этот корень также может быть изменен с помощью **/rootsuffix** переключатель **devenv.exe**. Для VSIP этот модификатор обычно является **Exp,** поэтому корень версии будет, например, 8.0Exp.|
|*(метрический корень)*|Это `AD7Metrics` либо, `AD7Metrics(Debug)`либо , в зависимости от того, используется ли версия отладки dbgmetric.lib. **Примечание:**  Независимо от того, используется ли dbgmetric.lib, эта конвенция именования должна соблюдаться, если у вас есть различия между отладкой и версиями релиза, которые должны быть отражены в реестре.|
|*(метрика типа)*|Тип метрики, `Engine`которая `ExpressionEvaluator` `SymbolProvider`будет написана: , , и т.д. Все они определяются как в dbgmetric.h как `metricTypeXXXX`, где `XXXX` конкретное имя типа.|
|*(метрика)*|Имя записи, которое должно быть присвоено значение для установки метрики. Фактическая организация метрик зависит от типа метрики.|
|*(метрика)*|Значение, присвоенное метрике. Тип значения должен иметь (строка, число и т.д.) зависит от метрики.|

> [!NOTE]
> Все GUID хранятся в `{GUID}`формате . Например, `{123D150B-FA18-461C-B218-45B3E4589F9B}`.

### <a name="debug-engines"></a>Двигатели дебага
 Ниже приводится организация отладки двигателей метрик в реестре. `Engine`— это имя типа метрики для движка отладки и соответствует *«метрическому типу»* в вышеуказанном подлом реестра.

 `Engine`\

 *(двигатель гид)*\

 `CLSID` = *(класс гид)*

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

 `PortSupplier`\

 `0` = *(портовый поставщик гид)*

 `1` = *(портовый поставщик гид)*

|Заполнитель|Описание|
|-----------------|-----------------|
|*(двигатель гид)*|GUID двигателя отладки.|
|*(класс гид)*|GUID класса, который реализует этот движок отладки.|
|*(портовый поставщик гид)*|GUID поставщика порта, если таковые имеется. Многие двигатели отладить использовать поставщик порта по умолчанию и, следовательно, не указать своего поставщика. В этом случае подключка `PortSupplier` будет отсутствовать.|

### <a name="port-suppliers"></a>Поставщики портов
 Ниже приводится организация метрик поставщика порта в реестре. `PortSupplier`является наименованием типа метрики для поставщика порта и соответствует *«метрическому типу».*

 `PortSupplier`\

 *(портовый поставщик гид)*\

 `CLSID` = *(класс гид)*

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

|Заполнитель|Описание|
|-----------------|-----------------|
|*(портовый поставщик гид)*|GUID поставщика порта|
|*(класс гид)*|GUID класса, который реализует этот поставщик порта|

### <a name="symbol-providers"></a>Поставщики символов
 Ниже приводится организация символов поставщика метрик в реестре. `SymbolProvider`является типом метрики для поставщика символов и соответствует *«метрическому типу».*

 `SymbolProvider`\

 *(поставщик символов гид)*\

 `file`\

 `CLSID` = *(класс гид)*

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

 `metadata`\

 `CLSID` = *(класс гид)*

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

|Заполнитель|Описание|
|-----------------|-----------------|
|*(поставщик символов гид)*|GUID поставщика символов|
|*(класс гид)*|GUID класса, который реализует этот поставщик символов|

### <a name="expression-evaluators"></a>Оценки экспрессии
 Ниже приводится организация показателей оценки выражения в реестре. `ExpressionEvaluator`— это имя типа метрики для оценщика выражения и соответствует *«метрическому типу».*

> [!NOTE]
> Тип метрики `ExpressionEvaluator` для не определен в dbgmetric.h, так как предполагается, что все метрические изменения для оценщиков экспрессии будут проходить через соответствующие функции оценки выражения (макет `ExpressionEvaluator` подключаемого ключа несколько сложен, поэтому детали скрыты внутри dbgmetric.lib).

 `ExpressionEvaluator`\

 *(язык гид)*\

 *(Поставщик гид)*\

 `CLSID` = *(класс гид)*

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

 `Engine`\

 `0` = *(отладка двигателя гида)*

 `1` = *(отладка двигателя гида)*

|Заполнитель|Описание|
|-----------------|-----------------|
|*(язык гид)*|GUID языка|
|*(Поставщик гид)*|GUID поставщика|
|*(класс гид)*|GUID класса, который реализует это выражение оценщика|
|*(отладка двигателя гида)*|GUID двигателя отладки, с которым работает этот оценщик выражения|

### <a name="expression-evaluator-extensions"></a>Расширение экспрессион-оценщика
 Ниже приводится организация показателей расширения экспресс-расширения выражения в реестре. `EEExtensions`— это имя типа метрики для расширений оценки выражения и соответствует *«метрическому типу».*

 `EEExtensions`\

 *(расширение гида)*\

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

|Заполнитель|Описание|
|-----------------|-----------------|
|*(расширение гида)*|GUID расширения оценщика выражения|

### <a name="exceptions"></a>Исключения
 Ниже приводится организация метрик исключений в реестре. `Exception`— это имя типа метрики для исключений и соответствует *«метрическому типу».*

 `Exception`\

 *(отладка двигателя гида)*\

 *(типы исключений)*\

 *(исключение)*\

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

 *(исключение)*\

 *(метрика) ( (метрика)*

 *(метрика) ( (метрика)*

|Заполнитель|Описание|
|-----------------|-----------------|
|*(отладка двигателя гида)*|GUID отладки двигателя, который поддерживает исключения.|
|*(типы исключений)*|Общее название подключаемого ключа, определяющего класс исключений, которые могут быть обработаны. Типичными именами являются **исключения из се,** **Win32 Исключения**, Общие исключения **продолжительности выполнения языка**, и **Родные Проверки времени выполнения**. Эти имена также используются для определения определенного класса исключений для пользователя.|
|*(исключение)*|Имя для исключения: например, **_com_error** или **Control-Break**. Эти имена также используются для определения конкретного исключения для пользователя.|

## <a name="requirements"></a>Требования
 Эти файлы находятся в каталоге [!INCLUDE[vs_dev10_ext](../../../extensibility/debugger/reference/includes/vs_dev10_ext_md.md)] установки SDK (по умолчанию, *«диск»*(Программные файлы» Microsoft Visual Studio 2010 SDK).\\

 Заголовок: включает в себя »dbgmetric.h

 Библиотека: libs'ad2de.lib, libs'dbgmetric.lib

## <a name="see-also"></a>См. также
- [Справка по API](../../../extensibility/debugger/reference/api-reference-visual-studio-debugging.md)
