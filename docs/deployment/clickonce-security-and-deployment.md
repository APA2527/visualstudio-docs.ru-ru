---
title: Безопасность и развертывание ClickOnce | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
helpviewer_keywords:
- Windows applications, ClickOnce deployment
- deploying applications [ClickOnce]
- ClickOnce deployment
- publishing, ClickOnce
ms.assetid: abab6d34-c3c2-45c1-a8b6-43c7d3131e7a
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: e723e53ab7f79589deb712fd7b854dabb87bcbb8
ms.sourcegitcommit: 209ed0fcbb8daa1685e8d6b9a97f3857a4ce1152
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/16/2019
ms.locfileid: "69551167"
---
# <a name="clickonce-security-and-deployment"></a>Развертывание и безопасность технологии ClickOnce
[!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)]— это технология развертывания, позволяющая создавать самостоятельно обновляемые приложения для Windows, которые можно устанавливать и запускать с минимальным участием пользователя. [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]обеспечивает полную поддержку публикации и обновления приложений, развернутых с помощью технологии ClickOnce, если вы разработали проекты C#с Visual Basic и Visual. Дополнительные сведения о развертывании C++ визуальных приложений см. в статье [Развертывание ClickOnce для визуальных C++ приложений](/cpp/windows/clickonce-deployment-for-visual-cpp-applications).

 [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)]Развертывание переводит три основные проблемы в развертывании:

- **Трудности обновления приложений.** При развертывании Microsoft установщик Windows при каждом обновлении приложения пользователь может установить обновление, MSP-файл и применить его к установленному продукту. При [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] развертывании обновления можно предоставлять автоматически. Загружаются только те части приложения, которые были изменены, а затем полное обновленное приложение переустанавливается из новой параллельной папки.

- **Влияние на компьютер пользователя.** При развертывании установщик Windows приложения часто полагаются на общие компоненты, что может привести к конфликтам версий. При [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] развертывании каждое приложение является автономным и не может мешать работе других приложений.

- **Разрешения безопасности.** Для развертывания установщик Windows требуются административные разрешения. Это позволяет устанавливать только ограниченные пользователи. [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] развертывание позволяет пользователям без прав администратора устанавливать и предоставлять только необходимые для приложения разрешения управления доступом для кода.

  В прошлом эти проблемы иногда привели к тому, что разработчики решили создать веб-приложения, а не приложения на базе Windows, что позволит легко установить более мощный пользовательский интерфейс. С помощью приложений, развернутых с помощью [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)], можно использовать преимущества обеих технологий.

## <a name="what-is-a-clickonce-application"></a>Что такое приложение ClickOnce?
 [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)]Приложение — это любое Windows Presentation Foundation (XBAP), Windows Forms (. exe), консольное приложение (. exe) или решение Office (DLL), опубликованное с помощью технологии. [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] Вы можете опубликовать [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложение тремя разными способами: с веб-страницы, из общей сетевой папки или с носителя, например с компакт-диска. [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] Приложение может быть установлено на компьютере конечного пользователя и выполняться локально даже в том случае, если компьютер находится в автономном режиме, или его можно запускать только в оперативном режиме без окончательной установки на компьютере конечного пользователя. Дополнительные сведения см. [в статье Выбор стратегии развертывания ClickOnce](../deployment/choosing-a-clickonce-deployment-strategy.md).

 [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)]приложения могут обновляться самостоятельно; они могут проверять наличие новых версий по мере их появления и автоматически заменять все обновленные файлы. Разработчик может указать поведение обновления; сетевой администратор также может управлять стратегиями обновления, например, устанавливая обязательность обновления. Также можно выполнить откат обновлений до более ранней версии конечным пользователем или администратором. Дополнительные сведения см. [в статье Выбор стратегии обновления ClickOnce](../deployment/choosing-a-clickonce-update-strategy.md).

 Поскольку [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложения изолированы, установка или [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] запуск приложения не могут нарушить работу существующих приложений. [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)]приложения автономны; Каждое [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложение устанавливается и запускается из безопасного кэша на уровне пользователя и приложения. [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)]приложения выполняются в зонах безопасности Интернета или интрасети. При необходимости приложение может запросить повышение прав. Дополнительные сведения см. в разделе [безопасные приложения ClickOnce](../deployment/securing-clickonce-applications.md).

## <a name="how-clickonce-security-works"></a>Принцип работы системы безопасности ClickOnce
 Основная [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] безопасность основана на сертификатах, политиках управления доступом для кода и запросе о доверии ClickOnce.

### <a name="certificates"></a>Сертификаты
 Сертификаты Authenticode используются для проверки подлинности издателя приложения. С помощью Authenticode для развертывания приложений технология ClickOnce помогает предотвратить портрайинг саму вредоносную программу в качестве легальной программы, поступающей от установленного надежного источника. При необходимости сертификаты также можно использовать для подписания манифестов приложения и развертывания, чтобы доказать, что файлы не были изменены. Дополнительные сведения см. в разделе [ClickOnce и Authenticode](../deployment/clickonce-and-authenticode.md). Сертификаты также можно использовать для настройки на клиентских компьютерах списка доверенных издателей. Если приложение поступает от доверенного издателя, его можно установить без вмешательства пользователя. Для получения дополнительной информации см. раздел [Общие сведения о развертывании доверенных приложений](../deployment/trusted-application-deployment-overview.md).

### <a name="code-access-security"></a>Управление доступом для кода
 Управление доступом для кода помогает ограничить доступ кода к защищенным ресурсам. В большинстве случаев для ограничения разрешений можно выбрать зоны Интернета или местной интрасети. Используйте страницу **Безопасность** в **прожектдесигнер** , чтобы запросить зону, соответствующую приложению. Вы также можете отлаживать приложения с ограниченными разрешениями, чтобы эмулировать работу конечных пользователей. Дополнительные сведения см. в статье [Управление доступом для кода для приложения ClickOnce](../deployment/code-access-security-for-clickonce-applications.md).

### <a name="clickonce-trust-prompt"></a>Запрос о доверии ClickOnce
 Если приложение запрашивает больше разрешений, чем позволяет зона, пользователю может быть предложено принять решение о доверии. Конечный пользователь может решить, являются ли приложения ClickOnce, такие как Windows Forms приложения, Windows Presentation Foundation приложения, консольные приложения, приложения браузера XAML и решения Office, доверенными для выполнения. Дополнительные сведения см. в разделе [Практическое руководство. настроить поведение запроса о доверии ClickOnce](../deployment/how-to-configure-the-clickonce-trust-prompt-behavior.md).

## <a name="how-clickonce-deployment-works"></a>Как работает развертывание ClickOnce
 Основная [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] архитектура развертывания основана на двух файлах манифеста XML: манифесте приложения и манифесте развертывания. Эти файлы используются, чтобы описать, откуда устанавливаются приложения ClickOnce, как они обновляются и когда они обновляются.

### <a name="publish-clickonce-applications"></a>Публикация приложений ClickOnce
 Манифест приложения описывает само приложение. Сюда входят сборки, зависимости и файлы, составляющие приложение, необходимые разрешения и расположение, в котором будут доступны обновления. Разработчик приложения создает манифест приложения с помощью мастера публикации в Visual Studio или Инструмент создания и изменения манифестов (*Mage. exe*) в [!INCLUDE[winsdklong](../deployment/includes/winsdklong_md.md)]. Дополнительные сведения см. в разделе [Практическое руководство. опубликовать приложение ClickOnce с помощью мастера публикации](../deployment/how-to-publish-a-clickonce-application-using-the-publish-wizard.md).

 Манифест развертывания содержит описание развертывания приложения. Сюда входит расположение манифеста приложения и версия приложения, которое должны выполняться клиентами.

### <a name="deploy-clickonce-applications"></a>Развертывание приложений ClickOnce
 После создания манифеста развертывания он копируется в место развертывания. Это может быть веб-сервер, общий сетевой ресурс или носитель, например компакт-диск. Манифест приложения и все файлы приложения также копируются в расположение развертывания, указанное в манифесте развертывания. Оно может совпадать с местом развертывания или отличаться от него. При использовании **мастера публикации** в Visual Studio операции копирования выполняются автоматически.

### <a name="install-clickonce-applications"></a>Установка приложений ClickOnce
 После завершения развертывания в указанном месте конечные пользователи могут загрузить и установить приложение, щелкнув значок файла манифеста развертывания на веб-странице или в папке. В большинстве случаев пользователю предоставляется простое диалоговое окно, предлагающее пользователю подтвердить установку, после чего установка будет продолжена, а приложение запустится без дополнительного вмешательства. В случаях, когда приложению требуются повышенные разрешения или приложение не подписано доверенным сертификатом, диалоговое окно также предлагает пользователю предоставить разрешение до того, как установка будет продолжена. Хотя установка ClickOnce выполняется для каждого пользователя, может потребоваться повышение прав, если имеются предварительные требования, требующие прав администратора. Дополнительные сведения о повышенных разрешениях см. в разделе [Защита приложений ClickOnce](../deployment/securing-clickonce-applications.md).

 Сертификаты могут быть доверенными на уровне компьютера или предприятия, чтобы приложения ClickOnce, подписанные с помощью доверенного сертификата, можно было устанавливать автоматически. Дополнительные сведения о доверенных сертификатах см. в разделе [Общие сведения о развертывании доверенных приложений](../deployment/trusted-application-deployment-overview.md).

 Приложение можно добавить в меню " **Пуск** " пользователя и в группу " **Установка и удаление программ** " на **панели управления**. В отличие от других технологий развертывания, в папку **Program Files** или реестр не добавляются никакие права администратора для установки не требуются.

> [!NOTE]
> Кроме того, можно запретить добавление приложения в меню **Пуск** , а также **Добавление или удаление группы программ** , в результате чего оно будет работать как веб-приложение. Дополнительные сведения см. [в статье Выбор стратегии развертывания ClickOnce](../deployment/choosing-a-clickonce-deployment-strategy.md).

### <a name="update-clickonce-applications"></a>Обновление приложений ClickOnce
 Когда разработчики приложений создают обновленную версию приложения, они создают новый манифест приложения и копируют файлы в место развертывания, обычно в папку с общим родителем, в исходную папку развертывания приложения. Администратор обновляет манифест развертывания, чтобы он указывал на расположение новой версии приложения.

> [!NOTE]
> Для выполнения этих действий можно использовать **Мастер публикации** в Visual Studio.

 Помимо размещения развертывания в манифесте развертывания также содержится размещение обновления (веб-страница или общий сетевой ресурс), проверяемое приложением на наличие обновленных версий. [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)]Свойства **публикации** используются, чтобы указать, когда и как часто приложение должно проверять наличие обновлений. Поведение обновления можно указать в манифесте развертывания или в качестве выбора пользователя в пользовательском интерфейсе приложения с помощью [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] интерфейсов API. Кроме того, в свойствах **публикации** может указываться обязательность обновлений или откат к предыдущей версии. Дополнительные сведения см. [в разделе Выбор стратегии обновления ClickOnce](../deployment/choosing-a-clickonce-update-strategy.md).

### <a name="third-party-installers"></a>Сторонние установщики
 Установщик ClickOnce можно настроить для установки сторонних компонентов вместе с приложением. Необходимо иметь распространяемый пакет (exe или MSI-файл) и описать пакет манифестом продукта, не зависящим от языка, и манифестом пакета, зависящим от языка. Дополнительные сведения см. в разделе [Создание пакетов начального загрузчика](../deployment/creating-bootstrapper-packages.md).

## <a name="clickonce-tools"></a>Средства ClickOnce
 В следующей таблице показаны средства, которые можно использовать для создания, редактирования, подписывания и повторного подписания манифестов приложения и развертывания.

|Tool|Описание|
|----------|-----------------|
|[Страница "Безопасность" в конструкторе проектов](../ide/reference/security-page-project-designer.md)|Подписывает манифесты приложения и развертывания.|
|[Страница публикации в конструкторе проектов](../ide/reference/publish-page-project-designer.md)|Создает и редактирует манифесты приложения и развертывания для Visual Basic и визуальных C# приложений.|
|[*Mage.exe* (инструмент создания и изменения манифестов)](/dotnet/framework/tools/mage-exe-manifest-generation-and-editing-tool)|Создает манифесты приложения и развертывания для Visual Basic, визуальных C#и визуальных C++ приложений.<br /><br /> Подписывает и повторно подписывает манифесты приложения и развертывания.<br /><br /> Может выполняться из пакетных скриптов и из командной строки.|
|[*MageUI.exe* (инструмент создания и изменения манифестов, графический клиент)](/dotnet/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client)|Создает и редактирует манифесты приложения и развертывания.<br /><br /> Подписывает и повторно подписывает манифесты приложения и развертывания.|
|[Задача GenerateApplicationManifest](../msbuild/generateapplicationmanifest-task.md)|Создает манифест приложения.<br /><br /> Можно запустить из MSBuild. Дополнительные сведения см. в разделе [Справка по MSBuild](../msbuild/msbuild-reference.md).|
|[Задача GenerateDeploymentManifest](../msbuild/generatedeploymentmanifest-task.md)|Создает манифест развертывания.<br /><br /> Можно запустить из MSBuild. Дополнительные сведения см. в разделе [Справка по MSBuild](../msbuild/msbuild-reference.md).|
|[Задача SignFile](../msbuild/signfile-task.md)|Подписывает манифесты приложения и развертывания.<br /><br /> Можно запустить из MSBuild. Дополнительные сведения см. в разделе [Справка по MSBuild](../msbuild/msbuild-reference.md).|
|[Microsoft. Build. Tasks. Deployment. Манифестутилитиес](https://docs.microsoft.com/dotnet/api/microsoft.build.tasks.deployment.manifestutilities)|Разрабатывайте собственное приложение для создания манифестов приложения и развертывания.|

 В следующей таблице показана версия .NET Framework, необходимая для поддержки приложений ClickOnce в этих браузерах.

|Browser|Версия платформы .NET Framework|
|-------------|----------------------------|
|Internet Explorer|2.0, 3.0, 3.5, 3.5 SP1, 4|
|Firefox|2.0 SP1, 3.5 SP1, 4|

## <a name="see-also"></a>См. также
- [Развертывание ClickOnce в Windows Vista](../deployment/clickonce-deployment-on-windows-vista.md)
- [Публикация приложений ClickOnce](../deployment/publishing-clickonce-applications.md)
- [Защита приложений ClickOnce](../deployment/securing-clickonce-applications.md)
- [Развертывание компонентов COM с помощью ClickOnce](../deployment/deploying-com-components-with-clickonce.md)
- [Сборка приложений ClickOnce из командной строки](../deployment/building-clickonce-applications-from-the-command-line.md)
- [Отладка приложений ClickOnce, использующих System.Deployment.Application](../deployment/debugging-clickonce-applications-that-use-system-deployment-application.md)
