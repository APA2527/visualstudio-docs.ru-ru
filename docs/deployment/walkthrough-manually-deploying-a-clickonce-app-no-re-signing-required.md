---
title: Развертывание ClickOnce вручную приложений, сохраняя фирменной символики
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
helpviewer_keywords:
- branding
- preserved branding information
- ClickOnce deployment, manually
- multiple ClickOnce deployment and branding
- ClickOnce deployment, SDK tools
- customer deployments
- manual ClickOnce deployments
- manifests [ClickOnce]
- ClickOnce applications, deployed by others
ms.assetid: c21822fb-d4ee-42e4-b72d-41ee9786efe5
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 47db202d07fd88bfb5e922964caf2cdd5008c6fd
ms.sourcegitcommit: 117ece52507e86c957a5fd4f28d48a0057e1f581
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/28/2019
ms.locfileid: "66263425"
---
# <a name="walkthrough-manually-deploy-a-clickonce-application-that-does-not-require-re-signing-and-that-preserves-branding-information"></a>Пошаговое руководство. Развертывание вручную приложения ClickOnce, которое не нуждается в повторном подписывании и сохраняет фирменную символику
При создании [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложения и присвоить ей клиенту для публикации и развертывания, клиент традиционно должен был обновить манифест развертывания и подписать его заново. Несмотря на то что, по-прежнему рекомендуется в большинстве случаев платформа .NET Framework 3.5 позволяет создавать [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] развертываний, которые могут развертываться клиентами без необходимости повторного создания новый манифест развертывания. Дополнительные сведения см. в разделе [развертывание ClickOnce-приложений для тестирования и рабочих серверов без повторного подписывания](../deployment/deploying-clickonce-applications-for-testing-and-production-without-resigning.md).

 При создании [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложения и присвоить ей клиенту для публикации и развертывания, приложение может использовать торговую марку клиента или сохранять фирменной символики. Например если приложение является одиночным фирменным приложением, может потребоваться сохранить фирменной символики. Если приложение сильно измененными для каждого клиента, может потребоваться использовать фирменную символику клиента. .NET Framework 3.5 позволяет сохранять фирменной символики, сведения об издателе и подпись безопасности при передаче приложения для развертывания в организации. Дополнительные сведения см. в разделе [создать ClickOnce-приложений для других пользователей для развертывания](../deployment/creating-clickonce-applications-for-others-to-deploy.md).

> [!NOTE]
> В этом пошаговом руководстве создаются развертывания вручную с помощью средства командной строки *Mage.exe* или графического средства *MageUI.exe*. Дополнительные сведения о развертывании вручную см. в разделе [Пошаговое руководство: Развертывание вручную приложения ClickOnce](../deployment/walkthrough-manually-deploying-a-clickonce-application.md).

## <a name="prerequisites"></a>Предварительные требования
 Для выполнения шагов в этом пошаговом руководстве вам потребуется следующее:

- Приложение Windows Forms, которое вы готовы к развертыванию. Это приложение будет называться *WindowsFormsApp1*.

- Visual Studio или Windows SDK.

### <a name="to-deploy-a-clickonce-application-with-multiple-deployment-and-branding-support-using-mageexe"></a>Развертывание ClickOnce-приложения с поддержкой фирменной настройки, с помощью Mage.exe нескольких развертываний и

1. Откройте командную строку Visual Studio или [!INCLUDE[winsdkshort](../debugger/debug-interface-access/includes/winsdkshort_md.md)] командную строку и перейдите в каталог, в котором будут храниться ваши [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] файлов.

2. Создайте каталог с именем текущей версии развертывания. Если это первый раз, что вы развертываете приложение, скорее всего будет выбрана **1.0.0.0**.

   > [!NOTE]
   > Версия развертывания может отличаться от версии файлов приложения.

3. Создайте подкаталог с именем **bin** и скопируйте все файлы приложения, включая исполняемые файлы, сборки, ресурсы и файлы данных.

4. Создайте манифест приложения с помощью вызова Mage.exe.

   ```cmd
   mage -New Application -ToFile 1.0.0.0\WindowsFormsApp1.exe.manifest -Name "Windows Forms App 1" -Version 1.0.0.0 -FromDirectory 1.0.0.0\bin -UseManifestForTrust true -Publisher "A. Datum Corporation"
   ```

5. Подписать манифест приложения с помощью цифрового сертификата.

   ```cmd
   mage -Sign WindowsFormsApp1.exe.manifest -CertFile mycert.pfx
   ```

6. Создайте манифест развертывания с помощью вызова *Mage.exe*. По умолчанию *Mage.exe* пометит вашей [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] развертывания как установленное приложение, так что он может выполняться как в интерактивном и автономном режиме. Чтобы сделать приложение доступным только в том случае, если пользователь находится в сети, используйте `-i` аргумент со значением `f`. Так как это приложение будет воспользоваться преимуществами нескольких функция развертывания, исключить `-providerUrl` аргумент *Mage.exe*. (В версиях платформы .NET Framework версии 3.5, за исключением `-providerUrl` для автономного приложения приводит к ошибке.)

   ```cmd
   mage -New Deployment -ToFile WindowsFormsApp1.application -Name "Windows Forms App 1" -Version 1.0.0.0 -AppManifest 1.0.0.0\WindowsFormsApp1.manifest
   ```

7. Не подписать манифест развертывания.

8. Укажите все файлы для клиента, который будет развертывать приложение в своей сети.

9. На этом этапе клиент должен подписать манифест развертывания свой собственный самостоятельно сформированный сертификат. Например, если клиент работает в компании под названием Adventure Works, он может создать самозаверяющий сертификат с помощью *MakeCert.exe* средство. Затем используйте *Pvk2pfx.exe* , которая позволяет объединить файлы, созданные программой *MakeCert.exe* в PFX-файл, который может быть передан в *Mage.exe*.

    ```cmd
    makecert -r -pe -n "CN=Adventure Works" -sv MyCert.pvk MyCert.cer
    pvk2pfx.exe -pvk MyCert.pvk -spc MyCert.cer -pfx MyCert.pfx
    ```

10. Затем клиент использует этот сертификат для подписания манифеста развертывания.

    ```cmd
    mage -Sign WindowsFormsApp1.application -CertFile MyCert.pfx
    ```

11. Клиент развертывает приложения на своих пользователей.

### <a name="to-deploy-a-clickonce-application-with-multiple-deployment-and-branding-support-using-mageuiexe"></a>Для развертывания приложения ClickOnce с несколькими развертывания и поддержки фирменной настройки, с помощью MageUI.exe

1. Откройте командную строку Visual Studio или [!INCLUDE[winsdkshort](../debugger/debug-interface-access/includes/winsdkshort_md.md)] командную строку и перейдите в каталог, в котором будут храниться ваши [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] файлов.

2. Создайте подкаталог с именем **bin** и скопируйте все файлы приложения, включая исполняемые файлы, сборки, ресурсы и файлы данных.

3. Создайте подкаталог с именем текущей версии развертывания. Если это первый раз, что вы развертываете приложение, скорее всего будет выбрана **1.0.0.0**.

   > [!NOTE]
   > Версия развертывания может отличаться от версии файлов приложения.

4. Переместить \\ **bin** каталог в каталог, созданный на шаге 2.

5. Запустите средство графического *MageUI.exe*.

   ```cmd
   MageUI.exe
   ```

6. Создайте новый манифест приложения, выбрав **файл**, **New**, **манифест приложения** в меню.

7. По умолчанию **имя** введите имя и номер версии данного развертывания. Также укажите значение для **издателя**, который будет использоваться как имя папки для ссылки на ярлык приложения в меню "Пуск" при его развертывании.

8. Выберите **параметры приложения** вкладку и нажмите кнопку **использовать манифест приложения для доверенной информации**. Это позволит сторонних фирменная символика для данного [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложения.

9. Выберите **файлы** вкладку и нажмите кнопку **Обзор** рядом с пунктом **каталога приложения** текстовое поле.

10. Выберите каталог, содержащий файлы приложения, созданные на шаге 2 и нажмите кнопку **ОК** в диалоговом окне выбора папки.

11. Нажмите кнопку **заполнить** кнопку, чтобы добавить все файлы приложения в список файлов. Если приложение содержит более одного исполняемого файла, пометьте главный исполняемый файл для этого развертывания в качестве запускаемого приложения, выбрав **точки входа** из **тип файла** стрелку раскрывающегося списка. (Если приложение содержит только один исполняемый файл, *MageUI.exe* пометит его автоматически.)

12. Выберите **разрешения, необходимые** и выберите уровень доверия, необходимые приложению. По умолчанию используется **полного доверия**, который будет отображаться подходит для большинства приложений.

13. Выберите **файл**, **Сохранить** из меню и сохраните манифест приложения. Вам будет предложено подписать манифест приложения при его сохранении.

14. При наличии сертификата, хранящегося в виде файла в файловой системе, используйте **знак, что файл сертификата** и выберите сертификат из файловой системы, используя кнопку с многоточием ( **...** ) кнопку.

     -или-

     Если сертификат хранится в хранилище сертификатов, доступную с вашего компьютера, выберите **входа хранимым сертификатом**и выберите сертификат из предоставленного списка.

15. Выберите **файл**, **New**, **манифест развертывания** меню, чтобы создать манифест развертывания, а затем на **имя** вкладке, предоставить имя и номер версии (**1.0.0.0** в этом примере).

16. Переключиться в режим **обновление** и укажите частоту обновления приложения. Если приложение использует [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] API развертывания для проверки наличия обновлений, снимите флажок **это приложение должно проверять наличие обновлений**.

17. Переключиться в режим **ссылка приложения** вкладки. Можно предварительно заполнить все значения на этой вкладке, нажав кнопку **выбрать манифест** кнопки и выборе манифеста приложения, созданного на предыдущих шагах.

18. Выберите **Сохранить** и сохраните манифест развертывания на диск. Вам будет предложено подписать манифест приложения при его сохранении. Нажмите кнопку **отменить** сохранить манифест без подписи.

19. Предоставьте все файлы приложения клиенту.

20. На этом этапе клиент должен подписать манифест развертывания свой собственный самостоятельно сформированный сертификат. Например, если клиент работает в компании под названием Adventure Works, он может создать самозаверяющий сертификат с помощью *MakeCert.exe* средство. Затем используйте *Pvk2pfx.exe* , которая позволяет объединить файлы, созданные программой *MakeCert.exe* в PFX-файл, который может быть передан в *MageUI.exe*.

    ```cmd
    makecert -r -pe -n "CN=Adventure Works" -sv MyCert.pvk MyCert.cer
    pvk2pfx.exe -pvk MyCert.pvk -spc MyCert.cer -pfx MyCert.pfx
    ```

21. С помощью созданный сертификат, клиент теперь подписывает манифест развертывания путем открытия манифеста развертывания в *MageUI.exe*, а затем сохраните его. Когда появится диалоговое окно подписания, клиент выбирает **знак, что файл сертификата** , а затем выбирает PFX-файл, сохраненный на диске.

22. Клиент развертывает приложения на своих пользователей.

## <a name="see-also"></a>См. также
- [Mage.exe (средство создания и редактирования манифеста)](/dotnet/framework/tools/mage-exe-manifest-generation-and-editing-tool)
- [MageUI.exe (средство создания и редактирования манифестов, графический клиент)](/dotnet/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client)
- [MakeCert](/windows/desktop/SecCrypto/makecert)
