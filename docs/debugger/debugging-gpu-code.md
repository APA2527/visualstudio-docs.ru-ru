---
title: Отладка кода GPU | Документация Майкрософт
description: Сведения об отладке кода на C++, который выполняется в графическом процессоре (GPU), в Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- CSharp
- VB
- FSharp
- C++
ms.assetid: c7e77a5a-cb57-4b11-9187-ecc89acc8775
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 19191d8d46e17da52b13f692db605168b06b38d9
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99872681"
---
# <a name="debugging-gpu-code"></a>Отладка кода GPU
Можно выполнять отладку кода C++, который выполняется в графическом процессоре (GPU). Поддержка отладки GPU в Visual Studio включает обнаружение состояния гонки, запуск процессов и присоединение к ним, а также интеграцию с окнами отладчика.

## <a name="supported-platforms"></a>Поддерживаемые платформы
 Отладка поддерживается в [!INCLUDE[win7](../debugger/includes/win7_md.md)], [!INCLUDE[win8](../debugger/includes/win8_md.md)], Windows 10, [!INCLUDE[winsvr08_r2](../debugger/includes/winsvr08_r2_md.md)], [!INCLUDE[winserver8](../debugger/includes/winserver8_md.md)] и Windows Server 2016. Для отладки в программном эмуляторе требуется [!INCLUDE[win8](../debugger/includes/win8_md.md)], Windows 10, [!INCLUDE[winserver8](../debugger/includes/winserver8_md.md)] или Windows Server 2016. Для отладки на оборудовании необходимо установить драйверы для видеокарты. Не все производители оборудования реализуют полный набор функций для отладки. См. информацию об ограничениях в документации производителя.

> [!NOTE]
> Независимые производители оборудования, желающие реализовать поддержку отладки GPU в Visual Studio, должны создать библиотеку DLL, реализующую интерфейс VSD3DDebug для взаимодействия с драйверами производителей.

## <a name="configuring-gpu-debugging"></a>Настройка отладки GPU
 Отладчик не может прерывать выполнение одновременно кода ЦП и кода GPU при работе одного приложения. По умолчанию отладчик прерывает выполнение кода ЦП. Для отладки кода GPU следует выполнить одно из указанных ниже действий.

- В списке **Тип отладки** панели инструментов **Стандартная** выберите **Только GPU**.

- Откройте контекстное меню для своего проекта в области **Обозреватель решений** и выберите **Свойства**. В диалоговом окне **Страницы свойств** выберите **Отладка**, после чего выберите **Только GPU** в списке **Тип отладчика**.

## <a name="launching-and-attaching-to-applications"></a>Запуск приложений и присоединение к ним
 Для запуска и остановки отладки GPU можно использовать команды отладки Visual Studio. Дополнительные сведения см. в статье [Навигация по коду с помощью отладчика](../debugger/navigating-through-code-with-the-debugger.md). Можно также присоединить отладчик GPU к выполняющемуся процессу, но лишь при условии, что этот процесс выполняет код GPU. Дополнительные сведения см. в статье [Присоединение к выполняемым процессам](../debugger/attach-to-running-processes-with-the-visual-studio-debugger.md).

## <a name="run-current-tile-to-cursor-and-run-to-cursor"></a>Команды "Выполнить текущий Tile до курсора" и "Выполнить до текущей позиции"
 При отладке кода GPU существуют два варианта выполнения кода до текущего положения курсора. Команды для обоих вариантов доступны в контекстном меню редактора кода.

1. По команде **Выполнить до текущей позиции** приложение выполняется до достижения текущей позиции курсора, после чего выполнение приостанавливается. Это не означает, что текущий поток будет выполнен до позиции курсора. Инициировать приостановку выполнения может любой поток, который первым достигнет текущего положения курсора. См. статью [Навигация по коду с помощью отладчика](../debugger/navigating-through-code-with-the-debugger.md).

2. По команде **Выполнить текущий блок до курсора** приложение выполняется до тех пор, пока все потоки в текущем блоке потоков (tile) не достигнут курсора, после чего выполнение приостанавливается.

## <a name="debugging-windows"></a>Окна отладки
 С помощью некоторых окон отладки можно просматривать, помечать и замораживать потоки GPU. Дополнительные сведения можно найти в разделе

- [Использование окна "Параллельные стеки"](../debugger/using-the-parallel-stacks-window.md)

- [Использование окна задач](../debugger/using-the-tasks-window.md)

- [Практическое руководство. Использование окна контроля параллельных данных](../debugger/how-to-use-the-parallel-watch-window.md)

- [Отладка потоков и процессов](../debugger/debug-threads-and-processes.md) (панель инструментов "Место отладки")

- [Практическое руководство. использование окна потоков GPU](../debugger/how-to-use-the-gpu-threads-window.md)

## <a name="data-synchronization-exceptions"></a>Исключения синхронизации данных
 Отладчик может распознавать несколько условий синхронизации данных во время выполнения. При обнаружении условия отладчик переходит в состояние приостановки выполнения. На выбор предлагаются два варианта действий: **Прервать** или **Продолжить**. В диалоговом окне **Исключения** предусмотрены параметры, с помощью которых можно указать, должен ли отладчик распознавать эти условия и при каких из этих условий он должен прерывать выполнение. Дополнительные сведения см. в статье [Управление исключениями с помощью отладчика](../debugger/managing-exceptions-with-the-debugger.md). В диалоговом окне **Параметры** также есть возможность указать, что отладчик должен игнорировать исключения, если записываемые данные не изменяют значения данных. Для получения дополнительной информации см. [General, Debugging, Options Dialog Box](../debugger/general-debugging-options-dialog-box.md).

## <a name="troubleshooting"></a>Устранение неполадок

### <a name="specifying-an-accelerator"></a>Определение ускорителя
 Точки останова в коде GPU распознаются, только если код выполняется на ускорителе [accelerator::direct3d_ref](/cpp/parallel/amp/reference/accelerator-class#direct3d_ref) (REF). Если ускоритель в коде не указывается, в свойствах проекта в качестве значения **Тип ускорителя отладки** будет автоматически выбран ускоритель REF. Если ускоритель явным образом указывается непосредственно в коде, ускоритель REF во время отладки использоваться не будет и точки останова не будут распознаваться, если только поддержка отладки не предусмотрена в самом оборудовании GPU. Выходом из этой ситуации может быть создание собственного кода, который будет использовать ускоритель REF во время отладки. Дополнительные сведения см. в свойствах проекта, а также статьях [Использование объектов accelerator и accelerator_view](/cpp/parallel/amp/using-accelerator-and-accelerator-view-objects) и [Параметры проекта для конфигурации отладки C++](../debugger/project-settings-for-a-cpp-debug-configuration.md).

### <a name="conditional-breakpoints"></a>Условные точки останова
 Условные точки останова в коде GPU поддерживаются, но не каждое выражение может быть вычислено на устройстве. Если выражение не может быть вычислено на устройстве, оно вычисляется в отладчике. Отладчик, вероятно, работает медленнее, чем устройство.

### <a name="error-there-is-a-configuration-issue-with-the-selected-debugging-accelerator-type"></a>Ошибка: Возникла проблема конфигурации с выбранным типом акселератора отладки.
 Эта ошибка возникает, если значения параметров проекта не соответствуют конфигурации компьютера, на котором производится отладка. Дополнительные сведения см. в статье [Параметры проекта для конфигурации отладки C++](../debugger/project-settings-for-a-cpp-debug-configuration.md).

### <a name="error-the-debug-driver-for-the-selected-debugging-accelerator-type-is-not-installed-on-the-target-machine"></a>Ошибка: На целевом компьютере не установлен драйвер отладки для выбранного типа акселератора отладки.
 Эта ошибка происходит при отладке на удаленном ПК. Пока не будет начато выполнение, отладчик не может определить, установлены ли драйверы на удаленном ПК. Драйверы предоставляются производителем видеоадаптера.

### <a name="error-timeout-detection-and-recovery-tdr-must-be-disabled-at-the-remote-site"></a>Ошибка: На удаленном сайте необходимо отключить механизм обнаружения и исправления зависания во время ожидания (TDR).
 При выполнении вычислений C++ AMP существует вероятность превышения контрольного времени ожидания, установленного предусмотренным в Windows механизмом обнаружения и исправления зависаний (TDR). При возникновении этой ошибки вычисления прекращаются и данные утрачиваются. Дополнительные сведения см. в разделе [Обработка ошибок TDR в C++ AMP](/archive/blogs/nativeconcurrency/handling-tdrs-in-c-amp).

## <a name="see-also"></a>См. также
- [Пошаговое руководство: отладка приложения C++ AMP](/cpp/parallel/amp/walkthrough-debugging-a-cpp-amp-application)
- [Параметры проекта для конфигурации отладки C++](../debugger/project-settings-for-a-cpp-debug-configuration.md)
- [Запуск отладки GPU в Visual Studio](/archive/blogs/nativeconcurrency/start-gpu-debugging-in-visual-studio-2012)