---
title: Установка часов на переменных Документы Майкрософт
ms.custom: seodec18
ms.date: 10/11/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.watch
helpviewer_keywords:
- debugging [Visual Studio], Watch window
- expressions [debugger], evaluating
- variables [debugger], evaluating
- expression evaluation
- registers, evaluating
- debugging [Visual Studio], expression evaluation
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: ea3d2a1e82e92473859fef29754fbb831cf3685b
ms.sourcegitcommit: 95f26af1da51d4c83ae78adcb7372b32364d8a2b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79301017"
---
# <a name="watch-variables-with-watch-windows-and-quickwatch"></a>Смотреть переменные с окнами Смотреть и БыстрыйСмотреть

Во время отладки можно **использовать** watch Windows и **quickWatch** для просмотра переменных и выражений. Окна доступны только во время сеанса отладки.

**Окна watch** могут отображать несколько переменных одновременно при отладке. Диалог **«Быстрый час»** отображает одну переменную одновременно и должен быть закрыт до того, как отладка может продолжаться.

Если это первый раз, когда вы пытались отладить код, вы можете прочитать [отладка для абсолютных новичков](../debugger/debugging-absolute-beginners.md) и [методов и инструментов отладки,](../debugger/write-better-code-with-visual-studio.md) прежде чем перейти к этой статье.

## <a name="observe-variables-with-a-watch-window"></a>Наблюдайте переменные с окном Watch

Вы можете открыть несколько окон **Watch** и наблюдать за более чем одной переменной в окне **Watch.**

Например, установить часы на `a`значения, `b` `c` и в следующем коде:

```C++
int main()
{
    int a, b, c;
    a = 1;
    b = 2;
    c = 0;

    for (int i = 0; i < 10; i++)
    {
        a++;
        b *= 2;
        c = a + b;
    }

    return 0;
}

```

1. Установите точку `c = a + b;` разрыва на линии, нажав в левом краю, выбрав **Debug** > **Toggle Breakpoint**, или нажав **F9.**

1. Начните отладку, выбрав зеленую стрелку **Start** или **Debug** > **Start Debugging**или нажмите **F5.** Выполнение паузы в точке разрыва.

1. Откройте окно **Часов,** выбрав **Debug** > **Windows** > **Watch** > **1**или нажав на **Ctrl**+**Alt**+**W** > **1.**

   Вы можете открыть дополнительные окна **Смотреть,** выбрав окна **2,** **3,** или **4**.

1. В окне **Смотреть** выберите пустой `a`ряд и введите переменную. Сделайте то `b` `c`же самое для и .

   ![Смотреть переменные](../debugger/media/watchvariables.png "WatchVariables")

1. Продолжить отладку, выбрав **Отек** > **Шаг в** или нажав **F11** по мере необходимости для продвижения. Переменные значения в окне **Watch** меняются при `for` итератной обработке цикла.

>[!NOTE]
>Только для СЗ,
>- Возможно, потребуется квалифицировать контекст переменной имени или выражения, используюго переменное имя. Контекст — это функция, исходный файл или модуль, в котором находится переменная. Если необходимо квалифицировать контекст, используйте синтаксис [оператора контекста (СЗ)](../debugger/context-operator-cpp.md) в окне **«Имя** в **окне вахты».**
>
>- Вы можете добавить имена регистров и переменных имен, используя ** $ \<&nbsp;имя регистра>** или ** @ \<регистровое&nbsp;имя>** к **названию** в окне **Watch.** Для получения дополнительной информации см. [Pseudovariables](../debugger/pseudovariables.md).

## <a name="use-expressions-in-a-watch-window"></a>Используйте выражения в окне Watch

Вы можете наблюдать любое допустимое выражение, распознаемые отладчиком в окне **Watch.**

Например, для кода в предыдущем разделе можно получить среднее значение `(a + b + c) / 3` трех значений, введя в окне **Смотреть:**

![Смотреть выражение](../debugger/media/watchexpression.png "Смотреть выражение")

Правила оценки выражений в окне **Watch,** как правило, такие же, как и правила оценки выражений на языке кода. Если выражение имеет ошибку синтаксиса, ожидайте ту же ошибку компилятора, что и в редакторе кода. Например, опечатка в предыдущем выражении создает эту ошибку в окне **Смотреть:**

![Просмотр ошибки выражения](../debugger/media/watchexpressionerror.png "Просмотр ошибки выражения")

В окне **Watch** может появиться круг с иконой двух волнистых линий. Этот значок означает, что отладчик не оценивает выражение из-за потенциальной зависимости от перекрестного потока. Для оценки кода требуется временное запуск других потоков в приложении, но так как вы находитесь в режиме перерыва, все потоки в приложении обычно останавливаются. Разрешение временному запуску других потоков может иметь неожиданные последствия для состояния приложения, а отладчик может игнорировать такие события, как точки разрыва и исключения в этих потоках.

::: moniker range=">= vs-2019" 
## <a name="search-in-the-watch-window"></a>Поиск в окне Дозора

Вы можете искать ключевые слова в столбцах «Имя, значение» и «Введите» окна **Watch,** используя панель поиска над каждым окном. Хит ENTER или выберите одну из стрелок для выполнения поиска. Чтобы отменить текущий поиск, выберите значок "x" в панели поиска.

Используйте левую и правую стрелки (Shift-F3 и F3, соответственно) для навигации между найденными совпадениями.

![Поиск в окне смотреть](../debugger/media/ee-search-watch.png "Поиск в окне смотреть")

Чтобы сделать поиск более или менее тщательным, используйте **выпадение поиска в** верхней части окна **Watch,** чтобы выбрать, сколько уровней глубиной вы хотите искать в вложенных объектов. 

## <a name="pin-properties-in-the-watch-window"></a>Свойства контакта в окне Watch

>[!NOTE]
> Эта функция поддерживается в .NET Core 3.0 или выше.

Вы можете быстро проверять объекты по их свойствам в окне Watch с помощью инструмента **Pinnable Properties.**  Чтобы использовать этот инструмент, нависните над свойством и выберите значок контакта, который появляется или щелкните правой кнопкой мыши, и выберите элемент Пин в **качестве избранного** варианта в результирующем контекстном меню.  Это пузыри вверх, что свойство в верхней части списка свойств объекта, и имя свойства и значение отображается в столбце **Значение.**  Чтобы открепить свойство, выберите значок контакта снова или выберите **элемент Unpin в качестве избранного** варианта в контекстном меню.

![Свойства контакта в окне Watch](../debugger/media/basic-pin-watch.gif "Свойства контакта в окне Watch")

Вы также можете переключить имена свойств и отфильтровать незакрепленные свойства при просмотре списка свойств объекта в окне Watch.  Вы можете получить доступ к обоим опциям, выбрав кнопки в панели инструментов над окном часов.

::: moniker-end

### <a name="refresh-watch-values"></a><a name="bkmk_refreshWatch"></a>Обновить значения часов

Значок обновления (круговая стрелка) может отображаться в окне **Watch** при оценке выражения. Значок обновления указывает на ошибку или значение, которое устарело.

Чтобы обновить значение, выберите значок обновления или нажмите на пробел. Отладчик попытается пересчитать выражение. Однако вы можете не хотеть или быть в состоянии пересмотреть выражение, в зависимости от того, почему значение не было оценено.

Нависает над значком обновления или просмотрите столбец **Значение** по той причине, что выражение не было оценено. Некоторые из причин:

- Ошибка произошла при оценке выражения, как и в предыдущем примере. Возможно тайм-аут или переменная может быть вне сферы действия.

- Выражение имеет вызов функции, который может вызвать побочный эффект в приложении. Смотрите [побочные эффекты выражения](#bkmk_sideEffects).

- Автоматическая оценка свойств и неявных вызовов функции отключена.

Если значок обновления отображается из-за автоматической оценки свойств и неявных вызовов функций, вы можете включить ее, выбрав **оценку свойства Enable и другие неявные вызовы функций** в**Options** > **Общем**варианте**отладки** >  **инструментов.** > 

Чтобы продемонстрировать использование значка обновления:

1. В общих**опциях** > **General** > **«Инструменты** > Параметры» очистите **оценку свойств Включить и другие неявные вызовы функций.** **Tools**

1. Введите следующий код, и в окне `list.Count` **Смотреть,** установите часы на свойстве.

   ```csharp
   static void Main(string[] args)
   {
       List<string> list = new List<string>();
       list.Add("hello");
       list.Add("goodbye");
   }
   ```

1. Приступите к отладке. Окно **Watch** показывает что-то вроде следующего сообщения:

   ![Освежить часы](../debugger/media/refreshwatch.png "Освежить часы")

1. Чтобы обновить значение, выберите значок обновления или нажмите на пробел. Отладчик переоценивает выражение.

### <a name="expression-side-effects"></a><a name="bkmk_sideEffects"></a>Побочные эффекты выражения

Оценка некоторых выражений может изменить значение переменной или иным образом повлиять на состояние приложения. Например, вычисление следующего выражения изменяет значение `var1`:

```csharp
var1 = var2
```

Этот код может вызвать [побочный эффект.](https://en.wikipedia.org/wiki/Side_effect_\(computer_science\)) Побочные эффекты могут затруднить отладку, изменив способ работы приложения.

Выражение с побочными эффектами оценивается только один раз, когда вы впервые ввести его. После этого выражение появляется серым в окне **Смотреть,** и дальнейшие оценки отключены. В столбце tooltip или **Value** поясняется, что выражение вызывает побочный эффект. Можно принудить переоценку, выбрав значок обновления, который отображается рядом со значением.

Один из способов предотвращения обозначения побочных эффектов заключается в отключении автоматической оценки функций. В**General** **общих** > **опциях** >  > **параметры инструментов,** отменить выбор **оценки свойств и других неявных вызовов функций.**

Только для C-, когда оценка свойств или неявные вызовы функции выключены, можно принудить оценку, добавив модификатор формата **ac** к переменному **имени** в окне **Watch.** См. раздел [Определители формата C#](../debugger/format-specifiers-in-csharp.md).

## <a name="use-object-ids-in-the-watch-window-c-and-visual-basic"></a><a name="bkmk_objectIds"></a>Идентиматируйте объекты в окне Watch (C и Visual Basic)

Иногда требуется наблюдать за поведением конкретного объекта. Например, можно отследить объект, на который ссылается локальная переменная после того, как эта переменная вышла из сферы действия. В C# и Visual Basic можно создавать идентификаторы объектов для определенных экземпляров ссылочных типов и использовать их в окне **Контрольные значения** и условиях точек останова. Идентификатор объекта создается службами отладки среды CLR и связан с объектом.

> [!NOTE]
> Иик-ики объектов создают слабые ссылки, которые не препятствуют сбору мусора. Они действительны только в рамках текущего сеанса отладки.

В следующем коде `MakePerson()` метод `Person` создает локальную переменную:

```csharp
class Person
{
    public Person(string name)
    {
        Name = name;
    }
    public string Name { get; set; }
}

public class Program
{
    static List<Person> _people = new List<Person>();
    public static void Main(string[] args)
    {
        MakePerson();
        DoSomething();
    }

    private static void MakePerson()
    {
        var p = new Person("Bob");
        _people.Add(p);
    }

    private static void DoSomething()
    {
        // more processing
         Console.WriteLine("done");
    }
}
```

Чтобы `Person` узнать имя метода, `DoSomething()` можно добавить ссылку `Person` на идентификатор объекта в окне **Watch.**

1. Установите точку разрыва в `Person` коде после создания объекта.

1. Приступите к отладке.

1. При приостановке выполнения в точке разрыва откройте окно **Locals,** выбрав **Debug** > **Windows** > **Locals.**

1. В окне **Locals** щелкните `Person` переменной и выберите **Идентификатор объекта.**

   Вы должны увидеть знак**$** доллара () плюс номер в окне **locals,** который будет идентификатором предмета.

1. Добавьте идентификатор объекта в окно **Watch,** нажав правой кнопкой идентификатор объекта и выбрав **Добавить часы.**

1. Установите еще одну `DoSomething()` точку разрыва в методе.

1. Продолжайте отладку. При паузе выполнения `DoSomething()` в методе окно `Person` **Watch** отображает объект.

   > [!NOTE]
   > Если вы хотите видеть свойства объекта, `Person.Name`такие как, необходимо включить оценку свойств, выбрав **Tools** > **Параметры инструментов** > **отладки** > **общей** > **оценки свойств Enable и других неявных вызовов функций.**

## <a name="dynamic-view-and-the-watch-window"></a>Динамический вид и окно Смотреть

Некоторые языки сценариев (например, JavaScript или Python) используют динамические или [утиные](https://en.wikipedia.org/wiki/Duck_typing) ввода, а версия .NET 4.0 и позже поддерживает объекты, которые трудно наблюдать в обычных окнах отладки.

Окно **Watch** отображает эти объекты как динамические объекты, которые создаются из типов, реализующих <xref:System.Dynamic.IDynamicMetaObjectProvider> интерфейс. Динамические узлы объектов отображают динамические члены динамических объектов, но не позволяют редактировать значения участника.

Чтобы обновить значения **Dynamic View,** выберите [значок обновления](#bkmk_refreshWatch) рядом с динамическим узелом объекта.

Чтобы отобразить только **динамический вид** для объекта, добавьте динамический **dynamic** формат- иного элемента в окне **Watch:**

- Для C#: `ObjectName, dynamic`
- Для Visual Basic: `$dynamic, ObjectName`

>[!NOTE]
>- Отладчик C's не переоценивает значения в **динамическом представлении** при наступе на следующую строку кода.
>- Visual Basic debugger автоматически обновляет выражения, добавленные через **Dynamic View.**
>- Вычисление членов **динамического представления** может иметь [побочные эффекты](https://en.wikipedia.org/wiki/Side_effect_\(computer_science\)).

**Чтобы вставить новую переменную часов, которая отбрасывает объект к динамическому объекту:**

1. Нажмите правой кнопкой мыши любого ребенка **динамического представления**.
1. Выберите **Добавить Часы**. Становится `object.name` `((dynamic) object).name` и появляется в новом окне **Смотреть.**

Отладчик также добавляет в окно **Autos** узла для отваги **динамического представления** объекта. Чтобы открыть окно **Autos** во время отладки, выберите **Отображение** > **Windows** > **Autos.**

**Dynamic View** также улучшает отладку объектов COM. Когда отладчик попадает на объект COM, завернутый в **System.__ComObject,** он добавляет узло **Dynamic View** для объекта.

## <a name="observe-a-single-variable-or-expression-with-quickwatch"></a>Наблюдайте одну переменную или выражение с помощью quickWatch

Вы можете использовать **для** наблюдения за одной переменной.

Например, для следующего кода:

```csharp
static void Main(string[] args)
{
    int a, b;
    a = 1;
    b = 2;
    for (int i = 0; i < 10; i++)
    {
        a = a + b;
    }
}
```

Чтобы наблюдать `a` переменную,

1. Установите точку останова на строке `a = a + b;` .

1. Приступите к отладке. Выполнение паузы в точке разрыва.

1. Выберите `a` переменную в коде.

1. Выберите **Debug** > **БыстрыйСмотреть**, Нажмите **Shift**+**F9**, или правой кнопкой мыши и выберите **БыстрыйСмотреть**.

   Появляется диалог **«Быстрый смотреть».** Переменная `a` находится в поле **выражения** со **значением** **1**.

   ![Переменная часы быстрого просмотра](../debugger/media/quickwatchvariable.png "Переменная часы быстрого просмотра")

1. Чтобы оценить выражение с помощью переменной, введите выражение, например `a + b` в поле **выражения,** и выберите **Reevaluate.**

   ![Выражение быстрого просмотра](../debugger/media/quickwatchexpression.png "Выражение быстрого просмотра")

1. Чтобы добавить переменную или выражение из **«Быстрый смотреть»** в окно **Watch,** выберите **Добавить часы.**

1. Выберите **Близко,** чтобы закрыть окно **быстрый смотреть.** (**Быстрый час** является модальным диалогом, так что вы не можете продолжать отладку до тех пор, пока она открыта.)

1. Продолжайте отладку. Вы можете наблюдать переменную в окне **Watch.**

## <a name="see-also"></a>См. также раздел
- [Что такое отладка?](../debugger/what-is-debugging.md)
- [Методы и инструменты отладки](../debugger/write-better-code-with-visual-studio.md)
- [Первый взгляд на отладку](../debugger/debugger-feature-tour.md)
- [Окна debugger](../debugger/debugger-windows.md)
