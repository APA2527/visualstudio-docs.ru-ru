---
title: Установка контрольных значений для переменных | Документация Майкрософт
ms.custom: seodec18
ms.date: 10/11/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.watch
helpviewer_keywords:
- debugging [Visual Studio], Watch window
- expressions [debugger], evaluating
- variables [debugger], evaluating
- expression evaluation
- registers, evaluating
- debugging [Visual Studio], expression evaluation
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: d8cd119ab39939de6562adcb962679874d528283
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62929361"
---
# <a name="watch-variables-with-watch-windows-and-quickwatch"></a>Наблюдать за переменными с помощью окна контрольных значений и "Быстрая проверка"

Во время отладки, можно использовать **Watch** windows и **"Быстрая проверка"** для просмотра значений переменных и выражений. Windows доступны только во время сеанса отладки.

**Контрольные значения** windows может выводиться несколько переменных во время во время отладки. **"Быстрая проверка"** диалоговое окно отображает одну переменную в момент времени и должны быть закрыты перед продолжением отладки.

Если это в первый раз, которое вы пытались пройти отлаживать код, вы можете прочитать [отладки для начинающих](../debugger/debugging-absolute-beginners.md) и [методик и средств отладки](../debugger/write-better-code-with-visual-studio.md) прежде чем приступить к этой статье.

## <a name="observe-variables-with-a-watch-window"></a>Наблюдать за переменными в окне контрольных значений

Можно открыть несколько **Watch** окно и обратите внимание на более чем одна переменная в **Контрольные значения** окна.

Например, чтобы установка контрольных значений по значениям `a`, `b`, и `c` в следующем коде:

```C++
int main()
{
    int a, b, c;
    a = 1;
    b = 2;
    c = 0;

    for (int i = 0; i < 10; i++)
    {
        a++;
        b *= 2;
        c = a + b;
    }

    return 0;
}

```

1. Установите точку останова на `c = a + b;` строки, щелкнув в левом поле, выбрав **Отладка** > **точка останова**, или нажав клавиши **F9**.

1. Начать отладку, выбрав зеленый **запустить** стрелку или **Отладка** > **начать отладку**, или нажмите клавишу **F5**. Выполнение приостанавливается в точке останова.

1. Откройте **Watch** окно, выбрав **Отладка** > **Windows** > **Watch**  >   **Контрольное значение 1**, или нажав клавиши **Ctrl**+**Alt**+**W** > **1**.

   Вы можете открыть дополнительные **Watch** windows, выбрав windows **2**, **3**, или **4**.

1. В **Watch** окно, выберите пустую строку и переменной типа `a`. Сделайте то же самое `b` и `c`.

   ![Наблюдать за переменными](../debugger/media/watchvariables.png "WatchVariables")

1. Продолжить отладку, выбрав **Отладка** > **шаг с заходом** или нажав клавиши **F11** при необходимости для перехода. В значениях переменных в **Watch** окно изменения при просмотре `for` цикла.

>[!NOTE]
>Для C++
>- Может потребоваться уточнить контекст имени переменной или выражение, содержащее имя переменной. Контекст — это функция, исходный файл или модуль, где находится переменная. Если вам нужно определить контекст, используйте [(C++) с помощью оператора контекста](../debugger/context-operator-cpp.md) синтаксис в **имя** в **Контрольные значения** окна.
>
>- Можно добавлять имена регистров и имена переменных с помощью  **$ \<зарегистрировать&nbsp;имя >** или  **@ \<зарегистрировать&nbsp;имя >** для **имя** в **Watch** окна. Для получения дополнительной информации см. [Pseudovariables](../debugger/pseudovariables.md).

## <a name="use-expressions-in-a-watch-window"></a>Использование выражений в окне контрольных значений

Вы можете наблюдать за любое допустимое выражение, которое распознает отладчик в **Watch** окна.

Например, для кода в предыдущем разделе, среднее трех значений можно получить, введя `(a + b + c) / 3` в **Watch** окна:

![Посмотреть выражение](../debugger/media/watchexpression.png "посмотреть выражение")

Правила вычисления выражений в **Watch** окно чаще всего это так же, как правила вычисления выражений в язык кода. Если выражение содержит синтаксическую ошибку, ожидается, что та же ошибка компилятора, как и в редакторе кода. Например, опечатка в предыдущем выражении создает эту ошибку в **Watch** окна:

![Просмотрите ошибки выражение](../debugger/media/watchexpressionerror.png "смотреть ошибка в выражении")

Кружок с двумя волнистыми линиями значок должен присутствовать во **Watch** окна. Этот значок означает, что отладчик не вычисляет выражение, из-за потенциальных зависимостей между потоками. Для вычисления коду требуется других потоков в приложении временного запуска, но так как вы находитесь в режиме приостановки выполнения, обычно останавливаются все потоки в приложении. Разрешение временного запуска других потоков может иметь непредвиденные эффекты на состояние приложения и отладчик может игнорировать события, такие как точки останова и исключения в этих потоках.

::: moniker range=">= vs-2019" 
## <a name="search-in-the-watch-window"></a>Поиск в окне контрольных значений

Можно выполнить поиск ключевых слов в имя, значение и тип столбцов **Watch** окна с помощью панели поиска выше каждое окно. Нажмите клавишу ВВОД или выберите одну из стрелок, чтобы выполнить поиск. Чтобы отменить производится поиск, выберите значок «x» в строке поиска.

Используйте кнопки со стрелками влево и вправо (Shift + F3 и F3, соответственно) для перехода между найдено совпадений.

![Поиск в окно контрольных значений](../debugger/media/ee-search-watch.png "поиска в окно контрольных значений")

Чтобы сделать поиск более или менее тщательной используйте **глубокого поиска** раскрывающийся список в верхней части **Watch** окно для выбора число уровней вложенности, который необходимо найти в вложенные объекты. 

::: moniker-end

### <a name="bkmk_refreshWatch"></a> Обновление просматриваемых значений

Значок обновления (круговой стрелки) могут отображаться в **Watch** окно при вычислении выражения. Значок обновления указывает ошибку или значение, устарела.

Чтобы обновить значение, щелкните значок обновления, или нажмите клавишу ПРОБЕЛ. Отладчик попытается пересчитать выражение. Тем не менее может не требуется или иметь возможность пересчитать выражение, в зависимости от того, почему не было вычислено значение.

Наведите указатель мыши на значок обновления или см. в разделе **значение** столбца по той причине, выражение не было вычислено. Причины.

- Возникла ошибка при вычислении выражения, как показано в предыдущем примере. Могут возникнуть, времени ожидания, или переменная может быть за пределы области действия.

- Выражение содержит вызов функции, которая может вызвать побочный эффект в приложении. См. в разделе [выражения побочных эффектов](#bkmk_sideEffects).

- Автоматическое вычисление свойств и неявные вызовы функций отключены.

Если значок обновления отображается из-за отключения автоматического вычисления свойств и неявные вызовы функций, вы можете включить, выбрав **включить вычисление свойств и другие неявные вызовы функций** в **средства**   >  **Параметры** > **отладки** > **Общие**.

Чтобы продемонстрировать с помощью значка "Обновить":

1. В **средства** > **параметры** > **Отладка** > **Общие**, снимите **Включить вычисление свойств и другие неявные вызовы функций** "флажок".

1. Введите следующий код и в **Watch** окне настройте Контрольное `list.Count` свойство.

   ```csharp
   static void Main(string[] args)
   {
       List<string> list = new List<string>();
       list.Add("hello");
       list.Add("goodbye");
   }
   ```

1. Приступите к отладке. **Watch** окне отображается примерно следующее сообщение:

   ![Обновить Watch](../debugger/media/refreshwatch.png "обновление контрольных значений")

1. Чтобы обновить значение, щелкните значок обновления, или нажмите клавишу ПРОБЕЛ. Отладчик выполняет повторное вычисление выражения.

### <a name="bkmk_sideEffects"></a> Выражение побочные эффекты

Вычисление некоторых выражений можно изменить значение переменной или иным способом повлиять на состояние приложения. Например, вычисление следующего выражения изменяет значение `var1`:

```csharp
var1 = var2
```

Этот код может привести к [побочный эффект](https://en.wikipedia.org/wiki/Side_effect_\(computer_science\)). Побочные эффекты могут затруднить отладки путем изменения способа работы приложения.

Выражения с побочными эффектами вычисляется только один раз, при первом его вводе. После этого содержится это выражение затененный в **Watch** окна и дальнейшей оценки отключены. Подсказка или **значение** статья объясняет, что выражение вызывает побочные эффекты. Можно принудительно повторного вычисления, выбрав значок обновления, которое отображается рядом со значением.

Один из способов предотвращения обозначение побочных эффектов — отключить автоматическое вычисление функций. В **средства** > **параметры** > **Отладка** > **Общие**, отмените выбор **Включить вычисление свойств и другие неявные вызовы функций**.

Для C# только, если вычисление свойств и неявных вызовов функций отключено, можно принудительно вычислить выражение, добавив **ac** модификатора формата переменной **имя** в **контрольных значений**  окно. См. раздел [Определители формата C#](../debugger/format-specifiers-in-csharp.md).

## <a name="bkmk_objectIds"></a> Использование идентификаторов объектов в окне контрольных значений (C# и Visual Basic)

Иногда необходимо наблюдать за поведением определенного объекта. Например может потребоваться отслеживать объект, на который ссылается локальная переменная после эта переменная вышла за пределы области действия. В C# и Visual Basic можно создавать идентификаторы объектов для определенных экземпляров ссылочных типов и использовать их в окне **Контрольные значения** и условиях точек останова. Идентификатор объекта создается службами отладки среды CLR и связан с объектом.

> [!NOTE]
> Идентификаторы объектов создают слабые ссылки, которые не препятствуют объект от сборщика мусора. Они действительны только в рамках текущего сеанса отладки.

В следующем коде `MakePerson()` метод создает `Person` использование локальной переменной:

```csharp
class Person
{
    public Person(string name)
    {
        Name = name;
    }
    public string Name { get; set; }
}

public class Program
{
    static List<Person> _people = new List<Person>();
    public static void Main(string[] args)
    {
        MakePerson();
        DoSomething();
    }

    private static void MakePerson()
    {
        var p = new Person("Bob");
        _people.Add(p);
    }

    private static void DoSomething()
    {
        // more processing
         Console.WriteLine("done");
    }
}
```

Чтобы узнать имя `Person` в `DoSomething()` метод, можно добавить ссылку на `Person` идентификатор объекта в **Watch** окна.

1. Установите точку останова в коде после `Person` объект был создан.

1. Приступите к отладке.

1. Когда выполнение приостанавливается в точке останова, откройте **"Локальные"** окно, выбрав **Отладка** > **Windows** > **"Локальные"**.

1. В **"Локальные"** окно, щелкните правой кнопкой мыши `Person` переменных и выберите **создать идентификатор объекта**.

   Вы должны увидеть знак доллара (**$**) плюс количество в **"Локальные"** окно, в котором идентификатор объекта.

1. Добавьте идентификатор объекта для **Watch** окно, щелкните правой кнопкой мыши идентификатор объекта и выбрав **Добавить контрольное значение**.

1. Установить еще одну точку останова `DoSomething()` метод.

1. Продолжайте отладку. Когда выполнение приостанавливается в `DoSomething()` метод, **Watch** окно отображает `Person` объекта.

   > [!NOTE]
   > Если вы хотите увидеть свойства объекта, например `Person.Name`, необходимо включить вычисление свойств, выбрав **средства** > **параметры**  >   **Отладка** > **Общие** > **включить вычисление свойств и другие неявные вызовы функций**.

## <a name="dynamic-view-and-the-watch-window"></a>Динамическое представление и окно контрольных значений

Некоторых скриптовых языках (например, JavaScript или Python) используется динамическая или [по признакам](https://en.wikipedia.org/wiki/Duck_typing) типизацию и .NET 4.0 и более поздних версий поддерживает объекты, которые трудно наблюдать в обычных окон отладки.

**Watch** окно отображает эти объекты в виде динамических объектов, которые создаются из типов, реализующих <xref:System.Dynamic.IDynamicMetaObjectProvider> интерфейс. Динамический объект узлы Показать динамические члены динамических объектов, но не разрешать редактирования значений членов.

Чтобы обновить **динамическое представление** значения, выберите [значка "Обновить"](#bkmk_refreshWatch) рядом с узлом динамический объект.

Для отображения только **динамическое представление** для объекта, добавьте **динамического** описатель формата после имени динамический объект в **Watch** окна:

- Для C#: `ObjectName, dynamic`
- Для Visual Basic: `$dynamic, ObjectName`

>[!NOTE]
>- C# Отладчик автоматически не пересчитывает значения в **динамическое представление** при переходе на следующую строку кода.
>- Отладчик Visual Basic автоматически обновляет выражения, добавляемые с помощью **динамическое представление**.
>- Вычисление членов **динамического представления** может иметь [побочные эффекты](https://en.wikipedia.org/wiki/Side_effect_\(computer_science\)).

**Для вставки нового контрольного значения переменных, приводит объект к динамическому объекту:**

1. Щелкните правой кнопкой мыши любой дочерний **динамическое представление**.
1. Выберите **Добавить контрольное значение**. `object.name` Становится `((dynamic) object).name` и откроется в новом **Watch** окна.

Кроме того, отладчик добавляет **динамическое представление** дочерний узел объекта **"Видимые"** окна. Чтобы открыть **"Видимые"** окне во время отладки, выберите **Отладка** > **Windows** > **"Видимые"**.

**Динамическое представление** также расширяет возможности отладки для COM-объектов. Когда отладчик переходит к COM-объект в оболочку **System.__ComObject**, он добавляет **динамическое представление** узел для объекта.

## <a name="observe-a-single-variable-or-expression-with-quickwatch"></a>Наблюдать за одной переменной или выражения с "Быстрая проверка"

Можно использовать **"Быстрая проверка"** для наблюдения за одной переменной.

Например, следующий код:

```csharp
static void Main(string[] args)
{
    int a, b;
    a = 1;
    b = 2;
    for (int i = 0; i < 10; i++)
    {
        a = a + b;
    }
}
```

Чтобы наблюдать за `a` переменной,

1. Установите точку останова на строке `a = a + b;` .

1. Приступите к отладке. Выполнение приостанавливается в точке останова.

1. Выберите переменную `a` в коде.

1. Выберите **Отладка** > **"Быстрая проверка"**, нажмите клавишу **Shift**+**F9**, или щелкните правой кнопкой мыши и выберите **"Быстрая проверка"**.

   **"Быстрая проверка"** откроется диалоговое окно. `a` Переменная находится в **выражение** поле с **значение** из **1**.

   ![Переменная "Быстрая проверка"](../debugger/media/quickwatchvariable.png "переменной \"Быстрая проверка\"")

1. Чтобы оценить выражение, с помощью переменной, введите выражение, например `a + b` в **выражение** выберите **пересчитать**.

   ![Выражение "Быстрая проверка"](../debugger/media/quickwatchexpression.png "выражения быстрой проверки")

1. Чтобы добавить переменную или выражение из **"Быстрая проверка"** для **Watch** выберите **Добавить контрольное значение**.

1. Выберите **закрыть** закрыть **"Быстрая проверка"** окна. (**"Быстрая проверка"** является модальным диалоговым окном, поэтому вы не можете продолжать отладку, пока он открыт.)

1. Продолжайте отладку. Вы можете наблюдать за переменной в **Watch** окна.

## <a name="see-also"></a>См. также
- [Что такое отладка?](../debugger/what-is-debugging.md)
- [Методы и инструменты отладки](../debugger/write-better-code-with-visual-studio.md)
- [Сначала посмотрим, отладка](../debugger/debugger-feature-tour.md)
- [Окна отладчика](../debugger/debugger-windows.md)
