---
title: Поддерживаемые изменения кода (C++) | Документация Майкрософт
description: Сведения о том, какие изменения кода поддерживаются при использовании функции "Изменить и продолжить" при отладке проекта на C++ в Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 02/18/2020
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- Edit and Continue, limitations
- supported code changes
- object files, limitations of Edit and Continue
- C++ language, supported code changes
- coding, supported code changes
- resource files, limitations of Edit and Continue
- code changes, handling in Edit and Continue
- what's new [C++], supported code changes
- code changes
ms.assetid: f5754363-8a56-417b-b904-b05d9dd26d03
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- cplusplus
ms.openlocfilehash: d000d2757321701c2e14427c6bbb4d3e4164d26f
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99876307"
---
# <a name="supported-code-changes-c"></a>Поддерживаемые изменения кода (C++)
В C++ большинство типов изменений, вносимых в код, обрабатывается в режиме "Изменить и продолжить". Некоторые изменения, однако, не могут быть применены во время выполнения программы. Чтобы применить эти изменения, необходимо остановить выполнение и собрать обновленную версию кода.

 Сведения о работе с компонентом "Изменить и продолжить" для C++ в Visual Studio см. в разделе [Изменить и продолжить (C++)](../debugger/edit-and-continue-visual-cpp.md).

## <a name="requirements"></a><a name="BKMK_Requirements"></a> Требования
### <a name="build-settings-project--properties"></a>Параметры сборки (Проект > Свойства):
  1. **C/C++ > Общие > Формат отладочной информации**: База данных программы для компонента "Изменить и продолжить" (`/ZI`)
  2. **C/C++ > Создание кода > Включить минимальное перестроение**: Да (`/Gm`)
  3. **Компоновщик > Общие > Включить инкрементную компоновку**: Да (`/INCREMENTAL`)

     Любые несовместимые параметры компоновщика (такие как `/SAFESEH` или `/OPT:`...) должны вызвать предупреждение _LNK4075_ во время сборки.  
     Пример: `LINK : warning LNK4075: ignoring '/INCREMENTAL' due to '/OPT:ICF' specification`

### <a name="debugger-settings-debug--options--general"></a>Параметры отладчика (Отладка > Параметры > Общие):
  - Включение функции "Изменить машинный код и продолжить"

     Любые несовместимые параметры компилятора или компоновщика вызывают ошибку во время операции "Изменить и продолжить".  
     Пример: `Edit and Continue : error  : ‘file.cpp’ in ‘MyApp.exe’ was not compiled with Edit and Continue enabled. Ensure that the file is compiled with the Program Database for Edit and Continue (/ZI) option.`

## <a name="unsupported-changes"></a><a name="BKMK_Unsupported_changes"></a> Неподдерживаемые изменения
 Следующие изменения в коде C/C++ не могут быть применены во время сеанса отладки. Если внести любое из таких изменений и попытаться применить его, в окне **Вывод** отобразится сообщение об ошибке или предупреждение.

- Большинство изменений в глобальных или статических данных.

- Изменения в исполняемых файлах, которые были скопированы с другого компьютера, а не собраны локально.

- Изменения в типах данных, которые влияют на структуру объекта, например изменения в данных-членах класса.

- Добавление более 64 Кбайт нового кода или данных.

- Добавление переменных, требующих конструктор в точке, предшествующей указателю инструкции.

- Изменения, которые влияют на код, требующий инициализации во время выполнения.

- Добавление обработчиков исключений в некоторых экземплярах.

- Изменения в файлах ресурсов.

- Изменения в коде файлов, доступных только для чтения.

- Изменения в коде при отсутствии соответствующего PDB-файла.

- Изменения в коде, для которого отсутствует объектный файл.

* Изменение лямбда-выражений, которые:
  - имеют статический или глобальный член;
  - передаются в функцию std::function; это приводит к нарушению подлинности ODR и к ошибке C1092.

- Операция "Изменить и продолжить" не обновляет статические библиотеки. При внесении изменения в статическую библиотеку выполнение будет продолжено со старой версией без выдачи предупреждения.

## <a name="unsupported-scenarios"></a><a name="BKMK_Unsupported_scenarios"></a> Неподдерживаемые сценарии
 Операция "Изменить и продолжить" для C/C++ не доступна в следующих сценариях отладки:

- Отладка собственных приложений, скомпилированных с помощью компилятора [/Zo (улучшение оптимизированного процесса отладки)](/cpp/build/reference/zo-enhance-optimized-debugging)

- В версиях Visual Studio до Visual Studio 2015 с обновлением 1 отладка приложений или компонентов UWP. Начиная с Visual Studio 2015 с обновлением 1 операцию "Изменить и продолжить" можно использовать в приложениях DirectX и приложениях UWP C++, поскольку теперь поддерживается параметр компилятора `/ZI` с параметром `/bigobj`. Функцию "Изменить и продолжить" можно также использовать с двоичными файлами, скомпилированными с параметром `/FASTLINK` .

- Отладка приложений Магазина 8/8.1 В этих проектах используется набор инструментов VC 120 и параметр C/ C++ `/bigobj`. Компонент "Изменить и продолжить" с `/bigobj` поддерживается только в наборе инструментов VC 140.

- отладка в Windows 98;

- отладка в смешанном режиме (машинный код/управляемый код);

- отладка JavaScript;

- отладка SQL;

- отладка с использованием файла дампа;

- изменение кода после необработанного исключения, когда не включен параметр **Очищать стек вызовов от кадров необработанных исключений** ;

- отладка приложения с использованием команды **Присоединиться к** вместо запуска приложения кнопкой **Пуск** в меню **Отладка** ;

- отладка оптимизированного кода;

- отладка старой версии кода после того, как новую версию не удалось собрать из-за ошибок сборки.

- С помощью настраиваемого пути компилятора (*CL. exe*). Из соображений безопасности для перекомпиляции файла во время операции "Изменить и продолжить" в Visual Studio всегда используется установленный компилятор. Если вы используете пользовательский путь компилятора (например, через пользовательскую переменную `$(ExecutablePath)` в файле `*.props`), появится предупреждение, и Visual Studio возвращается к использованию установленного компилятора той же версии или архитектуры.

- Система сборки FASTBuild. FASTBuild в настоящее время несовместима с параметром компилятора "Включить минимальное перестроение (`/Gm`)", поэтому режим "Изменить и продолжить" не поддерживается.

- Устаревшие архитектуры и наборы инструментов VC. При использовании набора инструментов VC 140 отладчик по умолчанию поддерживает операции "Изменить и продолжить" в приложениях x86 и x64. Устаревшие наборы инструментов поддерживают только приложения x86. Наборы инструментов старше VC 120 должны использовать устаревший отладчик. Для использования функции "Изменить и продолжить" установите флажок "_Отладка > Параметры > Общие >_ Использовать режим совместимости машинного кода".

## <a name="linking-limitations"></a><a name="BKMK_Linking_limitations"></a> Ограничения компоновки

### <a name="linker-options-that-disable-edit-and-continue"></a><a name="BKMK_Linker_options_that_disable_Edit_and_Continue"></a> Параметры компоновщика, отключающие режим «Изменить и продолжить»
 Следующие параметры компоновщика отключают режим "Изменить и продолжить".

- Параметры **/OPT:REF**, **/OPT:ICF** и **/INCREMENTAL:NO** отключают режим "Изменить и продолжить" со следующим предупреждением:  
     `LINK : warning LNK4075: ignoring /EDITANDCONTINUE due to /OPT specification`

- Параметры **/ORDER**, **/RELEASE** и **/FORCE** отключают режим "Изменить и продолжить" со следующим предупреждением:  
     `LINK : warning LNK4075: ignoring /INCREMENTAL due to /option specification`

- Установка любых параметров, предотвращающих создание файла программной базы данных (.PDB), отключает режим "Изменить и продолжить" без предупреждения.

### <a name="auto-relinking-limitations"></a><a name="BKMK_Auto_relinking_limitations"></a> Ограничения автоматического повторного связывания
 По умолчанию функция "Изменить и продолжить" повторно компонует программу в конце сеанса отладки, чтобы создать новый исполняемый файл.

 Функция "Изменить и продолжить" не может осуществлять перекомпоновку программы, если отладка выполняется не из расположения исходного построения. Сообщение говорит о том, что необходимо вручную заново осуществить построение.

 Функция "Изменить и продолжить" не осуществляет повторное построение статических библиотек. При внесении изменений в статическую библиотеку в режиме «Изменить и продолжить» необходимо вручную повторно осуществить построение библиотеки и повторно скомпоновать использующие ее приложения.

 Функция "Изменить и продолжить" не вызывает шаги пользовательского построения. Если программа использует пользовательские шаги построения, может возникнуть необходимость произвести построение вручную, чтобы можно было вызывать пользовательские шаги построения. В этом случае можно отключить перекомпоновку после выполнения "Изменить и продолжить", чтобы предлагалось построение заново вручную.

 **Отключение перекомпоновки после выполнения "Изменить и продолжить"**

1. В меню **Отладка** выберите **Параметры и настройки**.

2. В диалоговом окне **Параметры** откройте узел **Отладка** и выберите узел **Изменить и продолжить** .

3. Снимите флажок **Перекомпоновка изменений кода после отладки** .

## <a name="precompiled-header-limitations"></a><a name="BKMK_Precompiled_header_limitations"></a> Ограничения предварительно откомпилированных заголовков
 По умолчанию в режиме "Изменить и продолжить" загружаются и обрабатываются предкомпилированные заголовки в фоновом режиме для ускорения обработки изменений кода. Загрузка предкомпилированных заголовков требует выделения физической памяти, что может быть проблемой в случае компиляции на компьютере с ограниченной RAM. Будет ли это являться проблемой, можно определить с помощью диспетчера задач Windows, выяснив объем доступной физической памяти во время отладки. Если это количество больше размера предварительно скомпилированных заголовков, то в режиме "Изменить и продолжить" не должно возникнуть проблем. Если объем свободной памяти меньше объема, необходимого для прекомпилированных заголовков, можно запретить средству "Изменить и продолжить" загружать прекомпилированные заголовки в фоновом режиме.

 **Чтобы отключить фоновую загрузку прекомпилированных заголовков для средства "Изменить и продолжить"**

1. В меню **Отладка** выберите **Параметры и настройки**.

2. В диалоговом окне **Параметры** откройте узел **Отладка** и выберите узел **Изменить и продолжить** .

3. Снимите флажок **Разрешить прекомпиляцию** .

## <a name="idl-attribute-limitations"></a><a name="BKMK_IDL_attribute_limitations"></a> Ограничения атрибутов IDL
 В режиме "Изменить и продолжить" не создаются повторно файлы определения интерфейса (IDL). Как следствие, изменения в атрибутах IDL не отображаются в ходе отладки. Для того чтобы увидеть изменения в атрибутах IDL, необходимо остановить процесс отладки и заново осуществить построение приложения. При режиме "Изменить и продолжить" не выводится сообщение об ошибке или предупреждение при изменении атрибутов IDL. Дополнительные сведения см. в разделе [Атрибуты IDL](/cpp/windows/idl-attributes).

## <a name="diagnosing-issues"></a><a name="BKMK_Diagnosing_issues"></a>Диагностические проблемы
 Если ваш сценарий не соответствует ни одному из указанных выше условий, можно собрать дополнительные сведения, задав следующий параметр реестра DWORD:
 1. Откройте командную строку разработчика.
 2. Выполните следующую команду:  
     `VsRegEdit.exe set “C:\Program Files (x86)\Microsoft Visual Studio\[Version]\[YOUR EDITION]” HKCU Debugger NativeEncDiagnosticLoggingLevel DWORD 1`

 Установка этого значения в начале сеанса отладки приводит к тому, что различные компоненты функции "Изменить и продолжить" выдают подробные сведения о ведении журнала на панели **Окно вывода** > **Отладка**.

## <a name="see-also"></a>См. также
- [Изменить и продолжить (C++)](../debugger/edit-and-continue-visual-cpp.md)
