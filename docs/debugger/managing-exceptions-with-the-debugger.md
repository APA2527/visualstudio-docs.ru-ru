---
title: Управление исключениями с отладчиком Документы Майкрософт
ms.custom: seodec18
ms.date: 10/09/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.exceptions
- vs.debug.exceptions.find
dev_langs:
- CSharp
- VB
- FSharp
- C++
- JScript
helpviewer_keywords:
- run-time errors
- exception handling, during debugging
- errors [debugger]
- debugger, runtime errors
- On Error-style error handlers
- exceptions, Win32
- run-time errors, debugging
- Win32, exceptions
- run time, exceptions
- error handling
- debugging [Visual Studio], exception handling
- common language runtime, exceptions
- native run-time checks
- exceptions, debugging
ms.assetid: 43a77fa8-37d0-4c98-a334-0134dbca4ece
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 00ad5b41dd0a11661d281f24474b7673ea0a342c
ms.sourcegitcommit: 95f26af1da51d4c83ae78adcb7372b32364d8a2b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79301125"
---
# <a name="manage-exceptions-with-the-debugger-in-visual-studio"></a>Управление исключениями с отладчиком в Visual Studio

Исключение указывает на состояние ошибки, возникающее при выполнении программы. Можно сказать отладчику, какие исключения или наборы исключений взломать, и в какой момент вы хотите, чтобы отладчик сломался (т.е. пауза в отладчике). Когда отладчик ломается, он показывает вам, где было брошено исключение. Вы также можете добавить или удалить исключения. С решением, открытым в Visual Studio, используйте Настройки > **исключения Отеков >,** чтобы открыть окно **параметров исключения.**

Предоставьте обработчики, которые реагируют на наиболее важные исключения. Если вам нужно знать, как добавлять обработчики для исключений, [см. Исправление ошибок, написав лучший код C .](../debugger/write-better-code-with-visual-studio.md) Кроме того, узнайте, как настроить отладчик, чтобы всегда нарушать выполнение для некоторых исключений.

При возникновении исключения отладчик записывает сообщение об исключении в окно **вывода.** Это может привести к разрыву исполнения в следующих случаях, когда:

- Выбрасывается исключение, которое не обрабатывается.
- Отладчик настроен для выполнения перед вызовом любого обработчика.
- Вы установили [Just My Code,](../debugger/just-my-code.md)и отладчик настроен для того, чтобы разбить все исключения, которые не обрабатываются в коде пользователя.

> [!NOTE]
> В ASP.NET существует обработчик исключений верхнего уровня, отображающий станицы ошибок в браузере. Он не нарушает исполнение, если **только мой код** включен. Например, [см. Сообщите отладчику продолжить работу над необработанными исключениями, приведенными ниже.](#BKMK_UserUnhandled)

<!-- Two consecutive notes are intentional here...-->

> [!NOTE]
> В приложениях, написанных на Visual Basic, отладчик управляет всеми ошибками как исключениями, даже при использовании обработчиков ошибок типа On Error.

## <a name="tell-the-debugger-to-break-when-an-exception-is-thrown"></a>Сообщите отладчику, чтобы он сломался при броске исключения

Отладчик может выбить выполнение в точке, где выбрасывается исключение, поэтому можно изучить исключение до вызова обработчика.

В окне **параметров исключения** **(Debug > настройки windows > исключения)** расширьте узлы для категории исключений, таких как **Общие исключения для выполнения языка.** Затем выберите флажок для конкретного исключения в этой категории, например **System.AccessViolationException.** Можно также выбрать всю категорию исключений.

![Checked AccessViolationException](../debugger/media/exceptionsettingscheckaccess.png "ExceptionSettingsCheckAccess")

> [!TIP]
> Вы можете найти определенные исключения, используя окно **поиска** в панели **параметров исключений,** или использовать поиск для фильтрации для определенных областей имен **(например, System.IO).**

При выборе исключения в окне **параметров исключений** выполнение отладчика будет ломаться там, где будет брошено исключение, независимо от того, обработано ли оно. Теперь исключение называется исключением первого шанса. Ниже приведено несколько примеров.

- В следующем приложении консоли СЗ основной метод бросает `try/catch` **AccessViolationException** внутри блока.

  ```csharp
  static void Main(string[] args)
  {
      try
      {
          throw new AccessViolationException();
          Console.WriteLine("here");
      }
      catch (Exception e)
      {
          Console.WriteLine("caught exception");
      }
      Console.WriteLine("goodbye");
  }
  ```

  Если у вас есть **AccessViolationException** проверены в `throw` **настройках исключений,** выполнение будет перерыв на линии, когда вы запустите этот код в отладчик. После этого выполнение можно продолжить. В консоли должны отображаться обе строки.

  ```cmd
  caught exception
  goodbye
  ```

  но он не отображает `here` линию.

- Консольное приложение Сз ссылается на библиотеку класса с классом, который имеет два метода. Один метод бросает исключение и обрабатывает его, в то время как второй метод бросает то же исключение, но не обрабатывает его.

  ```csharp
  public class Class1
  {
      public void ThrowHandledException()
      {
          try
          {
              throw new AccessViolationException();
          }
          catch (AccessViolationException ave)
          {
              Console.WriteLine("caught exception" + ave.Message);
          }
      }

      public void ThrowUnhandledException()
      {
          throw new AccessViolationException();
      }
  }
  ```

  Далее приводится метод Main() консольного приложения:

  ```csharp
  static void Main(string[] args)
  {
      Class1 class1 = new Class1();
      class1.ThrowHandledException();
      class1.ThrowUnhandledException();
  }
  ```

  Если у вас есть **AccessViolationException** проверены в `throw` **настройках исключений,** выполнение будет перерыв на линии в обоих **ThrowHandledException ()** и **ThrowUnhandledException ()** при запуске этого кода в отладчик.

Чтобы восстановить параметры исключения для по умолчанию, выберите **список «Восстановить» в кнопку настроек по умолчанию:**

![Восстановить параметры исключения до значений по умолчанию](../debugger/media/restoredefaultexceptions.png "ВосстановлениеDefaultИсключения")

## <a name="tell-the-debugger-to-continue-on-user-unhandled-exceptions"></a><a name="BKMK_UserUnhandled"></a>Сообщите отладчику продолжить работу по необработанным исключениям

Если вы отлажаете код .NET или JavaScript с [помощью Just My Code,](../debugger/just-my-code.md)вы можете сказать отладчику, чтобы предотвратить нарушение исключений, которые не обрабатываются в коде пользователя, но обрабатываются в другом месте.

1. В окне **«Параметры исключений»** откройте меню ярлыка, нажав на метку столбца, а затем выберите **колонки Show > дополнительных действий.** (Если вы выключили **Just My Code,** вы не увидите эту команду.) Появляется третья колонка под названием **Дополнительные действия.**

   ![Столбец дополнительных действий](../debugger/media/additionalactionscolumn.png "ДополнительныеДействияКолонка")

   Для исключения, которое показывает **Продолжение при необработанном коде пользователя** в этой статье, отладчик продолжается, если это исключение не обрабатывается в коде пользователя, но обрабатывается извне.

2. Чтобы изменить этот параметр для конкретного исключения, выберите исключение, нажмите право, чтобы показать меню ярлыка, и выберите **Продолжить, когда не обрабатывается в Коде пользователя.** Можно также изменить настройку для целой категории исключений, таких как все исключения общего языка Runtime.

   ![«Продолжить, когда не обработано в настройках пользовательского кода»](../debugger/media/continuewhenunhandledinusercodesetting.png "ПродолжитьКогдаUnhandledInUserCodeУстановка")

Например, ASP.NET веб-приложений обрабатывают исключения, преобразовывая их в код состояния HTTP 500[(Обработка исключений в ASP.NET Web API),](/aspnet/web-api/overview/error-handling/exception-handling)что может не помочь определить источник исключения. В следующем примере пользовательский код вызывает метод `String.Format()` , который создает <xref:System.FormatException>. Выполнение прерывается следующим образом.

![Перерывы на&#45;необработанное исключение пользователя](../debugger/media/exceptionunhandledbyuser.png "ИсключениеНеобработаноПользователем")

## <a name="add-and-delete-exceptions"></a>Добавление и удаление исключений

Исключения можно добавлять и удалять. Чтобы удалить тип исключения из категории, выберите исключение и выберите **выбранное исключение из** кнопки списка (знак минус) на панели **инструментов «Параметры исключений».** Или вы можете нажать правой кнопкой исключение и выбрать **Удалить** из меню ярлыка. Исключение исключения имеет тот же эффект, что и беспрепятственное исключение, которое заключается в том, что отладчик не сломается при броске.

Чтобы добавить исключение:

1. В окне **параметров исключения** выберите одну из категорий исключений (например, **Общее время выполнения языка).**

2. Выберите **исключение для выбранной кнопки категории** (знак плюс).

   ![«Добавить исключение к выбранной категории» кнопки](../debugger/media/addanexceptiontotheselectedcategorybutton.png "AddAnExceptiontotheSвыбраннаяКнопка категории")

3. Введите имя исключения (например, **System.UriTemplateMatchS).**

   ![Введите имя исключения](../debugger/media/typetheexceptionname.png "TypeTheExceptionName")

   Исключение добавляется в список (в алфавитном порядке) и автоматически проверяется.

Чтобы добавить исключение из исключений доступа к памяти GPU, JavaScript Runtime Исключения, или Win32 Исключения категории, включают код ошибки и описание.

> [!TIP]
> Проверьте правильность написания! В окне **Параметры исключений** не проверяется существование добавленного исключения. Поэтому при вводе **Sytem.UriTemplateMatchException** появится запись для этого исключения (а не для **System.UriTemplateMatchException**).

Параметры исключения сохраняются в файл SUO решения и таким образом применяются к конкретному решению. Параметры конкретного исключения нельзя повторно использовать в решениях. Теперь сохраняются только добавленные исключения; удаленные исключения не являются. Вы можете добавить исключение, закрыть и вновь открыть решение, и исключение все еще будет там. Однако при удалении исключения, закрытии и повторном открытии решения исключение появится снова.

В окне **Параметры исключений** поддерживаются универсальные типы исключений на C#, но не на Visual Basic. Чтобы делать останов при возникновении таких исключений, как `MyNamespace.GenericException<T>`, необходимо добавить исключение в виде **MyNamespace.GenericException'1**. То есть, если вы создали исключение, как этот код:

```csharp
public class GenericException<T> : Exception
{
    public GenericException() : base("This is a generic exception.")
    {
    }
}
```

Исключение можно добавить в **параметры исключений** с помощью предыдущей процедуры:

![добавление общего исключения](../debugger/media/addgenericexception.png "AddGenericException")

## <a name="add-conditions-to-an-exception"></a>Добавление условий к исключению

Используйте окно **параметров исключения** для настройки условий для исключений. В настоящее время поддерживаемые условия включают имя модуля (ы), чтобы включить или исключить для исключения. Установив имена модулей в качестве условий, можно выбрать перерыв для исключения только на определенных модулях кода. Вы также можете избежать нарушения на определенных модулей.

> [!NOTE]
> Добавление условий к исключению поддерживается начиная с [!include[vs_dev15](../misc/includes/vs_dev15_md.md)].

Для добавления условных исключений:

1. Выберите кнопку **«Условия отсечения»** в окне «Параметры исключений» или нажмите справа на кнопку «За исключением» и выберите **«Условия отсеиваем»**

   ![Условия для исключения](../debugger/media/dbg-conditional-exception.png "DbgУсловный Исключение")

2. Чтобы добавить дополнительные необходимые условия к исключению, выберите **Условие добавления** для каждого нового условия. Появляются дополнительные линии состояния.

   ![Дополнительные условия для исключения](../debugger/media/extraconditionsforanexception.png "ДополнительныеусловияДляанисключения")

3. Для каждой строки состояния введите имя модуля и измените список оператора сравнения на **Equals** или **Not Equals.** Вы можете указать**\\**подстановочные знаки () в имени, чтобы указать более одного модуля.

4. Если вам нужно удалить условие, выберите **X** в конце линии состояния.

## <a name="see-also"></a>См. также раздел

- [Возобновление выполнения после исключения](../debugger/continuing-execution-after-an-exception.md)<br/>
- [Практическое руководство. Анализ системного кода после исключения](../debugger/how-to-examine-system-code-after-an-exception.md)<br/>
- [Как: Используйте нативные проверки времени выполнения](../debugger/how-to-use-native-run-time-checks.md)<br/>
- [Использование проверки кода во время выполнения без библиотеки среды выполнения языка C](../debugger/using-run-time-checks-without-the-c-run-time-library.md)<br/>
- [Первый взгляд на отладчика](../debugger/debugger-feature-tour.md)
