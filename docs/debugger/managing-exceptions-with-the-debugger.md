---
title: Управление исключениями с помощью отладчика | Документация Майкрософт
ms.custom: seodec18
ms.date: 10/09/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.exceptions
- vs.debug.exceptions.find
dev_langs:
- CSharp
- VB
- FSharp
- C++
- JScript
helpviewer_keywords:
- run-time errors
- exception handling, during debugging
- errors [debugger]
- debugger, runtime errors
- On Error-style error handlers
- exceptions, Win32
- run-time errors, debugging
- Win32, exceptions
- run time, exceptions
- error handling
- debugging [Visual Studio], exception handling
- common language runtime, exceptions
- native run-time checks
- exceptions, debugging
ms.assetid: 43a77fa8-37d0-4c98-a334-0134dbca4ece
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: b83cb026bec6d33490517e5703a042b4a8e2434c
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62846678"
---
# <a name="manage-exceptions-with-the-debugger-in-visual-studio"></a>Управление исключениями с помощью отладчика в Visual Studio

Исключение указывает на состояние ошибки, возникающее при выполнении программы. Можно указать отладчику, какие исключения или наборы исключений на прерывание по, и на этом этапе требуется останов отладчика (то есть приостановки в отладчике). Когда отладчик приостанавливает, он показано, где возникло исключение. Можно также добавить или удалить исключения. С помощью решения, открытого в Visual Studio, используйте **Отладка > Windows > параметры исключений** открыть **параметры исключений** окна.

Предоставить обработчики, реагирующие на наиболее важные исключения. Если вам нужно знать, как добавить обработчики для исключений, см. в разделе [исправления ошибок, написав лучше C# кода](../debugger/write-better-code-with-visual-studio.md). Кроме того Узнайте, как настроить отладчик всегда прерывает выполнение для некоторых исключений.

При возникновении исключения отладчик записывает его сообщение в окно **Вывод**. Он может прервать выполнение в следующих случаях, когда:

- Исключение, не обработано.
- Отладчик настроен на прерывание выполнения до вызова любого обработчика.
- Вы задали [Just My Code](../debugger/just-my-code.md), и отладчик настроен на прерывание по любому исключению, не обрабатываемому в коде пользователя.

> [!NOTE]
> В ASP.NET существует обработчик исключений верхнего уровня, отображающий станицы ошибок в браузере. Если он не прерывает выполнение **Just My Code** включен. Например, см. в разделе [отладчик по-прежнему не обработанное пользовательским кодом исключений](#BKMK_UserUnhandled) ниже.

<!-- Two consecutive notes are intentional here...-->

> [!NOTE]
> В приложениях, написанных на Visual Basic, отладчик управляет всеми ошибками как исключениями, даже при использовании обработчиков ошибок типа On Error.

## <a name="tell-the-debugger-to-break-when-an-exception-is-thrown"></a>Остановить при возникновении исключения отладчик

Отладчик может прервать выполнение в точке, где создается исключение, поэтому может проверить исключение до вызова обработчика.

В **параметры исключений** окна (**Отладка > Windows > параметры исключений**), разверните узел для категории исключений, например **исключения среды CLR**. Затем установите флажок для конкретного исключения в этой категории, такие как **System.AccessViolationException**. Можно также выбрать всю категорию исключений.

![Проверка AccessViolationException](../debugger/media/exceptionsettingscheckaccess.png "ExceptionSettingsCheckAccess")

> [!TIP]
> Поиска конкретных исключений можно с помощью **поиска** окно в **параметры исключений** панели инструментов или применить функцию поиска для фильтрации определенных пространств имен (таких как **System.IO**).

При выборе исключение в **параметры исключений** окна, выполнение отладчика будет прерываться везде, где это исключение вызывается, независимо от того, является ли он обрабатывается. Теперь исключение называется первым экземпляром исключения. Ниже приведено несколько примеров.

- В следующем консольном приложении C# метод Main создает исключение **AccessViolationException** внутри блока `try/catch`.

  ```csharp
  static void Main(string[] args)
  {
      try
      {
          throw new AccessViolationException();
          Console.WriteLine("here");
      }
      catch (Exception e)
      {
          Console.WriteLine("caught exception");
      }
      Console.WriteLine("goodbye");
  }
  ```

  Если у вас есть **AccessViolationException** возврата **параметры исключений**, выполнение прервется на `throw` строке при выполнении этого кода в отладчике. После этого выполнение можно продолжить. В консоли должны отображаться обе строки.

  ```cmd
  caught exception
  goodbye
  ```

  но не отображает `here` строки.

- Консольное приложение C# ссылается на библиотеку классов с классом, который имеет два метода. Один метод вызывает исключение и обрабатывает его, а второй метод создает исключение, но не может обработать его.

  ```csharp
  public class Class1
  {
      public void ThrowHandledException()
      {
          try
          {
              throw new AccessViolationException();
          }
          catch (AccessViolationException ave)
          {
              Console.WriteLine("caught exception" + ave.Message);
          }
      }

      public void ThrowUnhandledException()
      {
          throw new AccessViolationException();
      }
  }
  ```

  Далее приводится метод Main() консольного приложения:

  ```csharp
  static void Main(string[] args)
  {
      Class1 class1 = new Class1();
      class1.ThrowHandledException();
      class1.ThrowUnhandledException();
  }
  ```

  Если у вас есть **AccessViolationException** возврата **параметры исключений**, выполнение прервется на `throw` строки в обоих **ThrowHandledException()** и **ThrowUnhandledException()** при выполнении этого кода в отладчике.

Чтобы восстановить значения по умолчанию параметры исключений, выберите **восстановить значения по умолчанию для списка** кнопки:

![Восстановить значения по умолчанию параметры исключения](../debugger/media/restoredefaultexceptions.png "RestoreDefaultExceptions")

## <a name="BKMK_UserUnhandled"></a>Отладчик по-прежнему не обработанное пользовательским кодом исключений

При отладке кода .NET или JavaScript с параметром [Just My Code](../debugger/just-my-code.md), можно указать отладчику во избежание прерывания из-за исключения, которые не обрабатываются в пользовательском коде, но обрабатываются в другом месте.

1. В **параметры исключений** окно, откройте контекстное меню, щелкнув правой кнопкой мыши заголовок столбца и выберите **Показать столбцы > Дополнительные действия**. (Если вы отключили **Just My Code**, данная команда не отображается.) Третий столбец с именем **дополнительные действия** отображается.

   ![Дополнительный столбец действий](../debugger/media/additionalactionscolumn.png "AdditionalActionsColumn")

   Для исключения, показывающий **продолжить после необработанной ошибки в пользовательском коде** этот столбец, отладчик продолжает выполняться, если исключение не обрабатывается в пользовательском коде, а обрабатывается извне.

2. Чтобы изменить этот параметр для конкретного исключения, выберите исключение, щелкните правой кнопкой мыши, чтобы отобразить контекстное меню и выберите **продолжить после необработанной ошибки в пользовательском коде**. Можно также изменить параметр для всей категории исключений, например все исключения CLR).

   ![** Продолжить после необработанной ошибки в пользовательский код ** параметр](../debugger/media/continuewhenunhandledinusercodesetting.png "ContinueWhenUnhandledInUserCodeSetting")

Например, веб-приложения ASP.NET обрабатывают исключения путем их преобразования в код состояния HTTP 500 ([обработка исключений в веб-API ASP.NET](http://www.asp.net/web-api/overview/error-handling/exception-handling)), что может затруднить определение источника исключения. В следующем примере пользовательский код вызывает метод `String.Format()` , который создает <xref:System.FormatException>. Выполнение прерывается следующим образом.

![Прерывается на пользователя&#45;необработанное исключение](../debugger/media/exceptionunhandledbyuser.png "ExceptionUnhandledByUser")

## <a name="add-and-delete-exceptions"></a>Добавление и удаление исключений

Исключения можно добавлять и удалять. Чтобы удалить тип исключения из категории, выберите исключение и выберите **Удаление выбранного исключения из списка** кнопки (минус) на **параметры исключений** панели инструментов. Либо вы можете щелкните исключение правой кнопкой мыши и выберите **удалить** в контекстном меню. Удаление исключения действует так же как флажок снят, для исключения это, что отладчик не будет прерывать выполнение при возникновении исключения.

Чтобы добавить исключение:

1. В **параметры исключений** окно, выберите один из категории исключений (например, **среда CLR**).

2. Выберите **добавить исключение в выбранной категории** кнопки (знак «плюс»).

   ![** Добавить исключение на кнопку выбранной категории **](../debugger/media/addanexceptiontotheselectedcategorybutton.png "AddAnExceptionToTheSelectedCategoryButton")

3. Введите имя исключения (например, **System.UriTemplateMatchException**).

   ![Введите имя исключения](../debugger/media/typetheexceptionname.png "TypeTheExceptionName")

   Исключение автоматически проверяется и добавляется в список (в алфавитном порядке).

Чтобы добавить исключение для исключения обращения к памяти GPU, исключения среды выполнения JavaScript или категории исключения Win32, включите код ошибки и описание.

> [!TIP]
> Проверьте правильность написания! В окне **Параметры исключений** не проверяется существование добавленного исключения. Поэтому при вводе **Sytem.UriTemplateMatchException** появится запись для этого исключения (а не для **System.UriTemplateMatchException**).

Параметры исключения сохраняются в файл SUO решения и таким образом применяются к конкретному решению. Параметры конкретного исключения нельзя повторно использовать в решениях. Теперь сохраняются только добавленных исключений; удаленные исключения не. Вы можете добавить исключение, закрыть и снова откройте решение, и исключение будет по-прежнему существует. Однако при удалении исключения, закрытии и повторном открытии решения исключение появится снова.

В окне **Параметры исключений** поддерживаются универсальные типы исключений на C#, но не на Visual Basic. Чтобы делать останов при возникновении таких исключений, как `MyNamespace.GenericException<T>`, необходимо добавить исключение в виде **MyNamespace.GenericException'1**. То есть если вы создавали исключение, подобное этот код:

```csharp
public class GenericException<T> : Exception
{
    public GenericException() : base("This is a generic exception.")
    {
    }
}
```

Можно добавить исключение **параметры исключений** с помощью приведенного выше:

![Добавление общего исключения](../debugger/media/addgenericexception.png "AddGenericException")

## <a name="add-conditions-to-an-exception"></a>Добавление условий для исключения

Используйте **параметры исключений** окно, чтобы задать условия для исключения. В настоящее время поддерживаются такие условия включают имена модулей для включения или исключения для исключения. Установив имена модулей в качестве условий, можно прерывать выполнение для исключения только в определенных модулей кода. Вы также можете во избежание прерывания из-за конкретных модулей.

> [!NOTE]
> Добавление условия к исключению поддерживается начиная с версии [!include[vs_dev15](../misc/includes/vs_dev15_md.md)].

Добавление условного исключения:

1. Выберите **изменить условия** кнопку в окне «параметры исключений» или щелкните правой кнопкой мыши исключение и выбрать **изменения условий**.

   ![Условия для исключения](../debugger/media/dbg-conditional-exception.png "DbgConditionalException")

2. Чтобы добавить дополнительные обязательные условия исключения, выберите **добавить условие** для каждого нового условия. Будут показаны дополнительные условия линии.

   ![Дополнительные условия для исключения](../debugger/media/extraconditionsforanexception.png "ExtraConditionsForAnException")

3. Для каждой строки условию, введите имя модуля и измените список операторов сравнения для **равно** или **не равно**. Можно указать подстановочные знаки (**\\\***) в имени, чтобы указать несколько модулей.

4. Если вам нужно удалить условие, выберите **X** в конце строки условия.

## <a name="see-also"></a>См. также

- [Возобновление выполнения после исключения](../debugger/continuing-execution-after-an-exception.md)<br/>
- [Практическое руководство. Анализ системного кода после исключения](../debugger/how-to-examine-system-code-after-an-exception.md)<br/>
- [Практическое руководство. Проверки времени выполнения машинного кода](../debugger/how-to-use-native-run-time-checks.md)<br/>
- [Использование проверки кода во время выполнения без библиотеки среды выполнения языка C](../debugger/using-run-time-checks-without-the-c-run-time-library.md)<br/>
- [Первое знакомство с отладчиком](../debugger/debugger-feature-tour.md)
