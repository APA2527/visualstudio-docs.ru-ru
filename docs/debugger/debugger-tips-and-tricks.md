---
title: Советы и рекомендации по работе с отладчиком
description: Сведения о некоторых малоизвестных функциях, поддерживаемых отладчиком Visual Studio
ms.custom: seodec18
ms.date: 06/15/2018
ms.topic: conceptual
helpviewer_keywords:
- stepping
- debugging [Visual Studio], execution control
- execution, controlling in debugger
ms.assetid: 5262d8b1-2648-429e-85d5-90fcaadfb362
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: bf8d6df020694bb10fe4f3f051551056549d5673
ms.sourcegitcommit: 95f26af1da51d4c83ae78adcb7372b32364d8a2b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79301179"
---
# <a name="learn-productivity-tips-and-tricks-for-the-debugger-in-visual-studio"></a>Советы и рекомендации, способствующие повышению производительности при работе с отладчиком в Visual Studio

В этой статье приводятся советы и рекомендации по работе с отладчиком в Visual Studio. Обзор основных возможностей отладчика см. в статье [Первое знакомство с отладчиком](../debugger/debugger-feature-tour.md). В этой статье рассматриваются некоторые моменты, не включенные в обзор возможностей.

## <a name="pin-data-tips"></a>Советы по закреплению данных

Если во время отладки вы часто наводите указатель мыши на подсказки по данным, можно закрепить подсказку для переменной, чтобы получать к ней быстрый доступ. Переменная остается закрепленной даже после перезапуска. Чтобы закрепить подсказку по данным, наведите на нее курсор и щелкните значок булавки. Можно закрепить несколько переменных.

![Закрепление подсказки по данным](../debugger/media/dbg-tips-data-tips-pinned.png "PinningDataTip")

## <a name="edit-your-code-and-continue-debugging-c-vb-c"></a>Изменение кода и продолжение отладки (C#, VB, C++)

В большинстве языков, поддерживаемых Visual Studio, можно изменять код во время сеанса отладки, а затем продолжать отладку. Для использования этой функции щелкните код, чтобы установить в нем курсор, когда отладчик приостановлен, внесите изменения и нажмите клавишу **F5**, **F10** или **F11**, чтобы продолжить отладку.

![Изменение и продолжение отладки](../debugger/media/dbg-tips-edit-and-continue.gif "EditAndContinue")

Дополнительные сведения об этой функции и ее ограничениях см. в статье [Изменить и продолжить](../debugger/edit-and-continue.md).

## <a name="edit-xaml-code-and-continue-debugging"></a>Изменение кода XAML и продолжение отладки

Сведения об изменении кода XAML во время сеанса отладки см. в статье [Создание и отладка выполняющегося кода XAML с помощью горячей перезагрузки XAML](../xaml-tools/xaml-hot-reload.md).

## <a name="debug-issues-that-are-hard-to-reproduce"></a>Отладка проблем, которые трудно воспроизвести

Если вам трудно воссоздать определенное состояние в своем приложении или на это уходит много времени, подумайте, может ли помочь использование условной точки останова. Можно использовать [условные точки останова](../debugger/using-breakpoints.md#BKMK_Specify_a_breakpoint_condition_using_a_code_expression) и фильтровать точки останова, чтобы избежать разбиения кода приложения, пока приложение не перейдет в нужное состояние (например, состояние, в котором переменная хранит неправильные данные). Вы можете установить условия, используя выражения, фильтры или счетчики попаданий и т. д.

#### <a name="to-create-a-conditional-breakpoint"></a>Создание условной точки останова

1. Щелкните правой кнопкой мыши значок точки останова (красный шарик) и выберите пункт **Условия**.

2. В окне **Параметры точки останова** введите выражение.

    ![Условная точка останова](../debugger/media/dbg-multithreaded-conditional-breakpoint.png "ConditionalBreakpoint")

3. Если вы заинтересованы в другом типе условия, выберите **Фильтр** вместо **Условное выражение** в диалоговом окне **Параметры точки останова**, а затем следуйте советам для фильтра.

## <a name="configure-the-data-to-show-in-the-debugger"></a>Настройка отображения данных в отладчике

С помощью атрибута [DebuggerDisplay](../debugger/using-the-debuggerdisplay-attribute.md) в C#, Visual Basic и C++ (только для кода C++/CLI) можно указать отладчику, какую информацию следует отображать. Для кода C++ то же самое можно сделать с помощью [визуализаций Natvis](create-custom-views-of-native-objects.md).

## <a name="change-the-execution-flow"></a>Изменение потока выполнения

Когда отладчик приостановил выполнение на строке кода, с помощью мыши захватите указатель с желтой стрелкой в левой части. Переместите указатель с желтой стрелки на другую точку в пути выполнения кода. Чтобы продолжить выполнение приложения, нажмите клавишу F5 или выполните шаг-команду.

![Перемещение указателя выполнения](../debugger/media/dbg-tour-move-the-execution-pointer.gif "Перемещение указателя выполнения")

Изменяя поток выполнения, можно решать множество задач, например тестировать различные пути выполнения кода или повторно выполнять код без перезапуска отладчика.

> [!WARNING]
> Как правило, при работе с этой функцией необходимо соблюдать осторожность — вы увидите соответствующее предупреждение во всплывающей подсказке. Могут отображаться и другие предупреждения. При перемещении указателя предыдущее состояние приложения не возвращается.

## <a name="track-an-out-of-scope-object-c-visual-basic"></a>Отслеживание объекта, не входящего в область (C#, Visual Basic)

Можно легко просматривать переменные с помощью окон отладчика, таких как окно **Контрольные значения**. Однако если переменная выходит за пределы области в окне **Контрольные значения**, можно заметить, что она неактивна (выделена серым цветом). В некоторых случаях использования приложений значение переменной может измениться даже тогда, когда переменная выходит за пределы области, и может потребоваться тщательно ее отслеживать (например, переменная может быть собрана в качестве мусора). Для отслеживания переменной создайте для нее идентификатор объекта в окне **Контрольные значения**.

#### <a name="to-create-an-object-id"></a>Создание идентификатора объекта

1. Установите точку останова рядом с переменной, которую необходимо отслеживать.

2. Запустите отладчик (**F5**) и остановите его в точке останова.

3. Найдите переменную в окне **Локальные** (**Отладка > Окна > Локальные**), щелкните переменную правой кнопкой мыши и выберите пункт **Создать идентификатор объекта**.

    ![Создание идентификатора объекта](../debugger/media/dbg-tips-watch-create-object-id.png "CreateObjectID")

4. В окне **$** вы должны увидеть символ **Локальные** . Эта переменная является идентификатором объекта.

5. Щелкните правой кнопкой мыши переменную идентификатора объекта и выберите пункт **Добавить контрольное значение**.

Дополнительные сведения см. в статье [Создание предложения идентификатора объекта](../debugger/watch-and-quickwatch-windows.md#bkmk_objectIds).

## <a name="view-return-values-for-functions"></a>Просмотр возвращаемых значений для функций

Чтобы просмотреть возвращаемые значения для функций, при пошаговом выполнении кода взгляните на функции, отображаемые в окне **Видимые**. Чтобы просмотреть возвращаемое значение для функции, убедитесь, что нужная функция уже выполнена (нажмите **F10** один раз, если в данный момент вы остановились на вызове функции). Если окно закрыто, последовательно выберите **Отладка > Окна > Видимые**, чтобы открыть окно **Видимые**.

![Окно "Видимые"](../debugger/media/dbg-tips-autos-window.png "AutosWindow")

Кроме того, для просмотра возвращаемых значений можно вводить функции в окно **Интерпретация**. (Откройте его, выбрав **Отладка > Окна > Интерпретация**.)

![Окно интерпретации](../debugger/media/dbg-tips-immediate-window.png "ImmediateWindow")

Кроме того, в окнах **Контрольные значения** и **Интерпретация** можно использовать [псевдопеременные](../debugger/pseudovariables.md), такие как `$ReturnValue`.

## <a name="inspect-strings-in-a-visualizer"></a><a name="string_visualizer"></a>Проверка строк в визуализаторе

При работе со строками может быть целесообразно просмотреть всю отформатированную строку. Чтобы просмотреть обычный текст, строки в формате XML, HTML или JSON, щелкните значок лупы (![значок визуализатора](../debugger/media/dbg-tips-visualizer-icon.png "Значок визуализатора")) при наведении указателя мыши на переменную, содержащую строковое значение.

![Открытие визуализатора строк](../debugger/media/dbg-tips-string-visualizers.png "OpenStringVisualizer")

Визуализатор строк может помочь определить, имеет ли строка неправильный формат, в зависимости от типа строки. Например, пустое поле **Значение** указывает, что строка не распознается типом визуализатора. Дополнительные сведения см. в статье [Диалоговое окно визуализатора строк](../debugger/string-visualizer-dialog-box.md).

![Визуализатор строк JSON](../debugger/media/dbg-tips-string-visualizer-json.png "JSONStringVisualizer")

Для некоторых других типов, таких как объекты DataSet и DataTable, отображаемых в окнах отладчика, можно также открыть встроенный визуализатор.

## <a name="break-into-code-on-handled-exceptions"></a>Прерывание выполнения кода при обработанных исключениях

Отладчик прерывает выполнение кода при необработанных исключениях. Однако обработанные исключения (например, исключения, возникающие в блоке `try/catch`) могут также быть источником ошибок и, возможно, вам потребуется изучить их. Можно настроить прерывание работы отладчика при обработанных исключениях, а также настроить параметры в диалоговом окне **Параметры исключений**. Откройте это диалоговое окно, выбрав **Отладка > Окна > Параметры исключений**.

В диалоговом окне **Параметры исключений** можно указать отладчику прерывать выполнение кода при конкретных исключениях. На приведенном ниже рисунке отладчик прерывает выполнение кода при возникновении `System.NullReferenceException`. Дополнительные сведения см. в статье [Управление исключениями](../debugger/managing-exceptions-with-the-debugger.md).

![Диалоговое окно "Параметры исключений"](../debugger/media/dbg-tips-exception-settings.png "ExceptionSettingsDialogBox")

## <a name="debug-deadlocks-and-race-conditions"></a>Отладка взаимоблокировок и состояний гонки

Если необходимо отладить проблемы, которые являются общими для многопоточных приложений, зачастую бывает полезно просматривать расположение потоков во время отладки. Это можно легко сделать с помощью кнопки **Показать потоки в исходном коде**.

#### <a name="to-show-threads-in-your-source-code"></a>Отображение потоков в исходном коде

1. Во время отладки нажмите кнопку **Показать потоки в исходном коде** ![Показать потоки в исходном коде](../debugger/media/dbg-multithreaded-show-threads.png "ThreadMarker") на панели инструментов **Отладка**.

2. Посмотрите на переплет в левой части окна. В этой строке отображается значок *Маркер потока* ![Метка потока](../debugger/media/dbg-thread-marker.png "ThreadMarker"), похожий на переплетение двух нитей. маркер потока указывает, что некий поток остановлен в этом месте.

    Обратите внимание, что маркер потока может быть частично скрыт точкой останова.

3. Наведите указатель мыши на маркер потока. Появится подсказка. Подсказка сообщает имя и идентификационный номер каждого остановившегося тут потока.

    Расположение потоков можно также просмотреть в окне [Параллельные стеки](../debugger/get-started-debugging-multithreaded-apps.md).

::: moniker range="vs-2017"
## <a name="examine-payloads-for-web-services-and-network-resources-uwp"></a>Изучение полезных данных для веб-служб и сетевых ресурсов (UWP)

В приложениях UWP можно анализировать выполненные сетевые операции с помощью API `Windows.Web.Http`. Это средство можно использовать для отладки веб-служб и сетевых ресурсов. Чтобы получить доступ к средству, выберите **Отладка > Профилировщик производительности**. Выберите **Сеть** и нажмите кнопку **Пуск**. В приложении выполните нужные действия, где используется `Windows.Web.Http`, а затем щелкните **Остановка сбора**, чтобы создать отчет.

![Средство профилирования — использование сети](../profiling/media/prof-tour-network-usage.png "NetworkUsageProfTool")

Выберите операцию в представлении "Сводка", чтобы просмотреть более подробные сведения.

![Подробные сведения в средстве использования сети](../profiling/media/prof-tour-network-usage-details.png "DetailedViewNetworkUsage")

Дополнительные сведения см. в разделе [Использование сети](../profiling/network-usage.md).
::: moniker-end

## <a name="get-more-familiar-with-how-the-debugger-attaches-to-your-app-c-c-visual-basic-f"></a><a name="modules_window"></a> Получение дополнительных сведения о присоединении отладчика к приложению (C#, C++, Visual Basic, F#)

Чтобы присоединиться к выполняющемуся приложению, отладчик загружает файлы символов (PDB), созданные для той же сборки приложения, которую нужно отладить. В некоторых сценариях могут потребоваться базовые сведения о файлах символов. Изучить загрузку файлов символов в Visual Studio можно с помощью окна **Модули**.

Откройте окно **Модули** во время отладки, выбрав **Отладка > Окна > Модули**. В окне **Модули** можно узнать, какие модули будут рассматриваться отладчиком в качестве пользовательского кода (или [*моего кода*](../debugger/just-my-code.md)), а также проверить состояние загрузки символов для модуля. В большинстве сценариев отладчик автоматически находит файлы символов для пользовательского кода, но, если требуется выполнить шаг с заходом (или отладку) в код .NET, системный код или сторонний код библиотеки, необходимо выполнить дополнительные действия для получения нужных файлов символов.

![Просмотр сведений о символах в окне "Модули"](../debugger/media/dbg-tips-modules-window.png "ViewSymbolInformation")

Сведения о символах можно загрузить непосредственно из окна **Модули**, щелкнув правой кнопкой мыши и выбрав пункт **Загрузить символы**.

Иногда разработчики приложений поставляют приложения без соответствующих файлов символов (в целях уменьшения объема памяти), но сохраняют копию соответствующих файлов символов для сборки, чтобы отладить выпущенную версию позже.

Сведения о том, каким образом отладчик классифицирует код как пользовательский, см. в статье об [отладке пользовательского кода с помощью функции "Только мой код"](../debugger/just-my-code.md). Дополнительные сведения об файлах символов см. в статье [Указание файлов символов (PDB) и файлов с исходным кодом в отладчике Visual Studio](specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md).

## <a name="learn-more"></a>Дополнительные сведения

Дополнительные советы и рекомендации, а также более подробные сведения см. в следующих записях блога.

- [7 lesser known hacks for debugging in Visual Studio](https://devblogs.microsoft.com/visualstudio/7-lesser-known-hacks-for-debugging-in-visual-studio/) (7 малоизвестных советов по отладке в Visual Studio)
- [7 hidden gems in Visual Studio](https://devblogs.microsoft.com/visualstudio/7-hidden-gems-in-visual-studio-2017/) (7 тайных сокровищ в Visual Studio)

## <a name="see-also"></a>См. также

[Сочетания клавиш](../ide/productivity-shortcuts.md)
