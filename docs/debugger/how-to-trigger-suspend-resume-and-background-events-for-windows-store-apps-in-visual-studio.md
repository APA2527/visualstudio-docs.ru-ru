---
title: Триггер приостановки, возобновления и фоновых событий во время отладки универсальной платформы Windows | Документация Майкрософт
ms.custom: seodec18
ms.date: 01/16/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.error.background_task_activate_failure
dev_langs:
- CSharp
- VB
- FSharp
- C++
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- uwp
ms.openlocfilehash: c0c5c6a1bfb161f8eed37cbf9c95740596977852
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63388502"
---
# <a name="how-to-trigger-suspend-resume-and-background-events-while-debugging-uwp-apps-in-visual-studio"></a>Активация приостановки, возобновления и фоновых событий во время отладки приложения UWP в Visual Studio
Если в данный момент отладка не выполняется, приложение **Управление жизненным циклом процесса** Windows управляет состоянием выполнения приложения: запуском, приостановкой, возобновлением и завершением работы приложения в ответ на действия пользователя и состояние устройства. При отладке Windows отключает эти события активации. В этом разделе описывается запуск этих событий в отладчике.

 Кроме того, в этом разделе описывается, как отладить **Фоновые задачи**. Фоновые задачи позволяют выполнять определенные операции в фоновом процессе, даже если приложение не выполняется. Можно использовать отладчик, чтобы перевести приложение в режим отладки, а затем, не запуская пользовательский интерфейс, запустить фоновую задачу и начать ее отладку.

 Дополнительные сведения об управлении жизненным циклом процессов и фоновых задачах см. в разделе [Launching, resuming, and multitasking](/windows/uwp/launch-resume/index).

## <a name="BKMK_Trigger_Process_Lifecycle_Management_events"></a> События управления жизненным циклом процессов активации
 Windows может приостановить работу приложения, если пользователь переходит из него или если Windows переключается в режим низкого электропотребления. Можно ответить на событие `Suspending` , чтобы сохранить соответствующие данные приложения и пользовательские данные в постоянном хранилище и чтобы освободить ресурсы. При переходе из состояния **Приостановлено** приложение возвращается в состояние **Выполняется** и продолжает работу с того момента, в котором оно было приостановлено. Можно ответить на событие `Resuming` , чтобы восстановить или обновить состояние приложения и получить назад ресурсы.

 Хотя Windows пытается хранить в памяти как можно больше приостановленных приложений, Windows может завершить работу приложения, если ресурсов для хранения приложения в памяти недостаточно. Пользователь также может явно закрыть приложение. Специального события, указывающего, что пользователь закрыл приложение, не существует.

 В отладчике Visual Studio можно вручную приостановить, возобновить и завершить работу приложения для отладки событий жизненного цикла процессов. Чтобы выполнить отладку события жизненного цикла процесса, выполните следующие действия.

1. Задайте точку останова в обработчике события, которое необходимо отладить.

2. Нажмите клавишу **F5** , чтобы начать отладку.

3. На панели инструментов **Место отладки** выберите событие, которое необходимо создать.

     ![Приостановка, возобновление, окончания и фоновые задачи](../debugger/media/dbg_suspendresumebackground.png "DBG_SuspendResumeBackground")

     Обратите внимание, что команда **Приостановить и завершить работу** закрывает приложение и завершает сеанс отладки.

## <a name="BKMK_Trigger_background_tasks"></a> Активация фоновых задач
 Любое приложение может зарегистрировать фоновую задачу, чтобы отвечать на некоторые системные события, даже если приложение не выполняется. Фоновые задачи не могут выполнять код, который непосредственно обновляет пользовательский интерфейс; вместо этого они показывают пользователю сведения об обновлениях плитки, обновлениях эмблемы и всплывающие уведомления. Дополнительные сведения см. в разделе [Supporting your app with background tasks](https://msdn.microsoft.com/library/4c7bb148-eb1f-4640-865e-41f627a46e8e).

 Можно активировать события, которые запускают фоновые задачи для приложения, из отладчика.

> [!NOTE]
> Отладчик может активировать только те события, которые не содержат данные, такие как события, указывающие на изменение состояния устройства. Фоновые задачи, которые требуют ввод данных пользователем или другие данные, необходимо активировать вручную.

 Проще всего активировать событие фоновой задачи, когда приложение не запущено. Однако также поддерживается активация события в стандартном сеансе отладки.

### <a name="BKMK_Trigger_a_background_task_event_from_a_standard_debug_session"></a> Активация события фоновой задачи из стандартного сеанса отладки

1. Задайте точку останова в коде фоновой задачи, который требуется отладить.

2. Нажмите клавишу **F5** , чтобы начать отладку.

3. Из списка событий на панели инструментов **Место отладки** выберите фоновую задачу, которую требуется запустить.

     ![Приостановка, возобновление, окончания и фоновые задачи](../debugger/media/dbg_suspendresumebackground.png "DBG_SuspendResumeBackground")

### <a name="BKMK_Trigger_a_background_task_when_the_app_is_not_running"></a> Активация фоновой задачи, когда приложение не выполняется

1. Задайте точку останова в коде фоновой задачи, который требуется отладить.

2. Откройте страницу свойств отладки для запускаемого проекта. Выберите проект в Обозревателе решений. В меню **Отладка** выберите пункт **Свойства**.

     Для C++ проектов, разверните **свойства конфигурации** и выберите **Отладка**.

3. Выполните одно из следующих действий.

    - Для проектов Visual C# и Visual Basic выберите **Не запускать, а отлаживать мой код при открытии**.

         ![C&#35;&#47;VB свойство отладки запуска приложения](../debugger/media/dbg_csvb_dontlaunchapp.png "DBG_CsVb_DontLaunchApp")

    - Для визуального C++ проектов, выберите **нет** из **запуск приложения** списка.

         ![C&#43;&#43;&#47;свойство отладки запуска VB приложения](../debugger/media/dbg_cppjs_dontlaunchapp.png "DBG_CppJs_DontLaunchApp")

4. Нажмите клавишу **F5** , чтобы перевести приложение в режим отладки. Обратите внимание, что в списке **Процесс** на панели инструментов **Место отладки** указывается имя пакета приложения, которое требуется указать в режиме отладки.

     ![Список процессов фоновой задачи](../debugger/media/dbg_backgroundtask_processlist.png "DBG_BackgroundTask_ProcessList")

5. Из списка событий на панели инструментов **Место отладки** выберите фоновую задачу, которую требуется запустить.

     ![Приостановка, возобновление, окончания и фоновые задачи](../debugger/media/dbg_suspendresumebackground.png "DBG_SuspendResumeBackground")

## <a name="BKMK_Trigger_Process_Lifetime_Management_events_and_background_tasks_from_an_installed_app"></a> Активация событий управления жизненным циклом процесса и фоновых задач из установленного приложения
 Используйте **отлаживать установленный пакет приложения** диалоговое окно, чтобы загрузить приложение, уже установлен в режим отладчика. Например вы отладить приложение, устанавливаемое из Microsoft Store, или выполнить отладку приложения при наличии исходных файлов для приложения, но не проект Visual Studio для приложения. **Отлаживать установленный пакет приложения** диалоговое окно позволяет запускать приложение в режиме отладки на компьютере с Visual Studio или на удаленном устройстве или чтобы настроить приложение для запуска в режиме отладки, но не запускает его. Дополнительные сведения см. в разделе [отладка установленного пакета приложения](../debugger/debug-installed-app-package.md).

 После загрузки приложения в отладчик можно использовать любую из описанных выше процедур.

## <a name="BKMK_Diagnosing_background_task_activation_errors"></a> Диагностика ошибок активации фоновой задачи
 В журналах диагностики в окне просмотра событий Windows для фоновой инфраструктуры содержались подробные сведения о средствах, которые можно использовать для диагностики и устранения ошибок фоновой задачи. Чтобы просмотреть журнал, выполните следующие действия.

1. Откройте приложение просмотра событий.

2. В панели **Действия** выберите **Просмотр** и убедитесь, что установлен флажок **Отобразить аналитический и отладочный журналы** .

3. На панели инструментов **Просмотр событий (локальных)** разверните узлы **Журналы приложений и служб** > **Microsoft** > **Windows** > **BackgroundTasksInfrastructure**.

4. Выберите журнал **Диагностические** .

## <a name="see-also"></a>См. также
- [Тестирование приложений UWP в Visual Studio](../test/testing-store-apps-with-visual-studio.md)
- [Отладка приложений в Visual Studio](/visualstudio/debugger/debugging-windows-store-and-windows-universal-apps)
- [Жизненный цикл приложения](/windows/uwp/launch-resume/app-lifecycle)
- [Launching, resuming, and multitasking](/windows/uwp/launch-resume/index)