---
title: Набор символов (.pdb) и исходных файлов в отладчике
ms.custom: seodec18
ms.date: 10/08/2018
ms.topic: conceptual
f1_keywords:
- VS.ToolsOptionsPages.Debugger.Native
- VS.ToolsOptionsPages.Debugger.Symbols
- vs.debug.options.Native
- vs.debug.nosymbols
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- source code
- .dbg files
- source code, managing
- symbols, managing
- .pdb files
- dbg files
- pdb files
- debugger
ms.assetid: 1105e169-5272-4e7c-b3e7-cda1b7798a6b
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: c5d7d5fa0a53ead2f49f89df37943d734a1b73fb
ms.sourcegitcommit: 1fc6ee928733e61a1f42782f832ead9f7946d00c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "60045346"
---
# <a name="specify-symbol-pdb-and-source-files-in-the-visual-studio-debugger-c-c-visual-basic-f"></a>Указание файлов символов (.pdb) и исходных файлов в отладчике Visual Studio (C#, C++, Visual Basic, F#)

База данных программы ( *.pdb*) файлов, также называемых файлы символов, сопоставления идентификаторов и операторы в исходном коде проекта, чтобы соответствующие идентификаторы и инструкциях в компиляции приложения.

При построении проекта из Visual Studio IDE с помощью стандартной конфигурации построения отладки, компилятор создает соответствующих файлов символов. Вы также можете [задать параметры символов в коде](#compiler-symbol-options).

*.Pdb* файл содержит информацию о состоянии отладки и проект, позволяющие выполнять инкрементную компоновку отладочной конфигурации приложения. Отладчик Visual Studio использует *.pdb* файлы, чтобы определить два ключевых момента во время отладки:

* Источник файла имя и номер строки для отображения в Интегрированной среде разработки Visual Studio.
* Где в приложении, чтобы остановить для точки останова.

Файлы символов также показано расположение исходных файлов и при необходимости на сервер для получения их из.

Отладчик загружает только *PDB-файл* файлы, которые точно соответствуют *PDB-файл* файлов, созданных при построении приложения (то есть исходный *.pdb* файлы или копии). Это точное дублирование является необходимым, поскольку макет приложения можно изменить, даже если сам код не изменился. Дополнительные сведения см. в статье [Почему Visual Studio требует, чтобы файлы символов отладчика точно соответствовали двоичным файлам, с которыми они были собраны?](https://blogs.msdn.microsoft.com/jimgries/2007/07/06/why-does-visual-studio-require-debugger-symbol-files-to-exactly-match-the-binary-files-that-they-were-built-with/)

> [!TIP]
> Для отладки кода за пределами исходный код проекта, например кода Windows или стороннего кода вызываемого проектом, необходимо указать расположение внешнего кода *.pdb* файлов (и при необходимости, исходные файлы), которые должны точно соответствовать сборки в приложении.

## <a name="symbol-file-locations-and-loading-behavior"></a>Расположения файлов символов и поведения при загрузке

> [!NOTE]
> При отладке управляемого кода на удаленном устройстве, все файлы символов должны находиться на локальном компьютере или в расположении [указанных в параметрах отладчика](#BKMK_Specify_symbol_locations_and_loading_behavior).

При отладке проекта в Интегрированной среде разработки Visual Studio, отладчик автоматически загружает файлы символов, которые находятся в папке проекта.

Отладчик также выполняет поиск файлов символов в следующих расположениях:

1. Расположение, указанное в библиотеке DLL или исполняемый файл ( *.exe*) файла.

   По умолчанию Если вы создали библиотеку DLL или *.exe* файл на компьютере, компоновщик помещает полный путь и имя файла связанного *PDB-файл* файла в библиотеке DLL или *.exe* файл. Отладчик проверяет, существует ли файл символов в этом расположении.

2. Той же папке, где находится библиотека DLL или *.exe* файл.

3. Любой из расположений, указанных в параметрах отладчика для файлов символов. Чтобы добавить и включить расположения символов, см. в разделе [настроить расположения символов и возможности загрузки](#BKMK_Specify_symbol_locations_and_loading_behavior).

   - Любая папка локального кэша символов.

   - Указанной сети, Интернет, или серверов символов — локальные и расположений, таких как серверы символов Microsoft, если выбран. [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] может загружать отладочные файлы символов с серверов символов, которые реализуют `symsrv` протокола. [Visual Studio Team Foundation Server](/azure/devops/pipelines/tasks/build/index-sources-publish-symbols) и [средства отладки для Windows](/windows-hardware/drivers/debugger/index) два средства, которые могут использовать серверы символов.

     Серверы символов, которые можно использовать включают:

     **Серверы общедоступных символов Майкрософт**: При отладке отказов, возникающих при обращении к системной библиотеке DLL или библиотеке стороннего, часто требуется система *.pdb* файлов. Система *.pdb* файлы содержат символы для библиотеки DLL Windows, *.exe* файлы и драйверы устройств. Вы можете получить символы для операционных систем Windows, MDAC, IIS, ISA и [!INCLUDE[dnprdnshort](../code-quality/includes/dnprdnshort_md.md)] с общедоступных серверов символов Майкрософт.

     **Серверы символов во внутренней сети или на локальном компьютере** Команда разработчиков или компания может создавать серверы символов для собственных продуктов и поддерживать кэш для символов из внешних источников. Можно иметь сервер символов на собственном компьютере.

     **Сторонние серверы символов** Сторонние поставщики приложений Windows и библиотек могут предоставить доступ к серверу символов в Интернете.

     > [!WARNING]
     > При использовании сервера символов, отличных от открытых серверов символов Майкрософт, убедитесь, что сервер символов и его путь заслуживают. Поскольку файлы символов могут содержать произвольный исполняемый код, вам могут предоставляться на угрозы безопасности.

<a name="BKMK_Specify_symbol_locations_and_loading_behavior"></a>
### <a name="configure-symbol-locations-and-loading-options"></a>Настройка расположения символов и параметров загрузки

На **средства** > **параметры** > **Отладка** > **символы** страницы, вы можете:

- Укажите и выберите пути поиска и серверы символов Microsoft, Windows или сторонних компонентов.
- Укажите модули, в или не которых отладчик должен автоматически загружать символы.
- Эти параметры можно измените во время выполнения отладки. См. в разделе [управления символами во время отладки](#manage-symbols-while-debugging).

**Указание расположения символов и параметров загрузки:**

1. В Visual Studio откройте **средства** > **параметры** > **Отладка** > **символы** (или **Отладка** > **параметры** > **символы**).

   ![Средства &#45; параметры &#45; Отладка &#45; страница "символы"](media/dbg-options-symbols.png "средства &#45; параметры &#45; Отладка &#45; страница \"символы\"")

2. В разделе **символов (PDB)** ,
   - Чтобы использовать **серверы символов Microsoft**, установите флажок.

   - Чтобы добавить к новому расположению сервера символов
     1. Выберите **+** панели инструментов.
     1. Введите путь к URL-адрес или папке сервера символов или расположения символов в текстовом поле. Завершение операторов помогает найти правильный формат.

     >[!NOTE]
     >Поиск выполняется только в указанной папке. Необходимо добавить записи для подкаталогах, которые требуется выполнить поиск.

   - Чтобы добавить новое расположение сервера символов VSTS,
     1. Выберите ![средства&#47; параметры&#47; Отладка&#47;новый значок сервера символов](media/dbg_tools_options_foldersicon.png "средства &#45; параметры &#45; Отладка &#45; новый значок сервера символов") значок на панели инструментов.
     1. В **подключиться к серверу символов VSTS** диалоговое окно, выберите один из указаны доступные серверы символов и выберите **Connect**.

   - Чтобы изменить порядок загрузки для расположения символов, используйте **Ctrl**+**вверх** и **Ctrl**+**вниз**, или **вверх** и **вниз** значки-стрелки.
   - Чтобы изменить URL-адрес или путь, дважды щелкните запись, или выберите его и нажмите клавишу **F2**.
   - Чтобы удалить запись, выберите его и затем выберите **-** значок.

3. (Необязательно) Чтобы повысить производительность загрузки символов, в разделе **кэшировать символы в каталоге**, путь к локальной папке, в который серверы символов могут копировать символы для типа.

   > [!NOTE]
   > Не размещайте локальном кэше символов в защищенную папку, например C:\Windows или вложенной папки. Вместо этого следует использовать папку, для которой разрешены чтение и запись.

   > [!NOTE]
   > Для проектов C++, если у вас есть `_NT_SYMBOL_PATH` набор переменных среды, она переопределит значение, заданное в разделе **кэшировать символы в каталоге**.

4. Укажите модули, для которых отладчик для загрузки из **символов (PDB)** при его запуске.

   - Выберите **загружать все модули, кроме исключенных** (по умолчанию), чтобы загрузить все символы для всех модулей в расположение файла символов, за исключением модулей, вы не исключите. Чтобы исключить некоторые модули, выберите **укажите исключенные модули**выберите **+** значок, введите имена модулей, которые нужно исключить и выберите **ОК**.

   - Чтобы загрузить только модули из расположения файлов символов, установите **нагрузки только указанные модули**. Выберите **укажите включенные модули**выберите **+** значок, введите имена модулей, а затем выберите **ОК**. Файлы символов для других модулей, не загружаются.

5. Нажмите кнопку **ОК**.

## <a name="other-symbol-options-for-debugging"></a>Другие параметры символов для отладки

Можно выбрать дополнительные параметры символов в **средства** > **параметры** > **Отладка** > **Общие** (или **Отладка** > **параметры** > **Общие**):

- **Загружать экспорты из DLL (только машинный код)**

  Загружаются таблицы экспорта DLL для C/C++. Дополнительные сведения см. в разделе [таблицы экспорта библиотеки DLL](#use-dumpbin-exports). Чтение данных экспорта DLL включает в себя дополнительные издержки, поэтому загрузка таблиц экспорта будет отключено по умолчанию. Можно также использовать `dumpbin /exports` в командной строке построения C/C++.

- **Включить отладку на уровне адреса** и **Показать Дизассемблированный код, если исходный код недоступен**

  Всегда отображает Дизассемблированный код отображался при источника файлы или файлы символов не найдены.

  ![Параметры &#47; Отладка &#47; параметры общие дизассемблирования](../debugger/media/dbg_options_general_disassembly_checkbox.png "параметры &#47; Отладка &#47; параметры общие дизассемблирования")
  <a name="BKMK_Use_symbol_servers_to_find_symbol_files_not_on_your_local_machine"></a>
- **Включить поддержку сервера системы управления версиями**

  Использует исходный сервер для отладки приложения, когда нет исходного кода на локальном компьютере, или *.pdb* файла не соответствует исходному коду. Исходный сервер принимает запросы на файлы и возвращает сами файлы из системы управления версиями. Исходный сервер выполняется с помощью библиотеку DLL с именем *srcsrv.dll* для чтения приложения *.pdb* файл. *.Pdb* файл содержит указатели на репозиторий исходного кода, а также команды для получения исходного кода из репозитория.

  Можно ограничить команды, *srcsrv.dll* могут выполнять в приложении *.pdb* файл, составив список разрешенных команд в файле с именем *srcsrv.ini*. Место *srcsrv.ini* файл в той же папке, что *srcsrv.dll* и *devenv.exe*.

  >[!IMPORTANT]
  >В приложении могут быть внедрены произвольные команды *PDB-файл* файл, поэтому убедитесь, что только те команды, которые необходимо выполнить в *srcsrv.ini* файл. Любая попытка выполнить команду не из файла *srcsvr.ini* вызовет диалоговое окно подтверждения. Дополнительные сведения см. в разделе [предупреждение системы безопасности: Отладчик должен выполнить команду без доверия](../debugger/security-warning-debugger-must-execute-untrusted-command.md).
  >
  >Параметры команд не проверяются, поэтому будьте внимательны с доверенными командами. Например, если перечисленных *cmd.exe* в вашей *srcsrv.ini*, пользователь-злоумышленник может указать параметры на *cmd.exe* это делает опасно.

  Выберите этот элемент и дочерние элементы, которые нужно. **Разрешить исходного сервера для частично доверенных сборок (только управляемый код)** и **всегда выполнять ненадежные команды исходного сервера без запроса подтверждения** могут повысить риски безопасности.

  ![Включить параметры исходного сервера](../debugger/media/dbg_options_general_enablesrcsrvr_checkbox.png "DBG_Options_General_EnableSrcSrvr_checkbox")

## <a name="compiler-symbol-options"></a>Параметры компилятора символа

При сборке проекта из Visual Studio IDE со стандартом **Отладка** конфигурацию сборки, C++ и управляемые компиляторы создают соответствующих файлов символов для кода. Можно также задать параметры компилятора в коде.

### <a name="cc-options"></a>Параметры C/C++

- *VC\<x > .pdb* и  *\<проекта > .pdb* файлов

  Объект *.pdb* файл C/C++, созданной при построении с [/Zi или/Zi](/cpp/build/reference/z7-zi-zi-debug-information-format). В [!INCLUDE[vcprvc](../code-quality/includes/vcprvc_md.md)], [/Fd](/cpp/build/reference/fd-program-database-file-name) параметр имена *.pdb* компилятор создает файл. При создании проекта в [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] в интегрированной среде разработки, **/Fd** параметр имеет значение для создания *.pdb* файл с именем  *\<проекта > .pdb*.

  При построении приложения C/C++ с использованием файла makefile, после чего задать **/ZI** или **/ZI** без использования **/Fd**, компилятор создает два *.pdb*файлы:

  - *VC\<x>.pdb*, где *\<x>* представляет версию Visual C++, например *VC11.pdb*.

    *VC\<x > .pdb* файл хранит все отладочные данные для отдельных объектных файлов и находится в том же каталоге, что и файл makefile. Каждый раз, он создает объектный файл, компилятор C/C++ добавляет отладочную информацию в *VC\<x > .pdb*. Поэтому, даже если каждый исходный файл включает общие файлы заголовков, такие как  *\<windows.h >* , определения типов из этих заголовков сохраняются только один раз, а не в каждом файле объекта. Вставляемая информация включает информацию о типах, но не включает символьную информацию, такую как определения функций.

  - *\<Проект > PDB-файл*

    *\<Проекта > .pdb* файл хранит все отладочные данные для проекта *.exe* файлов и располагается в *\debug* подкаталог. Файл *\<project>.pdb* содержит полные отладочные данные, включая прототипы функций, а не только сведения о типах, содержащиеся в *VC\<x>.pdb*.

  Оба *VC\<x > .pdb* и  *\<проекта > .pdb* файлы позволяют осуществлять добавочное обновление. Компоновщик также включает путь к *.pdb* файлы в *.exe* или *.dll* файла при его создании.

- <a name="use-dumpbin-exports"></a>Таблицы экспорта библиотеки DLL

  Используйте `dumpbin /exports` для просмотра символов, доступных в таблице экспорта библиотеки DLL. Символьные данные из таблиц экспорта библиотеки DLL могут быть полезны для работы с сообщениями Windows, процедурами Windows (WindowProcs), COM объектов, маршалинг или любой библиотеки DLL, у вас нет символов для. Символы доступны для любой 32-разрядной системной библиотеки DLL. Вызовы функций перечисляются в том порядке, в котором эти функции вызываются, при этом текущая функция (наиболее глубоко вложенная) располагается наверху.

  Прочитав `dumpbin /exports` выходных данных, вы увидите имена функция exact, включая не буквенно-цифровых символов. Видеть имена функция exact полезно при задании точки останова в функции, так как имена функций может быть усечен в других местах в отладчике. Дополнительные сведения см. в разделе [dumpbin /exports](/cpp/build/reference/dash-exports).

### <a name="net-framework-options"></a>Параметры платформы .NET Framework

Создать с помощью **/debug** для создания *.pdb* файл. Можно строить приложения с ключом **/debug: full** или **/debug: pdbonly**. При построении с ключом **/debug:full** создается отлаживаемый код. При сборке с ключом **/debug:pdbonly** создаются *PDB*-файлы, но не создается `DebuggableAttribute`, сообщающий JIT-компилятору о доступности отладочной информации. Ключ **/debug:pdbonly** следует использовать при создании *PDB*-файла для сборки выпуска, которая не подлежит отладке. Дополнительные сведения см. в разделе [/debug (параметры компилятора C#)](/dotnet/csharp/language-reference/compiler-options/debug-compiler-option) или [/debug (Visual Basic)](/dotnet/visual-basic/reference/command-line-compiler/debug).

### <a name="web-applications"></a>Веб-приложения

Задайте *web.config* файл приложения ASP.NET в режим отладчика. В режиме отладки ASP.NET создает символы для динамически созданных файлов и включает присоединение отладчика к приложению ASP.NET. Visual Studio устанавливает это автоматически при запуске отладки, если вы проект создан на основе шаблона веб-проектов.

## <a name="manage-symbols-while-debugging"></a>Управление символов при отладке

Можно использовать **модули**, **стек вызовов**, **"Локальные"** , **"Видимые"** , или любой **Watch** окно для загрузки символы, либо изменить параметры символов во время отладки. Дополнительные сведения см. в разделе [более подробно ознакомиться с как отладчик подключается к приложению](../debugger/debugger-tips-and-tricks.md#modules_window).

### <a name="use-the-modules-window"></a>Использование окна модулей

Во время отладки, **модули** окне отображаются модули кода, отладчик обработка в виде пользовательского кода или мой код и их загрузка состояния символов. Можно также отслеживать состояние загрузки символов, загрузить символы и изменение параметров символов в **модули** окна.

**Для отслеживания или изменение расположения символов и параметров во время отладки:**

1. Чтобы открыть **модули** окне во время отладки, выберите **Отладка** > **Windows** > **модули**.
1. В **модули** окно, щелкните правой кнопкой мыши **состояние символов** или **файл символов** заголовки, или для любого модуля.
1. В контекстном меню выберите один из следующих вариантов:

|Параметр|Описание|
|------------|-----------------|
|**Загрузить символы**|Отображается для модулей с пропущенных, не найден или не загружены символы. Пытается загрузить символы из расположений, указанных на **параметры** > **Отладка** > **символы** страницы. Если файл символов не найден или не загружен, запускает **проводнике** , можно указать новое расположение для поиска.|
|**Сведения о загрузке символов**|Показывает расположение загруженного файла символов или расположения, которые были найдены, если отладчику не удается найти файл.|
|**Параметры символов**|Открывает **параметры** > **Отладка** > **символы** страницы, где можно изменить, добавить расположения символов.|
|**Всегда загружать автоматически**|Добавляет файл выбранный символ список файлов, которые автоматически загружаются отладчиком.|

### <a name="use-the-no-symbols-loadedno-source-loaded-pages"></a>Используйте страницы нет символы Loaded/No исходного кода

Существует несколько способов для отладчика Приостановка выполнения кода, в которой нет символов или исходные файлы, доступные:

- Пошаговое выполнение кода.
- Приостановка выполнения кода из точки останова или исключение.
- Переключиться на другой поток.
- Кадр стека можно изменить, дважды щелкнув кадр в **стек вызовов** окна.

В этом случае отладчик отображает **символы не загружены** или **нет исходного кода** страниц, чтобы помочь найти и загрузить необходимые символы или источника.

 ![Страница не загружены символы](../debugger/media/dbg-nosymbolsloaded.png "DBG_NoSymbolsLoaded")

**Использование страницы документа "символы не загружены" позволяет найти и загрузить отсутствующие символы:**

- Чтобы изменить пути поиска, выберите путь не выбран, или выберите **новый путь** или **новый путь к VSTS** и введите или выберите новый путь. Выберите **загрузить** повторить поиск в путях и загрузить файл символов, если он найден.
- Чтобы переопределить все параметры символов и повторить пути поиска, выберите **обзора и найти \<имя исполняемого файла >** . Файл символов загружается в том случае, если он найден, или **проводнике** откроется, можно вручную выбрать символьный файл.
- Чтобы открыть **параметры** > **Отладка** > **символы** выберите **изменить параметры символов**.
- Для отображения дизассемблированного кода в новом окне один раз, выберите **просмотреть дизассемблированный код**, или выберите **диалоговое окно параметров** задать параметр, чтобы всегда показывать дизассемблированный код, когда источник файлы или файлы символов не найдены.
- Чтобы отобразить расположения, в котором выполняется поиск, а также событие, разверните **сведения о загрузке символов**.

Если отладчик найдет *PDB-файл* файл после выполнения один из вариантов и может извлечь исходный файл, используя сведения в *.pdb* файл, он отображается источник. В противном случае он отображает **нет исходного кода** страницу, которая описывает проблему, со ссылками на действия, которые может устранить проблему.

**Добавление путей поиска исходных файлов в решение:**

Можно указать расположения, отладчик ищет исходные файлы и исключить определенные файлы из поиска.

1. Выберите решение в **обозревателе решений**, а затем выберите **свойства** значок, нажмите клавишу **Alt**+**ввод**, или Щелкните правой кнопкой мыши и выберите **свойства**.

1. Выберите **исходные файлы отладки**.

1. В разделе **каталоги, содержащие исходный код**введите или выберите расположения исходного кода для поиска. Используйте **новую строку** значок, чтобы добавить другие расположения **вверх** и **вниз** значки со стрелками, чтобы изменить их, порядок или **X** значок, чтобы удалить их.

   >[!NOTE]
   >Отладчик производит поиск только указанного каталога. Любые подкаталоги, в которых требуется осуществлять поиск, должны быть внесены в список.

1. В разделе **не выполнять поиск следующих исходных файлов**, введите имена исходных файлов, чтобы исключить из поиска.

1. Выберите **ОК** или **применить**.

## <a name="see-also"></a>См. также
- [Сведения о файлы символов и параметры символов Visual Studio](https://devblogs.microsoft.com/devops/understanding-symbol-files-and-visual-studios-symbol-settings/)

- [Изменения принципов загрузки удаленных символов .NET в Visual Studio 2012 и 2013](https://devblogs.microsoft.com/devops/net-remote-symbol-loading-changes-in-visual-studio-2012-and-2013/)
