---
title: Отладка проектов DLL | Документация Майкрософт
ms.date: 11/06/2018
ms.topic: conceptual
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- debugging DLLs
- templates, debugging DLLs
- DLLs, debugging
- debugging [Visual Studio], DLLs
ms.assetid: 433cab30-d191-460b-96f7-90d2530ca243
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 898eb0eb1489d83e97ec9f0a5b38b475bda0199d
ms.sourcegitcommit: 485ffaedb1ade71490f11cf05962add1718945cc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2019
ms.locfileid: "72450422"
---
# <a name="debug-dlls-in-visual-studio-c-c-visual-basic-f"></a>Отладка библиотек DLL в VisualC#Studio C++(,, F#Visual Basic,)

Библиотека DLL (библиотека динамической компоновки) — это библиотека, содержащая код и данные, которые могут использоваться несколькими приложениями. Visual Studio можно использовать для создания, сборки, настройки и отладки библиотек DLL.

## <a name="create-a-dll"></a>Создание библиотеки DLL

Следующие шаблоны проектов Visual Studio могут создавать библиотеки DLL:

- C#, Visual Basic или F# библиотека классов
- C#или Visual Basic библиотеки управления Windows Forms (WCF)
- C++Библиотека динамической компоновки (DLL)

Дополнительные сведения см. в разделе [Методы отладки MFC](../debugger/mfc-debugging-techniques.md).

Отладка библиотеки WCF аналогична отладке библиотеки классов. Дополнительные сведения см. в разделе [элементы управления Windows Forms](/dotnet/framework/winforms/controls/index).

Обычно библиотека DLL вызывается из другого проекта. При отладке вызывающего проекта в зависимости от конфигурации библиотеки DLL можно выполнить шаг с заходом и отладить код библиотеки DLL.

## <a name="vxtskdebuggingdllprojectschangingdefaultconfigurations"></a>Отладочная конфигурация библиотеки DLL

При использовании шаблона проекта Visual Studio для создания приложения [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] автоматически создает необходимые параметры для отладочных и окончательных конфигураций сборки. При необходимости эти параметры можно изменить. Дополнительные сведения см. в следующих статьях:

- [Параметры проекта для конфигурации отладки C++](../debugger/project-settings-for-a-cpp-debug-configuration.md)
- [Параметры проекта для конфигураций отладки C#](../debugger/project-settings-for-csharp-debug-configurations.md)
- [Параметры проекта для конфигурации отладки Visual Basic](../debugger/project-settings-for-a-visual-basic-debug-configuration.md)
- [Практическое руководство. Настройка конфигураций отладки и выпуска](../debugger/how-to-set-debug-and-release-configurations.md)

### <a name="set-c-debuggableattribute"></a>Задать C++ DebuggableAttribute

Чтобы отладчик присоединится к C++ библиотеке DLL, C++ код должен выдавать `DebuggableAttribute`.

**Чтобы задать `DebuggableAttribute`, сделайте следующее:**

1. Выберите проект C++ DLL в **Обозреватель решений** и щелкните значок **Свойства** , либо щелкните правой кнопкой мыши проект и выберите пункт **Свойства**.

1. В области **Свойства** в разделе **Компоновщик**  > **Отладка**выберите **Да (/ASSEMBLYDEBUG)** для **отлаживаемой сборки**.

Дополнительные сведения см. в разделе [/ASSEMBLYDEBUG](/cpp/build/reference/assemblydebug-add-debuggableattribute).

### <a name="vxtskdebuggingdllprojectsexternal"></a>Задание расположенийC++ файлов C/DLL

Для отладки внешней библиотеки DLL вызывающий проект должен иметь возможность найти библиотеку DLL, ее PDB- [файл](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md)и другие файлы, необходимые для библиотеки DLL. Вы можете создать настраиваемую задачу сборки, чтобы скопировать эти файлы в папку *\<project >* папку выходных данных \debug, или скопировать файлы вручную.

Для C/C++ проектов расположение файлов Header и lib можно задать на страницах свойств проекта вместо того, чтобы копировать их в выходную папку.

**Чтобы задать расположение файловC++ C/Header и lib, выполните следующие действия.**

1. Выберите проект C/C++ DLL в **Обозреватель решений** и щелкните значок **Свойства** , либо щелкните правой кнопкой мыши проект и выберите пункт **Свойства**.

1. В верхней части панели **свойств** в разделе **Конфигурация**выберите **все конфигурации**.

1. В разделе **CC++ /**  > **Общие**  > **Дополнительные каталоги включаемых**файлов укажите папку с файлами заголовков.

1. В разделе **компоновщик**  > **Общие**  > **каталоги дополнительных библиотек**укажите папку с файлами lib.

1. В разделе **компоновщик**  > **входные**  > **Дополнительные зависимости**укажите полный путь и имя файла для файлов lib.

1. Нажмите кнопку **ОК**.

Дополнительные сведения о параметрах проекта см. в разделе Справочник по C++ [страницам свойств Windows C++ ](/cpp/build/reference/property-pages-visual-cpp).

## <a name="vxtskdebuggingdllprojectsbuildingadebugversion"></a>Создание отладочной версии

Перед началом отладки обязательно создайте отладочную версию библиотеки DLL. Для отладки библиотеки DLL вызывающее приложение должно иметь возможность найти его PDB- [файл](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md) и другие файлы, необходимые для работы библиотеки DLL.

Можно создать пользовательскую задачу сборки для копирования DLL-файлов в *папку проекта \<calling > папку \Debug* Output или скопировать файлы вручную.

Обязательно вызовите библиотеку DLL в правильном расположении. Это может показаться очевидным, но если вызывающее приложение находит и загружает другую копию библиотеки DLL, отладчик никогда не достигнет заданных точек останова.

## <a name="vxtskdebuggingdllprojectswaystodebugthedll"></a>Отладка библиотеки DLL

Нельзя запустить библиотеку DLL напрямую. Он должен вызываться приложением, как правило, файлом *exe* . Дополнительные сведения см. в разделе [проекты Visual Studio C++— ](/cpp/ide/creating-and-managing-visual-cpp-projects).

Чтобы выполнить отладку библиотеки DLL, можно [запустить отладку из вызывающего приложения](#vxtskdebuggingdllprojectsthecallingapplication)или выполнить [отладку из проекта библиотеки DLL](how-to-debug-from-a-dll-project.md) , указав его вызывающее приложение. Можно также использовать [окно интерпретации](#vxtskdebuggingdllprojectstheimmediatewindow) отладчика для вычисления функций DLL или методов во время разработки без использования вызывающего приложения.

Дополнительные сведения см. [в разделе первое знакомство с отладчиком](../debugger/debugger-feature-tour.md).

### <a name="vxtskdebuggingdllprojectsthecallingapplication"></a>Запуск отладки из вызывающего приложения

Приложение, вызывающее библиотеку DLL, может быть следующим:

- Приложение из [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] проекта в том же или другом решении из библиотеки DLL.
- Существующее приложение, которое уже развернуто и запущено на тестовом или рабочем компьютере.
- Программа расположена в Интернете и доступна по URL–адресу.
- Веб-приложение с веб-страницей, которая внедряет библиотеку DLL.

Для отладки библиотеки DLL из вызывающего приложения можно:

- Откройте проект для вызывающего приложения и начните отладку, выбрав **отладка**  > **начать отладку** или нажав клавишу **F5**.

  или

- Присоединитесь к приложению, которое уже развернуто и запущено на тестовом или рабочем компьютере. Используйте этот метод для библиотек DLL на веб-сайтах или в веб-приложениях. Дополнительные сведения см. в разделе [Практическое руководство. Присоединение к выполняемому процессу](../debugger/attach-to-running-processes-with-the-visual-studio-debugger.md).

Прежде чем начать отладку вызывающего приложения, установите точку останова в библиотеке DLL. См. раздел [Использование точек останова](../debugger/using-breakpoints.md). При попадании в точку останова DLL можно пошагово выполнить код, просматривая действие в каждой строке. Дополнительные сведения см. [в разделе Навигация по коду в отладчике](../debugger/navigating-through-code-with-the-debugger.md).

Во время отладки можно использовать окно **модули** для проверки библиотек DLL и *exe* -файлов, загружаемых приложением. Чтобы открыть окно " **модули** " во время отладки, выберите **Отладка**  > **модули** **Windows**  > . Дополнительные сведения см. в разделе [Практическое руководство. Использование окна модулей](../debugger/how-to-use-the-modules-window.md).

### <a name="vxtskdebuggingdllprojectstheimmediatewindow"></a>Использование окна интерпретации

Окно **интерпретации** можно использовать для вычисления функций или методов DLL во время разработки. Окно **интерпретации** играет роль вызывающего приложения.

>[!NOTE]
>Окно **интерпретации** можно использовать во время разработки с большинством типов проектов. Он не поддерживается для SQL, веб-проектов или скриптов.

Например, чтобы протестировать метод с именем `Test` в классе `Class1`:

1. Откройте проект DLL и откройте окно **Интерпретация** , выбрав **Отладка**  > **Windows**  > **интерпретация** или нажав клавиши **CTRL** +**ALT** +**I**.

1. Создайте экземпляр объекта типа `Class1`, введя следующий C# код в окне **интерпретации** и нажав клавишу **Ввод**. Этот управляемый код работает C# для и Visual Basic с соответствующими изменениями в синтаксисе:

   ```csharp
   Class1 obj = new Class1();
   ```

   В C# все имена должны быть указаны полностью. Все методы или переменные должны находиться в текущей области и контексте, когда языковая служба пытается вычислить выражение.

1. Предположим, что `Test` принимает один параметр `int` , вычислим `Test` с помощью окна **Интерпретация** :

   ```csharp
   ?obj.Test(10);
   ```

   Результаты выводятся в окне **Интерпретация** .

1. Можно продолжить отладку `Test`, установив в нем точку останова, а затем снова вычислив эту функцию.

   Будет достигнута точка останова, и вы сможете выполнить пошаговое `Test`. После выполнения `Test`, отладчик вернется в режим разработки.

## <a name="vxtskdebuggingdllprojectsmixedmodedebugging"></a> Отладка в смешанном режиме

Вы можете написать вызывающее приложение для библиотеки DLL в управляемом или машинном коде. Если собственное приложение вызывает управляемую библиотеку DLL и вы хотите выполнить отладку обоих, можно включить управляемые и машинные отладчики в свойствах проекта. Точный процесс зависит от того, хотите ли вы начать отладку из проекта библиотеки DLL или из проекта вызывающего приложения. Дополнительные сведения см. в разделе [Практическое руководство. Отладка в смешанном режиме](../debugger/how-to-debug-in-mixed-mode.md).

Также можно выполнить отладку собственной библиотеки DLL из управляемого вызывающего проекта. Дополнительные сведения см. [в разделе Отладка управляемого и машинного кода](how-to-debug-managed-and-native-code.md).

## <a name="see-also"></a>См. также
- [Отладка управляемого кода](../debugger/debugging-managed-code.md)
- [Подготовка к отладке C++ проектов](../debugger/debugging-preparation-visual-cpp-project-types.md)
- [Типы проектов C#, F# и Visual Basic](../debugger/debugging-preparation-csharp-f-hash-and-visual-basic-project-types.md)
- [Параметры проекта для конфигурации отладки C++](../debugger/project-settings-for-a-cpp-debug-configuration.md)
- [Параметры проекта для конфигураций отладки C#](../debugger/project-settings-for-csharp-debug-configurations.md)
- [Параметры проекта для конфигурации отладки Visual Basic](../debugger/project-settings-for-a-visual-basic-debug-configuration.md)
- [Безопасность отладчика](../debugger/debugger-security.md)
