---
title: Отладка проектов DLL | Документация Майкрософт
description: Выполняйте отладку файлов библиотеки динамической компоновки (DLL) в Visual Studio. Используйте Visual Studio для создания, сборки, настройки и отладки библиотек DLL.
ms.custom: SEO-VS-2020
ms.date: 11/06/2018
ms.topic: conceptual
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- debugging DLLs
- templates, debugging DLLs
- DLLs, debugging
- debugging [Visual Studio], DLLs
ms.assetid: 433cab30-d191-460b-96f7-90d2530ca243
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: b6ad51d6b791def360f12b2d64e4ef6841c7bcda
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99872798"
---
# <a name="debug-dlls-in-visual-studio-c-c-visual-basic-f"></a>Отладка библиотек DLL в Visual Studio (C#, C++, Visual Basic, F#)

Библиотека DLL (библиотека динамической компоновки) — это библиотека, содержащая код и данные, которые могут использоваться несколькими приложениями. Visual Studio можно использовать для создания, сборки, настройки и отладки библиотек DLL.

## <a name="create-a-dll"></a>Создание библиотеки DLL

Создавать библиотеки DLL можно с помощью следующих шаблонов проектов Visual Studio.

- Библиотека классов C#, Visual Basic или F#
- Библиотека элементов управления Windows Forms (WCF) C# или Visual Basic
- Библиотека динамической компоновки (DLL) C++

Дополнительные сведения см. в разделе [Методы отладки MFC](../debugger/mfc-debugging-techniques.md).

Отладка библиотеки WCF аналогична отладке библиотеки классов. Дополнительные сведения см. в статье [Элементы управления Windows Forms](/dotnet/framework/winforms/controls/index).

Обычно библиотека DLL вызывается из другого проекта. При отладке вызывающего проекта в зависимости от конфигурации библиотеки DLL можно выполнить шаг с заходом и отладить код библиотеки DLL.

## <a name="dll-debug-configuration"></a><a name="vxtskdebuggingdllprojectschangingdefaultconfigurations"></a> Конфигурация отладки библиотеки DLL

При создании приложения на основе шаблона проекта Visual Studio [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] автоматически создает требуемые параметры для конфигурации сборки отладки и выпуска. При необходимости эти параметры можно изменить. Дополнительные сведения см. в следующих статьях:

- [Параметры проекта для конфигурации отладки C++](../debugger/project-settings-for-a-cpp-debug-configuration.md)
- [Параметры проекта для конфигураций отладки C#](../debugger/project-settings-for-csharp-debug-configurations.md)
- [Параметры проекта для конфигурации отладки Visual Basic](../debugger/project-settings-for-a-visual-basic-debug-configuration.md)
- [Практическое руководство. Конфигурации отладки и выпуска](../debugger/how-to-set-debug-and-release-configurations.md)

### <a name="set-c-debuggableattribute"></a>Установка DebuggableAttribute C++

Чтобы отладчик мог присоединиться к библиотеке DLL C++, код C++ должен добавлять `DebuggableAttribute`.

**Установка `DebuggableAttribute`**

1. В **обозревателе решений** выберите проект DLL C++ и щелкните значок **Свойства** либо щелкните проект правой кнопкой мыши и выберите пункт **Свойства**.

1. В области **Свойства** в разделе **Компоновщик** > **Отладка** выберите **Да (/ASSEMBLYDEBUG)** для свойства **Отлаживаемая сборка**.

Дополнительные сведения см. в статье [/ASSEMBLYDEBUG](/cpp/build/reference/assemblydebug-add-debuggableattribute).

### <a name="set-cc-dll-file-locations"></a><a name="vxtskdebuggingdllprojectsexternal"></a> Задание расположений файлов DLL C/C++

Для отладки внешней библиотеки DLL вызывающий проект должен находить библиотеку DLL, ее [PDB-файл](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md) и любые другие файлы, необходимые библиотеке DLL. Вы можете создать пользовательскую задачу сборки, чтобы скопировать эти файлы в выходную папку *\<project folder>\Debug*, или скопировать файлы вручную.

Для проектов C/C++ можно задать расположения файлов заголовков и LIBD-файла на страницах свойств проекта, а не копировать их в выходную папку.

**Задание расположений файла заголовка C/C и LIB-файла**

1. В **обозревателе решений** выберите проект DLL C/C++ и щелкните значок **Свойства** либо щелкните проект правой кнопкой мыши и выберите пункт **Свойства**.

1. В верхней части области **Свойства** в разделе **Конфигурация** выберите **Все конфигурации**.

1. В разделе **C/C++**  > **Общие** > **Дополнительные включаемые каталоги** укажите папку с файлами заголовков.

1. В разделе **Компоновщик** > **Общие** > **Дополнительные каталоги библиотек** укажите папку с LIB-файлами.

1. В разделе **Компоновщик** > **Ввод** > **Дополнительные зависимости** укажите полный путь и имя файла для LIB-файлов.

1. Нажмите кнопку **ОК**.

Дополнительные сведения о параметрах проекта C++ см. в статье [Справочник C++ по страницам свойств проекта Windows](/cpp/build/reference/property-pages-visual-cpp).

## <a name="build-a-debug-version"></a><a name="vxtskdebuggingdllprojectsbuildingadebugversion"></a> Сборка отладочной версии

Перед началом отладки обязательно создайте отладочную версию библиотеки DLL. Для отладки библиотеки DLL вызывающее приложение должно находить [PDB-файл](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md) и любые другие файлы, необходимые библиотеке DLL.

Вы можете создать пользовательскую задачу сборки, чтобы скопировать эти файлы DLL в выходную папку *\<calling project folder>\Debug*, или скопировать файлы вручную.

Обязательно вызовите библиотеку DLL в правильном расположении. Это может показаться очевидным, но, если вызывающее приложение находит и загружает другую копию библиотеки DLL, отладчик никогда не достигнет заданных точек останова.

## <a name="debug-a-dll"></a><a name="vxtskdebuggingdllprojectswaystodebugthedll"></a> Отладка библиотека DLL

Библиотеку DLL нельзя запускать напрямую. Ее должно вызывать приложение, обычно это *EXE*-файл. Дополнительные сведения см. в статье [Проекты Visual Studio — C++](/cpp/ide/creating-and-managing-visual-cpp-projects).

Чтобы отладить библиотеку DLL, можно [начать отладку из вызывающего приложения](#vxtskdebuggingdllprojectsthecallingapplication) или [выполнить отладку из проекта DLL](how-to-debug-from-a-dll-project.md), указав вызывающее приложение. Можно также использовать [окно "Интерпретация"](#vxtskdebuggingdllprojectstheimmediatewindow) отладчика для вычисления функций или методов DLL во время разработки без использования вызывающего приложения.

Дополнительные сведения см. в статье [Первое знакомство с отладчиком](../debugger/debugger-feature-tour.md).

### <a name="start-debugging-from-the-calling-app"></a><a name="vxtskdebuggingdllprojectsthecallingapplication"></a> Запуск отладки из вызывающего приложения

Вызывать библиотеку DLL могут следующие виды приложений.

- Приложение из проекта [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] в том же или другом решении из библиотеки DLL.
- Существующее приложение, которое уже развернуто и работает на тестовом или рабочем компьютере.
- Программа расположена в Интернете и доступна по URL–адресу.
- Веб-приложение с веб-страницей, которая внедряет библиотеку DLL.

Выполнить отладку библиотеки DLL из вызывающего приложения можно следующими способами.

- Откройте проект для вызывающего приложения и начните отладку, выбрав **Отладка** > **Начать отладку** или нажав клавишу **F5**.

  or

- Выполните присоединение к приложению, которое уже развернуто и работает на тестовом или рабочем компьютере. Используйте этот вариант для библиотек DLL на веб-сайтах или в веб-приложениях. Дополнительные сведения см. в разделе [Практическое руководство. Присоединение к выполняемому процессу](../debugger/attach-to-running-processes-with-the-visual-studio-debugger.md).

Перед запуском отладки этого вызывающего приложения нужно установить точку останова в DLL. См. статью [Использование точек останова](../debugger/using-breakpoints.md). При попадании в точку останова DLL можно пошагово проходить по коду, наблюдая действия в каждой строке. Дополнительные сведения см. в статье [Навигация по коду с помощью отладчика](../debugger/navigating-through-code-with-the-debugger.md).

Во время отладки в окне **Модули** можно проверить библиотеки DLL и *EXE*-файлы, загружаемые приложением. Чтобы открыть окно **Модули**, во время отладки выберите **Отладка** > **Окна** > **Модули**. Дополнительные сведения см. в разделе [Практическое руководство. использовать окно модулей](../debugger/how-to-use-the-modules-window.md).

### <a name="use-the-immediate-window"></a><a name="vxtskdebuggingdllprojectstheimmediatewindow"></a> Использование окна "Интерпретация"

Окно **Интерпретация** можно использовать для вычисления функций или методов DLL во время разработки. Окно **Интерпретация** выполняет роль вызывающего приложения.

>[!NOTE]
>Окно **Интерпретация** можно использовать во время разработки с большинством типов проектов. Оно не поддерживается для SQL, веб-проектов или скриптов.

Например, чтобы протестировать метод с именем `Test` в классе `Class1`, выполните следующие действия.

1. Откройте проект DLL, откройте окно **Интерпретация**, последовательно выбрав пункты **Отладка** > **Окна** > **Интерпретация** или нажав сочетание клавиш **CTRL**+**ALT**+**I**.

1. Создайте объект типа `Class1`, введя следующий код C# в окне **Интерпретация** и нажав клавишу **ВВОД**. Этот управляемый код работает для C# и Visual Basic с соответствующими изменениями синтаксиса.

   ```csharp
   Class1 obj = new Class1();
   ```

   В C# все имена должны быть указаны полностью. Когда языковая служба пытается вычислить выражение, все методы или переменные должны находиться в текущей области и контексте.

1. Предположим, что `Test` принимает один параметр `int` , вычислим `Test` с помощью окна **Интерпретация** :

   ```csharp
   ?obj.Test(10);
   ```

   Результат будет выведен в окне **Интерпретация**.

1. Можно продолжить отладку `Test`, установив в нем точку останова, а затем снова вычислив эту функцию.

   Будет достигнута точка останова и можно будет пошагово пройти `Test`. После выполнения `Test`, отладчик вернется в режим разработки.

## <a name="mixed-mode-debugging"></a><a name="vxtskdebuggingdllprojectsmixedmodedebugging"></a> Отладка в смешанном режиме

Вы можете написать вызывающее приложение для библиотеки DLL в управляемом или машинном коде. Если собственное приложение вызывает управляемую библиотеку DLL и вы хотите выполнить отладку этих двух объектов, можно включить управляемые и машинные отладчики в свойствах проекта. Точный способ выполнения этой операции зависит от того, откуда будет начата отладка: из проекта DLL или из проекта вызывающего приложения. Дополнительные сведения см. в разделе [Практическое руководство. Отладка в смешанном режиме](../debugger/how-to-debug-in-mixed-mode.md).

Можно выполнить отладку собственной библиотеки DLL из управляемого вызывающего проекта. Дополнительные сведения см. в статье об [отладке управляемого и машинного кода](how-to-debug-managed-and-native-code.md).

## <a name="see-also"></a>См. также
- [Отладка управляемого кода](../debugger/debugging-managed-code.md)
- [Подготовка к отладке проектов C++](../debugger/debugging-preparation-visual-cpp-project-types.md)
- [Типы проектов C#, F# и Visual Basic](../debugger/debugging-preparation-csharp-f-hash-and-visual-basic-project-types.md)
- [Параметры проекта для конфигурации отладки C++](../debugger/project-settings-for-a-cpp-debug-configuration.md)
- [Параметры проекта для конфигураций отладки C#](../debugger/project-settings-for-csharp-debug-configurations.md)
- [Параметры проекта для конфигурации отладки Visual Basic](../debugger/project-settings-for-a-visual-basic-debug-configuration.md)
- [Безопасность отладчика](../debugger/debugger-security.md)
