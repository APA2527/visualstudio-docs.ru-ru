---
title: Список событий графики | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- vs.graphics.eventlist
ms.assetid: a1252e19-b27d-4dc7-a16b-fdac894c1f0e
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: d5c4e8f39ff77779985536e53d98ddc2785b109b
ms.sourcegitcommit: 257fc60eb01fefafa9185fca28727ded81b8bca9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2019
ms.locfileid: "72911493"
---
# <a name="graphics-event-list"></a>Список событий графики
Список событий графики в анализаторе графики Visual Studio служит для изучения событий Direct3D, возникших при отрисовке определенного кадра игры или приложения.

 Это список событий:

 ![Список событий, в имени которых есть "index".](media/gfx_diag_demo_event_list_orientation.png "gfx_diag_demo_event_list_orientation")

## <a name="using-the-event-list"></a>Использование списка событий
 Выбор события в списке событий отражается на информации, выводимой другими инструментами анализа графики. Используя список событий в сочетании с другими инструментами, можно подробно изучить проблему отрисовки, чтобы определить ее причину. Подробнее о том, как устранять проблемы отрисовки, используя список событий в сочетании с другими инструментами анализа графики, см. в статье [Примеры диагностики графики](graphics-diagnostics-examples.md).

 Эффективное использование возможностей списка событий — важное условие для решения проблем со сложными кадрами, которые могут содержать тысячи событий. Эффективное использование списка событий предполагает выбор наиболее подходящего вам представления, фильтрацию списка событий с помощью поиска, переход по ссылкам для получения дополнительной информации об объектах Direct3D, связанных с событием, и использование кнопок со стрелками для быстрого перемещения между вызовами Draw.

### <a name="color-coded-events-in-direct3d-12"></a>Обозначенные цветом события в Direct3D 12
 Direct3D 12 предоставляет несколько очередей, которые соответствуют различным аппаратным функциям. Чтобы помочь вам определить очередь, связанную с определенным событием графики в Direct3D 12, события в списке событий выделены цветом в зависимости от их очереди при работе с зарегистрированными данными приложения Direct3D 12.

|Очередь Direct3D 12|Цвет|
|-----------------------|-----------|
|Очередь отрисовки|Зеленый|
|Очереди вычислений|Желтый|
|Очередь копирования|Оранжевый|

 Direct3D 11 не предоставляют несколько очередей, поэтому события не выделяются цветом в списке событий при работе с зарегистрированными данными приложения Direct3D 11.

### <a name="event-list-views"></a>Представления списка событий
 Список событий поддерживает два разных представления, в которых события графики упорядочиваются по-разному в соответствии с рабочим процессом и вашими предпочтениями. Первое представление — это *рабочее представление GPU* , в котором события и связанные с ними состояния упорядочиваются иерархически. Второе — это *представление временной шкалы*, в котором события упорядочиваются хронологически в виде плоского списка.

 **Рабочее представление GPU** отображает захваченные события и их состояние в иерархии. Верхний уровень иерархии состоит из событий, таких как вызовы Draw, события очистки, события Present и события, связанные с представлениями. В списке событий можно развернуть вызов Draw, чтобы увидеть состояние устройства на момент вызова. Далее можно развернуть каждый тип состояния, чтобы увидеть события, которые задали эти значения. На этом уровне также можно увидеть, были ли определенное состояние установлено в предыдущем кадре и были ли оно установлено несколько раз с момента последнего вызова Draw.

 Представление **временной шкалы** отображает каждое записываемое событие в хронологическом порядке. Такой способ упорядочения списка событий аналогичен использовавшемуся в предыдущих версиях Visual Studio.

##### <a name="to-change-the-event-list-view-mode"></a>Смена режима просмотра для списка событий

- В окне **список событий графики** над списком событий откройте раскрывающийся список **представление** и выберите представление **временная шкала** или **рабочее изображение GPU** .

### <a name="filtering-events"></a>Фильтрация событий
 С помощью поля поиска, расположенного в правом верхнем углу окна **Список событий графики**, можно отфильтровать список событий, включив в него только те события, в именах которых содержатся определенные ключевые слова. Можно указать одно ключевое слово, например `Vertex`, как на иллюстрации выше, или несколько ключевых слов в виде списка, разделенного точками с запятой, например `Draw;Primitive`. Такой список соответствует событиям, в именах которых есть слово `Draw` или `Primitive`. При поиске пробелы учитываются, то есть `VSSet` и `VS Set` — это разные запросы. Поэтому формируйте запросы внимательно.

### <a name="moving-between-draw-calls"></a>Перемещение между вызовами Draw
 Так как изучение вызовов `Draw` имеет особенно важное значение, вы можете использовать кнопки **Переход к следующему вызову Draw** и **Переход к предыдущему вызову Draw**, находящиеся в левом верхнем углу окна **Список событий графики**, для быстрого поиска вызовов Draw и перехода между ними.

### <a name="links-to-graphics-objects"></a>Ссылки на графические объекты
 Для анализа некоторых событий графики может потребоваться дополнительная информация о текущем состоянии Direct3D или объектах Direct3D, на которые ссылается событие. Многие события предоставляют ссылки, перейдя по которым, можно получить эту подробную информацию.

## <a name="kinds-of-events-and-event-markers"></a>Типы событий и маркеров событий
 События, которые отображаются в списке событий, организованы в четыре категории: общие события, события Draw, пользовательские группы событий и пользовательские маркеры событий. Каждое событие, кроме общих, отображается вместе со значком, указывающим на категорию, к которой оно относится.

|Значок|Описание события|
|----------|-----------------------|
|(без значка)|Общее событие<br /> Любое событие, не являющееся пользовательским событием, пользовательской группой событий или событием Draw.|
|![Значок события Draw](media/vsg_eventlist_icon_draw.png "vsg_eventlist_icon_draw")|Событие Draw<br /> Указывает на событие Draw, произошедшее во время захваченного кадра.|
|![Значок маркера события, определяемого пользователем&#45;](media/vsg_eventlist_icon_user.png "vsg_eventlist_icon_user")|Пользовательская группа событий<br /> Группа связанных событий, определенная приложением.|
|![Значок маркера события, определяемого пользователем&#45;](media/vsg_eventlist_icon_user.png "vsg_eventlist_icon_user")|Пользовательский маркер события<br /> Помечает расположение, определенное приложением.|

## <a name="marking-user-defined-events-in-your-app"></a>Маркировка пользовательских событий в приложении
 Пользовательские события относятся к определенному приложению. С их помощью можно сопоставлять важные события, происходящие в приложении, с событиями в списке событий графики. Так, можно создать пользовательские группы событий для упорядочения связанных событий, например служащих для отрисовки пользовательского интерфейса, по группам или иерархиям для более удобного просмотра списка событий или создать маркеры, связанные с отрисовкой объектов определенных типов, чтобы быстро находить соответствующие события в списке событий.

 Для создания пользовательских групп и маркеров в приложении используйте те же API, которые Direct3D предоставляет для использования в других средствах Direct3D. Иногда в различных версиях Direct3D эти эти API меняются, однако основные функциональные возможности остаются прежними.

### <a name="user-defined-events-in-direct3d-12"></a>Пользовательские события в Direct3D 12
 Чтобы создать группы и маркеры в Direct3D 12, используйте API, описанные в этом разделе. В таблице ниже приведены сводные данные по доступным API в зависимости от того, помечаете ли вы события в очереди команд или в списке команд.

|Описание API|[ID3D12CommandQueue](/windows/desktop/api/d3d12/nn-d3d12-id3d12commandqueue)|[ID3D12GraphicsCommandList](/windows/desktop/api/d3d12/nn-d3d12-id3d12graphicscommandlist)|
|---------------------| - | - |
|Проверка доступности пользовательского события|[PIXGetStatus](/previous-versions//dn788637(v=vs.85))|[PIXGetStatus](/previous-versions//dn788637(v=vs.85))|
|Начало группы событий|[PIXBeginEvent](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-beginevent)|[PIXBeginEvent](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-beginevent)|
|Завершение группы событий|[PIXEndEvent](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-endevent)|[PIXEndEvent](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-endevent)|
|Создание маркера события|[PIXSetMarker](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-setmarker)|[PIXSetMarker](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setmarker)|

### <a name="user-defined-events-in-direct3d-11-and-earlier"></a>Пользовательские события в Direct3D 11 и более ранних версий
 Чтобы создать группы и маркеры в Direct3D 11 или более ранних версий, используйте API, описанные в этом разделе. В таблице ниже приведены API, которые можно использовать для Direct3D 11 и более ранних версий.

|Описание API|[ID3D11DeviceContext2](/windows/desktop/api/d3d11_2/nn-d3d11_2-id3d11devicecontext2) (Direct3D 11.2)|[ID3DUserDefinedAnnotation](/windows/win32/api/d3d11_1/nn-d3d11_1-id3duserdefinedannotation) (Direct3D 11.1)|Семейство API D3DPerf_ (Direct3D 11.0 и более ранних версий)|
|---------------------| - | - | - |
|Начало группы событий|`BeginEventInt`|`BeginEvent`|`D3DPerf_BeginEvent`|
|Завершение группы событий|`EndEventInt`|`EndEvent`|`D3DPerf_EndEvent`|
|Создание маркера события|`SetMarkerInt`|`SetMarker`|`D3DPerf_SetMarker`|

 Вы можете использовать любые API, которые поддерживает ваша версия Direct3D. Например, чтобы создать маркер события для API Direct3D 11.1, можно воспользоваться интерфейсом `SetMarker` или `D3DPerf_SetMarker`, но не интерфейсом `SetMarkerInt`, так как он доступен только в Direct3D 11.2. Кроме того, в одном приложении можно использовать сочетание API, поддерживающих различные версии Direct3D.

<!-- VERSIONLESS -->
<a name="resource-history"></a>
## <a name="resource-history"></a>Журнал ресурсов
Visual Studio 2017 и более поздние версии содержат окно **Журнал ресурсов** .  При выборе значка просмотра ![значок контрольного значения](media/gfx_watch.png) рядом с записью в окне **список событий** откроется окно **Журнал ресурсов** , показанное ниже:

![Журнал ресурсов](media/gfx_diag_resource_history.png)

Это окно позволяет просматривать историю выбранного элемента в списке событий.  Раскрывающееся меню вверху можно использовать для выбора других элементов для просмотра журнала.  В верхней половине окна содержатся **события настройки кадра**.  Это события, которые попадают в категорию *CREATE* Type и являются вызовами, которые обычно инициализируют и создают ресурс.  В нижней половине окна содержится раздел **события кадров** .  Это обычные события чтения и записи, происходящие во время использования ресурса.

| Столбец | Описание |
|-----------| - |
| **Type** | Показывает тип записи, как правило, *Создание*, *Чтение* и *запись*. |
| **Вид** | Отображает эскиз ресурса в данный момент времени.  Дважды щелкните эскиз, чтобы открыть подробное представление ресурса в это время. |
| **Event** | Показывает вызов метода, который вызвал событие.  Чтобы просмотреть дополнительные данные об отдельных элементах, щелкните значок просмотра ![значок контрольного значения](media/gfx_watch.png) на соответствующей строке.  Кроме того, для получения дополнительных сведений можно выбрать любой элемент, который отображается синим текстом, например `m_commandList` на снимке экрана выше. |

<!-- /VERSIONLESS -->

## <a name="see-also"></a>См. также
- [Пошаговое руководство. Отсутствие объектов вследствие состояния устройства](walkthrough-missing-objects-due-to-device-state.md)