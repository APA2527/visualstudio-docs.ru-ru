---
title: Отладчик HLSL шейдера | Документация Майкрософт
description: С помощью отладчика HLSL в анализаторе графики можно узнать, как ваш код HLSL работает в приложении. Отладчик может имитировать точный поток HLSL, который вас интересует.
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- vs.graphics.shaderviewer
ms.assetid: 4ccec541-3c49-42bd-972a-686eb3a88fbc
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 9d9a51df36a21d0f5234f78f6ac23ebf65f0c414
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99889243"
---
# <a name="hlsl-shader-debugger"></a>Отладчик HLSL шейдера
Отладчик HLSL в анализаторе графики Visual Studio помогает понять, как работает код шейдера HLSL в реальных условиях использования приложения.

 Это отладчик HLSL:

 ![Отладка HLSL с использованием окон контрольных значений и стека вызовов.](media/gfx_diag_demo_hlsl_debugger_orientation.png "gfx_diag_demo_hlsl_debugger_orientation")

## <a name="understanding-the-hlsl-debugger"></a>Что такое отладчик HLSL
 Отладчик HLSL может помочь понять проблемы, возникающие в коде шейдера. Отладка кода HLSL в [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] напоминает отладку кода, написанного на других языках, например на C++, C# или Visual Basic. Вы можете отслеживать содержимое переменных, устанавливать точки останова, пошагово выполнять код и перемещаться по стеку вызовов, как и при отладке кода на других языках.

 Однако поскольку GPU обеспечивают высокую производительность за счет выполнения кода шейдера в нескольких сотнях потоков одновременно, отладчик HLSL предназначен для работы совместно с другими инструментами анализатора графики, предоставляя информацию в наиболее понятном виде. Инструменты анализатора диагностики графики воспроизводят захваченные кадры, используя данные, которые были записаны в журнал графики; отладчик HLSL не отслеживает работу GPU в режиме реального времени во время выполнения кода шейдеров. Поскольку журнал графики содержит достаточно информации для воспроизведения любой части вывода графики, а анализ графики предоставляет средства, которые могут помочь точно выявить пиксель и событие, где произошла ошибка, отладчик HLSL должен имитировать только точный поток шейдера, интересующий пользователя. Это означает, что работу шейдера можно имитировать на ЦП, где хорошо видны все выполняемые операции. Именно благодаря этому работа отладчика HLSL похожа на отладку процессов на ЦП.

 Однако отладчик HLSL в настоящее время имеет следующие ограничения:

- Отладчик HLSL не поддерживает операцию "Изменить и продолжить", однако вы можете внести изменения в свои шейдеры и затем повторно создать кадр для просмотра результатов.

- невозможно отлаживать приложение и его код шейдера одновременно. Однако можно выбирать между ними;

- в окно контрольных значений можно добавлять переменные и регистры, однако выражения не поддерживаются.

  Тем не менее отладчик HLSL обеспечивает лучшую, более приближенную к ЦП, среду отладки по сравнению с другими средствами.

## <a name="hlsl-shader-edit--apply"></a>Режим "Изменить и применить" для шейдеров HLSL
 Отладчик шейдеров HLSL не поддерживает режим "Изменить и продолжить" так же, как отладчик ЦП, потому что модель выполнения GPU не позволяет отменить изменение состояния шейдера. Вместо этого отладчик HLSL поддерживает режим "Изменить и применить", который позволяет изменить исходные файлы HLSL, а затем выбрать команду **Применить**, чтобы повторно создать кадр и увидеть результаты изменений. Измененный код шейдера сохраняется в отдельном файле с целью поддержания целостности исходного файла HLSL проекта, но если вы удовлетворены изменениями, вы можете выбрать команду **Копировать в…** , чтобы скопировать изменения в проект. С помощью этой возможности вы можете быстро выполнять итерацию кода шейдера, содержащего ошибки, и избежать затратных операций повторного построения и захвата в рамках рабочего процесса отладки HLSL.

## <a name="hlsl-disassembly"></a>Дизассемблирование HLSL
 Отладчик шейдеров HLSL предоставляет код сборки шейдеров HLSL справа от исходного кода HLSL.

## <a name="debugging-hlsl-code"></a>Отладка кода HLSL
 Отладчик HLSL можно запускать из окна "Этапы конвейера" или "Журнал пикселей".

#### <a name="to-start-the-hlsl-debugger-from-the-graphics-pipeline-stages-window"></a>Запуск отладчика HLSL из окна "Этапы графического конвейера"

1. В окне **Этапы графического конвейера** найдите этап конвейера, связанный с шейдером, который требуется отладить.

2. Под заголовком этапа конвейера выберите команду **Начать отладку**, обозначенную небольшой зеленой стрелкой.

    > [!NOTE]
    > Эта точка входа в отладчик HLSL отлаживает только первый поток шейдера для соответствующего этапа, то есть первую обрабатываемую вершину или пиксель. Для доступа к другим потокам этих этапов шейдера можно использовать "Журнал пикселей".

#### <a name="to-start-the-hlsl-debugger-from-the-graphics-pixel-history"></a>Запуск отладчика HLSL из журнала пикселей графики

1. В окне **Журнал пикселей графики** разверните вызов Draw, связанный с шейдером, который требуется отладить. Каждый вызов рисования может соответствовать нескольким примитивам.

2. В данных вызова рисования разверните примитив, результирующий вклад в цвет которого предположительно содержит ошибку в коде шейдера. Если ошибку могут содержать несколько примитивов, выберите первый их них, чтобы избежать накопления ошибок, которое может затруднить диагностику проблемы.

3. В данных примитива укажите, что следует отлаживать — **Шейдер вершин** или **Шейдер пикселей**. Выберите шейдер вершин, если вы предполагаете, что шейдер пикселей работает правильно, но формирует неверный вклад в цвет, поскольку шейдер вершин передает ему неправильные константы. В противном случае следует отлаживать шейдер пикселей.

    Справа от выбранного шейдера выберите команду **Начать отладку**, обозначенную небольшой зеленой стрелкой.

   > [!NOTE]
   > Эта точка входа в отладчик HLSL отлаживает поток шейдера пикселей, соответствующего выбранному вызову рисования, примитиву или пикселю, или потоки шейдера вершин, результаты которых интерполируются выбранным вызовом рисования, примитивом или пикселем. В случае шейдеров вершин можно дополнительно уточнить точку входа (до конкретной вершины), развернув сведения шейдера вершин.

   Примеры использования отладчика HLSL для устранения ошибок шейдеров см. в разделе [Примеры](graphics-diagnostics-examples.md) и в пошаговых руководствах, указанных в разделе "См. также".

## <a name="see-also"></a>См. также
- [Пошаговое руководство: Отсутствие объектов вследствие заливки вершин](walkthrough-missing-objects-due-to-vertex-shading.md)
- [Пошаговое руководство: Отладка ошибок отрисовки, возникающих из-за заливки](walkthrough-debugging-rendering-errors-due-to-shading.md)
- [Пошаговое руководство: Использование диагностики графики для отладки вычислительного шейдера](walkthrough-using-graphics-diagnostics-to-debug-a-compute-shader.md)