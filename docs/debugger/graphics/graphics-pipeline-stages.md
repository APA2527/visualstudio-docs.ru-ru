---
title: Этапы графического конвейера | Документация Майкрософт
description: Устранение проблем с отрисовкой путем просмотра результатов преобразования вызова Draw на каждом этапе графического конвейера Direct3D.
ms.custom: SEO-VS-2020
ms.date: 02/09/2017
ms.topic: conceptual
f1_keywords:
- vs.graphics.pipeline
ms.assetid: 2bf5c12e-2a00-401c-8163-4e373d08ad3f
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 150c61e271e7951332848a601aaddc619a1c37e5
ms.sourcegitcommit: d10f37dfdba5d826e7451260c8370fd1efa2c4e4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "96993930"
---
# <a name="graphics-pipeline-stages"></a>Этапы графического конвейера
Окно "Этапы графического конвейера" помогает понять, как отдельный вызов Draw преобразуется каждым этапом графического конвейера Direct3D.

 Окно этапов конвейера выглядит следующим образом:

 ![Трехмерный объект проходит через этапы конвейера.](media/gfx_diag_demo_pipeline_stages_orientation.png)

## <a name="understanding-the-graphics-pipeline-stages-window"></a>Основные сведения об окне "Этапы графического конвейера"
 Окно этапов конвейера визуализирует результат каждого этапа графического конвейера отдельно для каждого вызова Draw. Как правило, результаты этапов в середине конвейера скрыты, что затрудняет выявление источника проблем отрисовки. Благодаря визуализации каждого этапа по отдельности окно этапов конвейера упрощает поиск места первого возникновения проблемы, например, можно легко определить, что этап шейдера вершин неожиданно заставляет объект отображаться вне экрана.

 После определения этапа, на котором возникает проблема, можно использовать другие средства анализатора графики для анализа того, как данные были интерпретированы или преобразованы. Проблемы отрисовки, возникающие на этапах конвейера, часто связаны с неверными дескрипторами формата вершин, ошибками в программах шейдеров или неправильно настроенным состоянием.

### <a name="links-to-related-graphics-objects"></a>Ссылки на связанные графические объекты
 Иногда для того, чтобы определить, почему вызов Draw взаимодействует определенным образом с графическим конвейером, необходим дополнительный контекст. Чтобы облегчить поиск такого дополнительного контекста, окно "Этапы графического конвейера" ссылается на один или несколько объектов, которые предоставляют дополнительный контекст для операций, выполняемых в графическом конвейере.

- В Direct3D 12 этот объект обычно является список команд.

- В Direct3D 11 этот объект обычно является контекстом графического устройства.

  Эти ссылки являются частью текущей сигнатуры события графики, расположенной в левом верхнем углу окна "Этапы графического конвейера". Откройте любую из этих ссылок для просмотра дополнительных сведений об объекте.

### <a name="viewing-and-debugging-shader-code"></a>Просмотр и отладка кода шейдера
 Можно выполнить анализ и отладку кода для вершин, поверхностей, доменов, геометрий и построителей текстуры с помощью элементов управления в нижней части соответствующих этапов в окне этапов конвейера.

#### <a name="to-view-a-shaders-source-code"></a>Просмотр исходного кода шейдера

- В окне **Этапы графического конвейера** найдите этап шейдера, соответствующий тому шейдеру, который вы хотите проанализировать. Затем под изображением предварительного просмотра перейдите по ссылке заголовка этапа шейдера, например, перейдите по ссылке **Vertex Shader obj:30**, чтобы просмотреть исходный код шейдера вершин.

    > [!TIP]
    > Номер объекта **obj:30** идентифицирует этот шейдер во всем интерфейсе анализатора графики, например в таблице объектов или окне журнала пикселей.

#### <a name="to-debug-a-shader"></a>Отладка шейдера

- В окне **Этапы графического конвейера** найдите этап шейдера, соответствующий тому шейдеру, отладку которого вы хотите выполнить. Затем под изображением предварительного просмотра выберите **Начать отладку**. Эта точка входа в отладчик HLSL по умолчанию устанавливается на первый вызов шейдера для соответствующего этапа, то есть первый пиксель, вершина или примитив, обрабатываемые шейдером во время вызова Draw. Доступ к вызовам этого шейдера для определенного пикселя или определенной вершины можно получить с помощью окна **Журнал пикселей графики**.

### <a name="the-pipeline-stages"></a>Этапы конвейера
 Окно этапов конвейера визуализирует те этапы конвейера, которые были активны во время вызова Draw. Каждый этап графического конвейера преобразует входные данные из предыдущего этапа и передает результат в следующий этап. Самый первый этап — сборщик входных данных — принимает индекс и данные вершин из приложения в качестве входных данных, а самый последний этап — средство слияния вывода — объединяет новые отрисованные пиксели с текущим содержимым буфера кадров или целевым объектом прорисовки в качестве выходных данных, чтобы создать окончательное изображение, которое выводится на экран.

> [!NOTE]
> Вычислительные шейдеры в окне **Этапы графического конвейера** не поддерживаются.

 **Сборщик входных данных.** Сборщик входных данных считывает данные индексов и вершин, заданные приложением, и выполняет их сборку для графического оборудования.

 В окне этапов конвейера выходные данные сборщика входных данных визуализируются в виде каркасной модели. Чтобы лучше рассмотреть результат, выберите **Сборщик входных данных** в окне **Этапы графического конвейера** для просмотра собранных вершин в полностью трехмерном режиме с использованием редактора моделей.

> [!NOTE]
> Если семантика `POSITION` отсутствует в выводе сборщика входных данных, на этапе **Сборщик входных данных** ничего не отображается.

 **Шейдер вершин.** На этапе шейдеров вершин вершины обычно обрабатываются путем выполнения таких операций, как преобразования, натягивание оболочки и освещение. Шейдеры вершин создают то же число вершин, которое они принимают в качестве входных данных.

 В окне этапов конвейера выходные данные шейдеров вершин визуализируются в виде каркасного растрового изображения. Чтобы лучше рассмотреть результат, выберите **Шейдер вершин** в окне **Этапы графического конвейера** для просмотра обработанных вершин в редакторе изображений.

> [!NOTE]
> Если семантика `POSITION` или `SV_POSITION` отсутствует в выводе шейдера вершин, на этапе **Шейдер вершин** ничего не отображается.

 **Шейдер поверхности** (только для Direct3D 11 и Direct3D 12). На этапе шейдеров поверхности обрабатываются контрольные точки, определяющие поверхность низкого порядка, например линию, треугольник или четырехугольник. В качестве выходных данных этот этап создает исправление геометрии более высокого порядка и константы исправления, которые передаются на этап тесселяции с фиксированными функциями.

 Этап шейдеров поверхностей не визуализируется в окне этапов конвейера.

 **Этап тесселяции** (только для Direct3D 11 и Direct3D 12). На этапе тесселяции используется аппаратный модуль с фиксированными функциями (непрограммируемый), который выполняет предварительную обработку домена, представленного выходными данными шейдера поверхностей. В качестве выходных данных он создает шаблон выборки домена и набор примитивов меньшего размера — точки, линии, треугольники, соединяющие эти выборки.

 Этап тесселяции не визуализируется в окне этапов конвейера.

 **Шейдер домена** (только для Direct3D 11 и Direct3D 12). Этап шейдера доменов обрабатывает исправления геометрии более высокого порядка из шейдера поверхности вместе с факторами тесселяции из этапа тесселяции. Факторы тесселяции могут включать в себя как факторы входных данных тесселяции, так и факторы выходных данных. В качестве выходных данных этап вычисляет позицию вершины точки на выходном исправлении в соответствии с факторами тесселяции.

 Этап шейдеров доменов не визуализируется в окне этапов конвейера.

 **Шейдер геометрии.** На этапе шейдеров геометрии обрабатываются целые примитивы — точки, линии или треугольники — вместе с дополнительными данными о вершинах для смежных примитивов. В отличие от шейдеров вершин шейдеры геометрии могут создавать больше или меньше примитивов, чем они приняли в качестве входных данных.

 В окне этапов конвейера выходные данные шейдеров геометрии визуализируются в виде каркасного растрового изображения. Чтобы лучше рассмотреть результат, выберите **Шейдер геометрии** в окне **Этапы графического конвейера** для просмотра обработанных примитивов в редакторе изображений.

 **Этап потокового вывода.** На этапе потокового вывода можно перехватывать преобразованные примитивы до растеризации и записывать их в память; оттуда эти данные могут повторно направляться в качестве входных данных в более ранние этапы графического конвейера или считываться ЦП.

 Этап потокового вывода не визуализируется в окне этапов конвейера.

 **Этап растеризации.** На этапе растеризации используется аппаратный модуль с фиксированными функциями (непрограммируемый), который преобразует векторные примитивы — точки, линии, треугольники — в растровое изображение, выполняя построчное преобразование. Во время растеризации вершины преобразуются в однородное пространство обрезки и обрезаются. В выходных данных построители текстуры сопоставляются, а атрибуты отдельных вершин интерполируются по примитиву и подготавливаются для построителя текстуры.

 Этап растеризации не визуализируется в окне этапов конвейера.

 **Шейдер пикселей.** На этапе шейдера пикселей обрабатываются растеризованные примитивы вместе с интерполированными данными вершин для создания значений, таких как цвет и глубина, для отдельных пикселей.

 В окне этапов конвейера выходные данные построителей текстуры визуализируются в виде полноцветного растрового изображения. Чтобы лучше рассмотреть результат, выберите **Построитель текстуры** в окне **Этапы графического конвейера** для просмотра обработанных примитивов в редакторе изображений.

 **Средство слияния вывода.** На этапе средства слияния вывода сочетается эффект новых отрисованных пикселей с содержимым их соответствующих буферов — цветом, глубиной и трафаретом — для создания новых значений в этих буферах.

 В окне этапов конвейера выходные данные средства слияния вывода визуализируются в виде полноцветного растрового изображения. Чтобы лучше рассмотреть результат, выберите **Средство слияния вывода** в окне **Этапы графического конвейера** для просмотра объединенного буфера кадров.

### <a name="vertex-and-geometry-shader-preview"></a>Предварительный просмотр для шейдеров вершин и геометрии
 Выбрав этап шейдера вершин или геометрии в окне **Этапы конвейера**, вы можете просмотреть входные и выходные данные выбранного шейдера на панели внизу.  Здесь вы найдете сведения о списке вершин, предоставленном шейдерам после сборки на этапе сборщика входных данных.

 ![Средство просмотра входного буфера на стадии шейдера вершин](media/gfx_diag_vertex_shader_inbuffers.png)

 Чтобы просмотреть результат этапа шейдеров вершин, выберите эскиз этапа шейдеров вершин для просмотра полноразмерного растеризованного каркаса сетки после его преобразования шейдером вершин.

 ![Результат предварительного просмотра стадии шейдера вершин](media/gfx_diag_vertex_shader_preview.png)

## <a name="see-also"></a>См. также
- [Пошаговое руководство: Отсутствие объектов вследствие заливки вершин](walkthrough-missing-objects-due-to-vertex-shading.md)
- [Пошаговое руководство: Отладка ошибок отрисовки, возникающих из-за заливки](walkthrough-debugging-rendering-errors-due-to-shading.md)