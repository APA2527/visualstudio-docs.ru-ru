---
title: Захват графической информации | Документация Майкрософт
ms.date: 02/09/2017
ms.topic: conceptual
f1_keywords:
- vs.graphics.frame
- vs.graphics.capturewindow
- VS.ToolsOptionsPages.Graphics_Diagnostics.Capture
ms.assetid: 187ce86e-e340-4f6c-8937-8e8f1027a17f
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: b38dd994eca30bfee071f00431f3b111c2ea444a
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72736186"
---
# <a name="capturing-graphics-information"></a>Захват графической информации
Захватывайте информацию графики из приложений DirectX, чтобы можно было использовать анализатор графики Visual Studio для диагностики проблем отрисовки и проблем производительности.

## <a name="capturing-graphics-information"></a>Захват графической информации
 Захват графической информации представляет собой двухэтапный процесс. На первом этапе приложение запускается в режиме диагностики графики и указываются один или более кадров для захвата подробной графической информации.

### <a name="to-run-your-app-under-graphics-diagnostics"></a>Запуск приложения в режиме диагностики графики

- В строке меню выберите **Отладка**, **Графика**, **Начать отладку графики**. (Клавиатура: Нажмите сочетание клавиш ALT+F5).

- На панели инструментов **Графика** нажмите кнопку **Начать отладку графики**.

  Во время выполнения приложения в режиме диагностики графики постоянно записывается определенная графическая информация; она включает настройку устройства, создания цепочки буферов, создание графических объектов и ресурсов и другие важные события, влияющие более чем на один кадр. В то же время можно записать подробные сведения об определенных кадрах; к ним относятся вызовы рисования и операции вычислительного шейдера, а также объекты Direct3D и поддерживающие их ресурсы.

### <a name="to-capture-a-frame"></a>Захват кадра

- В Visual Studio на панели инструментов **Графика** нажмите кнопку **Захватить кадр**, ![Значок кнопки захвата графики](media/debuggingdirectxgraphics.png "DebuggingDirectXGraphics").

- На клавиатуре нажмите клавишу Print Screen.

  > [!NOTE]
  > Во время выполнения приложения в режиме **Диагностика графика** клавишу PRINT SCREEN можно использовать только для захвата кадра графических данных; она не выполняет свою обычную функцию. Это продолжается до завершения захвата графической информации (как правило, в результате остановки отладки или выхода из приложения обычным образом), даже если в фокусе находится другое приложение.

- В интерфейсе захвата Visual Studio нажмите кнопку **Захват кадра** под временной шкалой **Диагностический сеанс** или нажмите большую кнопку **Захват кадра** под дорожкой **Кадров в секунду** справа от ранее захваченных кадров. Обе кнопки выделены на рисунке ниже.

   ![Захват кадров с помощью средства использования GPU.](media/pix_gpu_usage_tool_capture_frame.png)

   Когда все будет готово для проверки захваченных кадров, запустите **анализатор графики Visual Studio**, перейдя по ссылке **Кадр...** над эскизами или дважды щелкнув эскиз.

  Могут захватываться только целые кадры, поэтому при запуске захвата фактически записывается только графическая информация из следующего кадра. Запись начинается сразу после вывода кадра, на котором был запущен захват, и заканчивается после вывода захваченного кадра. Во время работы приложения в режиме диагностики графики можно захватить любое количество кадров. Если никакие кадры не захватываются, журнал графики очищается.

  Во время записи кадров Visual Studio отображает окно диагностики сеанса (.diagsession). Если закрыть это окно, остановить отладку или закрыть приложение, записать в этот журнал новые кадры будет невозможно. Чтобы получить больше информации графики, необходимо снова запустить приложение в режиме диагностики графики, чтобы начать новый журнал графики.

### <a name="graphics-diagnostics-capture-options"></a>Параметры захвата диагностики графики
 Вы можете настроить функцию захвата так, чтобы собирались стеки вызовов для всех событий графики или только для ограниченного их подмножества, отключить HUD захвата и включить или отключить режим совместимости захвата.

#### <a name="to-configure-graphics-diagnostics-capture-options"></a>Настройка параметров захвата диагностики графики

1. В строке меню в меню "Сервис" выберите пункт "Параметры". Откроется диалоговое окно "Параметры".

2. В списке категорий параметров слева выберите пункт «Диагностика графики», а затем настройте необходимые параметры диагностики графики.

     **Сбор стеков вызовов во время захвата (захват замедляется)** . Установите этот флажок, чтобы собирать стеки вызовов. По умолчанию стеки вызовов не собираются. Чтобы захватывать стеки вызовов, убедитесь, что флажок **Сбор стеков вызова при записи (замедляет запись)** установлен в значение "Включить сбор данных", а затем установите либо параметр **для маркеров рисования, диспетчеризации, представления и производительности** (это параметр по умолчанию), чтобы собирать только наиболее важные стеки вызовов, либо параметр **для всех**, чтобы собирать все стеки вызовов. Чтобы позднее прекратить сбор стеков вызовов, снимите флажок **Сбор стеков вызова при записи (замедляет запись)** .

     **Отключить внутриигровой HUD во время захвата**. Установите этот флажок, чтобы отключить наложение HUD, которое обычно отображается в приложении, находящемся в режиме диагностики графики. Чтобы отображать наложение HUD, снимите этот флажок.

     **Захват в режиме совместимости**. Установите этот флажок, чтобы захватывать графические данные в режиме совместимости. По умолчанию захват выполняется в режиме совместимости. В режиме совместимости Direct3D не будет сообщать о том, что GPU поддерживает дополнительные возможности помимо тех, которые определены на базовом функциональном уровне. Это позволяет предотвратить использование в приложении, в котором выполняется захват, специфичных для оборудования расширений GPU и обеспечивает возможность воспроизведения журнала графики с помощью любого GPU, поддерживающего тот же или более высокий функциональный уровень. Чтобы отключить режим совместимости, снимите этот флажок. Журналы, захваченные при отключенном режиме совместимости, не удастся воспроизвести на GPU, который не поддерживает дополнительные возможности, использовавшиеся приложением во время захвата.

     **Остановить запись при обнаружении ошибок в слоях пакетов SDK**. Установите этот флажок, чтобы немедленно остановить запись, если возникают ошибки.

## <a name="capturing-graphics-information-remotely"></a>Удаленный захват графической информации
 Графическую информацию можно захватывать из приложения, работающего на локальном компьютере или на удаленном компьютере или устройстве. Удаленный захват поддерживается для компьютеров с [!INCLUDE[winblue_client_2](../includes/winblue_client_2_md.md)] и устройств [!INCLUDE[winblue_winrt_2](../includes/winblue_winrt_2_md.md)]. Чтобы захватить графическую информацию из приложения, выполняющегося удаленно, настройте проект для удаленной отладки, а затем запустите приложение в режиме диагностики графики, как было описано выше. Приложение будет выполняться на удаленном компьютере, а захваченная графическая информация будет собираться на компьютере разработки.

 Настройка проекта для удаленной отладки зависит от типа разрабатываемого приложения и используемого языка программирования. Сведения о настройке удаленной отладки для приложения UWP см. в статье [Запуск приложений UWP на удаленном компьютере](../run-windows-store-apps-on-a-remote-machine.md). Сведения о настройке удаленной отладки классических приложений для Windows см. в разделе [Удаленная отладка](../remote-debugging.md).

 Впоследствии удаленный компьютер или устройство можно использовать для воспроизведения графической информации независимо от того, где она была захвачена. Дополнительные сведения см. в разделе [Практическое руководство. изменить компьютер воспроизведения диагностики графики](how-to-change-the-graphics-diagnostics-playback-machine.md).

## <a name="capturing-graphics-information-from-the-command-line"></a>Захват графических данных из командной строки
 С помощью программы командной строки можно захватывать графические данные из любых приложений. Программа DXCap.exe позволяет быстро захватывать и воспроизводить графические данные без использования Visual Studio или программного захвата. В частности, программу DXCap.exe можно использовать для автоматизации или в тестовой среде. Дополнительные сведения о DXCap.exe см. в разделе [Программа командной строки для захвата](command-line-capture-tool.md).

## <a name="see-also"></a>См. также
- [Пошаговое руководство: Запись графических сведений](walkthrough-capturing-graphics-information.md)