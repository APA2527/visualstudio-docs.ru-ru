---
title: Присоединение к выполняющимся процессам с помощью отладчика | Документация Майкрософт
ms.custom: seodec18
ms.date: 04/08/2019
ms.topic: conceptual
f1_keywords:
- vs.debug.processes.attach
- vs.debug.process
- vs.debug.programs
- vs.debug.detaching
- vs.debug.processes
- vs.debug.error.attach
- vs.debug.remotemachine
dev_langs:
- CSharp
- FSharp
- C++
- VB
helpviewer_keywords:
- remote debugging, attaching to programs
- processes, attaching to running processes
- Attach to Process dialog box
- debugging [Visual Studio], attaching to processes
- debugger, processes
ms.assetid: 27900e58-090c-4211-a309-b3e1496d5824
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: f1a41667592b6965497f9b87514719f7d8a5a442
ms.sourcegitcommit: 10d16e18c5f5e482c4c2856e6cacaad283463b65
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/09/2020
ms.locfileid: "75775994"
---
# <a name="attach-to-running-processes-with-the-visual-studio-debugger"></a>Присоединение к выполняемым процессам с использованием отладчика Visual Studio
Отладчик Visual Studio можно подключить к запущенному процессу на локальном или удаленном компьютере. После выполнения процесса выберите **отладка** > **присоединить к процессу** или нажмите клавиши **CTRL**+**ALT**+**P** в Visual Studio и используйте диалоговое окно **Присоединение к процессу** , чтобы подключить отладчик к процессу.

Можно использовать **Присоединение к процессу** для отладки запущенных приложений на локальных или удаленных компьютерах, одновременной отладки нескольких процессов, отладки приложений, которые не были созданы в Visual Studio, или отладки любого приложения, которое не было запущено из Visual Studio с подключенным отладчиком. Например, если вы используете приложение без отладчика и вызвали исключение, можно присоединить отладчик к процессу, в котором выполняется приложение, и начать отладку.

> [!TIP]
> Не уверены, следует ли использовать **Присоединение к процессу** для сценария отладки? См. раздел [Общие сценарии отладки](#BKMK_Scenarios).

## <a name="BKMK_Attach_to_a_running_process"></a>Присоединение к выполняющемуся процессу на локальном компьютере

Чтобы быстро присоединиться к процессу, присоединенному ранее, см. раздел повторное [Подключение к процессу](#BKMK_reattach).

Сведения об отладке процесса на удаленном компьютере см. в разделе [Присоединение к процессу на удаленном компьютере](#BKMK_Attach_to_a_process_on_a_remote_computer).

::: moniker range=">= vs-2019"
Сведения об отладке процесса .NET Core в контейнере DOCKER в Linux см. в разделе [Подключение к контейнеру DOCKER в Linux](#BKMK_Docker_Attach).
::: moniker-end

**Чтобы присоединиться к процессу на локальном компьютере, выполните следующие действия.**

1. В Visual Studio выберите **отладка** > **присоединить к процессу** (или нажмите клавиши **CTRL**+**ALT**+**P**), чтобы открыть диалоговое окно **Присоединение к процессу** .

   Для **типа соединения** должно быть задано значение **по умолчанию**. **Цель подключения** должна быть именем локального компьютера.

   ![DBG_Basics_Attach_To_Process](../debugger/media/DBG_Basics_Attach_To_Process.png "DBG_Basics_Attach_To_Process")

2. В списке **Доступные процессы** найдите и выберите процесс или процессы, к которым нужно присоединиться.

   - Чтобы быстро выбрать процесс, введите его имя или первую букву в поле **фильтры процессов** .

   - Если имя процесса неизвестно, просмотрите список или просмотрите [Общие сценарии отладки](#BKMK_Scenarios) для некоторых распространенных имен процессов.

   >[!TIP]
   >Процессы могут запускаться и останавливаться в фоновом режиме, пока открыто диалоговое окно **Присоединение к процессу** , поэтому список запущенных процессов может не всегда быть текущим. Чтобы просмотреть текущий список, можно в любое время нажать кнопку **Обновить** .

3. В поле **присоединить к** укажите тип кода, который планируется отладить. **Автоматический** параметр по умолчанию работает для большинства типов приложений.

   Чтобы выбрать типы кода вручную, выполните следующие действия.
   1. Нажмите кнопку **Выбрать**.
   1. В диалоговом окне **Выбор типа кода** выберите **Отладка этих типов кода**.
   1. Выберите типы кода, которые необходимо отладить.
   1. Нажмите кнопку **ОК**.

4. Выберите **Подключить**.

>[!NOTE]
>Вы можете присоединиться к нескольким приложениям для отладки, но за раз в отладчике активно только одно приложение. Активное приложение можно задать на панели инструментов или в окне **процессов** **отладки** Visual Studio.

## <a name="BKMK_Attach_to_a_process_on_a_remote_computer"></a> Присоединение к процессу на удаленном компьютере

Можно также выбрать удаленный компьютер в диалоговом окне **Присоединение к процессу** , просмотреть список доступных процессов, запущенных на этом компьютере, и присоединиться к одному или нескольким процессам для отладки. Удаленный отладчик (*msvsmon. exe*) должен выполняться на удаленном компьютере. Дополнительные сведения см. в разделе [Удаленная отладка](../debugger/remote-debugging.md).

Более полные инструкции по отладке приложений ASP.NET, развернутых в службах IIS, см. [в разделе Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md).

**Чтобы присоединиться к выполняющемуся процессу на удаленном компьютере, выполните следующие действия.**

1. В Visual Studio выберите **отладка** > **присоединить к процессу** (или нажмите клавиши **CTRL**+**ALT**+**P**), чтобы открыть диалоговое окно **Присоединение к процессу** .

2. В большинстве случаев **тип соединения** должен быть **значением по умолчанию** . В поле **цель подключения** выберите удаленный компьютер, используя один из следующих методов.

   - Щелкните стрелку раскрывающегося списка рядом с пунктом **целевой объект подключения**и выберите имя компьютера в раскрывающемся списке.
   - Введите имя компьютера в поле **цель подключения** и нажмите клавишу **Ввод**.

     Убедитесь, что Visual Studio добавляет требуемый порт в имя компьютера, которое отображается в формате **\<имя удаленного компьютера >:p порт** .

     ::: moniker range=">= vs-2019"

     > [!NOTE]
     > Если вы не можете подключиться с помощью имени удаленного компьютера, попробуйте использовать IP-адрес и порт (например, `123.45.678.9:4022`). 4024 — это порт по умолчанию для удаленного отладчика Visual Studio 2019 x64. Сведения о других назначениях портов удаленного отладчика см. в разделе [назначение портов удаленного отладчика](remote-debugger-port-assignments.md).

     ::: moniker-end
     ::: moniker range="vs-2017"

     > [!NOTE]
     > Если вы не можете подключиться с помощью имени удаленного компьютера, попробуйте использовать IP-адрес и порт (например, `123.45.678.9:4022`). 4022 — это порт по умолчанию для удаленного отладчика Visual Studio 2017 x64. Сведения о других назначениях портов удаленного отладчика см. в разделе [назначение портов удаленного отладчика](remote-debugger-port-assignments.md).

     ::: moniker-end

   - Нажмите кнопку **найти** рядом с полем **цель подключения** , чтобы открыть диалоговое окно **Удаленные соединения** . В диалоговом окне **удаленные подключения** перечислены все устройства, наявляющиеся в локальной подсети или непосредственно подключенные к компьютеру. Для обнаружения удаленных устройств может потребоваться [открыть UDP-порт 3702](../debugger/remote-debugger-port-assignments.md) на сервере. Выберите нужный компьютер или устройство и нажмите кнопку **выбрать**.

   > [!NOTE]
   > Параметр **типа соединения** сохраняется между сеансами отладки. Параметр **целевого объекта подключения** сохраняется между сеансами отладки только в том случае, если для этого целевого объекта произошло успешное подключение отладки.

3. Нажмите кнопку **Обновить** , чтобы заполнить список **Доступные процессы** .

    >[!TIP]
    >Процессы могут запускаться и останавливаться в фоновом режиме, пока открыто диалоговое окно **Присоединение к процессу** , поэтому список запущенных процессов может не всегда быть текущим. Чтобы просмотреть текущий список, можно в любое время нажать кнопку **Обновить** .

4. В списке **Доступные процессы** найдите и выберите процесс или процессы, к которым нужно присоединиться.

   - Чтобы быстро выбрать процесс, введите его имя или первую букву в поле **фильтры процессов** .

   - Если имя процесса неизвестно, просмотрите список или просмотрите [Общие сценарии отладки](#BKMK_Scenarios) для некоторых распространенных имен процессов.

   - Чтобы найти процессы, работающие под всеми учетными записями пользователей, установите флажок **Отображать процессы всех пользователей** .

     >[!NOTE]
     >Если попытаться подключиться к процессу, работающему под управлением ненадежной учетной записи, появится диалоговое окно подтверждения с предупреждением безопасности. Дополнительные сведения см. в разделе [предупреждение системы безопасности: Присоединение к процессу, принадлежит недоверенному пользователю может быть опасно. Если следующие сведения не вызывают доверия, то не следует присоединяться к процессу](../debugger/security-warning-attaching-to-a-process-owned-by-an-untrusted-user.md).

5. В поле **присоединить к** укажите тип кода, который планируется отладить. **Автоматический** параметр по умолчанию работает для большинства типов приложений.

   Чтобы выбрать типы кода вручную, выполните следующие действия.
   1. Нажмите кнопку **Выбрать**.
   1. В диалоговом окне **Выбор типа кода** выберите **Отладка этих типов кода**.
   1. Выберите типы кода, которые необходимо отладить.
   1. Нажмите кнопку **ОК**.

6. Выберите **Подключить**.

>[!NOTE]
>Вы можете присоединиться к нескольким приложениям для отладки, но за раз в отладчике активно только одно приложение. Активное приложение можно задать на панели инструментов или в окне **процессов** **отладки** Visual Studio.

В некоторых случаях при отладке в сеансе удаленный рабочий стол (службы терминалов) в списке **Доступные процессы** не отображаются все доступные процессы. Если вы используете Visual Studio в качестве пользователя с ограниченной учетной записью пользователя, в списке **Доступные процессы** не будут отображаться процессы, выполняющиеся в сеансе 0. Сеанс 0 используется для служб и других серверных процессов, включая *w3wp. exe*. Можно устранить эту проблему, запустив [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] под учетной записью администратора или запустив [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] с консоли сервера вместо сеанса служб терминалов.

Если ни один из этих обходных путей использовать невозможно, третий вариант — присоединение к процессу путем запуска `vsjitdebugger.exe -p <ProcessId>` из командной строки Windows. Идентификатор процесса можно определить с помощью *Tlist. exe*. Чтобы получить файл *tlist.exe*, скачайте и установите средства отладки для Windows, которые доступны на странице [скачиваемых файлов WDK и WinDbg](/windows-hardware/drivers/download-the-wdk).

::: moniker range=">= vs-2019"

## <a name="BKMK_Docker_Attach"></a>Присоединение к процессу, выполняющемуся в контейнере DOCKER в Linux

Вы можете подключить отладчик Visual Studio к процессу, выполняемому в контейнере DOCKER .NET Core на локальном или удаленном компьютере, с помощью диалогового окна **Присоединение к процессу** .

> [!IMPORTANT]
> Чтобы использовать эту функцию, необходимо установить рабочую нагрузку кросс-платформенное проектирование .NET Core и иметь локальный доступ к исходному коду.

**Чтобы присоединиться к выполняющемуся процессу в контейнере DOCKER в Linux, сделайте следующее:**

1. В Visual Studio выберите **отладка > присоединить к процессу (Ctrl + Alt + P)** , чтобы открыть диалоговое окно **Присоединение к процессу** .

![Меню "присоединение к процессу"](../debugger/media/attach-process-menu.png "Attach_To_Process_Menu")

2. Установите **тип подключения** **DOCKER (контейнер Linux)** .
3. Выберите **найти...** , чтобы задать **целевой объект подключения** с помощью диалогового окна **Выбор контейнера DOCKER** .

    Процесс контейнера DOCKER можно отлаживать как локально, так и удаленно.
    
    **Для локальной отладки процесса контейнера DOCKER выполните следующие действия.**
    1. Задайте для **узла DOCKER CLI** **локальный компьютер**.
    1. Выберите контейнер, к которому нужно подключиться из списка, и нажмите **кнопку ОК**.
    
    ![Выбрать меню контейнера DOCKER](../debugger/media/select-docker-container.png "Select_Docker_Container_Menu")
 
    **Б. для удаленной отладки контейнера DOCKER выполните следующие действия.**
    
    > [!NOTE] 
    > Существует два варианта удаленного подключения к выполняющемуся процессу в контейнере DOCKER. Первый способ использования SSH — идеальный вариант, если на локальном компьютере не установлены средства DOCKER.  Если средства DOCKER установлены локально и у вас есть управляющая программа DOCKER, настроенная на прием удаленных запросов, попробуйте второй вариант с помощью управляющей программы DOCKER.

    1. ***Чтобы подключиться к удаленному компьютеру по протоколу SSH, сделайте следующее:***
        1. Нажмите кнопку **Добавить...** , чтобы подключиться к удаленной системе.<br/>
        ![Подключение к удаленной системе](../debugger/media/connect-remote-system.png "Подключение к удаленной системе")
        1. Выберите запущенный контейнер для подключения после успешного подключения к SSH или управляющей программе и нажмите **кнопку ОК**.

    
    1. ***Назначение цели удаленному контейнеру, выполняющему процесс через [управляющую программу DOCKER](https://docs.docker.com/engine/reference/commandline/dockerd/)***
        1. Укажите адрес управляющей программы (т. е. через TCP, IP и т. д.) в **узле DOCKER (необязательно)** и щелкните ссылку Обновить.
        1. Выберите запущенный контейнер для присоединения после успешного подключения к управляющей программе и нажатия **кнопки ОК**.

4. Выберите соответствующий процесс контейнера из списка **доступных процессов** и щелкните **присоединить** , чтобы начать отладку процесса C# контейнера в Visual Studio.

    ![Завершено меню присоединения DOCKER](../debugger/media/docker-attach-complete.png "Завершено меню присоединения DOCKER")


::: moniker-end

## <a name="BKMK_reattach"></a>Повторное подключение к процессу

Вы можете быстро присоединиться к процессам, к которым ранее были присоединены, выбрав **отладка** > повторно **присоединить к процессу** (**SHIFT**+**ALT**+**P**). При выборе этой команды отладчик сразу же пытается присоединиться к последним процессам, подключенным к, с первой попыткой выполнить сопоставление с предыдущим ИДЕНТИФИКАТОРом процесса, если это не удается, путем сопоставления с предыдущим именем процесса. Если совпадений не найдено или если несколько процессов имеют одно и то же имя, откроется диалоговое окно **Присоединение к процессу** , в котором можно выбрать правильный процесс.

> [!NOTE]
> Команда **Повторное подключение к процессу** доступна начиная с Visual Studio 2017.

## <a name="BKMK_Scenarios"></a>Распространенные сценарии отладки

Чтобы определить, следует ли использовать **Присоединение к процессу** и какой процесс присоединить к, в следующей таблице приведены несколько распространенных сценариев отладки с ссылками на дополнительные инструкции, где это возможно. (Список не является исчерпывающим.)

Для некоторых типов приложений, например приложений универсальных приложений Windows (UWP), прямое подключение к имени процесса не выполняется, но вместо этого используется пункт меню **Отладка установленного пакета приложения** в Visual Studio (см. таблицу).

Чтобы отладчик мог присоединиться к коду на языке C++, код должен предоставлять `DebuggableAttribute`. Это можно добавить в код автоматически, путем связывания с параметром [/ASSEMBLYDEBUG](/cpp/build/reference/assemblydebug-add-debuggableattribute) компоновщика.

Для отладки скриптов на стороне клиента в браузере должна быть включена отладка скриптов. Для отладки клиентского скрипта на Chrome выберите **Web Kit** в качестве типа кода и в зависимости от типа приложения может потребоваться закрыть все экземпляры Chrome и запустить браузер в режиме отладки (введите `chrome.exe --remote-debugging-port=9222` из командной строки).

Чтобы быстро выбрать выполняющийся процесс для подключения, в Visual Studio введите **Ctrl**+**ALT**+**P**, а затем введите первую букву имени процесса.

|Сценарий|Метод Debug|Имя процесса|Примечания и ссылки|
|-|-|-|-|
|Удаленная отладка ASP.NET 4 или 4,5 на сервере IIS|Использование средств удаленного **взаимодействия и присоединение к процессу**|*w3wp.exe*|См. раздел [Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md) .|
|ASP.NET Core удаленной отладки на сервере IIS|Использование средств удаленного **взаимодействия и присоединение к процессу**|*dotnet.exe*|Сведения о развертывании приложений см. [в разделе Publishing to IIS](https://docs.asp.net/en/latest/publishing/iis.html). Сведения об отладке см. [в разделе Удаленная отладка ASP.NET Core на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-computer.md) .|
|Отладка клиентского скрипта на локальном сервере IIS для поддерживаемых типов приложений |Использовать **Присоединение к процессу**|*Chrome. exe*, *микрософтеджекп. exe*или *iexplore. exe*|Необходимо включить отладку скриптов. Для Chrome необходимо также запустить Chrome в режиме отладки и выбрать **код WebKit** в поле **присоединить к** .|
|Отладка C#a, Visual Basic или C++ приложения на локальном компьютере|Использовать стандартную отладку (**F5**) или **присоединить к процессу**|*\<AppName >. exe*|В большинстве случаев следует использовать стандартную отладку и не **присоединять к процессу**.|
|Удаленная отладка классического приложения Windows|Удаленные средства|Н/Д| См. раздел [Удаленная отладка a C# или Visual Basic приложение](../debugger/remote-debugging-csharp.md) или [Удаленная отладка C++ приложения](../debugger/remote-debugging-cpp.md) .|
|Отладка приложения ASP.NET на локальном компьютере после запуска приложения без отладчика|Использовать **Присоединение к процессу**|*iiexpress.exe*|Это может быть полезно для ускорения загрузки приложения, например (например,) при профилировании. |
|Отладка других поддерживаемых типов приложений в серверном процессе|Если сервер является удаленным, используйте средства удаленного **выполнения и присоедините к процессу** .|*Chrome. exe*, *iexplore. exe*или другие процессы|При необходимости используйте монитор ресурсов, чтобы помочь определить процесс. См. раздел [Удаленная отладка](../debugger/remote-debugging.md).|
|Удаленная отладка универсального приложения Windows (UWP), OneCore, HoloLens или приложения IoT|Отладка установленного пакета приложения|Н/Д|См. раздел [Отладка установленного пакета приложения](debug-installed-app-package.md) вместо использования **присоединения к процессу** .|
|Отладка универсального приложения Windows (UWP), OneCore, HoloLens или приложения IoT, которое не было запущено из Visual Studio|Отладка установленного пакета приложения|Н/Д|См. раздел [Отладка установленного пакета приложения](debug-installed-app-package.md) вместо использования **присоединения к процессу** .|

## <a name="use-debugger-features"></a>Использование функций отладчика

Чтобы использовать все функции отладчика Visual Studio (например, точки останова) при присоединении к процессу, приложение должно точно соответствовать локальному источнику и символам. То есть отладчик должен иметь возможность загружать правильные [файлы символов (. pdb)](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md). По умолчанию для этого требуется отладочная сборка.

В сценариях удаленной отладки должен быть уже открыт исходный код (или копия исходного кода) в Visual Studio. Скомпилированные двоичные файлы приложения на удаленном компьютере должны поступать из той же сборки, что и на локальном компьютере.

В некоторых локальных сценариях отладки в Visual Studio можно выполнять отладку без доступа к источнику, если в приложении есть правильные файлы символов. По умолчанию для этого требуется отладочная сборка. Дополнительные сведения см. в разделе [Указание исходных символов и файлов](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md).

## <a name="BKMK_Troubleshoot_attach_errors"></a> Устранение ошибок присоединения
 При присоединении отладчика к выполняющемуся процессу этот процесс может содержать один или несколько типов кода. Типы кода, к которым может присоединиться отладчик, отображаются и выбираются в диалоговом окне **Выбор типа кода** .

 Иногда отладчик может успешно присоединяться к одному типу кода, но не к другому. Такое может происходить при попытке присоединения к процессу, выполняющемуся на удаленном компьютере. На удаленном компьютере для одних типов кода могут иметься компоненты удаленной отладки, а для других — нет. Такое также может происходить при попытке присоединиться к двум или более процессам для прямой отладки базы данных. Отладка SQL поддерживает присоединение только к одному процессу.

 Если отладчик может присоединиться к некоторым (но не всем) типам кода, вы увидите сообщение, указывающее, какие типы не удалось присоединить.

 Если отладчик успешно подключается хотя бы к одному типу кода, то можно приступать к отладке процесса. Но отлаживать можно будет только те типы кода, к которым удалось подсоединиться. Неприсоединенный код в процессе будет по-прежнему работать, но вы не сможете устанавливать точки останова, просматривать данные или выполнять другие операции отладки с этим кодом.

 Если вы хотите получить более конкретные сведения о том, почему отладчику не удалось присоединиться к типу кода, попробуйте повторно присоединиться только к этому типу кода.

 **Чтобы получить подробные сведения о том, почему не удалось присоединиться к типу кода:**

1. Отключитесь от процесса. В меню **Отладка** выберите пункт **Отсоединить все**.

1. Повторно подключитесь к процессу, выбрав только тот тип кода, который не удалось присоединить.

    1. В диалоговом окне **Присоединение к процессу** выберите процесс в списке **Доступные процессы**.

    2. Выберите элемент **Выбрать**.

    3. В диалоговом окне **Выбор типа кода** выберите **Выполнять отладку кода следующих типов** и выберите тип кода, к которому не удалось присоединиться. Отмените выбор других типов кода.

    4. Нажмите кнопку **ОК**.

    5. В диалоговом окне **Присоединение к процессу** выберите **присоединить**.

    На этот раз присоединение не пройдет полностью, и будет выдано сообщение о конкретной ошибке.

## <a name="see-also"></a>См. также:

- [Отладка нескольких процессов](../debugger/debug-multiple-processes.md)
- [JIT-отладка](../debugger/just-in-time-debugging-in-visual-studio.md)
- [Удаленная отладка](../debugger/remote-debugging.md)
