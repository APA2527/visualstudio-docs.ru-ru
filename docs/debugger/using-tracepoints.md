---
title: Запись сведений с помощью точек трассировки | Документация Майкрософт
description: Установка точек трассировки для записи сведений в окно вывода без изменения или остановки кода. Для этого достаточно указать выходную строку под флажком "Действие" в окне "Параметры точки останова".
ms.custom: SEO-VS-2020
ms.date: 10/28/2019
ms.topic: how-to
helpviewer_keywords:
- tracepoints, about tracepoints
author: Sagar-S-S
ms.author: sashe
manager: AndSter
ms.workload:
- multiple
ms.openlocfilehash: 144f83b1be0c3a21aa5cb244f8498f61e3ef380a
ms.sourcegitcommit: 957da60a881469d9001df1f4ba3ef01388109c86
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/13/2021
ms.locfileid: "98150097"
---
# <a name="log-info-to-the-output-window-using-tracepoints-in-visual-studio"></a>Запись сведений в окне выхода с помощью точек трассировки в Visual Studio

Точки трассировки позволяют записывать сведения в окно выхода в разделе настраиваемых условий без изменения или остановки кода. Эта функция поддерживается и для управляемых языков (C#, Visual Basic, F#), и для машинного кода, а также для таких языков, как JavaScript и Python.

## <a name="let39s-take-an-example"></a>Рассмотрим пример.

В следующем примере приводится простой цикл `for` с переменной counter, которая увеличивается на единицу каждый раз, когда цикл выполняет очередную итерацию.

![Пример счетчика](../debugger/media/counterexample.png "Пример счетчика")

## <a name="set-tracepoints-in-source-code"></a>Установка точек трассировки в исходном коде

Чтобы установить точки трассировки, можно указать выходную строку под флажком **Действие** в окне **Параметры точки останова**.

1. Чтобы инициализировать точку трассировки, сначала щелкните поле слева от номера строки, в которой требуется установить точку трассировки.

   ![Инициализация точки останова](../debugger/media/breakpointinitialization.png "Инициализация точки останова")

2. Наведите указатель мыши на красный кружок и щелкните значок шестеренки.
3. Откроется окно **Параметры точки останова**.

   ![Окно точки останова](../debugger/media/breakpointwindow.png "Окно точки останова")

4. Установите флажок **Действие**.

   ![Установленный флажок Действия](../debugger/media/checkedactionsbox.png "Установленный флажок Действия")

   Обратите внимание, что красный кружок изменяется на ромб, что указывает переключение с точки останова на точку трассировки.

5. Введите сообщение, которое хотите выводить, в текстовое поле **Показать сообщение в окне вывода** (дополнительные сведения см. следующих разделах этой статьи).

   Теперь точка трассировки установлена. Если все, что вы хотели сделать, — это записать некоторые сведения в окно вывода, нажмите кнопку &quot;Закрыть&quot;.

6. Если вы хотите добавить условия, определяющие, когда должно отображаться ваше сообщение, установите флажок **Условия**.

   ![Установленный флажок Условия](../debugger/media/checkedconditionsbox.png "Установленный флажок Условия")

   Существует три варианта условий: **условное выражение**, **фильтр** и **количество обращений**.

## <a name="actions-menu"></a>Меню "Действия"

Это меню позволяет записывать сообщения в окно вывода. Введите строки, которые хотите выводить, в поле сообщения (кавычки не требуются). Если нужно отображать значения переменных, обязательно заключайте переменные в фигурные скобки.

Например, чтобы отображать значение переменной `counter` в консоли вывода, в текстовом поле сообщения введите {counter}.

![Выходное сообщение со значением переменной counter](../debugger/media/counteroutputmessage.png "Выходное сообщение со значением переменной counter")

Если теперь вы нажмете кнопку **Закрыть**, а затем запустите отладку программы (нажав клавишу **F5**), в окне вывода отобразится следующий результат.

![Сообщение действий в окне вывода](../debugger/media/actionsmessageinoutputwindow.png "Сообщение действий в окне вывода")

Для отображения более точных сведений можно также использовать специальные ключевые слова. Вводите ключевое слово точно так, как показано ниже (указывайте "$" перед каждым ключевым словом, а само ключевое слово записывайте прописными буквами).

| Ключевое слово | Что отображается |
| --- | --- |
| $ADDRESS | Текущая инструкция |
| $CALLER | Имя вызывающей функции |
| $CALLSTACK | Стек вызовов |
| $FUNCTION | Имя текущей функции |
| $PID | ИД процесса |
| $PNAME | Имя процесса |
| $TID | Идентификатор потока |
| $TNAME   | Имя потока |
| $TICK | Счетчик тактов (из Windows GetTickCount) |

## <a name="conditions-menu"></a>Меню "Условия"

С помощью меню "Условия" можно фильтровать выходные сообщения, чтобы они отображались только в определенных сценариях. Существует три основных типа условий.

### <a name="conditional-expression"></a>Условное выражение
Когда используется условное выражение, выходное сообщение отображается только при соблюдении определенных условий.

С помощью условных выражений можно задать, чтобы точка трассировки выводила сообщение, когда определенное условие имеет значение true или когда значение условия изменилось. Например, если требуется отображать значение счетчика только во время четных итераций цикла `for`, можно выбрать вариант **Is true** и ввести в текстовом поле сообщения `i%2 == 0`.

![Условное выражение Is True](../debugger/media/conditionalexpressionistrue.png "Условное выражение Is True")

Если вы хотите печатать значение счетчика при изменении итерации цикла `for`, выберите **When changed** и введите в текстовом поле сообщения `i`.

![Условное выражение When Changed](../debugger/media/conditionalexpressionwhenchanged.png "Условное выражение When Changed")

Поведение условного выражения **When Changed** зависит от языка программирования.

- В машинном коде отладчик не рассматривает первое вычисление условия как изменение значения, поэтому при первом вычислении выражения точка трассировки не сработает.
- В управляемом коде отладчик активирует точку трассировки при первом вычислении после выбора условия **When changed**.

Более полный обзор допустимых выражений, которые можно использовать при задании условий, см. в разделе [Выражения в отладчике](expressions-in-the-debugger.md).

### <a name="hit-count"></a>Количество обращений
Условие "количество обращений" позволяет отправлять выходное сообщение только после того, как строка кода, в которой установлена точка трассировки, выполнилась указанное число раз.

При использовании количества обращений можно указать вывод сообщения в том случае, когда количество выполнений строки кода, в которой установлена точка трассировки, равно, кратно или больше или равно значению, заданному в условии. Выберите наиболее подходящий вариант и введите в поле целочисленное значение (например, 5), представляющее нужную итерацию.

![Условное выражение Hit Count](../debugger/media/conditionalexpressionhitcount.png "Условное выражение Hit Count")

### <a name="filter"></a>Фильтр
При использовании условия фильтра можно указать, для каких устройств, процессов или потоков должно отображаться выходное сообщение.

![Условное выражение Filter](../debugger/media/conditionalexpressionfilter.png "Условное выражение Filter")

Список выражений фильтра:

- MachineName = "имя"
- ProcessId = значение
- ProcessName = "имя"
- ThreadId = значение
- ThreadName = "имя"

Строки (такие как имена) необходимо заключать в двойные кавычки. Значения можно указывать без кавычек. Предложения можно объединять, используя операторы `&` (`AND`), `||` (`OR`), `!` (`NOT`) и круглые скобки.

## <a name="considerations"></a>Особенности

Хотя точки трассировки предназначены для того, чтобы сделать интерфейс отладчика более понятным и удобным, при их использовании необходимо учитывать некоторые важные аспекты.

Иногда при проверке свойства или атрибута объекта его значение может измениться. Если значение изменяется во время проверки, эта ошибка не является следствием работы самой точки трассировки. Однако использование точек трассировки для проверки объектов не позволяет избежать этих случайных изменений.

Выражения в поле сообщений **Действие** могут вычисляться не таким способом, как в языке программирования, который вы используете для разработки. Например, чтобы вывести строку, не нужно заключать сообщение в кавычки, даже если обычно вы должны это делать при использовании `Debug.WriteLine()` или `console.log()`. Кроме того, синтаксис фигурных скобок (`{ }`) для выражений вывода также может отличаться от правил для вывода значений в используемом вами языке разработки. (Однако содержимое в фигурных скобках (`{ }`) в любом случае должно быть написано с использованием синтаксиса используемого языка разработки.)

Если вы пытаетесь отладить интерактивное приложение и ищете какую-нибудь аналогичную функцию, ознакомьтесь с нашей функциональностью точек ведения журнала в Snapshot Debugger. Отладчик моментальных снимков — это средство, используемое для исследования проблем в рабочих приложениях. Точки ведения журнала также позволяют отправлять сообщения в окно вывода без изменения исходного кода и не влияют на работу приложения. Дополнительные сведения см. в статье [Отладка интерактивных приложений Azure](../debugger/debug-live-azure-applications.md).

## <a name="see-also"></a>См. также

- [Что такое отладка?](../debugger/what-is-debugging.md)
- [Улучшение кода C# с помощью Visual Studio](../debugger/write-better-code-with-visual-studio.md)
- [Первое знакомство с отладкой](../debugger/debugger-feature-tour.md)
- [Выражения в отладчике](expressions-in-the-debugger.md)
- [Использование точек останова](../debugger/using-breakpoints.md)
- [Отладка интерактивных приложений Azure](../debugger/debug-live-azure-applications.md)
