---
title: Добавление новых источников данных
ms.date: 11/21/2018
ms.topic: conceptual
f1_keywords:
- vs.datasource.datasourcefieldspicker
helpviewer_keywords:
- data [Visual Studio], data sources
- data sources
ms.assetid: ed28c625-bb89-4037-bfde-cfa435d182a2
author: ghogen
ms.author: ghogen
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: 555d32eb295e944060d2efe0b843e9d157b7c675
ms.sourcegitcommit: 95f26af1da51d4c83ae78adcb7372b32364d8a2b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79301209"
---
# <a name="add-new-data-sources"></a>Добавление новых источников данных

В контексте инструментов данных .NET в Visual Studio *источник данных* относится к объектам .NET, которые подключаются к хранилику данных и делают данные доступными для приложения .NET. Дизайнеры Visual Studio могут использовать вывод ный источник данных для генерации шаблонного кода, который связывает данные с формами при перетаскивании и выпадении объектов базы данных из окна **источников данных.** Этот вид источника данных может быть:

- Класс в модели системы entity Framework, связанный с какой-то базой данных.

- Набор данных, связанный с какой-то базой данных.

- Класс, представляющий сетевую службу, такую как служба данных Windows Communication Foundation (WCF) или служба REST.

- Класс, представляющий службу SharePoint.

- Класс или коллекция в вашем решении.

> [!NOTE]
> Если вы не используете функции связывания данных, наборы данных, рамки сущности, LIN- для S'L, WCF или SharePoint, концепция "источника данных" не применяется. Просто подключитесь непосредственно к базе данных, используя объекты S'LCommand, и общайтесь непосредственно с базой данных.

Вы создаете и изсваивали источники данных с помощью **мастера конфигурации исходного кода в** windows Forms или приложении Windows Presentation Foundation. Для системы сущности сначала создайте классы сущностей, а затем начните мастер, выбрав **Project** > **Add New Data Source** (описано более подробно позже в этой статье).

![мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png)

## <a name="data-sources-window"></a>Источники данных - окно

После создания источника данных он отображается в окне инструмента **«Источники данных».**

> [!TIP]
> Чтобы открыть окно **источников данных,** убедитесь, что ваш проект открыт, а затем нажмите **Shift**+**Alt**+**D** или выберите **просмотр** > других**источников данных****Windows.** > 

Можно перетащить источник данных из окна **Data Sources** на поверхность или элемент управления. Это приводит к генерируемому шаблонному коду, отображаемому данные из хранилища данных.

На следующей иллюстрации показан набор данных, который был сброшен на форму Windows. Если вы выберете **F5** в приложении, данные из базовой базы данных отображается в элементах управления формы.

![Операция перетаскивания источника данных](../data-tools/media/raddata-data-source-drag-operation.png)

## <a name="data-source-for-a-database-or-a-database-file"></a>Источник данных для базы данных или файла базы данных

Можно создать набор данных или модель Entity Framework для использования в качестве источника данных для базы данных или файла базы данных.

### <a name="dataset"></a>Dataset

Чтобы создать набор данных в качестве источника данных, запустите **мастер конфигурации исходного кода данных,** выбрав **Project** > **Add New Source.** Выберите тип исходного кода **базы данных** и следуйте запросам, чтобы указать либо новое или существующее соединение базы данных, либо файл базы данных.

### <a name="entity-classes"></a>Классы сущностей

Для создания модели системы сущности в качестве источника данных:

1. Выполнить **"Волшебник модели данных сущности"** для создания классов сущности. Выберите **проект** > **Добавить новый пункт** > **ADO.NET модели данных сущности.**

   ![Элемент проекта нового проекта модели сущности](../data-tools/media/raddata-new-entity-framework-model-project-item.png)

1. Выберите метод, который вы хотите создать модель.

   ![мастер модели данных с использованием сущностей](../data-tools/media/raddata-entity-data-model-wizard.png)

1. Добавьте модель в качестве источника данных. Генерируемые классы отображаются в **мастере конфигурации исходного кода данных** при выборе категории **Объектов.**

   ![Мастер конфигурации исходного кода данных с классами сущностей](../data-tools/media/raddata-data-source-configuration-wizard-with-entity-classes.png)

## <a name="data-source-for-a-service"></a>Источник данных для службы

Чтобы создать источник данных из службы, запустите **"Мастер конфигурации исходного кода данных"** и выберите тип исходного кода **службы.** Это всего лишь ярлык к диалоговому окну **Справка** Добавления, к которому можно также получить доступ, нажав на проект в **Solution Explorer** и выбрав ссылку на **услугу Add**Service.

При создании источника данных из службы Visual Studio добавляет ссылку на сервис для вашего проекта. Visual Studio также создает прокси-объекты, которые соответствуют объектам, которые возвращает службу. Например, служба, возвращаюадоступ набора данных, представлена в проекте в виде набора данных; Служба, возвращаюав определенный тип, представлена в проекте как возвращенный тип.

Можно создать источник данных из следующих типов служб:

- [Службы данных WCF](/dotnet/framework/data/wcf/wcf-data-services-overview)

- [Услуги WCF](../data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio.md)

- ВЕБ-СЛУЖБЫ

    > [!NOTE]
    > Элементы, отображаемые в окне **источников данных,** зависят от данных, которые возвращает служба. Некоторые службы могут предоставлять недостаточный объем информации для того, чтобы **Мастер настройки источника данных** создал объекты с возможностью привязки. Например, если служба возвращает нетипиченный набор данных, при завершении работы мастер не отображается элементов в окне **источников данных.** Это связано с тем, что нетиповые наборы данных не обеспечивают схему, и поэтому у мастера нет достаточной информации для создания источника данных.

## <a name="data-source-for-an-object"></a>Источник данных для объекта

Можно создать источник данных с любого объекта, который предоставляет одно или несколько общедоступных свойств, запустив **мастер конфигурации исхода данных,** а затем выбрав тип исходного кода **объекта.** Все общедоступные свойства объекта отображаются в окне **источников данных.** Если вы используете рамки сущности и создали модель, вы найдете классы сущностей, которые являются источниками данных для приложения.

На странице **«Выберите объекты данных»** расширьте узлы в представлении дерева, чтобы найти объекты, к которым необходимо связать. Представление дерева содержит узлы для вашего проекта, а также для сборок и других проектов, на которые ссылается ваш проект.

Если вы хотите привязаться к объекту в сборке или проекте, который не отображается в представлении дерева, нажмите **Добавить ссылку** и используйте **кнопку Add Reference Dialog Box,** чтобы добавить ссылку на сборку или проект. После добавления ссылки сборка или проект добавляются в представление дерева.

> [!NOTE]
> Возможно, потребуется создать проект, содержащий объекты до появления объектов в представлении дерева.

> [!NOTE]
> Для поддержки связывания данных перетаскивания объектов, реализующих интерфейс <xref:System.ComponentModel.ITypedList> или <xref:System.ComponentModel.IListSource> интерфейс, должен иметь конструктор по умолчанию. В противном случае Visual Studio не может мгновенно извивать объект из источника данных и отображает ошибку при перетаскивании элемента на поверхность конструкции.

## <a name="data-source-for-a-sharepoint-list"></a>Источник данных для списка SharePoint

Можно создать источник данных из списка SharePoint, запустив **"Мастер конфигурации исходного кода данных"** и выбрав тип исходного кода **SharePoint.** SharePoint предоставляет данные через WCF Data Services, поэтому создание источника данных SharePoint равномне созданию источника данных из службы. Выбрав элемент **SharePoint** в **мастере конфигурации исходного кода данных, открывает** диалоговую будку **Справка службы** добавления, где вы подключаетесь к службе данных SharePoint, указывая на сервер SharePoint. Для этого требуется SDK SharePoint.

## <a name="see-also"></a>См. также раздел

- [Visual Studio Data Tools для .NET](../data-tools/visual-studio-data-tools-for-dotnet.md)
