---
title: Создание таблиц подстановки в приложениях Windows Forms
ms.date: 11/04/2016
ms.topic: how-to
helpviewer_keywords:
- lookup tables
- lookup tables, creating
ms.assetid: 0edd5385-c381-4b17-9096-74e2778db9d5
author: ghogen
ms.author: ghogen
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: 9a1ae368b7d2bf8548bf78a6a9795e19206bc277
ms.sourcegitcommit: 1d4f6cc80ea343a667d16beec03220cfe1f43b8e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2020
ms.locfileid: "85282661"
---
# <a name="create-lookup-tables-in-windows-forms-applications"></a>Создание таблиц подстановки в приложениях Windows Forms

*Таблица Уточняющий запрос* термина описывает элементы управления, привязанные к двум связанным таблицам данных. Эти элементы управления "Уточняющий запрос" отображают данные из первой таблицы на основе значения, выбранного во второй таблице.

Таблицы подстановки можно создать, перетащив главный узел родительской таблицы (из [окна Источники данных](add-new-data-sources.md#data-sources-window)) на элемент управления в форме, который уже привязан к столбцу в связанной дочерней таблице.

Например, рассмотрим таблицу `Orders` в базе данных Sales. Каждая запись в `Orders` таблице включает объект `CustomerID` , указывающий, какой клиент поместил заказ. `CustomerID`— Это внешний ключ, указывающий на запись клиента в `Customers` таблице. В этом сценарии вы развернете `Orders` таблицу в окне **Источники данных** и присвойте главному узлу **сведения**. Затем задайте `CustomerID` для столбца значение <xref:System.Windows.Forms.ComboBox> (или любой другой элемент управления, поддерживающий привязку уточняющего запроса) и перетащите `Orders` узел на форму. Наконец, перетащите `Customers` узел на элемент управления, привязанный к связанному столбцу — в данном случае — к <xref:System.Windows.Forms.ComboBox> `CustomerID` столбцу.

## <a name="to-databind-a-lookup-control"></a>Привязка элемента управления "Уточняющий запрос"

1. Откройте проект, откройте окно **Источники данных** , выбрав **Просмотреть**  >  **другие**  >  **Источники данных**Windows.

    > [!NOTE]
    > Для таблиц подстановки необходимо, чтобы в окне **Источники данных** были доступны две связанные таблицы или объекты. Дополнительные сведения см. [в разделе связи в наборах данных](relationships-in-datasets.md).

2. Разверните узлы в окне **Источники данных** , пока не увидите родительскую таблицу и все ее столбцы, а также связанную дочернюю таблицу и все ее столбцы.

    > [!NOTE]
    > Узел дочерней таблицы — это узел, который отображается как развертываемый дочерний узел в родительской таблице.

3. Измените тип перетаскивания дочерней таблицы на **Details** , выбрав **сведения** из списка элементов управления в узле дочерней таблицы. Дополнительные сведения см. в разделе [Установка элемента управления, создаваемого при перетаскивании из окна Источники данных](../data-tools/set-the-control-to-be-created-when-dragging-from-the-data-sources-window.md).

4. Нахождение узла, связывающего две таблицы ( `CustomerID` узел из предыдущего примера). Измените тип перетаскивания на, <xref:System.Windows.Forms.ComboBox> выбрав **поле со списком** в списке элементов управления.

5. Перетащите главный узел дочерней таблицы из окна **Источники данных** на форму.

     Элементы управления с привязкой к данным (с описательными метками) и панель инструментов ( <xref:System.Windows.Forms.BindingNavigator> ) отображаются в форме. [Набор данных](../data-tools/dataset-tools-in-visual-studio.md), [TableAdapter](../data-tools/create-and-configure-tableadapters.md), <xref:System.Windows.Forms.BindingSource> и <xref:System.Windows.Forms.BindingNavigator> отображается в области компонентов.

6. Теперь перетащите главный узел родительской таблицы из окна **Источники данных** непосредственно в элемент управления Уточняющий запрос ( <xref:System.Windows.Forms.ComboBox> ).

     Привязки подстановки теперь установлены. Конкретные свойства, заданные для элемента управления, см. в следующей таблице.

    |Свойство.|Пояснение к параметру|
    |--------------| - |
    |**DataSource**|Visual Studio задает для этого свойства <xref:System.Windows.Forms.BindingSource>, созданный для перетаскиваемой на элемент управления таблицы (сравните с созданием <xref:System.Windows.Forms.BindingSource> при создании элемента управления).<br /><br /> Если необходимо выполнить корректировку, задайте для этого параметра значение в <xref:System.Windows.Forms.BindingSource> таблице со столбцом, который необходимо отобразить.|
    |**DisplayMember**|Visual Studio задает для данного свойства первый столбец после первичного ключа, содержащий тип строковых данных для таблицы, которую вы перетаскиваете на элемент управления.<br /><br /> Если необходимо выполнить корректировку, задайте для этого параметра имя столбца, который требуется отобразить.|
    |**ValueMember**|Visual Studio задает для данного свойства первый столбец, участвующий в первичном ключе, или первый столбец в таблице, если ключ не задан.<br /><br /> Если необходимо выполнить корректировку, присвойте этому параметру первичный ключ в таблице со столбцом, который необходимо отобразить.|
    |**SelectedValue**|Visual Studio устанавливает это свойство в исходный столбец, удаленный из окна **Источники данных** .<br /><br /> Если необходимо выполнить корректировку, присвойте этому столбцу внешний ключ в связанной таблице.|

## <a name="see-also"></a>См. также

- [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)
