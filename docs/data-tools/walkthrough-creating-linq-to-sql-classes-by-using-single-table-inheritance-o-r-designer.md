---
title: LINQ to SQL классы с наследованием одной таблицы
description: В этом пошаговом руководстве вы создадите LINQ to SQL классы с помощью наследования одной таблицы в реляционный конструктор объектов Visual Studio (реляционный конструктор R).
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
ms.assetid: 63bc6328-e0df-4655-9ce3-5ff74dbf69a4
author: ghogen
ms.author: ghogen
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: b83fd664cb2969c12d69e1e818f61190deed3804
ms.sourcegitcommit: 72a49c10a872ab45ec6c6d7c4ac7521be84526ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2020
ms.locfileid: "94998243"
---
# <a name="walkthrough-create-linq-to-sql-classes-by-using-single-table-inheritance-or-designer"></a>Пошаговое руководство. Создание LINQ to SQL классов с помощью наследования одной таблицы (реляционный конструктор R)
[Средства LINQ to SQL в Visual Studio](../data-tools/linq-to-sql-tools-in-visual-studio2.md) поддерживают наследование одной таблицы, так как обычно реализуются в реляционных системах. Это пошаговое руководство раскрывает общие шаги, приведенные в разделе [Практическое руководство. Настройка наследования с помощью конструктора O/R](../data-tools/how-to-configure-inheritance-by-using-the-o-r-designer.md) , и предоставляет некоторые реальные данные для демонстрации использования наследования в [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)] .

В ходе этого пошагового руководства вы выполните следующие задачи:

- Создайте таблицу базы данных и добавьте в нее данные.

- Создайте приложение Windows Forms.

- Добавление файла [!INCLUDE[vbtecdlinq](../data-tools/includes/vbtecdlinq_md.md)] в проект.

- Создайте новые классы сущностей.

- Конфигурируйте классы сущностей на использование наследования.

- Выполните запрос унаследованного класса.

- Отобразите данные на Windows Forms

## <a name="create-a-table-to-inherit-from"></a>Создание таблицы для наследования
Чтобы увидеть, как работает наследование, создайте маленькую `Person` таблицу, используйте ее в качестве базового класса, а затем создайте `Employee` объект, наследующий от него.

### <a name="to-create-a-base-table-to-demonstrate-inheritance"></a>Для создания базовой таблицы, чтобы продемонстрировать наследование

1. В **Обозреватель сервера** или **Обозреватель базы данных** щелкните правой кнопкой мыши узел **таблицы** и выберите команду **Добавить новую таблицу**.

    > [!NOTE]
    > Может быть использована база данных Northwind или любая другая, к которой можно добавить таблицу.

2. В **Конструкторе таблиц** добавьте в таблицу следующие столбцы:

    |Имя столбца|Тип данных|Разрешить значения NULL|
    |-----------------|---------------|-----------------|
    |**ID**|**int**|**False**|
    |**Тип**|**int**|**True**|
    |**FirstName**|**nvarchar(200)**|**False**|
    |**LastName**|**nvarchar(200)**|**False**|
    |**Менеджер**|**int**|**True**|

3. Задайте столбец ID в качестве первичного ключа

4. Сохраните таблицу и дайте ей имя **Person**.

## <a name="add-data-to-the-table"></a>Добавление данных в таблицу
Чтобы вы могли убедиться, что наследование конфигурировано правильно, в таблицу нужно ввести некоторые данные для каждого класса в наследовании единственной таблицы.

### <a name="to-add-data-to-the-table"></a>Для добавления данных в таблицу

1. Откройте таблицу в окне просмотра данных. (Щелкните правой кнопкой мыши таблицу **Person** в **Обозреватель сервера** или **Обозреватель базы данных** и выберите команду **отобразить данные таблицы**.)

2. Скопируйте в таблицу следующие данные. (Его можно скопировать, а затем вставить в таблицу, выбрав всю строку на панели **результатов** .)

    |**ID**|**Тип**|**FirstName**|**LastName**|**Менеджер**|
    |-|-|-|-|-|
    |**1**|**1**|**Anne**|**Wallace**|**NULL**|
    |**2**|**1**|**Carlos**|**Grilo**|**NULL**|
    |**3**|**1**|**Yael**|**Peled**|**NULL**|
    |**4**|**2**|**Gatis**|**Ozolins**|**1**|
    |**5**|**2**|**Andreas**|**Hauser**|**1**|
    |**6**|**2**|**Tiffany**|**Phuvasate**|**1**|
    |**7**|**2**|**Alexey**|**Orekhov**|**2**|
    |**8**|**2**|**Michał**|**Poliszkiewicz**|**2**|
    |**9**|**2**|**Tai**|**Yee**|**2**|
    |**10**|**2**|**Fabricio**|**Noriega**|**3**|
    |**11**|**2**|**Mindy**|**Martin**|**3**|
    |**12**|**2**|**Ken**|**Kwok**|**3**|

## <a name="create-a-new-project"></a>Создание нового проекта
Теперь, когда таблица создана, создайте новый проект, чтобы продемонстрировать настройку наследования.

### <a name="to-create-the-new-windows-forms-application"></a>Создание нового приложения Windows Forms

1. В Visual Studio в меню **Файл** выберите пункты **Создать** > **Проект**.

2. В левой области разверните элемент **Visual C#** или **Visual Basic** , а затем выберите пункт **Windows Desktop**.

3. В средней области выберите тип проекта **приложения Windows Forms** .

4. Назовите проект **инхеританцевалксраугх** и нажмите кнопку **ОК**.

     Создается проект **InheritanceWalkthrough** и добавляется в **Обозреватель решений**.

## <a name="add-a-linq-to-sql-classes-file-to-the-project"></a>Добавление в проект файла классов LINQ to SQL

### <a name="to-add-a-linq-to-sql-file-to-the-project"></a>Для добавления файла LINQ to SQL в проект

1. В меню **Проект** выберите **Добавить новый элемент**.

2. Выберите шаблон **Классы LINQ to SQL** и нажмите кнопку **Добавить**.

     *DBML* -файл добавляется в проект, и открывается **конструктор O/R** .

## <a name="create-the-inheritance-by-using-the-or-designer"></a>Создание наследования с использованием реляционного конструктора объектов
Настройте наследование путем перетаскивания объекта **Наследование** из **Панели элементов** на область конструктора.

### <a name="to-create-the-inheritance"></a>Чтобы создать наследование, выполните следующие действия

1. В **Обозреватель сервера** или **Обозреватель базы данных** перейдите к таблице **Person** , созданной ранее.

2. Перетащите таблицу **Person** в область конструктора **O/R Designer** .

3. Перетащите вторую таблицу **Person** в **конструктор O/R** и измените его имя на **Employee**.

4. Удалите свойство **Manager** из объекта **Person**.

5. Удалите свойства **Type**, **ID**, **FirstName** и **LastName** из объекта **Employee**. (Другими словами, удалите все свойства, кроме свойства **Manager**.)

6. Из вкладки **Реляционный конструктор объектов****Панели элементов** создайте **Наследование** между объектами **Person** и **Employee**. Чтобы выполнить это, щелкните по пункту **Наследование** в **Панели элементов** и отпустите кнопку мыши. Затем щелкните объект **Employee** , а затем объект **Person** в **конструкторе объектов O/R**. Затем стрелка на линии наследования указывает на объект **Person** .

7. Щелкните по линии **Наследование** на области конструктора.

8. Задайте свойству **Свойство дискриминатора** значение **Type**.

9. Задайте свойству **Производное значение дискриминатора класса** значение **2**.

10. Задайте свойству **Базовое значение дискриминатора класса** значение **1**.

11. Задайте свойству **Наследование по умолчанию** значение **Person**.

12. Выполните построение проекта.

## <a name="query-the-inherited-class-and-display-the-data-on-the-form"></a>Выполнение запроса наследуемого класса и отображение данных на форме
Теперь добавьте в форму код, который запрашивает определенный класс в объектной модели.

### <a name="to-create-a-linq-query-and-display-the-results-on-the-form"></a>Для создания запроса LINQ и отображения результатов на форме

1. Перетащите **ListBox** на форму **Form1**.

2. Дважды щелкните форму, чтобы создать обработчик событий `Form1_Load`.

3. Добавьте следующий код в обработчик событий `Form1_Load` .

    ```vb
    Dim dc As New DataClasses1DataContext
    Dim results = From emp In dc.Persons _
        Where TypeOf emp Is Employee _
        Select emp

    For Each Emp As Employee In results
        ListBox1.Items.Add(Emp.LastName)
    Next
    ```

    ```csharp
    NorthwindDataContext dc = new DataClasses1DataContext();
    var results = from emp in dc.Persons
                  where emp is Employee
                  select emp;

    foreach(Employee Emp in results)
    {
        listBox1.Items.Add(Emp.LastName)
    }
    ```

## <a name="test-the-application"></a>Тестирование приложения
Запустите приложение и убедитесь, что записи, отображаемые в списке, являются сотрудниками (записи со значением 2 в столбце **тип** ).

### <a name="to-test-the-application"></a>Тестирование приложения

1. Нажмите клавишу **F5**.

2. Убедитесь, что отображаются только записи со значением 2 в их столбце **Type**.

3. Закройте форму. (В меню **Отладка** выберите команду **прерывать отладку**.)

## <a name="see-also"></a>См. также

- [Инструменты LINQ to SQL в Visual Studio](../data-tools/linq-to-sql-tools-in-visual-studio2.md)
- [Пошаговое руководство. Создание классов LINQ to SQL (реляционный конструктор объектов)](how-to-create-linq-to-sql-classes-mapped-to-tables-and-views-o-r-designer.md)
- [Практическое руководство. Назначение хранимых процедур для выполнения обновления, вставки и удаления (реляционный конструктор объектов)](../data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer.md)
- [LINQ to SQL](/dotnet/framework/data/adonet/sql/linq/index)
- [Как создать объектную модель в Visual Basic или C #](/dotnet/framework/data/adonet/sql/linq/how-to-generate-the-object-model-in-visual-basic-or-csharp)
