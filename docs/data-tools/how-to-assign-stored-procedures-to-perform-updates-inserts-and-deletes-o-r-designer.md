---
title: Использование хранимых процедур в LINQ to SQL для обновления данных (реляционный конструктор объектов)
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: e88224ab-ff61-4a3a-b6b8-6f3694546cac
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: 58dfb1016097429eeab10c3b50262adc7015e818
ms.sourcegitcommit: 117ece52507e86c957a5fd4f28d48a0057e1f581
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/28/2019
ms.locfileid: "66260794"
---
# <a name="how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-or-designer"></a>Практическое руководство. назначение хранимых процедур для выполнения обновлений, вставок и удалений (реляционный конструктор объектов)

Сохраненные процедуры можно добавлять в **реляционный конструктор объектов** и выполнять как обычные методы <xref:System.Data.Linq.DataContext>. Они также могут использоваться для переопределения стандартного LINQ к SQL поведения среды выполнения, которая выполняет вставки, обновления и удаления, когда изменения сохраняются из классов сущностей в базу данных (например, при вызове <xref:System.Data.Linq.DataContext.SubmitChanges%2A> метод).

> [!NOTE]
> Если хранимые процедуры возвращают значения, которые должны отправляться обратно на клиент (например, значения, вычисляемые в хранимой процедуре), создайте в хранимых процедурах выходные параметры. Если использовать выходные параметры невозможно, то вместо применения переопределений, созданных реляционным конструктором объектов, реализуйте разделяемый метод. Элементы, сопоставляемые со значениями, созданными базой данных, должны получать соответствующие значения после успешного завершения операций INSERT или UPDATE. Дополнительные сведения см. в разделе [обязанности разработчика в переопределении поведения по умолчанию](/dotnet/framework/data/adonet/sql/linq/responsibilities-of-the-developer-in-overriding-default-behavior).

> [!NOTE]
> LINQ to SQL обрабатывает значения, сформированные базой данных, автоматически для identity (Автоувеличение), rowguidcol (формируемые базой данных идентификаторы GUID) и столбцы отметок времени. Генерируемые базой данных значения в других типах столбцов будут неожиданно давать нулевое значение. Для возврата значения созданных базой данных, нужно вручную задать <xref:System.Data.Linq.Mapping.ColumnAttribute.IsDbGenerated%2A> для **true** и <xref:System.Data.Linq.Mapping.ColumnAttribute.AutoSync%2A> к одному из следующих: [AutoSync.Always](<xref:System.Data.Linq.Mapping.AutoSync.Always>), [AutoSync.OnInsert](<xref:System.Data.Linq.Mapping.AutoSync.OnInsert>), или [AutoSync.OnUpdate](<xref:System.Data.Linq.Mapping.AutoSync.OnUpdate>).

## <a name="configure-the-update-behavior-of-an-entity-class"></a>Конфигурировать поведение обновления класса сущностей

По умолчанию, логика обновления базы данных (вставки, обновления и удаления) с помощью изменения, внесенные в данные в LINQ в классы сущностей SQL обеспечивается выполнения LINQ to SQL. Среда выполнения по умолчанию создает команды INSERT, UPDATE и DELETE, основываясь на схеме таблицы (определения столбцов и информация о первичных ключах). Когда поведение по умолчанию не требуется, можно настроить поведение обновления по, назначив конкретные хранимые процедуры для выполнения операций вставки, обновления и удаления, необходимых для работы с данными в таблице. Можно также сделать это, когда поведение по умолчанию не сгенерировано, например, когда ваши классы сущностей сопоставляются с представлениями. Наконец, можно отменить поведение обновления по умолчанию, когда база данных требует доступа к таблице через сохраненные процедуры.

[!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]

### <a name="to-assign-stored-procedures-to-override-the-default-behavior-of-an-entity-class"></a>Чтобы назначить сохраненные процедуры для переопределения заданного по умолчанию поведения класса сущностей

1. Откройте файл **LINQ to SQL** в конструкторе. (Дважды щелкните по файлу **.dbml** в **Обозревателе решений**.)

2. В **Обозревателе серверов** или **Обозревателе базы данных** разверните узел **Сохраненные процедуры** и найдите сохраненные процедуры, которые вы хотите использовать для команд "Вставить", "Обновить" и (или) "Удалить" из класса сущностей.

3. Перетащите сохраненную процедуру на **реляционный конструктор объектов**.

     Сохраненная процедура добавляется в область методов как метод <xref:System.Data.Linq.DataContext>. Дополнительные сведения см. в разделе [методы DataContext (реляционный конструктор объектов)](../data-tools/datacontext-methods-o-r-designer.md).

4. Выберите класс сущностей, для которого вы хотите использовать сохраненную процедуру для выполнения обновлений.

5. В окне **Свойства** выберите команду для переопределения (**Вставить**, **Обновить** или **Удалить**).

6. Нажмите кнопку с многоточием (...) рядом с полем **Использовать среду выполнения**, чтобы открыть диалоговое окно **Настройка поведения**.

7. Выберите **Настроить**.

8. Выберите нужную сохраненную процедуру в списке **Настроить**.

9. Проверьте список **Аргументы метода** и **Свойства класса**, чтобы убедиться, что **Аргументы метода** сопоставляются соответствующим **Свойствам класса**. Сопоставьте аргументы исходного метода (`Original_<ArgumentName>`) исходным свойствам (`<PropertyName> (Original)`) для `Update` и `Delete` команд.

    > [!NOTE]
    > По умолчанию аргументы метода сопоставляются со свойствами класса, если их имена совпадают. Если имена свойств были изменены и больше не совпадают в таблице и в классе сущностей, то может потребоваться выбор эквивалентного свойства класса для сопоставления, если конструктор не сможет определить правильное сопоставление.

10. Нажмите кнопку **OK** или кнопку **Применить**.

    > [!NOTE]
    > Можно продолжить настройку режима для каждого сочетания класса и поведения, как вы нажмете кнопку **применить** после каждого изменения. Если изменить класс или поведения, прежде чем нажимать кнопку **применить**, появляется диалоговое окно предупреждения и дает возможность применить изменения.

Чтобы возвратиться к использованию заданной по умолчанию логики среды выполнения для обновлений, нажмите кнопку с многоточием рядом с командами **Вставить**, **Обновить** или **Удалить** в окне **Свойства** и потом выберите **Использовать среду выполнения** в диалоговом окне **Настройка поведения**.

## <a name="see-also"></a>См. также

- [Средства LINQ to SQL в Visual Studio](../data-tools/linq-to-sql-tools-in-visual-studio2.md)
- [Методы DataContext](../data-tools/datacontext-methods-o-r-designer.md)
- [LINQ to SQL (.NET Framework)](/dotnet/framework/data/adonet/sql/linq/index)
- [Вставка, обновление и удаление операций (.NET Framework)](/dotnet/framework/data/adonet/sql/linq/insert-update-and-delete-operations)
