---
title: Создание и настройка адаптеров таблиц TableAdapter
ms.date: 09/01/2017
ms.topic: conceptual
helpviewer_keywords:
- table adapters, creating
- creating TableAdapters
- data [Visual Studio], creating data components
- data [Visual Studio], TableAdapters
- data [Visual Studio], creating table adapters
ms.assetid: 08630d69-0d6c-4e8f-b42d-2922f45f8415
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: 026b670deb5beff42c927894ee9851ddb3ccc3ad
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62567537"
---
# <a name="create-and-configure-tableadapters"></a>Создание и настройка адаптеров таблиц TableAdapter

Адаптеры таблиц обеспечивают взаимодействие между приложением и базы данных. Они подключаются к базе данных, выполнения запросов или хранимых процедур, и возвращает новые данные таблицы или заполнения существующего <xref:System.Data.DataTable> с возвращенными данными. Адаптеры таблиц можно также отправлять обновленные данные из приложения в базе данных.

Адаптеры таблиц создаются автоматически при выполнении одного из следующих действий:

- Перетащите объекты базы данных из **обозревателя серверов** в **конструктор наборов данных**.

- Запустите мастер настройки источника данных и выберите либо **базы данных** или **веб-службы** тип источника данных.

   ![Мастер настройки источника данных в Visual Studio](media/data-source-configuration-wizard.png)

Можно также создать новый адаптер и настроить его с источником данных, перетащив TableAdapter из **элементов** в пустую область в **конструктор наборов данных** поверхности.

Введение в адаптеры таблиц, см. в разделе [заполнения набора данных с помощью адаптера таблицы](../data-tools/fill-datasets-by-using-tableadapters.md).

[!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]

## <a name="use-the-tableadapter-configuration-wizard"></a>Используйте мастер настройки адаптера таблицы

Запустите **мастер настройки адаптера таблицы** для создания или изменить адаптеры таблицы и их связанных таблиц DataTable. Можно настроить существующий адаптер таблицы, щелкнув его в **конструктор наборов данных**.

![raddata мастер настройки адаптера таблицы](../data-tools/media/raddata-table-adapter-configuration-wizard.png)

Если перетащить новый адаптер таблицы из области элементов при **конструктор наборов данных** находится в сосредоточиться, запустится мастер, и запросы, чтобы указать, какие данные берутся TableAdapter должны подключаться к. На следующей странице мастер запрашивает, какой тип команды следует использовать для взаимодействия с базой данных, инструкции SQL или хранимые процедуры. (Вы не увидите это при настройке TableAdapter, который уже связан с источником данных.)

- У вас есть возможность создать новую хранимую процедуру в основной базе данных, если у вас есть необходимые разрешения для базы данных. Если у вас нет этих разрешений, это не подойти.

- Вы также можете выполнять существующие хранимые процедуры для **ВЫБЕРИТЕ**, **вставить**, **обновление**, и **удалить** команды TableAdapter. Хранимая процедура, присвоенный **обновление** , например, команда при `TableAdapter.Update()` вызывается метод.

Сопоставьте параметры из выбранной хранимой процедуры с соответствующими столбцами в таблице данных. Например, если хранимая процедура принимает параметр с именем `@CompanyName` , он передает `CompanyName` набор столбцов в таблице, **исходный столбец** из `@CompanyName` параметр `CompanyName`.

> [!NOTE]
> Хранимая процедура, присвоенный команды SELECT выполняется путем вызова метода адаптера таблицы с именем на следующем шаге мастера. Метод по умолчанию — `Fill`, что код, который обычно используется для выполнения процедуры SELECT `TableAdapter.Fill(tableName)`. Если изменить имя по умолчанию из `Fill`, замените `Fill` с именем назначить и замените «Адаптер таблицы» фактическое имя адаптера таблицы (например, `CustomersTableAdapter`).

- Выбрав **создать методы для отправки обновлений непосредственно в базу данных** параметр эквивалентно заданию `GenerateDBDirectMethods` присваивается значение true. Данный параметр недоступен, если исходная инструкция SQL не предоставляет достаточный объем информации либо запрос не является обновляемым. Эта ситуация может возникнуть, например, в **JOIN** запросы и запросы, которые возвращают одно (скалярное) значение.

**Дополнительно** в мастере позволяют:

- Создать инструкции INSERT, UPDATE и DELETE, на основе инструкции SELECT, которая определена в **Создание инструкций SQL** страницы
- Использовать оптимистическую блокировку
- Укажите, следует ли обновить таблицу данных после вставки и выполняются инструкции UPDATE

## <a name="configure-a-tableadapters-fill-method"></a>Настройка метода Fill адаптера

Иногда может потребоваться изменить схему таблицы TableAdapter. Чтобы сделать это, измените основной TableAdapter `Fill` метод. Адаптеры таблиц создаются с первичными `Fill` метод, который определяет схему связанной таблицы данных. Основной `Fill` метод основан на запрос или хранимую процедуру, вы ввели при первоначальной настройке адаптера таблицы. Это метод first (самых верхних) в таблице данных в конструкторе наборов данных.

![TableAdapter с несколькими запросами](../data-tools/media/tableadapter.gif)

Любые изменения, внесенные в адаптер таблицы основной `Fill` метод отражаются в схему связанной таблицы данных. Например, удаление столбца из запроса в основном `Fill` метод также удаляет столбец из связанной таблицы данных. Кроме того, удаление столбца из главного `Fill` метод удаляет столбец из любых дополнительных запросов для этого TableAdapter.

Мастер настройки запроса адаптера таблицы можно использовать для создания и изменения дополнительных запросов для TableAdapter. Эти дополнительные запросы должны соответствовать схемы таблицы, если они возвращают скалярное значение.  При каждом дополнительном запросе имеет имя, которое можно указать.

Следующий пример показывает, как вызвать дополнительный запрос с именем `FillByCity`:

`CustomersTableAdapter.FillByCity(NorthwindDataSet.Customers, "Seattle")`

### <a name="to-start-the-tableadapter-query-configuration-wizard-with-a-new-query"></a>Чтобы запустить мастер настройки запроса адаптера таблицы с помощью нового запроса

1. Откройте свой набор данных в **Конструкторе наборов данных**.

2. Если вы создаете новый запрос, перетащите **запроса** объекта из **набора данных** вкладке **элементов** на <xref:System.Data.DataTable>, или выберите **добавить запрос**TableAdapter контекстном меню. Можно также перетащить **запроса** объекта на пустую область **конструктор наборов данных**, которая создает адаптер таблиц без связанного <xref:System.Data.DataTable>. Эти запросы можно только возвращать отдельные (скалярные) значения, или выполнения UPDATE, INSERT или удалить команды в базе данных.

3. На **Выбор подключения к данным** экране выберите или создайте подключение, которое будет использоваться запросом.

    > [!NOTE]
    > Этот экран появляется только в том случае, если конструктор не может определить правильное подключение для использования или доступных соединений нет.

4. На **Выбор типа команды** экрана, выберите один из следующих методов получения данных из базы данных:

    - **С помощью инструкций SQL** позволяет ввести инструкцию SQL для выбора данных из базы данных.

    - **Создать новую хранимую процедуру** обеспечивает, чтобы мастер создания нового хранимой процедуры (в базе данных) на основе указанной инструкции SELECT.

    - **Использовать существующие хранимые процедуры** позволяет запускать существующую хранимую процедуру при выполнении запроса.

### <a name="to-start-the-tableadapter-query-configuration-wizard-on-an-existing-query"></a>Чтобы запустить мастер настройки запроса адаптера таблицы в существующий запрос

- При редактировании существующего запроса адаптера таблицы, щелкните правой кнопкой мыши запрос и выберите **Настройка** в контекстном меню.

    > [!NOTE]
    > Щелкните правой кнопкой мыши основного запроса адаптера таблицы перенастраивает адаптер таблицы и <xref:System.Data.DataTable> схемы. Тем не менее, щелкнув правой кнопкой мыши дополнительный запрос в TableAdapter, настраивает только выбранный запрос. **Мастер настройки адаптера таблицы** перенастраивает определение адаптера таблицы, хотя **мастер настройки запроса TableAdapter** перенастраивает только выбранный запрос.

### <a name="to-add-a-global-query-to-a-tableadapter"></a>Чтобы добавить глобальный запрос адаптера таблицы

- Глобальные запросы являются SQL-запросы, которые возвращают одно (скалярное) значение или нет значения. Как правило глобальные функции выполнения операций базы данных, таких как вставки, обновления и удаления. Они также статистические сведения, такие как количество клиентов в таблицу или общие платежи для всех элементов в определенном порядке.

     Добавление глобальных запросов путем перетаскивания **запроса** объекта из **набора данных** вкладке **элементов** фигуру на пустую область **конструктор наборов данных**.

- Указать запрос, который выполняет требуемую задачу, например, `SELECT COUNT(*) AS CustomerCount FROM Customers`.

    > [!NOTE]
    > Перетаскивание **запроса** объекта непосредственно на **конструктор наборов данных** создает метод, который возвращает только скалярное значение (одно). Хотя запрос или хранимая процедура может возвращать более одного значения, метод, который создается с помощью мастера возвращает только одно значение. Например запрос может возвратить первый столбец первой строки возвращаемых данных.

## <a name="see-also"></a>См. также

- [Заполнение наборов данных с помощью адаптера таблицы](../data-tools/fill-datasets-by-using-tableadapters.md)