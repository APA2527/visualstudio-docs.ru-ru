---
title: Создание и настройка адаптеров таблиц TableAdapter
description: Узнайте, как создать и настроить TableAdapter в Visual Studio. Адаптеры таблиц обеспечивают взаимодействие между приложением и базой данных.
ms.custom: SEO-VS-2020
ms.date: 09/01/2017
ms.topic: how-to
helpviewer_keywords:
- table adapters, creating
- creating TableAdapters
- data [Visual Studio], creating data components
- data [Visual Studio], TableAdapters
- data [Visual Studio], creating table adapters
ms.assetid: 08630d69-0d6c-4e8f-b42d-2922f45f8415
author: ghogen
ms.author: ghogen
manager: jmartens
ms.workload:
- data-storage
ms.openlocfilehash: a9ab54b358125e45cfb0d6a4df30989cf679ab2d
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99867156"
---
# <a name="create-and-configure-tableadapters"></a>Создание и настройка адаптеров таблиц TableAdapter

Адаптеры таблиц обеспечивают взаимодействие между приложением и базой данных. Они подключаются к базе данных, выполняют запросы или хранимые процедуры и либо возвращают новую таблицу данных, либо заполняют существующие <xref:System.Data.DataTable> с помощью возвращенных данных. Адаптеры таблиц также могут передавать обновленные данные из приложения обратно в базу данных.

Адаптеры таблиц создаются при выполнении одного из следующих действий.

- Перетащите объекты базы данных из **Обозреватель сервера** в **Конструктор наборов данных**.

- Запустите мастер настройки источника данных и выберите **базу данных** или тип источника данных **веб-службы** .

   ![Мастер настройки источника данных в Visual Studio](media/data-source-configuration-wizard.png)

Можно также создать новый адаптер таблицы и настроить его с помощью источника данных, перетащив TableAdapter из **панели элементов** в пустой регион на **Конструктор наборов данных** поверхности.

Общие сведения об адаптерах таблиц см. в разделе [Заполнение наборов данных с помощью адаптеров таблиц](../data-tools/fill-datasets-by-using-tableadapters.md).

[!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]

## <a name="use-the-tableadapter-configuration-wizard"></a>Использование мастера настройки TableAdapter

Запустите **Мастер настройки адаптера таблицы** , чтобы создать или изменить адаптеры таблиц и связанные с ними таблицы данных. Можно настроить существующий адаптер TableAdapter, щелкнув его правой кнопкой мыши в **Конструктор наборов данных**.

![Мастер настройки адаптера таблицы раддата](../data-tools/media/raddata-table-adapter-configuration-wizard.png)

При перетаскивании нового TableAdapter из панели элементов, когда **Конструктор наборов данных** находится в фокусе, мастер запускается и предлагает указать источник данных, к которому должен подключаться адаптер таблицы. На следующей странице Мастер запрашивает тип команд, которые должны использоваться для взаимодействия с базой данных, либо инструкции SQL, либо хранимые процедуры. (Вы не увидите это, если настраиваете TableAdapter, уже связанный с источником данных.)

- При наличии правильных разрешений для базы данных можно создать новую хранимую процедуру в базовой базе данных. Если у вас нет этих разрешений, это не будет вариантом.

- Можно также выбрать запуск существующих хранимых процедур для команд **SELECT**, **INSERT**, **Update** и **Delete** адаптера таблицы TableAdapter. Хранимая процедура, назначенная команде **Update** , например, выполняется при `TableAdapter.Update()` вызове метода.

Сопоставьте параметры из выбранной хранимой процедуры с соответствующими столбцами в таблице данных. Например, если хранимая процедура принимает параметр с именем `@CompanyName` , который передается в `CompanyName` столбец таблицы, установите для **исходного столбца** `@CompanyName` параметра значение `CompanyName` .

> [!NOTE]
> Хранимая процедура, назначенная команде SELECT, выполняется путем вызова метода адаптера таблицы, имя которого вы назначите на следующем шаге мастера. Метод по умолчанию — `Fill` , поэтому код, который обычно используется для выполнения процедуры SELECT, — это `TableAdapter.Fill(tableName)` . Если изменить имя по умолчанию с `Fill` , замените на `Fill` имя назначения, а «TableAdapter» — на фактическое имя TableAdapter (например, `CustomersTableAdapter` ).

- Выбор **метода Create для отправки обновлений непосредственно в базу данных** эквивалентен присвоению `GenerateDBDirectMethods` свойству значения true. Данный параметр недоступен, если исходная инструкция SQL не предоставляет достаточный объем информации либо запрос не является обновляемым. Такая ситуация может возникнуть, например, в запросах **Join** и запросах, возвращающих одно (скалярное) значение.

**Дополнительные параметры** в мастере позволяют выполнять следующие задачи:

- Создавать инструкции INSERT, UPDATE и DELETE на основе инструкции SELECT, определенной на странице **Создание инструкций SQL**
- Использовать оптимистическую блокировку
- Укажите, следует ли обновлять таблицу данных после выполнения инструкций INSERT и UPDATE

## <a name="configure-a-tableadapters-fill-method"></a>Настройка метода Fill адаптера таблицы

Иногда может потребоваться изменить схему таблицы TableAdapter. Для этого необходимо изменить основной `Fill` метод TableAdapter. Адаптеры таблиц создаются с помощью основного `Fill` метода, определяющего схему связанной таблицы данных. Основной `Fill` метод основан на запросе или хранимой процедуре, введенной при первоначальной настройке TableAdapter. Это первый (самый верхний) метод в таблице данных в конструкторе наборов данных.

![TableAdapter с несколькими запросами](../data-tools/media/tableadapter.gif)

Любые изменения, вносимые в метод Main адаптера TableAdapter `Fill` , отражаются в схеме связанной таблицы данных. Например, при удалении столбца из запроса в `Fill` методе Main также удаляется столбец из связанной таблицы данных. Кроме того, удаление столбца из метода Main `Fill` удаляет столбец из любых дополнительных запросов для этого TableAdapter.

Для создания и изменения дополнительных запросов к адаптеру таблицы можно использовать мастер настройки запросов адаптера таблицы. Эти дополнительные запросы должны соответствовать схеме таблицы, если только они не возвращают скалярное значение.  Каждый дополнительный запрос имеет указанное имя.

В следующем примере показано, как вызвать дополнительный запрос с именем `FillByCity` :

`CustomersTableAdapter.FillByCity(NorthwindDataSet.Customers, "Seattle")`

### <a name="to-start-the-tableadapter-query-configuration-wizard-with-a-new-query"></a>Запуск мастера настройки запросов TableAdapter с помощью нового запроса

1. Откройте свой набор данных в **Конструкторе наборов данных**.

2. При создании нового запроса перетащите объект **запроса** с вкладки **набор данных** на **панели элементов** в <xref:System.Data.DataTable> или выберите команду **Добавить запрос** в контекстном меню TableAdapter. Можно также перетащить объект **запроса** на пустую область **Конструктор наборов данных**, которая создает TableAdapter без связанного объекта <xref:System.Data.DataTable> . Эти запросы могут возвращать только одиночные (скалярные) значения или выполнять команды UPDATE, INSERT или DELETE в базе данных.

3. На экране **Выбор подключения к данным** выберите или создайте соединение, которое будет использоваться запросом.

    > [!NOTE]
    > Этот экран появляется только в том случае, если конструктор не может определить правильное соединение или если нет доступных подключений.

4. На экране **Выбор типа команды выберите один** из следующих методов выборки данных из базы данных:

    - **Использование инструкций SQL** позволяет ввести инструкцию SQL для выбора данных из базы данных.

    - **Создать новую хранимую процедуру** позволяет мастеру создать новую хранимую процедуру (в базе данных) на основе указанной инструкции SELECT.

    - **Использование существующих хранимых процедур** позволяет запускать существующую хранимую процедуру при выполнении запроса.

### <a name="to-start-the-tableadapter-query-configuration-wizard-on-an-existing-query"></a>Запуск мастера настройки запросов TableAdapter на существующем запросе

- При редактировании существующего запроса TableAdapter щелкните запрос правой кнопкой мыши и выберите в контекстном меню пункт **настроить** .

    > [!NOTE]
    > Щелкнув правой кнопкой мыши основной запрос адаптера таблицы, вы переконфигурируете TableAdapter и <xref:System.Data.DataTable> схему. Однако, щелкнув правой кнопкой мыши дополнительный запрос в TableAdapter, вы настроите только выбранный запрос. **Мастер настройки TableAdapter** повторно настраивает определение TableAdapter, в то время как **Мастер настройки запросов TableAdapter** перенастраивает только выбранный запрос.

### <a name="to-add-a-global-query-to-a-tableadapter"></a>Добавление глобального запроса в TableAdapter

- Глобальные запросы — это запросы SQL, которые возвращают одно (скалярное) значение или без значения. Как правило, глобальные функции выполняют операции с базами данных, такие как операции вставки, обновления и удаления. Они также выполняют статистическую обработку данных, например количество клиентов в таблице или общую стоимость всех элементов в определенном порядке.

     Вы добавляете глобальные запросы, перетаскивая объект **запроса** с вкладки **набор данных** на **панели элементов** в пустую область **Конструктор наборов данных**.

- Укажите запрос, выполняющий нужную задачу, например `SELECT COUNT(*) AS CustomerCount FROM Customers` .

    > [!NOTE]
    > Перетаскивание объекта **запроса** непосредственно на **Конструктор наборов данных** создает метод, возвращающий только скалярное (одиночное) значение. Хотя выбранный запрос или хранимая процедура может возвращать больше одного значения, метод, созданный мастером, возвращает только одно значение. Например, запрос может вернуть первый столбец первой строки возвращаемых данных.

## <a name="see-also"></a>См. также раздел

- [Заполнение наборов данных с помощью адаптеров таблицы](../data-tools/fill-datasets-by-using-tableadapters.md)
