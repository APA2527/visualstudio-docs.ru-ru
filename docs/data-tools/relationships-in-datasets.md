---
title: Использовать DataRelation, чтобы создать отношения между наборами данных
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- vbData.Microsoft.VSDesigner.DataSource.DesignRelation
- vbdata.Microsoft.VSDesigner.DataSource.DesignRelation
helpviewer_keywords:
- relationships, about relationships
- datasets [Visual Basic], relationships
- relationships, datasets
ms.assetid: cfe274f0-71fe-40f6-994e-7c7f6273c9ba
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: 653a9b589e68c326fc40a94ed0fa3ab7e49acb8b
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62567654"
---
# <a name="create-relationships-between-datasets"></a>Создание связей между наборами данных
Наборы данных, которые содержат связанные данные таблицы использует <xref:System.Data.DataRelation> объектов для представления иерархическое отношение между таблицами и возврата связанных записей друг у друга. Добавление связанных таблиц к наборам данных с помощью **мастер настройки источника данных**, или **конструктор наборов данных**, создает и настраивает <xref:System.Data.DataRelation> объект.

<xref:System.Data.DataRelation> Объект выполняет две функции:

- Можно сделать доступной записи, относящиеся к записи, которой вы работаете. Он предоставляет дочерние записи, если вы находитесь в родительскую запись (<xref:System.Data.DataRow.GetChildRows%2A>) и родительской записи при работе с дочерними (<xref:System.Data.DataRow.GetParentRow%2A>).

- Вводит ограничения для обеспечения целостности данных, например удаление связанной дочерней записи при удалении родительской записи.

Важно понимать разницу между реальным объединением и функции <xref:System.Data.DataRelation> объекта. В значение true, соединения записи берутся из родительской и дочерней таблицами и поместить в один плоский набор записей. При использовании <xref:System.Data.DataRelation> объекта, создается новый набор записей. Вместо этого DataRelation отслеживает связи между таблицами и обеспечивает синхронизацию родительских и дочерних записей.

## <a name="datarelation-objects-and-constraints"></a>Объекты DataRelation и ограничения
Объект <xref:System.Data.DataRelation> объект также используется для создания и введения следующих ограничений:

- Ограничение уникальности, которое гарантирует, что столбец в таблице не содержит дубликатов.

- Ограничение внешнего ключа, который может использоваться для обеспечения целостности данных между родительской и дочерней таблицей в наборе данных.

Ограничения, заданные в <xref:System.Data.DataRelation> , реализуются посредством автоматического создания соответствующих объектов или настройки свойств. При создании ограничения foreign key с помощью <xref:System.Data.DataRelation> объект, экземпляры <xref:System.Data.ForeignKeyConstraint> добавляются в класс <xref:System.Data.DataRelation> объекта <xref:System.Data.DataRelation.ChildKeyConstraint%2A> свойство.

Ограничение уникальности реализуется либо присвоением <xref:System.Data.DataColumn.Unique%2A> свойство столбца данных, чтобы `true` либо путем добавления экземпляра <xref:System.Data.UniqueConstraint> класс <xref:System.Data.DataRelation> объекта <xref:System.Data.DataRelation.ParentKeyConstraint%2A> свойство. Сведения о приостановке ограничений в наборе данных, см. в разделе [отключение ограничений при заполнении набора данных](../data-tools/turn-off-constraints-while-filling-a-dataset.md).

### <a name="referential-integrity-rules"></a>Правила целостности данных
Являясь частью ограничения внешнего ключа можно указать правила целостности данных, которые применяются в трех местах:

- При обновлении родительской записи

- При удалении родительской записи

- При изменении принят или отклонен

Правила, которые планируется сделать указаны в <xref:System.Data.Rule> перечисления на них, перечисленные в следующей таблице.

|Правило ограничения внешнего ключа|Действие|
| - |------------|
|<xref:System.Data.Rule.Cascade>|Изменение (update или delete), внесенные в запись родительского также вносится в связанных записей в дочерней таблице.|
|<xref:System.Data.Rule.SetNull>|Дочерние записи не удаляются, но внешний ключ в дочерних записях присваивается <xref:System.DBNull>. Этот параметр, можно оставить дочерние записи, как «потерянные» — то есть не иметь отношений на родительские записи. **Примечание.** С помощью этого правила может привести недопустимые данные в дочерней таблице.|
|<xref:System.Data.Rule.SetDefault>|Внешний ключ в связанные дочерние записи устанавливается значение по умолчанию (в соответствии с параметром столбца <xref:System.Data.DataColumn.DefaultValue%2A> свойство).|
|<xref:System.Data.Rule.None>|Связанные дочерние записи не изменяется. Этот параметр, дочерние записи могут содержать ссылки на недопустимые родительские записи.|

Дополнительные сведения об обновлениях в таблицы набора данных см. в разделе [сохранить данные в базе данных](../data-tools/save-data-back-to-the-database.md).

### <a name="constraint-only-relations"></a>Только для ограничений отношений
При создании <xref:System.Data.DataRelation> объекта, у вас есть возможность указать, что отношение будет использоваться только для введения ограничений — то есть он будет не также использоваться для доступа к связанных записей. Этот параметр можно использовать для создания набора данных, является немного более эффективным и содержит меньшее число методов, чем с возможностью связанных записей. Тем не менее вы не сможете доступ к связанных записей. Например отношение только для ограничений запрещает удалять родительской записи, по-прежнему имеет дочерние записи, и дочерние записи недоступны через родительский.

## <a name="manually-creating-a-data-relation-in-the-dataset-designer"></a>Создание отношения данных в конструкторе наборов данных вручную
При создании таблицы данных с помощью средств конструирования данных в Visual Studio, связи создаются автоматически, если данные могут собираться из источника данных. Если вручную добавить таблицы данных из **набора данных** вкладке **элементов**, может потребоваться создать связи вручную. Дополнительные сведения о создании <xref:System.Data.DataRelation> объектов программным способом, см. в разделе [Добавление отношений DataRelation](/dotnet/framework/data/adonet/dataset-datatable-dataview/adding-datarelations).

Отношения между таблицами данных представляются в виде строк в **конструктор наборов данных**, с ключом и символом бесконечности изображающие аспект "один ко многим" отношения. По умолчанию имя связи не отображается в области конструктора.

[!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]

#### <a name="to-create-a-relationship-between-two-data-tables"></a>Чтобы создать связи между таблицами данных

1. Откройте свой набор данных в **Конструкторе наборов данных**. Дополнительные сведения см. в разделе [Пошаговое руководство: Создание набора данных в конструкторе наборов данных](walkthrough-creating-a-dataset-with-the-dataset-designer.md).

2. Перетащите **отношения** объекта из **набора данных** панели инструментов в дочернюю таблицу данных в отношении.

     **Отношения** откроется диалоговое окно, заполнение **дочерней таблицы** поле с таблицей, которую пользователь перетащил **отношения** объект.

3. Выберите родительскую таблицу из **родительской таблицы** поле. Родительская таблица содержит записи на стороне «один» отношения «один ко многим».

4. Убедитесь, что нужная таблица отображается в **дочерней таблицы** поле. Дочерняя таблица содержит записи на стороне «многие» отношения «один ко многим».

5. Введите имя для связи в **имя** поле, либо оставьте имя по умолчанию, на основе выбранных таблиц. Это имя для действительных <xref:System.Data.DataRelation> объект в коде.

6. Выберите столбцы, соединяющие таблицы в **ключевые столбцы** и **столбцы внешнего ключа** перечислены.

7. Выберите, следует ли создавать отношения и ограничения.

8. Установите или снимите **вложенное отношение** поле. Выбор этого параметра задает <xref:System.Data.DataRelation.Nested%2A> свойства `true`, и вызывает дочерние строки связи вкладываются в родительский столбец, когда эти строки записываются в виде XML-данных или синхронизированы с <xref:System.Xml.XmlDataDocument>. Дополнительные сведения см. в разделе [вложение отношений DataRelation](/dotnet/framework/data/adonet/dataset-datatable-dataview/nesting-datarelations).

9. Задайте правила, которые будут применяться при внесении изменений в записи в этих таблицах. Дополнительные сведения см. в разделе <xref:System.Data.Rule>.

10. Нажмите кнопку **ОК** для создания связи. Линия отношения отобразится в конструкторе между двумя таблицами.

#### <a name="to-display-a-relation-name-in-the-dataset-designer"></a>Чтобы отобразить имя отношения в конструкторе наборов данных

1. Откройте свой набор данных в **Конструкторе наборов данных**. Дополнительные сведения см. в разделе [Пошаговое руководство: Создание набора данных в конструкторе наборов данных](walkthrough-creating-a-dataset-with-the-dataset-designer.md).

2. Из **данных** меню, выберите **Показать подписи отношений** команду, чтобы отобразить имя отношения. Снимите этой команды, чтобы скрыть имя отношения.

## <a name="see-also"></a>См. также

- [Создание и настройка наборов данных в Visual Studio](../data-tools/create-and-configure-datasets-in-visual-studio.md)