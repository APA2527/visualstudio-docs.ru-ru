---
title: Практическое руководство. Настройка наследования с помощью реляционного конструктора объектов
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: e594af12-e777-434a-bc08-7dd2dac84cdc
author: jillre
ms.author: jillfra
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: ddd3d8b25c6e215302af8e0b40b5a971f5f4aa39
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2019
ms.locfileid: "72641917"
---
# <a name="how-to-configure-inheritance-by-using-the-or-designer"></a>Практическое руководство. Настройка наследования с помощью реляционного конструктора объектов
**Реляционный конструктор объектов** (**Реляционный конструктор**объектов) поддерживает концепцию наследования одной таблицы, так как она часто реализуется в реляционных системах. При однотабличном наследовании имеется единственная таблица базы данных, которая содержит поля как для родительских данных, так и для дочерних. Для реляционных данных столбец дискриминатора содержит значение, которое определяет, какому классу принадлежит каждая запись.

Например, рассмотрим `Persons` таблицу, которая содержит всех сотрудников компании. Некоторые лица являются служащими, а некоторые - менеджерами. Таблица `Persons` содержит столбец с именем `EmployeeType` со значением 1 для руководителей и значением 2 для сотрудников; Это столбец дискриминатора. В этом случае можно создать подкласс служащих и заполнить класс только записями, которые имеют в столбце `EmployeeType` значение 2. Кроме того, можно удалить из каждого класса неприменимые столбцы.

Создание модели объекта, который использует наследование (и соответствует реляционным данным), может быть несколько запутанным. В следующей процедуре описываются действия, необходимые для настройки наследования при помощи **реляционного конструктора объектов**. Следующие универсальные шаги, не ссылающиеся на существующие таблицы и столбцы, могут быть сложными, поэтому предоставляется пошаговое руководство по использованию данных. Подробные пошаговые инструкции по настройке наследования с помощью **реляционный конструктор объектов**, см. в разделе [Пошаговое руководство: Создание LINQ to SQL классы с помощью однотабличного наследования (реляционный конструктор объектов)](../data-tools/walkthrough-creating-linq-to-sql-classes-by-using-single-table-inheritance-o-r-designer.md).

## <a name="to-create-inherited-data-classes"></a>Чтобы создать наследуемые классы данных

1. Откройте **Реляционный конструктор O/R** , добавив элемент **LINQ to SQL Classes** в существующий Visual Basic C# или проект.

2. Перетащите таблицу, которая будет использоваться в качестве базового класса, в **конструктор O/R**.

3. Перетащите вторую копию таблицы в **конструктор O/R** и переименуйте ее. Это производный класс или подкласс.

4. Щелкните **Наследование** на вкладке **Реляционный конструктор объектов** на **Панели элементов**, после чего щелкните по подклассу (по таблице, которую вы переименовали) и подключите его к базовому классу.

    > [!NOTE]
    > Щелкните элемент **Наследование** на **Панели элементов** и, отпустив кнопку мыши, щелкните второй экземпляр класса, созданный на шаге 3, а затем щелкните первый класс, созданный на шаге 2. Стрелка на линии наследования указывает на первый класс.

5. Удалите в каждом классе свойства объектов, которые не должны выводиться и не используются для ассоциаций. При попытке удалить свойства объекта, используемые для связей, появляется сообщение об ошибке: [свойство \<property name > не может быть удалено, так как оно участвует в ассоциации \<association имя >](../data-tools/the-property-property-name-cannot-be-deleted-because-it-is-participating-in-the-association-association-name.md).

    > [!NOTE]
    > Поскольку производный класс наследует свойства, определенные в своем базовом классе, нельзя определить в каждом классе одинаковые столбцы. (Столбцы реализуются как свойства.) Можно включить создание столбцов в производном классе, установив модификатор наследования для свойства в базовом классе. Дополнительные сведения см. в разделе [основы наследования (Visual Basic)](/dotnet/visual-basic/programming-guide/language-features/objects-and-classes/inheritance-basics).

6. Выберите линию наследования в **конструкторе O/R**.

7. В окне **Свойства** задайте для **свойства дискриминатора** имя столбца, который различает записи в классах.

8. Задайте в свойстве **Значение производного класса дискриминатора** значение в базе данных, которое обозначает запись в качестве наследуемого типа. (Это значение хранится в столбце дискриминатора и используется для обозначения унаследованного класса.)

9. Задайте в свойстве **Дискриминатор базового класса** значение, которое обозначает запись в качестве базового типа. (Это значение хранится в столбце дискриминатора и используется для обозначения базового класса.)

10. Дополнительно можно установить свойство **Наследование по умолчанию**, чтобы обозначить тип в иерархии наследования, который используется при загрузке строк, которые не соответствуют какому-либо определенному коду наследования. Иными словами, если у записи есть значение в столбце дискриминатора, которое не соответствует значению в свойствах **дискриминатора производного класса** или **значения дискриминатора базового класса** , запись загружается в тип, обозначенный как  **Наследование по умолчанию**.

## <a name="see-also"></a>См. также

- [Средства LINQ to SQL в Visual Studio](../data-tools/linq-to-sql-tools-in-visual-studio2.md)
- [Пошаговое руководство. Создание классов LINQ to SQL (реляционный конструктор объектов)](how-to-create-linq-to-sql-classes-mapped-to-tables-and-views-o-r-designer.md)
- [Доступ к данным в Visual Studio](../data-tools/accessing-data-in-visual-studio.md)
- [LINQ to SQL](/dotnet/framework/data/adonet/sql/linq/index)
- [Пошаговое руководство. Создание классов LINQ to SQL с использованием наследования с одной таблицей (реляционный конструктор объектов)](../data-tools/walkthrough-creating-linq-to-sql-classes-by-using-single-table-inheritance-o-r-designer.md)
- [Основы наследования (Visual Basic)](/dotnet/visual-basic/programming-guide/language-features/objects-and-classes/inheritance-basics)
- [Наследование](/dotnet/csharp/programming-guide/classes-and-structs/inheritance)