---
title: Проверка и отладка кода SharePoint | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- unit testing [SharePoint development in Visual Studio]
- IntelliTrace [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, IntelliTrace
- SharePoint development in Visual Studio, unit testing
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 7b57e07245631d37594d66ea7907b16efd817b2b
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63008259"
---
# <a name="verify-and-debug-sharepoint-code"></a>Проверка и отладка кода SharePoint
С помощью IntelliTrace и модульного тестирования вы сможете гораздо легче отлаживать свои решения SharePoint и проверять, что каждый метод в них работает правильно. Эти функции можно использовать для проектов SharePoint в Visual Studio, выполнив те же процедуры, что и для других типов проектов.

## <a name="intellitrace"></a>IntelliTrace
С помощью IntelliTrace можно не только определять текущее состояние своего решения SharePoint, но также отслеживать прошедшие события и контекст, в котором эти события произошли. В своем решении SharePoint можно переходить назад и вперед к различным моментам во времени, в которых произошли события, и просматривать состояния и значения переменных в каждый момент времени. С помощью динамических переходов можно более быстро и легко отлаживать решения SharePoint без установки нескольких точек останова. Можно также сохранить сеанс отладки в журнал IntelliTrace (*.iTrace*) файл, открыть его позже в Visual Studio Enterprise и выполнить отладку после аварийного завершения. *.ITrace* файл содержит подробные сведения о когда и где случились определенные ошибки SharePoint, таким образом, чтобы легче можно выяснить причину ошибки. Сведения в *.iTrace* файл является подмножеством всего журнала ошибок, создающий единой системы ведения журнала (ULS) в SharePoint. Эти сведения включают события, относящихся к SharePoint, например при открытии или закрытии профиля пользователя и при загрузке свойств в проекте SharePoint, их чтении или изменении. Можно настроить записываемые события IntelliTrace. Дополнительные сведения см. в разделе [Использование сохраненных данных IntelliTrace](../debugger/using-saved-intellitrace-data.md).

При возникновении ошибки в SharePoint, диалоговое окно ошибки указывает идентификатор "идентификатор корреляции" для конкретной ошибки. Можно также получить идентификаторы корреляции из событий, перечисленных в *.iTrace* файл. Чтобы отобразить список всех событий, которые выполнялись с заданным Идентификатором корреляции, можно ввести идентификатор в **Analysis** разделе страницы сводки IntelliTrace. В этом разделе вы можете выбрать, следует ли показывать только имена произошедших событий или их имена вместе со сведениями о вызовах, к примеру: имя функции, точки выхода и точки входа, параметры и возвращаемые значения.

Можно получить события Visual Studio в IntelliTrace, выбрав **F5** ключ. Для получения событий, относящихся к SharePoint, необходимо собирать данные IntelliTrace в решениях SharePoint с помощью Microsoft Monitoring Agent. Это средство собирает данные IntelliTrace и создает *.iTrace* файлов для приложений, которые развертываются вне Visual Studio. Дополнительные сведения см. в разделе [возможности IntelliTrace](../debugger/intellitrace-features.md) и [использование автономного сборщика данных IntelliTrace](../debugger/using-the-intellitrace-stand-alone-collector.md).

## <a name="unit-test"></a>Модульный тест
В коде модульное тестирование, в котором создаются и запускаются тестовый код в методы теста можно проще находить ошибки. Эти методы содержат пустые переменные и оператор Assert, который можно использовать для проверки логики и функциональности своего проекта, в зависимости от объектной модели SharePoint. Дополнительные сведения см. в статье [Модульное тестирование кода](../test/unit-test-your-code.md).

### <a name="support-for-microsoft-fakes-framework"></a>Поддержка Microsoft Fakes framework
Проекты SharePoint поддерживают Microsoft Fakes, платформу изоляции, в которой можно создать тестовые заглушки и оболочки на основе делегатов (в приложениях на основе платформы .NET Framework). С помощью платформы Fakes вы можете создавать, поддерживать и встраивать заглушки в модульные тесты. Эти заглушки и оболочки изолируют модульные тесты от среды. Вы можете создавать заглушки для тестирования кода, который использует интерфейсы или незапечатанные классы с переопределяемыми методами. Можно создавать оболочки для перенаправления жестко заданных вызовов к запечатанным классам со статическими или непереопределяемыми методами альтернативной реализации оболочки. Вы также можете использовать делегаты с заглушками и оболочками для динамической настройки поведения отдельных членов заглушки. Дополнительные сведения см. в разделе [изоляция тестируемого кода с помощью Microsoft Fakes](../test/isolating-code-under-test-with-microsoft-fakes.md).

## <a name="related-articles"></a>Связанные статьи

|Заголовок|Описание|
|-----------|-----------------|
|[IntelliTrace](../debugger/intellitrace.md)|Описаны более простые способы отладки решений Visual Studio с помощью IntelliTrace.|
|[Пошаговое руководство: Отладка приложения SharePoint с помощью IntelliTrace](../sharepoint/walkthrough-debugging-a-sharepoint-application-by-using-intellitrace.md)|Описывает использование IntelliTrace для поиска ошибок кода в проекте SharePoint.|
|[Модульное тестирование кода](../test/unit-test-your-code.md)|Описывает способ поиска логических ошибок в коде с помощью модульных тестов.|

## <a name="see-also"></a>См. также

- [Улучшение качества кода](../test/improve-code-quality.md)