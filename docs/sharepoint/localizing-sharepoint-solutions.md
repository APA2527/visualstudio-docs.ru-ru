---
title: Локализация решений SharePoint | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- VS.SharePointTools.Project.GlobalAndFeatureResource
- VS.SharePoint.Project.AddResourceDialog
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- globalizing [SharePoint development in Visual Studio]
- localizing [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, localizing
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 7bcd11d7860e1d191479d4a2ea5f9fac78dcdfe2
ms.sourcegitcommit: 40bd5b27f247a07c2e2514acb293b23d6ce03c29
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2019
ms.locfileid: "73189220"
---
# <a name="localize-sharepoint-solutions"></a>Локализация решений SharePoint

  Процесс подготовки приложений к использованию по всему миру называется локализацией. Локализация — это преобразование ресурсов в определенные языки и региональные параметры. Дополнительные сведения см. в разделе [Глобализация и локализация приложений](../ide/globalizing-and-localizing-applications.md). В этом разделе приводятся общие сведения о локализации решения SharePoint.

 Чтобы локализовать решение, необходимо удалить жестко запрограммированные строки из кода и сделать их абстрактными в файлы ресурсов. Файл ресурсов — это файл на основе [!INCLUDE[TLA2#tla_xml](../sharepoint/includes/tla2sharptla-xml-md.md)]с расширением *RESX* . Файл ресурсов содержит переведенные версии строк, используемых в решении. Дополнительные сведения см. [в разделе ресурсы в приложениях](/previous-versions/dotnet/netframework-4.0/f45fce5x(v=vs.100)).

> [!NOTE]
> Добавляйте в файлы ресурсов решения SharePoint только строковые ресурсы. Хотя редактор ресурсов позволяет добавлять нестроковые ресурсы, нестроковые ресурсы не развертываются в SharePoint.

## <a name="resource-files"></a>Файлы ресурсов
 Существует три типа файлов ресурсов: по умолчанию, нейтральные к языку и зависящие от языка.

|Тип файла ресурсов|Описание|
|------------------------|-----------------|
|Значение по умолчанию|Файлы ресурсов по умолчанию, также называемые резервным ресурсом, содержат строки, локализованные для языка и региональных параметров по умолчанию, например английский. Они используются, если не удается найти локализованные файлы ресурсов для указанного языка. Ресурсы по умолчанию не имеют отдельных файлов, они хранятся в основной сборке приложения.|
|Не зависящий от языка|Файл ресурсов, который содержит строки, локализованные для языка, но не для конкретного языка и региональных параметров. Например, "fr" для французского языка.|
|Для конкретного языка|Файл ресурсов, содержащий строки, локализованные для языка и языка и региональных параметров. Например, "fr-CA" для французского языка (Канада).|

 Дополнительные сведения см. в разделе [Иерархическая организация ресурсов для локализации](../ide/globalizing-and-localizing-applications.md).

 Чтобы указать файлы ресурсов по умолчанию в проектах SharePoint, разрабатываемых в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], выберите **инвариантный язык (инвариантная страна)** в списке язык и региональные параметры диалогового окна **Добавление ресурса** при добавлении файла ресурсов.

## <a name="localize-visual-studio-sharepoint-solutions"></a>Локализация решений SharePoint для Visual Studio
 При локализации решения следует учитывать все текстовые данные, отображаемые в решении пользователям. Информационные сообщения, сообщения об ошибках и строки [!INCLUDE[TLA2#tla_ui](../sharepoint/includes/tla2sharptla-ui-md.md)] должны быть переведены, и эти переводы помещаются в файлы ресурсов.

 Каждая строка в файле ресурсов имеет уникальный идентификатор. Используйте один и тот же идентификатор для переведенной строки в каждом файле ресурсов. Например, если "Строка1" — это идентификатор первой строки в файле ресурсов по умолчанию, используйте тот же идентификатор для первой строки в файлах ресурсов, зависящих от языка.

 В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] приложений SharePoint обычно используются три области: компоненты, разметка страницы ASPX и код. В следующих разделах предполагается, что у вас есть решение SharePoint, которое необходимо локализовать на немецком и японском языках. По умолчанию используется английский язык.

### <a name="localize-features"></a>Локализация функций
 Для локализации функции необходимо заменить жестко заданное название и описание функции на выражение, которое ссылается на переведенный заголовок и строку в локализованном файле ресурсов. Это изменение можно выполнить в **конструкторе компонентов** [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]. Дополнительные сведения см. [в разделе Практические руководства. Локализация компонента](../sharepoint/how-to-localize-a-feature.md).

 Чтобы локализовать англоязычные компоненты на немецком и японском языках, добавьте в проект три элемента проекта файла ресурсов: один для английского языка, один для немецкого, а другой для японского. Файлы ресурсов компонентов нельзя использовать для локализации разметки или кода ASPX. для них требуются отдельные файлы ресурсов.

 После создания файлов ресурсов компонентов добавьте в них переведенные строки. Получите доступ к локализованным строкам с помощью выражения в следующем формате:

```aspx-csharp
$Resources:String ID
```

 Ресурсы компонента в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] всегда называются Resources. При выборе языка, отличного от инвариантного языка, в имя файла ресурсов добавляется [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)] языка и региональных параметров. Например, если добавить файл ресурсов компонента инвариантного языка (по умолчанию), он называется *Resources. resx*. При добавлении ресурса компонента, зависящего от языка, путем выбора языка и региональных параметров "Японский" (Япония) файл называется *Resources. ja-JP. resx*. Имена файлов ресурсов компонентов назначаются автоматически и не могут быть изменены.

 Областью ресурсов компонента является локальная для компонента, к которому они добавляются. Чтобы создать ресурсы, которые могут использоваться любым файлом компонента или элемента в решении, добавьте элемент проекта **глобального файла ресурсов** вместо файла ресурсов компонента. Элемент проекта " **глобальный файл ресурсов** " находится в папке **2010** в разделе **SharePoint** в диалоговом окне **Добавление нового элемента** . Файлы глобальных ресурсов развертываются в папку \Ресаурцес корневой папки SharePoint.

### <a name="localize-aspx-page-markup"></a>Локализация разметки страницы ASPX
 Чтобы локализовать [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)] страницы, добавьте в проект три элемента проекта файла ресурсов: один для английского языка, один для немецкого, а другой для японского. Если вам не нужно локализовать код в дополнение к разметке, можно добавить файлы глобальных ресурсов.

 Укажите имя файла ресурсов языка по умолчанию. Присвойте локализованным файлам ресурсов то же имя, к которому добавляется язык и региональные параметры, зависящие от языка [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)]. Например, *MyAppResources.de-de. resx* для немецкого языка и *мяппресаурцес. ja-JP. resx* для японского языка.

 Задайте для свойства **тип развертывания** каждого файла ресурсов значение **AppGlobalResource**. Это приводит к развертыванию файлов ресурсов в папке App_GlobalResources, где они доступны для всех страниц ASPX и элементов управления в решении. Папка App_GlobalResources находится в папке К:\инетпуб\ввврут\всс\виртуалдиректориес\\< номер порта\>\App_GlobalResources.

> [!NOTE]
> Если вы используете неглобальные файлы ресурсов, переместите их в папку элемента проекта, чтобы включить свойство тип развертывания и другие свойства, относящиеся к SharePoint.

 Файлы ресурсов разметки ASPX также можно использовать для локализации кода. Если вы используете ресурсы для локализации кода в дополнение к разметке ASPX, оставьте параметр свойства Действие сборки для каждого файла как внедренный ресурс, чтобы сделать ресурс компилируемым в вспомогательную сборку. Однако если вы используете файлы ресурсов только для локализации разметки, при необходимости можно изменить действие сборки на содержимое, чтобы предотвратить компиляцию файла в основную сборку приложения.

 Замените все жестко запрограммированные строки свойств на страницах ASPX и разметка элементов управления выражением в следующем формате:

```aspx-csharp
<asp:<class> runat="server" Text="<%$Resources:<Resource File Name>, <String ID>%>" />
```

 Пример:

```aspx-csharp
<asp:Button ID="btn1" runat="server" onclick="btn1_Click" Text="<%$Resources:Resource1,String7%>"></asp:Button>
```

 В качестве текста для ASPX используйте выражение в следующем формате:

```aspx-csharp
<asp:literal ID="<ID>" runat="server" Text="<%$Resources:<Resource File Name>, <String ID>%>" />
```

 Пример:

```aspx-csharp
<asp:literal ID="Literal1" runat="server" Text="<%$Resources:Resource1, String9%>" />
```

 Дополнительные сведения см. [в разделе инструкции. Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md).

### <a name="localize-code"></a>Локализация кода
 Помимо локализации строк компонентов и [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)] разметки, необходимо также локализовать строки сообщений и строки ошибок, которые отображаются в коде решения. Локализованные сборки содержат информационные сообщения и сообщений об ошибках. Вспомогательные сборки содержат строки, видимые пользователям, например [!INCLUDE[TLA2#tla_ui](../sharepoint/includes/tla2sharptla-ui-md.md)] текстовые и выходные сообщения, такие как исключения.

 [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] использует модель концентратора и звезды стандартной .NET Framework. Концентратор или основная сборка программы содержит ресурсы языка по умолчанию. Периферийные или вспомогательные сборки содержат ресурсы для конкретного языка. Дополнительные сведения см. в статье [Упаковка и развертывание ресурсов](/previous-versions/dotnet/netframework-4.0/sb6a8618(v=vs.100)). Вспомогательные сборки компилируются из файлов ресурсов (*RESX*). При добавлении файлов ресурсов для конкретного языка в проект и пакет решения [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] компилирует файлы ресурсов во вспомогательные сборки с именем *{Project Name}. Resources. dll*.

 Как и в случае с разметкой ASPX, локализация кода приложения SharePoint путем добавления в проект отдельных элементов проекта файла ресурсов; один для языка по умолчанию и один для каждого локализованного языка. Однако, как упоминалось ранее, если у вас уже есть файлы ресурсов для локализации разметки ASPX, их можно повторно использовать для локализации кода. Если необходимо создать файлы ресурсов, предоставьте файлу ресурсов языка по умолчанию имя, добавленное с расширением *RESX* . Назовите локализованные файлы ресурсов с тем же именем, к которому добавляется язык и региональные параметры [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)]. Задайте для свойства Действие сборки для каждого файла ресурсов значение Внедренный ресурс, чтобы разрешить создание вспомогательных сборок ресурсов.

 Чтобы создать вспомогательные сборки, выполните сборку проекта, а затем добавьте файлы в качестве дополнительных сборок на вкладке **Дополнительно** **конструктора пакетов**. Добавляя сборки, добавьте в начало пути к расположению [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)] папку, например *de-de\\{Project Item Name}. Resources. dll*. Это позволяет пакету содержать файлы с одинаковыми именами.

 В коде замените жестко запрограммированные строки вызовами метода <xref:System.Web.HttpContext.GetGlobalResourceObject%2A>, используя следующий синтаксис:

```aspx-csharp
HttpContext.GetGlobalResourceObject("<Resource File Name>", "<String ID>")
```

 Дополнительные сведения см. [в разделе Практические руководства. Локализация кода](../sharepoint/how-to-localize-code.md).

#### <a name="web-part-code-localization"></a>Локализация кода веб-части
 Веб-части включают в себя функцию редактора пользовательских свойств, включающую атрибуты кода, использующие жестко запрограммированные строки, такие как веб-DisplayName, Category и Description. Чтобы заменить строковые значения для этих атрибутов, создайте отдельный класс, производный от класса атрибута. В этих классах задайте свойство атрибута. Свойство атрибута зависит от базового класса. Например, свойство Дисплайнамевалуе атрибута DisplayName имеет значение, а свойство Дескриптионвалуе атрибута Description.

 В производном классе сослаться на идентификатор строки из файла ресурсов и объекта ResourceManager, чтобы получить локализованное значение для идентификатора строки. Верните это значение в атрибут редактора свойств.

## <a name="see-also"></a>См. также
- [Практические руководства. Локализация компонента](../sharepoint/how-to-localize-a-feature.md)
- [Как локализовать разметку ASPX](../sharepoint/how-to-localize-aspx-markup.md)
- [Практические руководства. Локализация кода](../sharepoint/how-to-localize-code.md)
- [Как добавить файл ресурсов](../sharepoint/how-to-add-a-resource-file.md)
- [Как использовать файл ресурсов для указания локализованных имен, свойств и разрешений](../sharepoint/how-to-use-a-resource-file-to-specify-localized-names-properties-and-permissions.md)
