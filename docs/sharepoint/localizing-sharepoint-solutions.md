---
title: Локализация решений SharePoint | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- VS.SharePointTools.Project.GlobalAndFeatureResource
- VS.SharePoint.Project.AddResourceDialog
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- globalizing [SharePoint development in Visual Studio]
- localizing [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, localizing
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 90da60cb904ba6e3db2be3805256fcf4eb9122ee
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63444347"
---
# <a name="localize-sharepoint-solutions"></a>Локализация решений SharePoint

  Процесс подготовки приложений, чтобы их можно использовать по всему миру называется локализацией. Локализация перевода ресурсов для конкретного языка и региональных параметров. Дополнительные сведения см. в разделе [Globalizing and Localizing Applications](../ide/globalizing-and-localizing-applications.md). Здесь представлен обзор процесса локализации решения SharePoint.

 Для локализации решения, удалите из кода жестко запрограммированные строки и перенести их в файлы ресурсов. Файл ресурсов является [!INCLUDE[TLA2#tla_xml](../sharepoint/includes/tla2sharptla-xml-md.md)]-файл c *.resx* расширения. Файл ресурсов содержит переведенные версии строк, используемых в решении. Дополнительные сведения см. в разделе [ресурсы в приложениях](http://go.microsoft.com/fwlink/?LinkID=155844).

> [!NOTE]
> Добавляйте только строковые ресурсы в файл ресурсов решения SharePoint. Несмотря на то, что редактор ресурсов позволяет добавлять не строковые ресурсы, такие ресурсы не развертываются в SharePoint.

## <a name="resource-files"></a>Файлы ресурсов
 Существует три типа файлов ресурсов: по умолчанию, не зависящий от языка и конкретного языка.

|Тип файла ресурсов|Описание|
|------------------------|-----------------|
|Значение по умолчанию|Также известен как резервный ресурс, файл ресурсов по умолчанию содержит строки, локализованные для культуры по умолчанию, например в английском языке. Они используются, если невозможно найти файл ресурсов для указанного языка. Ресурсы по умолчанию не имеют отдельных файлов, они хранятся в основной сборке приложения.|
|Не зависящий от языка|Файл ресурсов, содержащий строки, локализованные под определенный язык, но не заданных региональных параметров. Например, «fr» для французского языка.|
|Зависящие от языка|Файл ресурсов, содержащий строки, локализованные под определенный язык и региональные параметры. Например, «fr-CA» для французский — Канада.|

 Дополнительные сведения см. в разделе [иерархическая организация ресурсов, для локализации](http://go.microsoft.com/fwlink/?LinkId=178360).

 Чтобы указать файл ресурсов по умолчанию в проектах SharePoint, разрабатываемых в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], выберите **универсальный язык (Универсальная страна)** в списке язык и региональные параметры **добавить ресурс** диалоговое окно, когда вы Добавьте файл ресурсов.

## <a name="localize-visual-studio-sharepoint-solutions"></a>Локализация решений Visual Studio SharePoint
 При локализации решения следует выделить всю текстовую информацию, отображаемую решением для пользователей. Информационные сообщения, сообщения об ошибках и [!INCLUDE[TLA2#tla_ui](../sharepoint/includes/tla2sharptla-ui-md.md)] строки должны быть переведены, а перевод помещен в файлы ресурсов.

 Каждая строка в файле ресурсов имеет уникальный идентификатор. Используйте одинаковые идентификаторы для переведенных строк в каждом файле ресурсов. Например если «String1» является идентификатором первой строки в файле ресурса по умолчанию, используйте тот же идентификатор для первой строки в файлы ресурсов для конкретного языка.

 Существует три области, обычно локализации в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] приложения SharePoint: компоненты, разметка страницы ASPX и код. Для наглядности в следующих разделах предполагается, что у вас есть решение SharePoint, локализуемое на немецкий и японский. Язык по умолчанию — на английском языке.

### <a name="localize-features"></a>Локализация компонентов
 Для локализации компонентов необходимо заменить жестко запрограммированное название и описание возможности выражением, которое ссылается на переведенное название и строку в локализованном файле ресурсов. Внесения этого изменения в **конструктора компонентов** в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]. Дополнительные сведения см. в разделе [Как Локализация компонента](../sharepoint/how-to-localize-a-feature.md).

 Для локализации компонентов с английского языка на немецкий и японский, три элемента проекта файла ресурсов добавьте в проект: одному для английского, немецкого и японского языков. Файлы ресурсов для компонентов нельзя использовать для локализации разметки ASPX или кода. для них требуются отдельные файлы ресурсов.

 После создания файлов ресурсов компонента добавьте переведенных строк к ним. Доступ к локализованным строкам с помощью выражения в следующем формате:

```aspx-csharp
$Resources:String ID
```

 Ресурсы компонента в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] всегда имеют имена ресурсов. Если выбран язык, отличный от инвариантного языка, язык [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)] добавляется к имени файла ресурсов. Например, если при добавлении файла ресурсов компонента универсальный язык (по умолчанию), он вызывается *Resources.resx*. При добавлении ресурсов компонента конкретного языка, выбрав язык и региональные параметры японский (Япония), файл будет назван *получает имя Resources.ja-JP.resx*. Имена файла ресурсов компонента присваиваются автоматически и не может быть изменено.

 Область ресурсов компонента является локальной для компонента, к которому они добавляются. Чтобы создать ресурсы, которые могут быть использованы любым файлом компонента или элемента решения, добавление **глобальные файлы ресурсов** элемент проекта вместо файла ресурсов компонента. **Глобальные файлы ресурсов** элемент проекта находится в **2010** папке **SharePoint** в **Добавление нового элемента** диалоговое окно. Глобальные файлы ресурсов развертываются в папке \Resources корневой папки SharePoint.

### <a name="localize-aspx-page-markup"></a>Локализация разметки страницы ASPX
 Для локализации [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)] страниц, добавьте три элемента проекта файла ресурсов в проект: одному для английского, немецкого и японского языков. Если у вас нет для локализации кода вместе с разметкой, вместо этого можно добавить глобальные файлы ресурсов.

 Укажите имя для файла ресурсов языка по умолчанию. Присвойте имя, совпадающее с языка конкретного языка и региональных параметров локализованным файлам ресурсов [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)]. Например *MyAppResources.de-DE.resx* для немецкого языка и *MyAppResources.ja-JP.resx* для японского языка.

 Задайте **тип развертывания** свойства каждого файла ресурсов для **AppGlobalResource**. В результате файлы ресурсов развертываются в папке App_GlobalResources, где они доступны для всех страниц ASPX и элементов управления решения. Папка App_GlobalResources находится в C:\inetpub\wwwroot\wss\VirtualDirectories\\< номер порта\>\App_GlobalResources.

> [!NOTE]
> При использовании не глобальных файлов ресурсов, переместите их в папку элементов проекта, чтобы включить свойство типа развертывания и другие свойства, относящиеся к SharePoint.

 Файлы ресурсов разметки ASPX также могут использоваться для локализации кода. При использовании ресурсов для локализации кода вместе с разметкой ASPX, оставьте действие при сборке значения этого свойства каждого файла как внедренный ресурс, ресурс для компиляции во вспомогательную сборку. Тем не менее если вы используете файлы ресурсов для локализации разметки, при необходимости можно изменить действие сборки к содержимому для предотвращения файла компилируемого в основную сборку приложения.

 Замените все жестко запрограммированные свойства строки в разметке страницы и элементы управления ASPX выражение в следующем формате:

```aspx-csharp
<asp:<class> runat="server" Text="<%$Resources:<Resource File Name>, <String ID>%>" />
```

 Пример:

```aspx-csharp
<asp:Button ID="btn1" runat="server" onclick="btn1_Click" Text="<%$Resources:Resource1,String7%>"></asp:Button>
```

 Для ASPX, в виде текста используйте выражение в следующем формате:

```aspx-csharp
<asp:literal ID="<ID>" runat="server" Text="<%$Resources:<Resource File Name>, <String ID>%>" />
```

 Пример:

```aspx-csharp
<asp:literal ID="Literal1" runat="server" Text="<%$Resources:Resource1, String9%>" />
```

 Дополнительные сведения см. в разделе [Как Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md).

### <a name="localize-code"></a>Локализация кода
 В дополнение к локализации строк компонента и [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)] разметки, также необходимо локализовать строки сообщений и ошибок, которые появляются в коде решения. Локализованные информационные сообщения и сообщения об ошибках будут содержаться во вспомогательных сборках. Вспомогательные сборки содержат строки, которые отображаются для пользователей, таких как [!INCLUDE[TLA2#tla_ui](../sharepoint/includes/tla2sharptla-ui-md.md)] текст и выходные сообщения, такие как исключения.

 [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] использует стандартную модель звездообразной .NET Framework. Концентратор, или основная сборка программы, содержит языковые ресурсы по умолчанию. Спицы, или вспомогательные сборки, содержат языковые ресурсы. Дополнительные сведения см. в статье [Упаковка и развертывание ресурсов](http://go.microsoft.com/fwlink/?LinkId=179280). Вспомогательные сборки компилируются из ресурса (*.resx*) файлы. При добавлении файлов языковых ресурсов в проект и пакет решения, [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] компилирует файлы ресурсов во вспомогательные сборки с именем *.resources.dll {имя проекта}*.

 Как и в случае с разметкой ASPX, локализация кода приложения SharePoint путем добавления отдельных элементов проекта файла ресурсов в проект; один для языка по умолчанию и по одному для каждого языка локализации. Тем не менее как упоминалось ранее, если у вас уже есть файлы ресурсов для локализации разметки ASPX, их можно было использовать для локализации кода. Если вам нужно создать файлы ресурсов, имя файла ресурсов языка по умолчанию по своему усмотрению, дополненный *.resx* расширения. Именование локализованные файлы ресурсов тем же именем, дополненный языка конкретного языка и региональных параметров [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)]. Свойства Действие при сборке каждого файла ресурсов для внедренных ресурсов, чтобы разрешить создание вспомогательных сборок ресурсов.

 Чтобы создать вспомогательные сборки, постройте проект и затем добавьте файлы в качестве дополнительных сборок через **Дополнительно** вкладке **конструктора пакетов**. При добавлении сборки, добавить в начало культуры [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)] папку пути, такие как *de-DE\\.resources.dll {имя элемента проекта}*. Благодаря этому пакет может содержать файлы, которые имеют одинаковые имена.

 В коде, замените жестко запрограммированные строки вызовы <xref:System.Web.HttpContext.GetGlobalResourceObject%2A> метод, используя следующий синтаксис:

```aspx-csharp
HttpContext.GetGlobalResourceObject("<Resource File Name>", "<String ID>")
```

 Дополнительные сведения см. в разделе [Как Локализация кода](../sharepoint/how-to-localize-code.md).

#### <a name="web-part-code-localization"></a>Локализация кода веб-части
 Веб-части содержат пользовательскую функцию редактора свойств, содержащий атрибуты кода, использующие жестко запрограммированные строки, такие как WebDisplayName, категория и WebDescription. Чтобы заменить значения строк для этих атрибутов, создайте отдельный класс, производный от класса атрибута. В этих классах задайте свойство атрибута. Свойство атрибута зависит от базового класса. Например свойством атрибута WebDisplayName является DisplayNameValue, а свойством атрибута WebDescription — DescriptionValue.

 В производном классе сошлитесь на идентификатор строки из файла ресурсов и объекта ResourceManager, чтобы получить локализованное значение для идентификатора строки. Верните это значение в атрибут редактора свойств.

## <a name="see-also"></a>См. также
- [Практическое руководство. Локализация компонента](../sharepoint/how-to-localize-a-feature.md)
- [Практическое руководство. Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md)
- [Практическое руководство. Локализация кода](../sharepoint/how-to-localize-code.md)
- [Практическое руководство. Добавьте файл ресурсов](../sharepoint/how-to-add-a-resource-file.md)
- [Практическое руководство. Использование файла ресурсов для задания локализованных имен, свойств и разрешений](../sharepoint/how-to-use-a-resource-file-to-specify-localized-names-properties-and-permissions.md)
