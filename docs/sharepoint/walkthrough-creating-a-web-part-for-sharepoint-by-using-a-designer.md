---
title: Создание веб-части для SharePoint с помощью конструктора
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- Web Parts [SharePoint development in Visual Studio], designer
- Web Parts [SharePoint development in Visual Studio], creating
- Web Parts [SharePoint development in Visual Studio], designing
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 9963c2f7e829e9d295ca254aa651e37e3ad08efd
ms.sourcegitcommit: 25570fb5fb197318a96d45160eaf7def60d49b2b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/30/2019
ms.locfileid: "66401148"
---
# <a name="walkthrough-create-a-web-part-for-sharepoint-by-using-a-designer"></a>Пошаговое руководство. Создание веб-части для SharePoint с помощью конструктора

Если вы создаете веб-частей для сайта SharePoint, пользователям можно непосредственно изменить содержимое, внешний вид и поведение страниц на этом сайте с помощью браузера. В этом пошаговом руководстве показано, как создать веб-часть визуально с помощью SharePoint **визуальной веб-части** шаблона проекта в Visual Studio.

Веб-часть, которую вам предстоит создать отображает представление месячного календаря и флажок для каждого списка календаря на сайте. Пользователи могут указать, какие списки календаря включить в представление месячного календаря, установив флажки.

В данном пошаговом руководстве рассмотрены следующие задачи:

- Создание веб-части с помощью **визуальной веб-части** шаблона проекта.
- Разработка веб-части с помощью конструктора Visual Web Developer в Visual Studio.
- Добавление кода для обработки событий элементов управления веб-части.
- Тестирование веб-части в SharePoint.

    > [!NOTE]
    > На компьютере могут отображаться различные имена или расположения некоторых элементов пользовательского интерфейса для Visual Studio в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. См. статью [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).

## <a name="prerequisites"></a>Предварительные требования

Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.

- Поддерживаемые версии Windows и SharePoint.

## <a name="create-a-web-part-project"></a>Создайте проект веб-части

Во-первых, создайте проект веб-части с помощью **визуальной веб-части** шаблона проекта.

1. Запуск [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] с помощью **Запуск от имени администратора** параметр.

2. В строке меню выберите **Файл** > **Создать** > **Проект**.

     Откроется диалоговое окно **Новый проект** .

3. В **новый проект** диалоговое окно, в одном **Visual C#** или **Visual Basic**, разверните **Office/SharePoint**, а затем выберите  **Решения SharePoint** категории.

4. В списке шаблонов выберите **SharePoint 2013 — Визуальная веб-часть** шаблона, а затем выберите **ОК** кнопки.

     **Мастер настройки SharePoint** отображается. С помощью этого мастера, можно указать сайт, который будет использоваться для отладки проекта и уровень доверия решения.

5. В **Какова степень доверия для этого решения SharePoint?** выберите **развернуть как решение фермы** переключатель.

6. Выберите **Готово** кнопку, чтобы принять локальный сайт SharePoint по умолчанию.

## <a name="designing-the-web-part"></a>Разработка веб-части

Разработка веб-части путем добавления элементов управления из **элементов** на поверхность конструктора Visual Web Developer.

1. В конструкторе Visual Web Developer выберите **разработки** tab для переключения в режим конструктора.

2. В строке меню выберите **Вид** > **Панель элементов**.

3. В **стандартный** узел **элементов**, выберите **CheckBoxList** управления, а затем выполните одно из следующих действий:

    - Откройте контекстное меню для **CheckBoxList** выберите **копирования**, откройте контекстное меню для первой строки в конструкторе и выберите **вставить**.

    - Перетащите **CheckBoxList** управления из **элементов**и подключитесь к первой строке в конструкторе элемента управления.

4. Повторите предыдущий шаг, но перемещайте кнопку на следующую строку в конструкторе.

5. В конструкторе выберите **Button1** кнопки.

6. В строке меню выберите **представление** > **окно "Свойства"** .

     **Свойства** откроется окно.

7. В **текст** свойства кнопки, введите **обновления**.

## <a name="handling-the-events-of-controls-on-the-web-part"></a>Обработка событий элементов управления веб-части

Добавьте код, который позволяет пользователю добавлять календари в представление главного календаря.

1. Выполните одно из следующих действий.

   - В конструкторе, дважды щелкните **обновления** кнопки.

   - В **свойства** окно для **обновление** "Кнопка", выберите **события** кнопки. В **щелкните** свойство, введите **Button1_Click**, а затем нажмите клавишу ВВОД.

     В редакторе кода откроется файл кода пользовательского элемента управления и `Button1_Click` появится обработчик событий. Позже вы добавите код в этот обработчик событий.

2. Добавьте следующие инструкции в начало файла кода пользовательского элемента управления.

     [!code-vb[SP_VisualWebPart#1](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#1)]
     [!code-csharp[SP_VisualWebPart#1](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#1)]

3. Добавьте следующую строку кода, чтобы `VisualWebPart1` класса. Этот код объявляет управления представлением месячного календаря.

     [!code-vb[SP_VisualWebPart#2](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#2)]
     [!code-csharp[SP_VisualWebPart#2](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#2)]

4. Замените `Page_Load` метод `VisualWebPart1` класса следующим кодом. Этот код выполняет следующие задачи:

   - Добавляет представление месячного календаря в пользовательский элемент управления.

   - Добавляет флажок для каждого списка календаря на сайте.

   - Задает шаблон для каждого типа элемента, который отображается в представлении календаря.

     [!code-vb[SP_VisualWebPart#3](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#3)]
     [!code-csharp[SP_VisualWebPart#3](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#3)]

5. Замените `Button1_Click` метод `VisualWebPart1` класса следующим кодом. Этот код добавляет элементы из каждого выбранного календаря в представление главного календаря.

     [!code-vb[SP_VisualWebPart#4](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#4)]
     [!code-csharp[SP_VisualWebPart#4](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#4)]

## <a name="test-the-web-part"></a>Тестирование веб-части

При запуске проекта открывается сайт SharePoint. Веб-часть автоматически добавляется к коллекции веб-частей в SharePoint. Чтобы протестировать этот проект, вы будете выполнять следующие задачи:

- Добавьте событие для каждого из двух отдельных списков календарей.
- Добавьте веб-часть на страницу веб-частей.
- Укажите списки для включения в представление месячного календаря.

### <a name="to-add-events-to-calendar-lists-on-the-site"></a>Чтобы добавить события в списки календарей на сайте

1. В Visual Studio, выберите **F5** ключ.

     Откроется сайт SharePoint и [!INCLUDE[wss_14_long](../sharepoint/includes/wss-14-long-md.md)] на странице отображается панель быстрого запуска.

2. На панели быстрого запуска в разделе **перечислены**, выберите **календаря** ссылку.

     **Календаря** появится страница.

     Если связь календаря не появится на панели быстрого запуска, выберите **содержимое сайта** ссылку. Если не отображается на странице содержимого сайта **календаря** , создайте его.

3. На странице "Календарь", выберите день и выберите **добавить** ссылку в выбранном дне, чтобы добавить событие.

4. В **Title** введите **событие в календаре по умолчанию**, а затем выберите **Сохранить** кнопки.

5. Выберите **содержимое сайта** связать, а затем щелкните **Добавление веб-приложения** плитку.

6. На **создать** выберите **календаря** введите, назовите календарь и выберите **создать** кнопки.

7. Добавьте событие в новый календарь, назовите событие **событие в пользовательском календаре**, а затем выберите **Сохранить** кнопки.

### <a name="to-add-the-web-part-to-a-web-part-page"></a>Чтобы добавить веб-часть на страницу веб-частей

1. На **содержимое сайта** странице откройте **страницы сайта** папки.

2. На ленте выберите **файлы** открытой вкладкой ", **новый документ** меню и выберите **страницу веб-части** команды.

3. На **новые страницы веб-частей** странице, назовите страницу **SampleWebPartPage.aspx**и нажмите кнопку **создать** кнопки.

     Откроется веб-части.

4. В верхней части страницы веб-частей, выберите **вставить** вкладке, а затем выберите **веб-часть** кнопки.

5. Выберите **Custom** папку, выберите **VisualWebPart1** веб-части, а затем выберите **добавить** кнопки.

     Веб-части отображается на странице. В веб-части отображаются следующие элементы управления:

    - Представление месячного календаря.

    - **Обновления** кнопки.

    - Объект **календаря** "флажок".

    - Объект **пользовательский календарь** "флажок".

### <a name="to-specify-lists-to-include-in-the-monthly-calendar-view"></a>Задание списков для включения в представление месячного календаря

В веб-части выберите календари, которые вы хотите включить в представление месячного календаря, а затем выберите **обновления** кнопки.

События из всех указанных календарей отображаются в представление месячного календаря.

## <a name="see-also"></a>См. также

[Создание веб-частей для SharePoint](../sharepoint/creating-web-parts-for-sharepoint.md)
[как: Создание веб-части SharePoint](../sharepoint/how-to-create-a-sharepoint-web-part.md)
[Пошаговое руководство: Создание веб-части для SharePoint](../sharepoint/walkthrough-creating-a-web-part-for-sharepoint.md)
