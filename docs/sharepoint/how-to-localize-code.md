---
title: Как локализовать код | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- localizing code [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, localizing
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 6c1963ff0b6ef317dfa1a2c8154a1628710dc562
ms.sourcegitcommit: f9e44f5ab6a1dfb56c945c9986730465e1adb6fc
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2020
ms.locfileid: "86016684"
---
# <a name="how-to-localize-code"></a>Практические руководства. Локализация кода
  Нелокализованный код использует жестко запрограммированные строковые значения. Чтобы локализовать строки кода, замените их вызовами <xref:System.Web.HttpContext.GetGlobalResourceObject%2A> метода, который является методом, который ссылается на локализованные ресурсы.

## <a name="localize-code"></a>Локализация кода

#### <a name="to-localize-code"></a>Локализация кода

1. В **Обозреватель решений**откройте контекстное меню для элемента проекта и выберите команду **Добавить**  >  **модуль**.

     Выберите шаблон **файл ресурсов** .

    > [!NOTE]
    > Не забудьте добавить файл ресурсов в элемент проекта SharePoint, чтобы свойство тип развертывания было доступно. Это свойство требуется далее в этой процедуре.

2. Укажите для файла ресурсов языка по умолчанию имя, к которому добавляется расширение *RESX* , например *мяппресаурцес. resx*.

3. Повторите шаги 1 и 2, чтобы добавить отдельные файлы ресурсов в элемент проекта SharePoint: по одному для каждого языка локализации.

     Используйте одно и то же базовое имя для каждого локализованного файла ресурсов, но добавьте идентификатор языка и региональных параметров. Например, назовите немецкий локализованный ресурс *MyAppResources.de-de. resx*.

4. Откройте каждый файл ресурсов и добавьте локализованные строки. Используйте в каждом файле одинаковые идентификаторы строки.

5. Измените значение свойства **тип развертывания** каждого файла ресурсов на **AppGlobalResource** , чтобы каждый файл был развернут в папке App_GlobalResources сервера.

6. Оставьте значение свойства **действие сборки** для каждого файла как **внедренный ресурс**.

     Внедренные ресурсы компилируются в DLL проекта.

7. Создайте проект, чтобы создать вспомогательные DLL ресурсов.

8. В **конструкторе пакетов**перейдите на вкладку **Дополнительно** и добавьте вспомогательную сборку.

9. В поле **Расположение** добавьте к пути к расположению папку с идентификатором культуры, например *de-de \\ \<Project Item Name>.resources.dll*.

10. Если решение еще не ссылается на сборку System. Web, добавьте ссылку на нее и добавьте директиву в код в <xref:System.Web> .

11. Найдите все жестко заданные строки в коде, отображаемые пользователям, например, текст пользовательского интерфейса, ошибок и текст сообщений. Замените их вызовом метода <xref:System.Web.HttpContext.GetGlobalResourceObject%2A>, используя следующий синтаксис:

    ```csharp
    HttpContext.GetGlobalResourceObject("Resource File Name", "String ID")
    ```

12. Нажмите клавишу **F5** , чтобы создать и запустить приложение.

13. В SharePoint измените язык интерфейса по умолчанию.

     Локализованные строки появятся в приложении. Для вывода локализованных ресурсов на сервере SharePoint должен быть установлен языковой пакет, соответствующий языку и региональным параметрам файла ресурсов.

## <a name="see-also"></a>См. также раздел
- [Локализация решений SharePoint](../sharepoint/localizing-sharepoint-solutions.md)
- [Практические руководства. Локализация компонента](../sharepoint/how-to-localize-a-feature.md)
- [Как локализовать разметку ASPX](../sharepoint/how-to-localize-aspx-markup.md)
- [Как добавить файл ресурсов](../sharepoint/how-to-add-a-resource-file.md)
