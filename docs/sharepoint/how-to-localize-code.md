---
title: Практическое руководство. Локализация кода | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- localizing code [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, localizing
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 8b848bdb4d0b71f5762601204195f0e81a1c2733
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63443093"
---
# <a name="how-to-localize-code"></a>Практическое руководство. Локализация кода
  Не локализованный код использует жестко заданные строковые значения. Локализовать строки кода, замените их вызовы <xref:System.Web.HttpContext.GetGlobalResourceObject%2A>, который является методом, который ссылается на локализованные ресурсы.

## <a name="localize-code"></a>Локализация кода

#### <a name="to-localize-code"></a>Для локализации кода

1. В **обозревателе решений**, откройте контекстное меню для элемента проекта и выберите **добавить** > **модуль**.

     Выберите **файл ресурсов** шаблона.

    > [!NOTE]
    > Не забудьте добавлять файл ресурсов на элемент проекта SharePoint, чтобы обеспечить доступность свойства типа развертывания. Это свойство необходимо далее в этой процедуре.

2. Имя файла ресурсов языка по умолчанию по своему усмотрению, дополненный *.resx* расширения, такие как *MyAppResources.resx*.

3. Повторите шаги 1 и 2, чтобы добавить отдельные файлы ресурсов в элемент проекта SharePoint: по одному для каждого языка локализации.

     Использовать же базовое имя для каждого локализованного файла ресурсов, но добавьте идентификатор языка и региональных параметров. Например, имя немецкий локализованных ресурсов *MyAppResources.de-DE.resx*.

4. Откройте каждый файл ресурсов и добавьте локализованные строки. Используйте в каждом файле одинаковые идентификаторы строки.

5. Измените значение свойства **тип развертывания** свойства каждого файла ресурсов для **AppGlobalResource** чтобы каждый файл для развертывания в папке сервера App_GlobalResources.

6. Оставьте значение **действие при построении** свойство как **внедренный ресурс**.

     Внедренные ресурсы компилируются в DLL проекта.

7. Построение проекта, чтобы создать группу ресурсов, вспомогательные библиотеки DLL.

8. В **конструктора пакетов**, выберите **Дополнительно** вкладку, а затем добавьте вспомогательную сборку.

9. В **расположение** окне спереди папку идентификатор языка и региональных параметров для пути доступа, такие как *de-DE\\\<имя элемента проекта >. resources.dll*.

10. Если решение не ссылается на сборку System.Web, добавьте ссылку на него и добавьте директиву в код, чтобы <xref:System.Web>.

11. Найдите все жестко заданные строки в коде, отображаемые пользователям, например, текст пользовательского интерфейса, ошибок и текст сообщений. Замените их вызовом метода <xref:System.Web.HttpContext.GetGlobalResourceObject%2A>, используя следующий синтаксис:

    ```csharp
    HttpContext.GetGlobalResourceObject("Resource File Name", "String ID")
    ```

12. Выберите **F5** ключ для сборки и запуска приложения.

13. В SharePoint необходимо измените язык по умолчанию.

     Локализованные строки будут отображаться в приложении. Чтобы отобразить локализованные ресурсы, на сервер SharePoint должен иметь установлен языковой пакет, соответствующий файл ресурсов языка и региональных параметров.

## <a name="see-also"></a>См. также
- [Локализация решений SharePoint](../sharepoint/localizing-sharepoint-solutions.md)
- [Практическое руководство. Локализация компонента](../sharepoint/how-to-localize-a-feature.md)
- [Практическое руководство. Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md)
- [Практическое руководство. Добавьте файл ресурсов](../sharepoint/how-to-add-a-resource-file.md)
