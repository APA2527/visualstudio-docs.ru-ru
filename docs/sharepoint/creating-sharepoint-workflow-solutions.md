---
title: Создание решений для рабочих процессов SharePoint | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- VSTO.NewSharePointWorkflowWizard.Page3
- VS.SharePointTools.Workflow.WorkflowName
- VSTO.NewSharePointWorkflowWizard.Page2
- VSTO.NewSharePointWorkflowWizard.Page1
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, workflows
- workflows [SharePoint development in Visual Studio]
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: f4139760995d655dbeb4e1c76d164f21949a9b50
ms.sourcegitcommit: dcbb876a5dd598f2538e62e1eabd4dc98595b53a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/28/2019
ms.locfileid: "72984551"
---
# <a name="create-sharepoint-workflow-solutions"></a>Создание решений для рабочих процессов SharePoint

[!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] предоставляет средства, помогающие создавать настраиваемые рабочие процессы, которые управляют жизненным циклом документов и элементов списка на веб-сайте SharePoint. Предоставляется конструктор, набор элементов управления действием и ссылки на необходимые сборки. [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] также включает **Мастер настройки SharePoint**, помогающий создавать и настраивать рабочие процессы.

Дополнительные сведения о SharePoint см. в [статье продукты и технологии Microsoft SharePoint](/sharepoint/dev/).

## <a name="workflows-in-sharepoint"></a>Рабочие процессы в SharePoint
 При добавлении рабочего процесса в библиотеку или список SharePoint необходимо применить бизнес-процесс ко всем элементам в библиотеке или списке. Рабочий процесс описывает действия, которые система или пользователи должны выполнить на каждом элементе, например отправку редактируемого элемента и его последующее рецензирование. Эти действия, называемые *действиями*, являются стандартными блоками рабочего процесса.

 Вы можете создавать рабочие процессы SharePoint в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] и развертывать их на веб-сайте SharePoint. После развертывания рабочего процесса в SharePoint он связывается с библиотекой или списком. Затем он может быть запущен автоматически, процессом или вручную пользователем. Дополнительные сведения об операциях рабочего процесса см. [в статье Разработка рабочих процессов SharePoint с помощью Visual Studio](/sharepoint/dev/general-development/develop-sharepoint-workflows-using-visual-studio).

## <a name="create-custom-sharepoint-workflows"></a>Создание настраиваемых рабочих процессов SharePoint
 В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]доступны два проекта рабочих процессов SharePoint: **последовательный** рабочий процесс и **Рабочий процесс конечного автомата**.

 *Последовательный рабочий процесс* представляет ряд шагов. Шаги выполняются один за другим до завершения последнего действия. Последовательные рабочие процессы всегда являются строго последовательными в их выполнении. Так как они могут принимать внешние события и включать параллельные логические потоки, точный порядок выполнения может отличаться. На следующем рисунке показан пример последовательного рабочего процесса.

 ![Последовательный рабочий процесс](../sharepoint/media/sp-sequential.png "Последовательный рабочий процесс")

 *Рабочий процесс конечного автомата* представляет собой набор состояний, переходов и действий. Действия в рабочем процессе конечного автомата выполняются асинхронно. Это означает, что они не обязательно выполняются один за другим, а вызываются действиями и состояниями. Одно состояние назначается начальным, а затем на основе события выполняется переход в другое состояние. Конечный автомат может иметь конечное состояние, определяющее конец рабочего процесса. На следующей схеме показан пример рабочего процесса конечного автомата.

 ![Рабочий процесс конечного автомата](../sharepoint/media/sp-state.png "Рабочий процесс конечного компьютера")

 Дополнительные сведения о типах рабочих процессов см. в разделе [типы рабочих процессов](/previous-versions/office/developer/sharepoint-2010/ms468447(v=office.14)).

### <a name="use-the-wizard"></a>Использование мастера
 При создании проекта рабочего процесса SharePoint в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]необходимо сначала указать его параметры в **мастере настройки SharePoint**. Мастер использует эти параметры для создания проекта в **Обозреватель решений**. Этот проект содержит файл кода, несколько файлов, используемых для развертывания рабочего процесса, и ссылки на сборки, необходимые для создания настраиваемого рабочего процесса SharePoint.

 После создания рабочего процесса его свойства можно изменить в окно свойств. Хотя большинство свойств рабочего процесса можно изменить непосредственно в окно свойств, для некоторых требуется нажать кнопку с многоточием (![ASP.net Mobile Designer Ellipse](../sharepoint/media/mwellipsis.gif "Эллипс конструктора ASP.NET для мобильных устройств")), чтобы изменить их значения. Эта кнопка перезапускает **Мастер настройки SharePoint**. После внесения изменений в значение свойства нажмите кнопку Готово, чтобы завершить их **работу** .

> [!NOTE]
> Свойство " **тип рабочего процесса** " доступно только для чтения и не может быть изменено. Если необходимо изменить тип рабочего процесса, необходимо создать другой рабочий процесс.

## <a name="design-a-sharepoint-workflow"></a>Разработка рабочего процесса SharePoint
 После определения всех шагов в бизнес-процессе используйте конструктор рабочих процессов [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] для проектирования рабочего процесса SharePoint. Чтобы открыть конструктор, дважды щелкните Workflow1.cs или Workflow1. vb в **Обозреватель решений**или откройте контекстное меню для любого из этих файлов и нажмите кнопку **Открыть**.

### <a name="activities"></a>Действия
 Чтобы создать рабочий процесс, добавьте действия из **области элементов** в *расписание рабочего процесса* в конструкторе. Расписание рабочего процесса содержит последовательность действий в том порядке, в котором они должны выполняться.

 Существует два типа действий:

- *Простые действия* выполняют одну единицу работы, например "задержка на 1 день" или "Запуск веб-службы".

- *Составные действия* содержат другие действия. Например, условное действие может содержать две ветви.

  Оба типа действий доступны на **панели элементов**.

  Действия могут иметь свойства, методы и события. Окно **Свойства** используется для задания свойств действия.

  Можно также создать настраиваемое действие. Дополнительные сведения см. [в разделе Пошаговое руководство. Создание настраиваемого действия рабочего процесса сайта](../sharepoint/walkthrough-create-a-custom-site-workflow-activity.md).

  Действия организованы на следующих вкладках **панели элементов**:

- **Рабочий процесс SharePoint**

- **Windows Workflow v 3.0**

- **Windows Workflow v 3.5**

  SharePoint поддерживает не все основные действия рабочего процесса. Дополнительные сведения см. в разделе [рабочие процессы для Windows SharePoint Services обзор](/previous-versions/office/developer/sharepoint-2010/ms446847(v=office.14)).

#### <a name="sharepoint-workflow-activities"></a>Действия рабочего процесса SharePoint
 Вкладки **рабочего процесса SharePoint** содержат специальные действия для использования в [!INCLUDE[wss_14_long](../sharepoint/includes/wss-14-long-md.md)]. Эти действия упрощают и ускоряют разработку рабочих процессов жизненного цикла документов. Дополнительные сведения о действиях, перечисленных на вкладке **Рабочий процесс SharePoint** , см. в статье [Общие сведения о действиях рабочих процессов для Windows SharePoint Services](/previous-versions/office/developer/sharepoint-2010/ms446847(v=office.14)).

#### <a name="windows-workflow-activities"></a>Действия рабочего процесса Windows
 На вкладках **Рабочий процесс Windows** содержатся действия, предоставляемые [!INCLUDE[TLA#tla_workflow](../sharepoint/includes/tlasharptla-workflow-md.md)]. Эти действия можно использовать для создания расписаний рабочих процессов для любого типа приложений Windows Workflow.

 Дополнительные сведения о действиях, перечисленных на вкладке **рабочие процессы Windows** , см. в разделе [Windows Workflow Foundation действия](/previous-versions/dotnet/netframework-3.5/ms733615(v=vs.90)). Дополнительные сведения о Windows Workflow Foundation см. в разделе [Общие](/previous-versions/dotnet/netframework-3.5/ms734631(v=vs.90))сведения о Windows Workflow Foundation.

### <a name="work-with-activities-in-the-designer"></a>Работа с действиями в конструкторе
 Расписание рабочего процесса может содержать сочетание действий рабочего процесса Windows и действий рабочего процесса SharePoint.

 В конструкторе отображаются визуальные подсказки, помогающие правильно позиционировать и настраивать действия. При перетаскивании или копировании действия из расписания рабочего процесса конструктор показывает зеленые значки плюс (+), которые показывают верные расположения для этого действия в рабочем процессе. Невозможно разместить действие в расположении, где оно будет недопустимым. Например, нельзя разместить действие Send как первое действие в ветви "действие прослушивания". Дополнительные сведения см. в разделе [Центр разработчиков SharePoint Designer](https://developer.microsoft.com/office/docs).

## <a name="collect-information-during-the-workflow"></a>Получение сведений во время рабочего процесса
 Может потребоваться собрать сведения от пользователей в заранее заданное время в рабочем процессе. Данные можно собираются с помощью форм или свойств элементов.

### <a name="forms"></a>Формы
 Формы подобны диалоговым окнам, которые содержат вопросы и предоставляют пользователям способы предоставления ответов.

 Существует четыре типа форм, которые можно использовать в рабочем процессе:

- Ассоциация

- Приглашения

- Изменение

- Задача

  [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] включает шаблоны элементов для форм ассоциаций и инициации. Пример *формы взаимосвязей* — это одна из них, которая позволяет администратору установить рабочий процесс, вводить параметры, связанные с рабочим процессом, например предельную сумму расходов для рабочего процесса расходов. Примером *формы инициации* является то, что позволяет пользователю рабочего процесса расходов вводить сумму, потраченную на рабочий процесс. Дополнительные сведения об этих типах форм см. в разделе [проект SharePoint и шаблоны элементов проектов](../sharepoint/sharepoint-project-and-project-item-templates.md).

### <a name="item-properties"></a>Свойства элемента
 Вы также можете получать данные от пользователей, используя свойства элемента в библиотеке или списке SharePoint. Основной файл кода (Workflow1.cs или Workflow1. vb) объявляет экземпляр класса Microsoft. SharePoint. Workflow. Спворкфловактиватионпропертиес. Воркфловпропертиес с именем `workflowProperties`. Используйте объект `workflowProperties` для доступа к свойствам библиотеки или списка в коде. Пример см. в разделе [Пошаговое руководство. Создание и отладка решения для рабочих процессов SharePoint](../sharepoint/walkthrough-creating-and-debugging-a-sharepoint-workflow-solution.md).

## <a name="debug-a-sharepoint-workflow-template"></a>Отладка шаблона рабочего процесса SharePoint
 Отладку проекта рабочего процесса SharePoint можно выполнить так же, как при отладке других [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] веб-проектов. При запуске отладчика [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] использует параметры, указанные в **мастере настройки SharePoint** , чтобы открыть соответствующий веб-сайт SharePoint и автоматически связать шаблон рабочего процесса с соответствующей библиотекой или числ. [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] также присоединяет отладчик [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] к [!INCLUDE[wss_14_long](../sharepoint/includes/wss-14-long-md.md)] процессу с именем *w3wp. exe*.

 Чтобы протестировать рабочий процесс, необходимо запустить его вручную. Дополнительные сведения см. в подразделе «Отладка рабочих процессов» раздела [Отладка решений SharePoint](../sharepoint/debugging-sharepoint-solutions.md). Дополнительные сведения о [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] отладке веб-приложений см. в разделе [Отладка веб-приложений и скриптов](../debugger/how-to-enable-debugging-for-aspnet-applications.md).

## <a name="deploy-a-sharepoint-workflow-template"></a>Развертывание шаблона рабочего процесса SharePoint
 [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] проекты рабочих процессов SharePoint развертываются так же, как и другие [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] проекты SharePoint. Дополнительные сведения см. в разделе [Упаковка и развертывание решений SharePoint](../sharepoint/packaging-and-deploying-sharepoint-solutions.md).

## <a name="import-globally-reusable-workflows"></a>Импорт глобально повторно используемых рабочих процессов
 В дополнение к созданию рабочих процессов для повторного использования, SharePoint Designer позволяет создавать *глобально повторно используемые рабочие процессы*, которые являются рабочими процессами, которые могут использоваться любым сайтом SharePoint. Проект Импорт рабочего процесса с возможностью повторного использования в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] в настоящее время не импортирует глобальные рабочие процессы для повторного использования. Однако можно использовать SharePoint Designer для преобразования глобального рабочего процесса для повторного использования в рабочий процесс, пригодный для повторного использования, или импортировать рабочий процесс как непреобразованный декларативный рабочий процесс. Дополнительные сведения см. в разделе [Импорт элементов из существующего сайта SharePoint](../sharepoint/importing-items-from-an-existing-sharepoint-site.md).

## <a name="related-topics"></a>См. также

|Заголовок|Описание|
|-----------|-----------------|
|[Пошаговое руководство. Создание и отладка решения для рабочих процессов SharePoint](../sharepoint/walkthrough-creating-and-debugging-a-sharepoint-workflow-solution.md)|Приводится пошаговое создание и отладка простого [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] рабочего процесса.|
|[Пошаговое руководство. Создание рабочего процесса с формами ассоциаций и инициации](../sharepoint/walkthrough-creating-a-workflow-with-association-and-initiation-forms.md)|В этой статье приводится пошаговое описание создания полнофункционального [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] рабочего процесса с формами ассоциаций и инициации.|
|[Пошаговое руководство. Добавление страницы приложения в рабочий процесс](../sharepoint/walkthrough-add-an-application-page-to-a-workflow.md)|Сборка в разделе [Пошаговое руководство. Создание рабочего процесса с формами связывания и инициации](../sharepoint/walkthrough-creating-a-workflow-with-association-and-initiation-forms.md) путем добавления дополнительной страницы приложения *. aspx* , которая сообщает о данных, вводимых в рабочий процесс.|
|[Пошаговое руководство. Создание настраиваемого действия рабочего процесса сайта](../sharepoint/walkthrough-create-a-custom-site-workflow-activity.md)|Демонстрирует выполнение двух ключевых задач: создание рабочего процесса на уровне сайта и создание настраиваемого действия рабочего процесса.|
|[Пошаговое руководство. Импорт рабочего процесса с возможностью повторного использования SharePoint Designer в Visual Studio](../sharepoint/walkthrough-import-a-sharepoint-designer-reusable-workflow-into-visual-studio.md)|Демонстрирует импорт повторно используемых декларативных рабочих процессов, созданных в SharePoint Designer 2010, в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] проект SharePoint.|

## <a name="see-also"></a>См. также

- [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)
- [Сборка и отладка решений SharePoint](../sharepoint/building-and-debugging-sharepoint-solutions.md)
- [Создание страниц приложения для SharePoint](../sharepoint/creating-application-pages-for-sharepoint.md)