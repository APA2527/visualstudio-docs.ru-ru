---
title: Пошаговое руководство. Создание веб-части для SharePoint | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- Web Parts [SharePoint development in Visual Studio], developing
- Web Parts [SharePoint development in Visual Studio], creating
- Web Parts [SharePoint development in Visual Studio], designing
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 622dfafbe16efee1e953fbc42bfa3b94cfa3cc58
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62965275"
---
# <a name="walkthrough-create-a-web-part-for-sharepoint"></a>Пошаговое руководство. Создание веб-части для SharePoint

Веб-части позволяют пользователям непосредственно изменять содержимое, внешний вид и поведение страниц сайта SharePoint с помощью браузера. В этом пошаговом руководстве показано, как создать веб-части с помощью **веб-часть** шаблона элемента в Visual Studio 2010.

Веб-часть отображает сотрудников в сетке данных. Пользователь указывает расположение файла, содержащего данные о сотрудниках. Пользователь также может фильтровать сетку данных так, чтобы отображались в списке только сотрудники, которые являются руководителями.

В данном пошаговом руководстве рассмотрены следующие задачи:

- Создание веб-части с помощью Visual Studio **веб-часть** шаблона элемента.

- Создание свойства, которое может быть задана пользователем веб-части. Это свойство указывает расположение файла данных сотрудников.

- Отображение содержимого в веб-части путем добавления элементов управления веб-части в коллекцию элементов управления.

- Создание нового пункта меню, называется *глагол,* , отображаемый в меню команд, готовый для просмотра веб-части. Команды позволяют пользователю изменять данные, отображаемые в веб-части.

- Тестирование веб-части в SharePoint.

    > [!NOTE]
    > Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. Дополнительные сведения см. в разделе [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).

## <a name="prerequisites"></a>Предварительные требования

- Поддерживаемые редакции Microsoft Windows и SharePoint.

- Visual Studio 2017 или службам DevOps в Azure.

## <a name="create-an-empty-sharepoint-project"></a>Создайте пустой проект SharePoint

Во-первых создайте пустой проект SharePoint. Позже вы добавите веб-части в проект с помощью **веб-часть** шаблона элемента.

1. Запуск [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] с помощью **Запуск от имени администратора** параметр.

2. В строке меню выберите **файл** > **New** > **проекта**.

3. В **новый проект** диалогового окна разверните узел **SharePoint** язык, который вы хотите использовать, а затем выберите в узле **2010** узла.

4. В **шаблоны** панели выберите **проект SharePoint 2010**, а затем выберите **ОК** кнопку.

     **Мастер настройки SharePoint** отображается. Этот мастер позволяет выбрать сайт, который будет использоваться для отладки проекта и уровень доверия решения.

5. Выберите **развернуть как решение фермы** переключатель, а затем выберите **Готово** кнопку, чтобы принять локальный сайт SharePoint по умолчанию.

## <a name="add-a-web-part-to-the-project"></a>Добавьте в проект веб-части

Добавить **веб-часть** элемента в проект. **Веб-часть** элемента добавляется файл кода веб-части. Позже вы добавите код в файл кода веб-части для отображения содержимого веб-части.

1. В строке меню выберите **Проект** > **Добавить новый элемент**.

2. В **Добавление нового элемента** отображаемое в диалоговом окне **установленные шаблоны** панели разверните **SharePoint** узел и нажмите кнопку **2010** узла.

3. В списке шаблонов SharePoint выберите **веб-часть** шаблона, а затем выберите **добавить** кнопки.

     **Веб-часть** элемент появляется в **обозревателе решений**.

## <a name="rendering-content-in-the-web-part"></a>Отображение содержимого в веб-части

Вы можете указать, какие элементы управления, будет отображаться в веб-часть, добавив их в коллекцию controls класса веб-части.

1. В **обозревателе решений**откройте *WebPart1.vb* (в Visual Basic) или *WebPart1.cs* (в C#).

     В редакторе кода откроется файл кода веб-части.

2. Добавьте следующие инструкции в начало файла кода веб-части.

     [!code-csharp[SP_WebPart#1](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#1)]
     [!code-vb[SP_WebPart#1](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#1)]

3. Добавьте следующий код в класс `WebPart1` . Этот код объявляет следующие поля:

   - Сетка данных для отображения сотрудников в веб-части.

   - Текст, отображаемый в элементе управления, который используется для фильтрации сетки данных.

   - Метка, которая отображает сообщение об ошибке, если сетка данных не удалось отобразить данные.

   - Строка, содержащая путь к файлу данных сотрудников.

     [!code-csharp[SP_WebPart#2](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#2)]
     [!code-vb[SP_WebPart#2](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#2)]

4. Добавьте следующий код в класс `WebPart1` . Этот код добавляет пользовательское свойство с именем `DataFilePath` веб-части. Пользовательское свойство является свойством, которое можно задать в SharePoint для пользователя. Это свойство возвращает и задает расположение файла данных XML, который используется для заполнения сетки данных.

     [!code-csharp[SP_WebPart#3](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#3)]
     [!code-vb[SP_WebPart#3](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#3)]

5. Замените метод `CreateChildControls` следующим кодом. Этот код выполняет следующие задачи:

   - Добавляет сетки данных и метки, объявленного на предыдущем шаге.

   - Привязывает сетку данных в XML-файл, содержащий данные о сотрудниках.

     [!code-csharp[SP_WebPart#4](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#4)]
     [!code-vb[SP_WebPart#4](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#4)]

6. Добавьте следующий метод в класс `WebPart1` . Этот код выполняет следующие задачи:

   - Создает команду, которая отображается в меню команд веб-части, готовый для просмотра веб-части.

   - Обрабатывает событие, возникающее при выборе пользователем команды в меню команд. Этот код фильтрует список сотрудников, который отображается в сетке данных.

     [!code-csharp[SP_WebPart#5](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#5)]
     [!code-vb[SP_WebPart#5](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#5)]

## <a name="test-the-web-part"></a>Тестирование веб-части

При запуске проекта открывается сайт SharePoint. Веб-часть автоматически добавляется к коллекции веб-частей в SharePoint. Можно добавить веб-части на любую страницу веб-части.

1. Вставьте следующий код XML в файл блокнота. Этот XML-файл содержит образцы данных, которое будет отображаться в веб-части.

    ```xml
    <?xml version="1.0" encoding="utf-8" ?>
        <employees xmlns="http://schemas.microsoft.com/vsto/samples">
           <employee>
               <name>David Hamilton</name>
               <hireDate>2001-05-11</hireDate>
               <title>Sales Associate</title>
           </employee>
           <employee>
               <name>Karina Leal</name>
               <hireDate>1999-04-01</hireDate>
               <title>Manager</title>
           </employee>
           <employee>
               <name>Nancy Davolio</name>
               <hireDate>1992-05-01</hireDate>
               <title>Sales Associate</title>
           </employee>
           <employee>
               <name>Steven Buchanan</name>
               <hireDate>1955-03-04</hireDate>
               <title>Manager</title>
           </employee>
           <employee>
               <name>Suyama Michael</name>
               <hireDate>1963-07-02</hireDate>
               <title>Sales Associate</title>
           </employee>
        </employees>
    ```

2. В блокноте, в строке меню выберите **файл** > **Сохранить как**.

3. В **Сохранить как** отображаемое в диалоговом окне **тип** выберите **все файлы**.

4. В **имя файла** введите **data.xml**.

5. Выберите любую папку с помощью **Обзор папок** кнопку, а затем выберите **Сохранить** кнопки.

6. В Visual Studio, выберите **F5** ключ.

     Откроется сайт SharePoint.

7. На **действия сайта** меню, выберите **Дополнительно**.

8. В **создать** выберите **страницу веб-части** введите, а затем выберите **создать** кнопки.

9. В **новые страницы веб-частей** странице, назовите страницу **SampleWebPartPage.aspx**и нажмите кнопку **создать** кнопки.

     Откроется страница веб-части.

10. Выберите любую зону на странице веб-части.

11. В верхней части страницы, выберите **вставить** вкладке, а затем выберите **веб-часть** кнопки.

12. В **категории** панели выберите **Custom** папку, выберите **WebPart1** веб-части и нажмите кнопку **добавить** кнопки.

     Веб-части отображается на странице.

## <a name="test-the-custom-property"></a>Тестирование пользовательского свойства

Чтобы заполнить сетки данных, которая отображается в веб-части, укажите путь к XML-файле, который содержит данные обо всех сотрудниках.

1. Выберите стрелку, отображающуюся в правой части веб-части, а затем выберите **изменить веб-часть** в появившемся меню.

     Область, содержащая свойства веб-части отображается в правой части страницы.

2. В области, разверните **Разное** узла, введите путь к XML-файле, который был создан ранее, выберите **применить** кнопку, а затем выберите **ОК** кнопки.

     Убедитесь, что список сотрудников отображается в веб-части.

## <a name="test-the-web-part-verb"></a>Тестирование команды веб-части

Отобразить или скрыть сотрудников, которые не являются менеджерами, щелкнув элемент, который отображается в меню команд веб-части.

1. Выберите стрелку, отображающуюся в правой части веб-части, а затем выберите **Показывать только менеджеров** в появившемся меню.

     В веб-части отображаются только сотрудники, которые являются руководителями.

2. Снова нажмите кнопку со стрелкой, а затем выберите **Показывать всех сотрудников** в появившемся меню.

     Все сотрудники отображаются в веб-части.

## <a name="see-also"></a>См. также

[Создание веб-частей для SharePoint](../sharepoint/creating-web-parts-for-sharepoint.md)
[как: Создание веб-части SharePoint](../sharepoint/how-to-create-a-sharepoint-web-part.md)
[как: Создание веб-части SharePoint с помощью конструктора](../sharepoint/how-to-create-a-sharepoint-web-part-by-using-a-designer.md)
[Пошаговое руководство: Создание веб-части для SharePoint с помощью конструктора](../sharepoint/walkthrough-creating-a-web-part-for-sharepoint-by-using-a-designer.md)
