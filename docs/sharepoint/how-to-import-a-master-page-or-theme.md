---
title: Как импортировать главную страницу или тему | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, importing items
- importing items [SharePoint development in Visual Studio]
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 7abca9e9141fdc8d4540e8a38e9579862fc540f1
ms.sourcegitcommit: f9e44f5ab6a1dfb56c945c9986730465e1adb6fc
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2020
ms.locfileid: "86015298"
---
# <a name="how-to-import-a-master-page-or-theme"></a>Как импортировать главную страницу или тему
  Создание и использование эталонных страниц дает возможность обеспечения согласованного внешнего вида страниц сайта SharePoint. [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]не предоставляет шаблоны для этих элементов, но их можно создать в SharePoint Designer, а затем импортировать в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] . Дополнительные сведения см. в разделе [стандартный блок: страницы и пользовательский интерфейс](/previous-versions/office/developer/sharepoint-2010/ee539040(v=office.14)) на веб-сайте Майкрософт.

### <a name="to-import-a-master-page-or-theme"></a>Импорт главной страницы или темы

1. Создайте или откройте проект SharePoint в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].

     Сведения о создании проекта SharePoint см. в разделе [проект SharePoint и шаблоны элементов проектов](../sharepoint/sharepoint-project-and-project-item-templates.md).

2. В строке меню выберите **проект**  >  **Добавить новый элемент**.

3. В диалоговом окне **Добавление нового элемента** разверните узел **SharePoint** и выберите узел **2010** .

4. В списке шаблонов SharePoint выберите шаблон **модуля** , а затем укажите имя модуля.

     Модуль содержит файлы (такие как эталонная страница или файлы тем) для развертывания в указанное в SharePoint расположение.

5. В модуле удалите файл по умолчанию с именем *Sample.txt*.

6. Выберите узел модуля.

7. В строке меню выберите **проект**  >  **Добавить существующий элемент**, а затем выберите главную страницу или файл темы.

     Файлы эталонной страницы имеют расширение .master, а файлы темы — расширение .thmx.

8. Если вы добавили главную страницу, измените параметр **разрешения конфликтов развертывания** на **Автоматический** в свойствах модуля.

    > [!NOTE]
    > Ошибки могут возникать, если имя главной страницы совпадает с именем существующей главной страницы, помеченной как эталонная страница по умолчанию или настраиваемая эталонная страница. Сведения о том, как устранить эту проблему, см. в разделе [Пошаговое руководство. Импорт настраиваемой главной страницы и страницы сайта с изображением](../sharepoint/walkthrough-import-a-custom-master-page-and-site-page-with-an-image.md).

9. В модуле откройте *Elements.xml*.

     Необходимо обновить файл *Elements.xml* , чтобы указать ссылку на добавленную главную страницу или тему.

10. Для главной страницы замените существующую разметку модуля следующей разметкой.

    ```xml
    <Module Name="[Module Name]" Url="_catalogs/masterpage">
        <File Path="[Module Name]\[Master Page Name].master"
          Url="[Master Page Name].master" Type="GhostableInLibrary" />
    </Module>
    ```

     Для темы замените существующую разметку модуля следующей разметкой.

    ```xml
    <Module Name="[Module Name]" Url="_catalogs/theme"
        <File Path="[Module Name]\[Theme Name].thmx" Url="[Theme
          Name].thmx" Type="GhostableInLibrary" />
    </Module>
    ```

     Обязательно замените значения заполнителей фактическими именами модуля и главной страницей или темой.

     Атрибут `Type="GhostableInLibrary"` указывает, что элемент добавляется в базу данных содержимого, а `Url` атрибут модуля определяет место хранения файла в базе данных содержимого SharePoint.

11. Чтобы изменить область развертывания для главной страницы, в **Обозреватель решений**откройте файл компонента в конструкторе компонентов, а затем выберите новую область развертывания из списка **область** .

     Значение **Web** означает, что Главная страница относится только к веб-сайту, который в данный момент указан в проекте. Значение **site** означает, что Главная страница применяется к текущему семейству веб-сайтов, включая все дочерние сайты и корневой веб-сайт. Другие значения не применяются.

    > [!NOTE]
    > Так как темы применяются только к уровню семейства веб-узлов, рекомендуется не задавать область темы на что-либо, кроме **site**. Если тема используется на дочернем сайте, могут возникать ошибки.

12. В строке меню выберите **Сборка**  >  **Развернуть решение**.

13. Чтобы проверить, правильно ли развернуты файлы, откройте сайт SharePoint, выберите меню " **действия сайта** ", выберите команду " **Параметры сайта** ", а затем щелкните ссылку " **главные страницы** " или ссылку " **темы** ".

     В открывшемся списке эталонных страниц или тем содержится импортированная вами эталонная страница или тема.

## <a name="see-also"></a>См. также раздел
- [Эталонные страницы](/previous-versions/office/developer/sharepoint-2010/ms443795(v=office.14))
- [Импорт элементов с существующего сайта SharePoint](../sharepoint/importing-items-from-an-existing-sharepoint-site.md)
- [Создание страниц для SharePoint](../sharepoint/creating-pages-for-sharepoint.md)
- [Использование модулей для включения файлов в решение](../sharepoint/using-modules-to-include-files-in-the-solution.md)
