---
title: Создание многократно используемых элементов управления для веб-части или страниц приложений | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: overview
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- user controls [SharePoint development in Visual Studio], creating
- SharePoint development in Visual Studio, user controls
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: b174e1e16802838f19cec6dce727ea3199df730f
ms.sourcegitcommit: f9e44f5ab6a1dfb56c945c9986730465e1adb6fc
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2020
ms.locfileid: "86015136"
---
# <a name="create-reusable-controls-for-web-parts-or-application-pages"></a>Создание многократно используемых элементов управления для веб-частей или страниц приложений
  Visual Studio позволяет создавать пользовательские элементы управления с возможностью повторного использования, которые можно размещать на страницах приложений и в веб-частях, используемых в SharePoint. Эти элементы управления называются пользовательскими. Пользовательский элемент управления — это разновидность составного элемента управления, который работает во многом подобно веб-странице ASP.NET — можно добавлять существующие элементы управления веб-сервера и разметку в пользовательский элемент управления, а также определять свойства и методы для этого элемента управления. Затем их можно внедрить на веб-страницы ASP.NET, где они работают как единое целое.

## <a name="create-a-user-control"></a>Создание пользовательского элемента управления
 Чтобы создать пользовательский элемент управления, добавьте **Пользовательский элемент управления** в **пустой проект SharePoint**. Дополнительные сведения см. в разделе [инструкции. Создание пользовательского элемента управления для страницы приложения SharePoint или веб-части](../sharepoint/how-to-create-a-user-control-for-a-sharepoint-application-page-or-web-part.md).

 При добавлении элемента **пользовательского элемента управления** Visual Studio создает в проекте папку, а затем добавляет в нее несколько файлов. В следующей таблице описывается каждый файл.

|Файл|Описание|
|----------|-----------------|
|Файл пользовательского элемента управления|Определяет пользовательский элемент управления. Разработайте пользовательский элемент управления, добавив элементы управления и разметку в этот файл.|
|Файл кода|Содержит код, лежащий в основе пользовательского элемента управления. Добавьте код для управления событиями в этот файл.|
|Файл кода конструктора|Содержит код, созданный конструктором, который не должен редактироваться напрямую.|

## <a name="design-the-user-control"></a>Разработка пользовательского элемента управления
 Разработайте пользовательский элемент управления с помощью конструктора Visual Web Developer в Visual Studio. Этот конструктор отображается при открытии файла пользовательского элемента управления в проекте и выборе вкладки **конструктор** .

## <a name="consume-the-user-control"></a>Использование пользовательского элемента управления
 Пользовательские элементы управления не отображаются в SharePoint, пока они не будут включены в страницу приложения или веб-часть.

 Чтобы включить пользовательский элемент управления на странице приложения, откройте веб-страницу, в которую нужно добавить пользовательский элемент управления ASP.NET. Перейдите в представление конструирования, выберите файл пользовательского элемента управления в обозреватель решений и перетащите его на страницу. Пользовательский элемент управления ASP.NET добавляется на страницу, и конструктор создает директиву @ Register, которая необходима для того, чтобы страница могла распознать пользовательский элемент управления. Теперь можно работать с открытыми свойствами и методами элемента управления.

 Чтобы включить пользовательский элемент управления в веб-часть, добавьте пользовательский элемент управления в коллекцию веб-частей <xref:System.Web.UI.WebControls.WebParts.Part.Controls%2A> в файле кода веб-части. В следующем примере пользовательский элемент управления добавляется в <xref:System.Web.UI.WebControls.WebParts.Part.Controls%2A> коллекцию веб-части.

 [!code-vb[SP_VisualWebPart#5](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1.vb#5)]
 [!code-csharp[SP_VisualWebPart#5](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1.cs#5)]

## <a name="debug-a-user-control"></a>Отладка пользовательского элемента управления
 Чтобы выполнить отладку пользовательского элемента управления, убедитесь, что пользовательский элемент управления включен в страницу приложения или веб-часть в проекте SharePoint. Затем можно отлаживать код в пользовательском элементе управления так же, как и при отладке кода в любом проекте Visual Studio.

 При запуске отладчика Visual Studio Visual Studio открывает сайт SharePoint.

 В SharePoint откройте страницу приложения, которая содержит пользовательский элемент управления. Если пользовательский элемент управления включен в веб-часть, добавьте веб-часть на страницу веб-частей в SharePoint.

 Дополнительные сведения об отладке проектов SharePoint см. в разделе [Устранение неполадок решений SharePoint](../sharepoint/troubleshooting-sharepoint-solutions.md).

## <a name="related-topics"></a>См. также

|Заголовок|Описание|
|-----------|-----------------|
|[Как создать пользовательский элемент управления для страницы приложения SharePoint или веб-части](../sharepoint/how-to-create-a-user-control-for-a-sharepoint-application-page-or-web-part.md)|Показывает, как создавать настраиваемые, многократно используемые элементы управления, которые могут использоваться страницами приложений и веб-части, которые выполняются в SharePoint.|
