---
title: Отладка расширений для инструментов SharePoint в Visual Studio | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, debugging extensions
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: e170a5ed703a9bf5aae2e73126de52ecf88e8084
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63443523"
---
# <a name="debug-extensions-for-the-sharepoint-tools-in-visual-studio"></a>Отладка расширений для инструментов SharePoint в Visual Studio
  Можно выполнять отладку расширения инструментов SharePoint в экспериментальном экземпляре или обычном экземпляре Visual Studio. Если вам необходимо устранить поведение расширения, можно также изменить значения реестра для отображения дополнительных сведений об ошибке и настроить, каким образом Visual Studio выполняет команды SharePoint.

## <a name="debug-extensions-in-the-experimental-instance-of-visual-studio"></a>Отладка расширений в экспериментальном экземпляре Visual Studio
 Для защиты среды разработки Visual Studio от случайного повреждения недоверенными расширениями, пакет SDK для Visual Studio предоставляет альтернативный экземпляр Visual Studio, называемый *экспериментальный экземпляр*, который можно использовать Установка и тестирование расширения. Новые расширения разрабатываются с помощью обычного экземпляра Visual Studio, но отлаживать и запускать их в экспериментальном экземпляре. Дополнительные сведения см. в разделе [экспериментальный экземпляр](../extensibility/the-experimental-instance.md).

 Если использование проекта VSIX для развертывания расширения, и проект VSIX запускаемым проектом в решении, Visual Studio автоматически устанавливает и запускает расширения в экспериментальном экземпляре, при отладке решения. Автозагружаемый проект — проект, который запускается при отладке решения, содержащего несколько проектов. Дополнительные сведения об использовании проекта VSIX для развертывания расширения см. в разделе [развертывания расширений для инструментов SharePoint в Visual Studio](../sharepoint/deploying-extensions-for-the-sharepoint-tools-in-visual-studio.md).

 Примеры, демонстрирующие способы отладки различных типов расширений в экспериментальном экземпляре Visual Studio см. в разделе ниже пошаговых руководства:

- [Пошаговое руководство: Расширение типа элемента проекта SharePoint](../sharepoint/walkthrough-extending-a-sharepoint-project-item-type.md)

- [Пошаговое руководство: Создание элемента проекта настраиваемого действия с помощью шаблона элемента, часть 1](../sharepoint/walkthrough-creating-a-custom-action-project-item-with-an-item-template-part-1.md)

- [Пошаговое руководство: Создание пользовательского шага развертывания для проектов SharePoint](../sharepoint/walkthrough-creating-a-custom-deployment-step-for-sharepoint-projects.md)

- [Пошаговое руководство: Расширения обозревателя сервера для отображения веб-частей](../sharepoint/walkthrough-extending-server-explorer-to-display-web-parts.md)

- [Пошаговое руководство: Вызов клиентской объектной модели SharePoint в расширении обозревателя серверов](../sharepoint/walkthrough-calling-into-the-sharepoint-client-object-model-in-a-server-explorer-extension.md)

## <a name="debug-extensions-in-the-regular-instance-of-visual-studio"></a>Отладка расширений в обычном экземпляре Visual Studio
 Если вы хотите выполнить отладку проекта расширения в обычном экземпляре Visual Studio, сначала установите расширение в обычном экземпляре. Затем присоедините отладчик к второй процесс Visual Studio. После завершения работы, расширение можно удалить, чтобы он больше не загружает на компьютере разработчика.

#### <a name="to-install-the-extension"></a>Установка расширения

1. Закройте все экземпляры Visual Studio.

2. Откройте в выходную папку построения для проекта расширения, *.vsix* файл, дважды щелкнув его или выбрав в контекстном меню и выбрав **откройте**:

3. В **установщик расширений Visual Studio** диалоговое окно, выберите выпуск Visual Studio, к которому вы хотите установить расширение, а затем выберите **установить** кнопки.

     Visual Studio устанавливает файлы расширения %UserProfile%\AppData\Local\Microsoft\VisualStudio\11.0\Extensions\\*имя автора*\\*имя расширения* \\ *версии*. Последние три папки в этом пути формируются на основе `Author`, `Name`, и `Version` элементов в *extension.vsixmanifest* файла для расширения.

4. После установки расширения Visual Studio выберите **закрыть** кнопки.

#### <a name="to-debug-the-extension"></a>Отладка расширения

1. Откройте Visual Studio с правами администратора и откройте проект расширения. Следующие действия ссылаются на этот экземпляр Visual Studio как *сначала экземпляров*.

2. Запустите другой экземпляр Visual Studio с правами администратора. Следующие действия ссылаются на этот экземпляр Visual Studio как *второй экземпляр*.

3. Перейдите к первому экземпляру Visual Studio.

4. В строке меню выберите **Отладка**, **присоединение к процессу**.

5. В **доступные процессы** выберите *devenv.exe*. Эта запись ссылается на второй экземпляр Visual Studio; Это необходимо выполнить отладку проекта расширения в экземпляре.

6. Выберите **Attach** кнопки.

     Visual Studio запускает проект расширения в режиме отладки.

7. Перейдите ко второму экземпляру Visual Studio.

8. Создайте новый проект SharePoint, который загружает расширение. Например, при отладке расширения для элементов проекта определения списка, создать **определение списка** проекта.

9. Выполните действия, необходимые для тестирования кода расширения.

10. Когда вы закончите отладку расширения, закройте второй экземпляр Visual Studio.

#### <a name="to-remove-the-extension"></a>Чтобы удалить расширение

1. В Visual Studio в строке меню выберите **средства**, **расширения и обновления**.

     Появится диалоговое окно **Расширения и обновления**.

2. В списке расширений выберите имя расширения и нажмите **удаления** кнопки.

3. В появившемся диалоговом окне, выберите **Да** кнопку, чтобы убедиться, что вы хотите удалить расширение.

4. Выберите **Перезагрузить сейчас** кнопку, чтобы завершить удаление.

## <a name="debug-sharepoint-commands"></a>Отладка команды SharePoint
 Если вы хотите выполнить отладку команды SharePoint, который является частью расширения инструментов SharePoint, необходимо подключить отладчик к *vssphost4.exe* процесса. Это 64-разрядных хост-процессе, который выполняет команды SharePoint. Дополнительные сведения о командах SharePoint и *vssphost4.exe*, см. в разделе [вызова объектной модели SharePoint](../sharepoint/calling-into-the-sharepoint-object-models.md).

#### <a name="to-attach-the-debugger-to-the-vssphost4exe-process"></a>Чтобы подключить отладчик к процессу vssphost4.exe

1. Начните отладку расширения в экспериментальном экземпляре Visual Studio или обычном экземпляре Visual Studio, следуя инструкциям выше.

2. В экземпляре Visual Studio, в котором выполняется отладчик, в строке меню, выберите **Отладка**, **присоединение к процессу**.

3. В **доступные процессы** выберите *vssphost.exe*.

    > [!NOTE]
    > Если vssphost.exe не отображается в списке, необходимо запустить *vssphost4.exe* процесса в экземпляре Visual Studio, в котором выполняется расширение. Как правило можно это сделать, выполнив действие, вызывающее Visual Studio для подключения к сайту SharePoint на компьютере разработчика. Например, Visual Studio запускает *vssphost4.exe* развернув узел подключения (узел, отображающий URL-адрес сайта) в разделе **подключения SharePoint** узел в **обозревателя серверов**  окна, или при добавлении определенных элементов проекта SharePoint, такие как **экземпляр списка** или **приемника событий** элементов в проект SharePoint.

4. Выберите **Attach** кнопки.

5. В экземпляре Visual Studio, в котором выполняется отладка выполните действия, необходимые для выполнения команды.

## <a name="modify-registry-values-to-help-debug-sharepoint-tools-extensions"></a>Изменения параметров реестра для отладки расширения инструментов SharePoint
 При отладке расширения средств SharePoint в Visual Studio, можно изменить значения в реестре для устранения расширения. Значения в рамках **HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\11.0\SharePointTools** ключ. Эти значения по умолчанию не существует.

 Для устранения любого расширения инструментов SharePoint, можно создать и задать EnableDiagnostics значение. В следующей таблице описаны это значение.

|Значение|Описание|
|-----------|-----------------|
|EnableDiagnostics|REG_DWORD указывает, отображаются ли диагностические сообщения в **вывода** окна.<br /><br /> Чтобы отобразить диагностические сообщения, это значение равно 1. Чтобы отключить отображение сообщений, это значение равно 0 или удалите это значение.<br /><br /> Для записи сообщений в **вывода** расширения средств SharePoint в окне, используйте службы проектов SharePoint. Дополнительные сведения см. в разделе [использование службы проектов SharePoint](../sharepoint/using-the-sharepoint-project-service.md).|

 Если расширение содержит команды SharePoint, можно создать и задать дополнительные значения, которые помогут вам устранить ошибки команды. В следующей таблице описаны эти значения.

|Значение|Описание|
|-----------|-----------------|
|AttachDebuggerToHostProcess|REG_DWORD указывает, следует ли отображать диалоговое окно, которое позволяет присоединить отладчик к *vssphost4.exe* сразу после ее запуска. Это полезно в том случае, если команда, необходимо выполнить отладку выполняется vssphost.exe сразу после ее запуска, а не было достаточно времени для вручную присоединить отладчик, перед выполнением команды. Чтобы отобразить диалоговое окно, *vssphost4.exe* вызовы <xref:System.Diagnostics.Debugger.Break%2A> метод при запуске.<br /><br /> Чтобы включить это поведение, это значение равно 1. Чтобы отключить это поведение, это значение равно 0 или удалите это значение.<br /><br /> Если это значение равно 1, также может потребоваться увеличить значение HostProcessStartupTimeout самостоятельно достаточно времени, чтобы присоединить отладчик Visual Studio ожидает *vssphost4.exe* информировать, что она запущена успешно.|
|ChannelOperationTimeout|REG_DWORD указывает время в секундах, Visual Studio для выполнения команды SharePoint. Если команда не выполнена вовремя <xref:Microsoft.VisualStudio.SharePoint.SharePointConnectionException> возникает исключение.<br /><br /> Значение по умолчанию — 120 секунд.|
|HostProcessStartupTimeout|REG_DWORD указывает время в секундах, что Visual Studio ожидает *vssphost4.exe* информировать, что она запущена успешно. Если *vssphost4.exe* не сообщает об успешном запуске вовремя <xref:Microsoft.VisualStudio.SharePoint.SharePointConnectionException> возникает исключение.<br /><br /> Значение по умолчанию составляет 60 секунд.|
|MaxReceivedMessageSize|REG_DWORD указывает максимально допустимый размер, в байтах сообщения WCF, которые передаются между Visual Studio и *vssphost4.exe*.<br /><br /> Значение по умолчанию составляет 1 048 576 байт (1 МБ).|
|MaxStringContentLength|REG_DWORD указывает максимально допустимый размер, в байтах строки, передаваемые между Visual Studio и *vssphost4.exe*.<br /><br /> Значение по умолчанию составляет 1 048 576 байт (1 МБ).|

## <a name="see-also"></a>См. также

- [Расширения инструментов SharePoint в Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md)
- [Развертывание расширений для инструментов SharePoint в Visual Studio](../sharepoint/deploying-extensions-for-the-sharepoint-tools-in-visual-studio.md)
