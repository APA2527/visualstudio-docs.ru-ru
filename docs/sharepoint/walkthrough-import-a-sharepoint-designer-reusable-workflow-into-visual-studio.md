---
title: Пошаговое руководство. Импорт рабочего процесса для повторного использования SharePoint Designer в Visual Studio | Документация Майкрософт
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- VS.SharePointTools.WSPImport.ImportWF
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, importing reusable workflows
- reusable workflows [SharePoint development in Visual Studio]
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: c7d1373339fac4768e2af1eda5770d5058ae8078
ms.sourcegitcommit: 47eeeeadd84c879636e9d48747b615de69384356
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63446605"
---
# <a name="walkthrough-import-a-sharepoint-designer-reusable-workflow-into-visual-studio"></a>Пошаговое руководство. Импорт рабочего процесса для повторного использования SharePoint Designer в Visual Studio
  В этом пошаговом руководстве показано, как импортировать повторно используемый рабочий процесс, созданный в SharePoint Designer 2010 в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] проекта рабочего процесса SharePoint.

 Рабочие процессы, созданные в SharePoint Designer, или *декларативных рабочих процессов*, состоят из [!INCLUDE[TLA2#tla_xml](../sharepoint/includes/tla2sharptla-xml-md.md)] инструкции вместо кода. В SharePoint Designer 2010 появился *многократно используемых рабочих процессов*, которые являются портативных декларативных рабочих процессов, которые могут использоваться в различных списках на сайтах SharePoint.

 Рабочие процессы, созданные в [!INCLUDE[vs_dev11_long](../sharepoint/includes/vs-dev11-long-md.md)], например автомата и последовательные рабочие процессы, называются *кода рабочие процессы*. Рабочие процессы с кодом состоят из XML-файлы и модули кода, в которых пользователи могут настраивать поведение рабочего процесса.

 Visual Studio позволяет импортировать рабочие процессы с возможностью повторного использования, созданные в SharePoint Designer 2010, и преобразовывать их в рабочие процессы с кодом, используемые на сайтах SharePoint.

 В этом пошаговом руководстве описаны следующие задачи.

- Создание простой и повторного использования рабочего процесса в SharePoint Designer.

- Экспорт рабочего процесса для повторного использования SharePoint Designer для *.wsp* файл и в SharePoint.

- Импорт *.wsp* файл в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] с помощью проекта импорт повторно используемого рабочего процесса.

- Изменение рабочего процесса путем добавления кода.

- С помощью импортируемого рабочего процесса на сайте SharePoint.

  [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]

## <a name="prerequisites"></a>Предварительные требования
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.

- Поддерживаемые выпуски [!INCLUDE[TLA#tla_win](../sharepoint/includes/tlasharptla-win-md.md)] и SharePoint.

- Visual Studio.

- Microsoft [!INCLUDE[TLA2#tla_office](../sharepoint/includes/tla2sharptla-office-md.md)] SharePoint Designer 2010.

## <a name="create-target-sharepoint-subsites"></a>Создание дочерних узлов SharePoint, целевой объект
 Сначала вы создаете два дочерних сайта SharePoint: один для размещения многократно используемых рабочих процессов в SharePoint Designer, другой для размещения преобразованных рабочих процессов.

#### <a name="to-create-sharepoint-subsites"></a>Чтобы создавать дочерние узлы SharePoint

1. В SharePoint Designer 2010, в строке меню выберите **файл** > **новый пустой веб-сайт**.

2. В **новый пустой веб-сайт** диалоговом окне перейдите на сайт SharePoint, где вы хотите создать рабочий процесс или использовать значение http://<em>имя_системы</em>/ и затем выберите **ОК** кнопка.

    Откроется домашняя страница.

3. В **дочерние сайты** выберите **New** кнопки.

4. В **New** диалоговое окно, выберите **шаблоны SharePoint** в списке в левой области и выберите **сайт группы** из списка в правой области.

5. В **укажите расположение веб-сайта** замените слово **дочерний сайт** в URL-адрес с **SPD1**и нажмите кнопку **ОК** кнопки.

    При этом откроется новый дочерний узел в SharePoint Designer. Закройте этот экземпляр SharePoint Designer и вернитесь к первому экземпляру (сайт верхнего уровня).

6. Повторите шаги 3 – 5 для создания второго дочернего сайта, на этот раз замените слово **дочерний сайт** в [!INCLUDE[TLA2#tla_url](../sharepoint/includes/tla2sharptla-url-md.md)] с **SPD2**.

## <a name="create-a-sharepoint-designer-reusable-workflow"></a>Создание рабочего процесса для повторного использования SharePoint Designer
 Поскольку SharePoint включает повторно используемые рабочие процессы, которые можно использовать для этого примера, создаст его. В этой простой рабочий процесс когда пользователь вводит новую задачу в списке задач, с определенным названием задача назначается этому пользователю.

#### <a name="to-create-a-sharepoint-designer-reusable-workflow"></a>Создание рабочего процесса для повторного использования SharePoint Designer

1. В **дочерние сайты** выберите **SPD1** сайте, чтобы изменить его.

2. На ленте выберите **повторно используемый рабочий процесс** кнопки.

     Откроется мастер создания рабочего процесса для повторного использования.

3. В **имя** введите **SPD Task Workflow**.

4. В **тип содержимого** выберите **задачи**, а затем выберите **ОК** кнопки.

     Рабочий процесс откроется в конструкторе рабочих процессов SharePoint Designer.

5. В конструкторе рабочих процессов, выберите шаг 1 и нажмите на ленте **условие** кнопки.

6. В списке условий выберите **при текущем элементе поле = значение**.

     На этом шаге добавляется условие, которое называется **Если поле = значение**.

7. В **Если поле = значение** условие, выберите **поле** ссылку.

8. В списке значений, выберите **Title**.

9. В **Если поле = значение** условие, выберите **значение** ссылку.

10. В диалоговом окне введите **новая задача**.

     Теперь оператор условия считывает **следующим образом: если текущее название: элемента = новая задача**.

11. Выберите линию под условным выражением, а затем на ленте выберите **действие** кнопки.

12. В списке действий выберите **набора полей в текущем элементе**.

13. В **набора полю значение** действие, выберите **поле** ссылку и выберите в списке **назначенные**.

14. В **набора полю значение** действие, выберите **значение** ссылку и выберите в списке существующих пользователей и групп, **пользователя, создавшего элемент**.

15. Выберите **добавить** кнопку, а затем выберите **ОК** кнопки.

     Теперь оператор действия выглядит **значение назначено для текущего элемента: CreatedBy**.

## <a name="save-and-deploy-the-reusable-workflow"></a>Сохранение и развертывание рабочего процесса для повторного использования
 Так как [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] можно импортировать только *.wsp* файлы, необходимо сохранить для повторного использования рабочего процесса в качестве *.wsp* файл и развернуть его в SharePoint, прежде чем импортировать их в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].

> [!IMPORTANT]
> Если появляется ошибка среды выполнения в следующей процедуре, необходимо выполнить процедуры в системе, которая имеет доступ к сайту SharePoint.

#### <a name="to-save-and-deploy-the-reusable-workflow"></a>Сохранение и развертывание рабочего процесса для повторного использования

1. В верхней части SharePoint Designer, выберите **Сохранить** кнопку, чтобы сохранить настройки, а затем выберите **публикации** кнопку, чтобы развернуть рабочий процесс для **SPD1** сайта SharePoint .

2. В области навигации выберите **рабочие процессы** объекта.

3. В разделе **повторно используемый рабочий процесс**, выберите **SPD Task Workflow**.

4. На ленте выберите **Сохранить как шаблон** кнопку для сохранения рабочего процесса в качестве *.wsp* файл.

5. Откройте **SPD1** сайта SharePoint в браузере, чтобы просмотреть *.wsp* файла в SharePoint.

6. На панели быстрого запуска выберите **библиотеки** ссылку.

7. В **библиотеки документов** выберите **ресурсов сайтов** ссылку.

     **SPD Task Workflow** файл в списке с другими ресурсами сайта.

8. В списке файлов выберите имя этого файла

9. В **Загрузка файла** диалоговое окно, выберите **Сохранить** кнопку, чтобы сохранить *.wsp* файл в локальной системе.

## <a name="import-the-wsp-file-into-visual-studio"></a>Импорт WSP-файл в Visual Studio
 Импорт *.wsp* файл в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] с помощью проекта импорт повторно используемого рабочего процесса. Этот проект преобразует рабочего процесса из рабочего процесса для повторного использования, декларативный процесс с кодом. После преобразования рабочего процесса, код будет использовать для изменения его поведения.

#### <a name="to-import-a-workflow-from-a-wsp-file-and-modify-it"></a>Импорт рабочего процесса в WSP-файл и изменить его

1. В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], в строке меню выберите **файл** > **New** > **проекта**.

2. В **новый проект** диалогового окна разверните узел **SharePoint** расположенный в области **Visual C#** или **Visual Basic**, а затем выберите **2010** узла.

3. В **шаблоны** панели выберите **Импорт повторно используемого рабочего процесса SharePoint 2010** шаблона, оставьте имя проекта как **WorkflowImportProject1**и нажмите кнопку **ОК** кнопки.

    Откроется мастер настройки SharePoint.

4. На **Укажите сайт и уровень безопасности для отладки** введите [!INCLUDE[TLA2#tla_url](../sharepoint/includes/tla2sharptla-url-md.md)] второго дочернего сайта SharePoint, созданного ранее: http://<em>системное имя</em>  /SPD2.

5. В **Какова степень доверия для этого решения SharePoint?** выберите **развернуть как решение фермы** переключатель, а затем выберите **Далее** кнопки.

    Дополнительные сведения об изолированных и решений фермы см. в разделе [замечания об изолированных решениях](../sharepoint/sandboxed-solution-considerations.md).

6. В **укажите новый источник проекта** странице, перейдите в расположение в системе, где сохранен *.wsp* файл, откройте файл и затем выберите **Далее** кнопка.

   > [!NOTE]
   > Выберите **Готово** кнопку, чтобы импортировать все доступные элементы в *.wsp* файл.

    Отобразится список доступных для импорта многократно используемых рабочих процессов.

7. В **выберите элементы для импорта** выберите **SPD Task Workflow** рабочего процесса, а затем выберите **Готово** кнопку.

    После завершения операции импорта, проект с именем **WorkflowImportProject1** создается, содержащего рабочий процесс с именем **SPD_Workflow_TestFT**. В этой папке содержится файл определения рабочего процесса *Elements.xml* и файл конструктора рабочих процессов (*.xoml*). Конструктор содержит два файла: файл правил (с расширением RULES) и файл с выделенным кодом (либо *.cs* или *.vb*, в зависимости от языка программирования проекта).

8. В **обозревателе решений**, удалить **Прочие импортированные файлы** папки.

9. В *Elements.xml* , удалите `InstantiationURL="_layouts/IniErkflIP.sspx"`.

10. В **обозревателе решений**, выберите **WorkflowImportProject1**, а затем в строке меню выберите **проекта** > **Назначить запускаемым проектом**  присвоить **WorkflowImportProject1** автозапускаемым элементом.

     Откроется список, немедленно при отладке проекта.

11. Так как **Импорт повторно используемого рабочего процесса SharePoint 2010** шаблона не импортирует связанные значения свойств импортируемого рабочего процесса, необходимо ввести их. Для этого выполните следующие действия.

    1. В **обозревателе решений**, выберите **SPD_Workflow_TestFT** узла.

    2. Нажмите кнопку с многоточием (![эллипс конструктора ASP.NET Mobile](../sharepoint/media/mwellipsis.gif "эллипс конструктора ASP.NET Mobile")) рядом с одним из списковых свойств, таких как **целевой список** свойство.

    3. Заполните отсутствующие значения в мастере настройки SharePoint и выберите **Готово** кнопки.

12. Выберите XOML-файл, а затем в строке меню выберите **представление** > **конструктор** Чтобы просмотреть импортированный рабочий процесс в конструкторе рабочих процессов.

13. В **Windows Workflow v3.0** узел **элементов**, выполните одно из следующих действий:

    - Откройте контекстное меню для **кода** действия, а затем выберите **копирования**. В конструкторе рабочих процессов откройте контекстное меню для строки под **SequenceActivity1** действия, а затем выберите **вставить**.

    - Перетащите **кода** действия из **элементов** в конструктор рабочих процессов и подключите его к строке под **SequenceActivity1** действия.

      Это добавляет действие в конструктор рабочих процессов с именем **CodeActivity1**. В этом действии вы добавите действие кода, который создает объявление в списке объявлений, когда пользователь запускает рабочий процесс.

14. Выполните одно из следующих действий.

    - Дважды щелкните **CodeActivity1** создать обработчик событий и просмотреть код.

    - В **свойства** окно для **CodeActivity1**, установите для параметра **ExecuteCode** свойства **codeActivity_ExecuteCode**.

15. Добавьте следующий код под существующие **с помощью** или **Imports** инструкции:

     [!code-csharp[SP_SPDWFImport#1](../sharepoint/codesnippet/CSharp/workflowimportproject1/workflows/spd_task_workflowft/spd task workflow.xoml.cs#1)]
     [!code-vb[SP_SPDWFImport#1](../sharepoint/codesnippet/VisualBasic/workflowimportproject1/workflows/spd_task_workflowft/spd task workflow.xoml.vb#1)]

16. Замените `codeActivity1_ExecuteCode` на следующий:

     [!code-csharp[SP_SPDWFImport#2](../sharepoint/codesnippet/CSharp/workflowimportproject1/workflows/spd_task_workflowft/spd task workflow.xoml.cs#2)]
     [!code-vb[SP_SPDWFImport#2](../sharepoint/codesnippet/VisualBasic/workflowimportproject1/workflows/spd_task_workflowft/spd task workflow.xoml.vb#2)]

## <a name="deploy-the-project-and-associate-the-workflow"></a>Развертывание проекта и связывать рабочий процесс
 Затем запустите WorkflowImportProject1 развернуть его на сайте SharePoint и свяжите его со списком задач, чтобы просмотреть и протестировать измененный преобразованный рабочий процесс.

#### <a name="to-deploy-the-project-and-associate-the-workflow"></a>Для развертывания проекта и связывать рабочий процесс

1. В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], выберите **F5** клавишу, чтобы запустить и развернуть проект преобразованного рабочего процесса.

2. На панели быстрого запуска выберите **задачи** ссылку, чтобы отобразить список задач.

3. На **Инструменты списка** вкладке, выберите **элементы** кнопку, а затем выберите **новый элемент** кнопки.

     **Задачи: новый элемент** откроется диалоговое окно.

4. В **Title** введите **новая задача**, а затем выберите **Сохранить** кнопки.

5. На **Инструменты списка** вкладке, выберите **списка** кнопку, а затем выберите **параметры списка** кнопки.

     **Параметры списка** появится страница.

6. В **разрешения и управление** выберите **параметры рабочего процесса** ссылку.

     **Параметры рабочего процесса** появится страница.

7. Выберите **Добавить рабочий процесс** ссылку.

8. В **рабочего процесса** выберите **WorkflowImportProject1 — SPD Workflow Test**.

9. В **имя** введите **SPD Workflow Test**, а затем выберите **ОК** кнопки.

10. В панели быстрого запуска выберите **задачи** списка.

11. Выберите стрелку рядом с пунктом **новую задачу**, а затем в списке выберите **рабочие процессы**.

12. В **запустить новый рабочий процесс** выберите ссылку для **SPD Workflow Test**и нажмите кнопку **запустить** кнопку, чтобы запустить рабочий процесс.

    > [!NOTE]
    > Кроме того вы можно автоматически связать рабочий процесс со списком, запустив мастер параметров рабочего процесса и задание рабочего процесса, автоматическое связывание.

     Обратите внимание, что рабочий процесс выполняет два действия: ваше имя отображается на задачи **назначено** столбца и объявление отображается в **объявления** списка.

## <a name="see-also"></a>См. также
- [Импорт элементов из существующего сайта SharePoint](../sharepoint/importing-items-from-an-existing-sharepoint-site.md)
- [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)
- [Создание многократно используемых элементов управления для веб-частей или страниц приложений](../sharepoint/creating-reusable-controls-for-web-parts-or-application-pages.md)
