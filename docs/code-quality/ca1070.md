---
title: 'CA1070: не объявляйте поля событий как виртуальные'
ms.date: 04/30/2020
ms.topic: reference
f1_keywords:
- CA1070
helpviewer_keywords:
- CA1070
author: mavasani
ms.author: mavasani
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 3139443d2cbce8c59053c54a65065497da3f9b19
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "88710810"
---
# <a name="ca1070-do-not-declare-event-fields-as-virtual"></a>CA1070: не объявляйте поля событий как виртуальные

|Элемент|Значение|
|-|-|
|CheckId|CA1070|
|Категория|Microsoft. Design|
|Критическое изменение|Критическое|

## <a name="cause"></a>Причина

[Событие, похожее на поле](/dotnet/csharp/language-reference/language-specification/classes#field-like-events) , было объявлено как виртуальное.

По умолчанию это правило рассматривает только видимые извне типы, но это можно [настроить](#configurability).

## <a name="rule-description"></a>Описание правила

Следуйте этим [рекомендациям по проектированию .NET](/dotnet/csharp/programming-guide/events/how-to-raise-base-class-events-in-derived-classes) , чтобы вызвать события базового класса в производных классах. Не объявляйте виртуальные события в базовом классе. Переопределенные события в производном классе имеют неопределенное поведение. Компилятор C# не обрабатывает это правильно, и непредсказуемо, будет ли подписчик производного события фактически подписываться на событие базового класса.

```csharp
using System;
public class C
{
    // CA1070: Event 'ThresholdReached' should not be declared virtual.
    public virtual event EventHandler ThresholdReached;
}
```

## <a name="how-to-fix-violations"></a>Устранение нарушений

Следуйте этим [рекомендациям по проектированию .NET](/dotnet/csharp/programming-guide/events/how-to-raise-base-class-events-in-derived-classes) и избегайте виртуальных событий, подобных полям.

## <a name="when-to-suppress-warnings"></a>Когда следует подавлять предупреждения

Если событие является видимым извне общедоступным API, который уже является частью поставляемой библиотеки, то можно отключить предупреждение из этого правила, чтобы избежать критических изменений для потребителей библиотеки.

## <a name="configurability"></a>Возможности настройки

Вы можете настроить, на какие части базы кода следует запускать это правило, в зависимости от их доступности. Например, чтобы указать, что правило должно выполняться только для поверхности API, не являющейся общедоступной, добавьте следующую пару "ключ-значение" в файл. editorconfig в проекте:

```ini
dotnet_code_quality.ca1070.api_surface = private, internal
```

Этот параметр можно настроить только для этого правила, для всех правил или для всех правил в этой категории (конструктор). Дополнительные сведения см. в разделе [Настройка анализаторов качества кода .NET](configure-fxcop-analyzers.md).

## <a name="see-also"></a>См. также раздел

- [Предупреждения по принципам разработки](design-warnings.md)
