---
title: Метрики кода — диапазон индексов обслуживаемости и значение
ms.date: 1/8/2021
description: Сведения о метрике диапазона индексов сопровождаемости для метрик кода в Visual Studio.
ms.topic: conceptual
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 14bee6dcb522b7c1dd0475ca309b829a09c0d4ec
ms.sourcegitcommit: b1f7e7d7a0550d5c6f46adff3bddd44bc1d6ee1c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/11/2021
ms.locfileid: "98069558"
---
# <a name="code-metrics---maintainability-index-range-and-meaning"></a>Метрики кода — диапазон индексов обслуживаемости и значение

Вопрос. индекс удобства обслуживания был сброшен в значение от 0 до 100. Как это было сделано?

Первоначально метрика вычисляется следующим образом: `Maintainability Index = 171 - 5.2 * ln(Halstead Volume) - 0.23 * (Cyclomatic Complexity) - 16.2 * ln(Lines of Code)`

Использование этой формулы означало, что она находится в диапазоне от 171 до неограниченного отрицательного числа.  По мере того как код поменялся в сторону 0, было бы ясно поддерживать код, и разница между кодом в 0 и отрицательным значением не было полезным.  В результате снижения полезности отрицательных чисел и необходимости сохранения метрики как можно более четкими мы решили рассматривать все 0 или менее индексы как 0, а затем переключить диапазон 171 или меньше от 0 до 100. По этой причине используется следующая формула:

   `Maintainability Index = MAX(0,(171 - 5.2 * ln(Halstead Volume) - 0.23 * (Cyclomatic Complexity) - 16.2 * ln(Lines of Code))*100 / 171)`

В дополнение к этому, мы решили быть консервативными с пороговыми значениями.  Желание было бы сказать, что если бы в индексе отображался красный цвет, то мы бы продемонстрировали высокую степень достоверности кода.  При этом мы предоставили следующие пороговые значения:

Для пороговых значений мы решили разбить этот 0-100 диапазон 80-20, чтобы снизить уровень шума и мы только что отметили код, который был подозрительным. Мы использовали следующие пороговые значения:

- 0-9 = красный
- 10-19 = желтый
- 20-100 = зеленый
