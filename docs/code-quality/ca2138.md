---
title: CA2138. Прозрачные методы не должны вызывать методы с атрибутом SuppressUnmanagedCodeSecurity
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA2138
ms.assetid: a14c4d32-f079-4f3a-956c-a1657cde0f66
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- cplusplus
ms.openlocfilehash: d88b2f5c15d51ff840cc6ff116396ffd6b5efd60
ms.sourcegitcommit: 535ef05b1e553f0fc66082cd2e0998817eb2a56a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/07/2019
ms.locfileid: "72021735"
---
# <a name="ca2138-transparent-methods-must-not-call-methods-with-the-suppressunmanagedcodesecurity-attribute"></a>CA2138. Прозрачные методы не должны вызывать методы с атрибутом SuppressUnmanagedCodeSecurity

|||
|-|-|
|TypeName|транспарентмесодсмустноткаллсуппрессунманажедкодесекуритимесодс|
|CheckId|CA2138|
|Category|Microsoft.Security|
|Критическое изменение|Критическое|

## <a name="cause"></a>Причина:
Прозрачный для системы безопасности метод вызывает метод, помеченный атрибутом <xref:System.Security.SuppressUnmanagedCodeSecurityAttribute>.

## <a name="rule-description"></a>Описание правила
Это правило срабатывает для любого прозрачного метода, который вызывает непосредственно в машинный код, например с помощью вызова P/Invoke (вызов неуправляемого кода). Методы P/Invoke и COM-взаимодействия, помеченные атрибутом <xref:System.Security.SuppressUnmanagedCodeSecurityAttribute>, приводят к вызову LinkDemand для вызывающего метода. Поскольку прозрачный для системы безопасности код не может удовлетворить требования LinkDemand, код также не может вызывать методы, помеченные атрибутом SuppressUnmanagedCodeSecurity, или методы класса, помеченные атрибутом SuppressUnmanagedCodeSecurity. Метод завершится ошибкой, или требование будет преобразовано в полное требование.

Нарушение этого правила приводит к <xref:System.MethodAccessException> в модели прозрачности безопасности уровня 2 и полному требованию для <xref:System.Security.Permissions.SecurityPermissionAttribute.UnmanagedCode%2A> в модели прозрачности уровня 1.

## <a name="how-to-fix-violations"></a>Устранение нарушений
Чтобы устранить нарушение этого правила, удалите атрибут <xref:System.Security.SuppressUnmanagedCodeSecurityAttribute> и пометьте метод атрибутом <xref:System.Security.SecurityCriticalAttribute> или <xref:System.Security.SecuritySafeCriticalAttribute>.

## <a name="when-to-suppress-warnings"></a>Когда следует подавлять предупреждения
Для этого правила отключать вывод предупреждений не следует.

## <a name="example"></a>Пример
[!code-csharp[FxCop.Security.CA2138.TransparentMethodsMustNotCallSuppressUnmanagedCodeSecurityMethods#1](../code-quality/codesnippet/CSharp/ca2138-transparent-methods-must-not-call-methods-with-the-suppressunmanagedcodesecurity-attribute_1.cs)]