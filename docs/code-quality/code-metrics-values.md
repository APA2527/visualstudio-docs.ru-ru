---
title: Вычисление метрик кода
ms.date: 11/02/2018
ms.topic: conceptual
f1_keywords:
- vs.codeanalysis.codemetrics.toolwindow
dev_langs:
- CSharp
- VB
- FSharp
helpviewer_keywords:
- code metrics [Visual Studio]
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 841b73bbb0c1f226e4a31a812bf8745bda1f118c
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "87507876"
---
# <a name="code-metrics-values"></a>Значения метрик кода

Повышенная сложность современных программных приложений также повышает сложность обеспечения надежности и сопровождения кода. Метрики кода представляют собой набор оценок программного обеспечения, которые дают разработчикам более глубокое представление о разрабатываемом коде. Используя преимущества метрик кода, разработчики могут понять, какие типы и методы должны быть переработаны или тщательно протестированы. Группы разработчиков могут выявление потенциальных рисков, понимание текущего состояния проекта и отслеживание хода выполнения во время разработки программного обеспечения.

Разработчики могут использовать Visual Studio для создания данных метрик кода, которые измеряют сложность и удобство обслуживания управляемого кода. Данные метрик кода могут создаваться для всего решения или отдельного проекта.

Сведения о создании данных метрик кода в Visual Studio см. в разделе [инструкции. Создание данных метрик кода](../code-quality/how-to-generate-code-metrics-data.md).

## <a name="software-measurements"></a>Программные измерения

В следующем списке показаны результаты метрик кода, которые вычисляет Visual Studio:

- **Индекс удобства обслуживания** — вычисляет значение индекса от 0 до 100, представляющее относительную простоту обслуживания кода. Высокое значение означает лучшую сопровождаемость. Для быстрого обнаружения проблем в коде можно использовать цветовую маркировку. Зеленая Оценка находится в диапазоне от 20 до 100 и указывает на то, что код обладает хорошей сопровождаемостью. Желтая Оценка находится в диапазоне от 10 до 19 и указывает, что код является умеренно поддерживаемым. Красная Оценка — это оценка между 0 и 9 и указывает на низкую сопровождаемость. Дополнительные сведения см. в разделе [диапазон индексов сопровождаемости и значение](https://blogs.msdn.microsoft.com/codeanalysis/2007/11/20/maintainability-index-range-and-meaning/) в записи блога.

- **Сложностью организации циклов сложность** — измеряет структурную сложность кода. Он создается путем вычисления количества различных путей кода в потоке программы. Программа, имеющая сложный поток управления, требует больше тестов для достижения хорошего объема протестированного кода и менее сопровождаемой. Дополнительные сведения см. в [записи Википедии для сложностью организации циклов сложность](https://wikipedia.org/wiki/Cyclomatic_complexity).

- **Глубина наследования** — указывает количество различных классов, которые наследуют друг от друга, вплоть до базового класса. Глубина наследования аналогична взаимосвязанности классов в том, что изменение базового класса может повлиять на любые из его унаследованных классов. Чем выше это число, тем более глубокое наследование и тем выше вероятность внесения изменений в базовый класс, что приводит к критическому изменению. Для более глубокого наследования низкое значение хорошо, а высокое значение является недопустимым.

- Взаимосвязь **классов** — измеряет связь с уникальными классами через параметры, локальные переменные, возвращаемые типы, вызовы методов, универсальные экземпляры или шаблоны шаблонов, базовые классы, реализации интерфейса, поля, определенные во внешних типах, и декорирование атрибутов. Хорошая разработка программного обеспечения определяет, что типы и методы должны иметь высокую связность и низкую связь. Высокая связь указывает на проект, который трудно использовать и поддерживать из-за множества взаимозависимостей от других типов. Дополнительные сведения см. в записи блога о [взаимосвязанности классов](https://blogs.msdn.microsoft.com/zainnab/2011/05/25/code-metrics-class-coupling/) .

::: moniker range=">=vs-2019"

- **Строки исходного кода** — указывает точное число строк исходного кода, имеющихся в исходном файле, включая пустые строки. Эта метрика доступна начиная с Visual Studio 2019 версии 16,4 и Microsoft. CodeAnalysis. метрик (2.9.5).

- **Строки исполняемого кода** — указывает приблизительное количество строк или операций исполняемого кода. Это количество операций в исполняемом коде. Эта метрика доступна начиная с Visual Studio 2019 версии 16,4 и Microsoft. CodeAnalysis. метрик (2.9.5). Значение обычно является близким к предыдущей метрике, **строкам кода**, которая является метрикой на основе инструкций языка MSIL, используемой в устаревшем режиме.
::: moniker-end
::: moniker range="vs-2017"

- **Строки кода** — указывает приблизительное количество строк в коде. Количество основывается на коде IL и, следовательно, не является точным числом строк в файле исходного кода. Большое число может означать, что тип или метод пытается выполнить слишком много усилий и должны быть разделены. Оно также может указывать на то, что тип или метод может быть трудно поддерживать.

   > [!NOTE]
   > [Версия командной строки](../code-quality/how-to-generate-code-metrics-data.md#command-line-code-metrics) средства метрики кода считает фактические строки кода, поскольку анализирует исходный код, а не IL.
::: moniker-end

## <a name="anonymous-methods"></a>Анонимные методы

*Анонимный метод* — это просто метод без имени. Анонимные методы чаще всего используются для передачи блока кода в качестве параметра делегата. Результаты метрик кода для анонимного метода, объявленного в элементе, например метод или метод доступа, связаны с членом, который объявляет метод. Они не связаны с членом, который вызывает метод.

## <a name="generated-code"></a>Созданный код

Некоторые программные средства и компиляторы создают код, который добавляется в проект, и разработчик проекта не может видеть или не должен изменять его. В основном метрики кода игнорируют сформированный код при вычислении значений метрик. Это позволяет значениям метрик отражать, что может видеть и изменять разработчик.

Код, созданный для Windows Forms, не пропускается, так как это код, который разработчик может просматривать и изменять.

## <a name="next-steps"></a>Дальнейшие действия

- [Как создавать данные метрик кода](../code-quality/how-to-generate-code-metrics-data.md)
- [Использование окна "Результаты метрик кода"](../code-quality/working-with-code-metrics-data.md)
