---
title: Рассчитать метрики кода
ms.date: 11/02/2018
ms.topic: conceptual
helpviewer_keywords:
- code metrics [Visual Studio]
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: ece5c08ca3aa4a9f5e5329dbf6d5fd6c9087d085
ms.sourcegitcommit: aa302af53de342e75793bd05b10325939dc69b53
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/11/2020
ms.locfileid: "75886405"
---
# <a name="code-metrics-values"></a>Значения метрик кода

Повышенная сложность современных программных приложений также увеличивает усложняет код, надежный и удобный в сопровождении. Метрики кода представляют собой набор оценок программного обеспечения, которые дают разработчикам более глубокое представление о разрабатываемом коде. Используя преимущества метрик кода, разработчикам понять типы и методы должны быть переработаны или более тщательное тестирование. Группы разработчиков могут определять потенциальные риски, понять текущее состояние проекта и отслеживания хода выполнения во время разработки программного обеспечения.

Разработчики могут использовать Visual Studio для получения данных метрик кода, которые измеряют сложности и удобства сопровождения управляемого кода. Данные метрик кода могут создаваться для всего решения или отдельного проекта.

Сведения о способах получения данных метрик кода в Visual Studio, см. в разделе [как: создание данных для метрик кода](../code-quality/how-to-generate-code-metrics-data.md).

## <a name="software-measurements"></a>Оценки программного обеспечения

Ниже показан код, Результаты метрик, которые вычисляет Visual Studio:

- **Индекс удобства поддержки** -вычисляет значение индекса от 0 до 100, представляющий относительной простоты обслуживания кода. Высокое значение означает превосходные возможности сопровождения. Цветовые индикаторы позволяют быстро определить проблемные места в коде. Зеленый рейтинг от 20 до 100 и указывает, что код имеет высокое удобство поддержки. Желтый рейтинг от 10 до 19 и указывает, что код поддерживать. Красный рейтинг оценку от 0 до 9, указывает на низкий удобство поддержки. Дополнительные сведения см. в разделе [диапазон индексов сопровождаемости и значение](https://blogs.msdn.microsoft.com/codeanalysis/2007/11/20/maintainability-index-range-and-meaning/) в записи блога.

- **Сложность организации циклов** -измеряет структурной сложности кода. Она создается в расчете количества разных путей кода в потоке программы. Программа, имеющая сложный поток управления, требует больше тестов для достижения хорошего объема протестированного кода и менее сопровождаемой. Дополнительные сведения см. в [записи Википедии для сложностью организации циклов сложность](https://wikipedia.org/wiki/Cyclomatic_complexity).

- **Глубина наследования** — указывает количество различных классов, которые наследуют друг от друга, вплоть до базового класса. Глубина наследования аналогична взаимосвязанности классов в том, что изменение базового класса может повлиять на любые из его унаследованных классов. Чем выше это число, тем более глубокое наследование и тем выше вероятность внесения изменений в базовый класс, что приводит к критическому изменению. Для более глубокого наследования низкое значение хорошо, а высокое значение является недопустимым.

- **Связанность классов** -измеряет увязка с уникальным классы с помощью параметров, локальных переменных, типы возвращаемых значений, вызовы методов, экземпляров универсального класса или шаблона, базовые классы, реализации интерфейса, полей, определенных для внешних типов и атрибут оформления. Разработка хорошего программного обеспечения определяет, что типы и методы должны иметь высокую слаженность и низкой связанностью. Высокая связанность свидетельствует о трудно повторно использовать и обслуживать из-за большого количества взаимозависимостей для других типов. Дополнительные сведения см. в записи блога о [взаимосвязанности классов](https://blogs.msdn.microsoft.com/zainnab/2011/05/25/code-metrics-class-coupling/) .

::: moniker range=">=vs-2019"

- **Строки исходного кода** — указывает точное число строк исходного кода, имеющихся в исходном файле, включая пустые строки. Эта метрика доступна начиная с Visual Studio 2019 версии 16,4 и Microsoft. CodeAnalysis. метрики (2.9.5).

- **Строки исполняемого кода** — указывает приблизительное количество строк или операций исполняемого кода. Это количество операций в исполняемом коде. Эта метрика доступна начиная с Visual Studio 2019 версии 16,4 и Microsoft. CodeAnalysis. метрики (2.9.5). Значение обычно является близким к предыдущей метрике, **строкам кода**, которая является метрикой на основе инструкций языка MSIL, используемой в устаревшем режиме.
::: moniker-end
::: moniker range="vs-2017"

- **Строки кода** -Указывает приблизительное число строк кода. Число зависит от кода IL и поэтому не точное число строк в файле исходного кода. Большое число может означать, что тип или метод пытается выполнить слишком много усилий и должны быть разделены. Он также может указывать, что тип или метод может быть трудно обслуживать.

   > [!NOTE]
   > [Командной строки версии](../code-quality/how-to-generate-code-metrics-data.md#command-line-code-metrics) кода средство метрики подсчитывать фактические строки кода, так как они анализируют исходный код вместо IL.
::: moniker-end

## <a name="anonymous-methods"></a>Анонимные методы

*Анонимный метод* — это метод, не имеет имени. Анонимные методы часто используются для передачи блока кода в качестве аргумента делегата. Результаты метрик кода для анонимного метода, объявленного в элементе, например метод или метод доступа, связаны с членом, который объявляет метод. Они не связаны с членом, который вызывает метод.

## <a name="generated-code"></a>Созданный код

Некоторые программные средства и компиляторы создают код, который добавляется в проект, и что разработчик проекта отсутствует или не следует изменять. В основном показатели качества кода игнорирует созданный код при расчете значения метрик. Это позволяет отражать разработчик может просматривать, изменять значения метрик.

Код, созданный для форм Windows Forms не учитывается, так как это код, который разработчик может просматривать, изменять.

## <a name="next-steps"></a>Следующие шаги

- [Практическое: создание данных для метрик кода](../code-quality/how-to-generate-code-metrics-data.md)
- [В окне результатов метрики кода](../code-quality/working-with-code-metrics-data.md)
