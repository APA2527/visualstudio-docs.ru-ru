---
title: 'CA2012: используйте ValueTasks правильно'
ms.date: 06/18/2020
ms.topic: reference
f1_keywords:
- UseValueTasksCorrectly
- CA2012
helpviewer_keywords:
- UseValueTasksCorrectly
- CA2012
author: stephentoub
ms.author: stoub
manager: jeffhand
ms.workload:
- multiple
ms.openlocfilehash: 10e71fca9cda048e91f76b329036ea01a2a78b0b
ms.sourcegitcommit: 5caad925ca0b5d136416144a279e984836d8f28c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/07/2020
ms.locfileid: "89508916"
---
# <a name="ca2012-use-valuetasks-correctly"></a>CA2012: используйте ValueTasks правильно

|Элемент|Значение|
|-|-|
|CheckId|CA2012|
|Категория|Microsoft. надежность|
|Критическое изменение|Не критическое|

## <a name="cause"></a>Причина

<xref:System.Threading.Tasks.ValueTask>Экземпляр, возвращенный из вызова члена, используется способом, который может привести к исключениям, повреждению или ухудшению производительности.

## <a name="rule-description"></a>Описание правила

<xref:System.Threading.Tasks.ValueTask> экземпляры, возвращаемые из вызовов членов, предназначены для непосредственного ожидания.  Попытки использовать ValueTask несколько раз или для прямого доступа к одному результату до его завершения могут привести к возникновению исключения или повреждения.  Пропуск такого ValueTask, скорее всего, указывает на функциональную ошибку и может привести к снижению производительности.

## <a name="how-to-fix-violations"></a>Устранение нарушений

Как правило, Валуетаскс следует ожидать непосредственно, а не отменять или хранить в других местах, таких как локальные переменные или поля.

## <a name="when-to-suppress-warnings"></a>Когда следует подавлять предупреждения

Для Валуетаскс, возвращенных произвольными вызовами элементов, вызывающему объекту необходимо предположить, что ValueTask должен быть потреблен (например, await) только один раз.  Однако если разработчик также управляет вызываемым членом и обладает полным набором знаний о его реализации, разработчик может быть уверен в том, что это предупреждение можно отключить, например, если Return ValueTask всегда заключает объект в оболочку <xref:System.Threading.Tasks.Task> .

## <a name="see-also"></a>См. также

- [Предупреждения, связанные с надежностью](../code-quality/reliability-warnings.md)
