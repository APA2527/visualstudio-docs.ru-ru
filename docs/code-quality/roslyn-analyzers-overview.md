---
title: Анализ кода с помощью анализаторов Roslyn
ms.date: 03/26/2018
ms.topic: overview
helpviewer_keywords:
- code analysis, managed code
- analyzers
- Roslyn analyzers
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- dotnet
ms.openlocfilehash: befbb09d347043ae304702618506d193344e23ba
ms.sourcegitcommit: fd5a5b057df3d733f5224c305096907989811f85
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/18/2019
ms.locfileid: "67195243"
---
# <a name="overview-of-net-compiler-platform-analyzers"></a>Обзор анализаторов на платформе .NET Compiler Platform

Анализаторы .NET Compiler Platform ("Roslyn") выполняют анализ стиля, качества, удобства, структуры и других характеристик кода, а также выявляют проблемы в нем. Visual Studio содержит встроенный набор анализаторов, которые анализируют код на C# или Visual Basic при его наборе. Вы можете настроить параметры таких встроенных анализаторов на странице [параметров текстового редактора](../ide/code-styles-and-code-cleanup.md) или в [файле .editorconfig](../ide/editorconfig-code-style-settings-reference.md). Вы можете установить дополнительные анализаторы в виде расширений Visual Studio или пакетов NuGet.

Если анализатор обнаруживает нарушения правил, они помечаются в редакторе кода (*волнистая линия* под соответствующим кодом) и в окне **Список ошибок**.

Многие правила анализатора или *диагностические средства* имеют одно или несколько связанных *исправлений кода*, которые можно применить для устранения проблемы. Все диагностические средства анализатора, встроенные в Visual Studio, имеют соответствующие исправления кода. Исправления кода отображаются в меню со значком лампочки вместе с другими типами [быстрых действий](../ide/quick-actions.md). Сведения об этих исправлениях кода см. в разделе [Распространенные быстрые действия](../ide/common-quick-actions.md).

![Нарушение анализа и исправление кода быстрого действия](../code-quality/media/built-in-analyzer-code-fix.png)

## <a name="roslyn-analyzers-vs-static-code-analysis"></a>Сравнение анализаторов Roslyn и статического анализа кода

В конечном счете анализаторы .NET Compiler Platform (Roslyn) заменят [статический анализ кода](../code-quality/code-analysis-for-managed-code-overview.md) для управляемого кода. Множество правил статического анализа кода уже были переписаны как диагностические средства анализатора Roslyn.

Как и нарушения правил статического анализа кода, нарушения анализаторов Roslyn отображаются в **списке ошибок**. Кроме того, нарушения анализаторов Roslyn выделяются в редакторе кода с помощью *волнистых линий* под соответствующим кодом. Цвет волнистой линии зависит [параметра серьезности](../code-quality/use-roslyn-analyzers.md#rule-severity) правила. На следующем снимке экрана показаны три нарушения&mdash;одно красное, одно зеленое и одно серое:

![Волнистые линии в редакторе кода](media/diagnostics-severity-colors.png)

Анализаторы Roslyn анализируют код не только во время сборки (как функция статического анализа кода, если она включена), но и в реальном времени по мере ввода. Анализаторы Roslyn также выполняют анализ времени разработки для файлов кода, которые не открыты в редакторе, если вы включите [полный анализ решения](../code-quality/how-to-enable-and-disable-full-solution-analysis-for-managed-code.md#to-toggle-full-solution-analysis).

> [!TIP]
> Ошибки и предупреждения времени сборки из анализаторов Roslyn отображаются только в том случае, если анализаторы установлены как пакет NuGet.

Анализаторы Roslyn не только сообщают о тех же типах проблем, что и статический анализ кода, но и упрощают исправление одного или всех экземпляров нарушений в файле или проекте. Эти действия называются *исправлениями кода*. Исправления кода зависят от конкретной интегрированной среды разработки; в Visual Studio они реализуются как [Быстрые действия](../ide/quick-actions.md). Не все диагностические средства анализатора имеют соответствующее исправление кода.

> [!NOTE]
> Следующие параметры пользовательского интерфейса применяются только к анализу статического кода.
>
> - Параметр меню **Анализ** > **Выполнить анализ кода**.
> - Флажки **Включить анализ кода в сборке** и **Исключить результат из созданного кода** на вкладке страницы свойств проекта **Анализ кода** (эти параметры не влияют на анализаторы Roslyn).

Чтобы различить нарушения из анализаторов Roslyn и статического анализа кода в **списке ошибок**, используйте столбец **Средство**. Если его значение соответствует одной из сборок анализаторов в **обозревателе решений**, например, **Microsoft.CodeQuality.Analyzers**, нарушение поступает из анализатора Roslyn. В противном случае нарушение поступает из статического анализа кода.

![Столбец "Средство" в списке ошибок](media/code-analysis-tool-in-error-list.png)

> [!TIP]
> Свойство msbuild **RunCodeAnalysis** в файле проекта используется только для анализа статического кода. Чтобы установить анализаторы, в файле проекта задайте **RunCodeAnalysis** значение **false**, чтобы запретить анализ статического кода после сборки.
>
> ```xml
> <RunCodeAnalysis>false</RunCodeAnalysis>
> ```

## <a name="nuget-package-versus-vsix-extension"></a>Сравнение пакета NuGet и расширения VSIX

Анализаторы .NET Compiler Platform можно устанавливать для отдельных проектов с помощью пакета NuGet или в масштабе всей системы Visual Studio в виде расширения Visual Studio. Между этими двумя способами [установки анализаторов](../code-quality/install-roslyn-analyzers.md) существуют некоторые ключевые различия.

### <a name="scope"></a>Область

Если анализаторы устанавливаются как расширение Visual Studio, они применяются на уровне решения, то есть ко всем экземплярам Visual Studio. Если анализаторы устанавливаются в виде пакета NuGet, что является предпочтительным, они применяются только к проекту, где установлен данный пакет NuGet. В командных окружениях анализаторы, установленные как пакеты NuGet, входят в область для *всех разработчиков*, работающих над этим проектом.

### <a name="build-errors"></a>Ошибки сборки

Чтобы применить правила во время сборки, например с помощью командной строки или в составе сборки непрерывной интеграции (CI), установите анализаторы как пакет NuGet. Если установить анализатор как расширение, его предупреждения и ошибки не будут отображаться в отчете о сборке.

На следующем снимке экрана показаны выходные данные сборки из командной строки для создания проекта, содержащего нарушение правила анализа.

![Выходные данные MSBuild с нарушением правила](media/command-line-build-analyzers.png)

### <a name="rule-severity"></a>Важность правил

Вы не можете задать важность правил из анализаторов, которые были установлены как расширение Visual Studio. Чтобы настроить [важность правила](../code-quality/use-roslyn-analyzers.md#rule-severity), установите анализаторы как пакет NuGet.

### <a name="categories"></a>Категории

Ниже приведены различные типы анализаторов, которые помогают анализировать код. 

- Анализаторы, рекомендованные корпорацией Майкрософт: [анализаторы FXCop](../code-quality/fxcop-analyzers.yml).
- Анализаторы интегрированной среды разработки Visual Studio: [EditorConfig](../ide/code-styles-and-code-cleanup.md)
- Анализаторы сторонних поставщиков: [StyleCop](https://www.nuget.org/packages/StyleCop.Analyzers/), [Roslynator](https://www.nuget.org/packages/Roslynator/), [XUnit Analyzers](https://www.nuget.org/packages/xunit.analyzers/), [Sonar Analyzer](https://www.nuget.org/packages/SonarAnalyzer.CSharp/).

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Установка анализаторов Roslyn в Visual Studio](../code-quality/install-roslyn-analyzers.md)

> [!div class="nextstepaction"]
> [Использование анализаторов Roslyn в Visual Studio](../code-quality/use-roslyn-analyzers.md)

## <a name="see-also"></a>См. также

- [Часто задаваемые вопросы по анализаторам](analyzers-faq.md)
- [Написание собственного анализатора Roslyn](../extensibility/getting-started-with-roslyn-analyzers.md)
- [Пакет SDK для .NET Compiler Platform](/dotnet/csharp/roslyn-sdk/)
