---
title: Интерактивная оболочка REPL для R
description: Использование интерактивной среды REPL для R в Visual Studio, встроенной в окна редактора.
ms.date: 06/28/2017
ms.topic: conceptual
author: kraigb
ms.author: kraigb
manager: jillfra
ms.workload:
- data-science
ms.openlocfilehash: 7109e74e858aa308b8f49e6e1e335478f801070b
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62815002"
---
# <a name="work-with-the-r-interactive-window"></a>Работа с интерактивным окном R

В состав инструментов R для Visual Studio (RTVS) входит интерактивное окно R, которое также называется средой **REPL** (Read-Evaluate-Print-Loop, чтение — оценка — печать — цикл), в которой можно ввести код R и сразу видеть результаты. В интерактивном окне доступны все модули, синтаксис и переменные, а также IntelliSense.

Интерактивное окно также интегрировано с обычными окнами редактора R. Можно выбрать код и нажать клавиши **CTRL**+**ВВОД** или щелкнуть правой кнопкой мыши и выбрать команду **Выполнить в интерактивном окне**, после чего код будет выполнен построчно в интерактивном окне как при вводе напрямую. Когда курсор находится на одной из строк в окне редактора, при нажатии клавиш **CTRL**+**ВВОД** эта строка отправляется в интерактивное окно, а курсор затем перемещается на следующую строку. Таким образом, можно просто нажать клавиши **CTRL**+**ВВОД** для пошагового выполнения кода.

Чтобы ознакомиться с этими возможностями, выполните действия из пошагового руководства [по началу работы с R](getting-started-with-r.md), а также действия в разделах этой статьи. [Фрагменты кода](code-snippets-for-r.md) выполняются в интерактивном окне так же, как и в окнах редактора R.

## <a name="overview-of-the-interactive-window"></a>Обзор интерактивного окна

Введите действительный код R и нажмите клавишу **ВВОД** в конце строки, чтобы выполнить код в этой строке:

```repl
> 3 + 3
[1] 6
```

Нажатие клавиши **ВВОД** в любом месте строки также позволяет запустить эту строку.

Все предыдущие входные и выходные данные в REPL доступны только для чтения, и изменить их не удастся. Однако можно в любое время выбрать и скопировать текст из окна, а затем вставить его. Вставленный код выполняется так, как если бы он был введен построчно.

То есть если начать ввод оператора и нажать клавишу **ВВОД**, RTVS знают, когда нужно продолжить оператор, и переходят в многострочный режим с командной строкой "+"слева и соответствующим отступом. RTVS также добавляет круглые скобки, прямые скобки и фигурные скобки.

![Ввод многострочного оператора в интерактивном окне](media/repl-multiline-entry.png)

В этом многострочном режиме блок кода выполняется при нажатии клавиши **ВВОД** только в том случае, если курсор находится в конце блока, в противном случае нажатие клавиши приводит к вставке новой строки. Тем не менее можно в любом месте нажать клавиши **CTRL**+**ВВОД**, чтобы немедленно запустить этот блок кода.

### <a name="toolbar-commands"></a>Команды на панели инструментов

Ниже показано интерактивное окно с панелью инструментов:

![Интерактивное окно с панелью инструментов](media/repl-window.png)

На панели инструментов доступны следующие команды, большинство из которых имеют сочетания клавиш и также доступны в меню **Инструменты R** > **Сеанс** и **Инструменты R** > **Рабочий каталог** (или как указано):

| Кнопка | Команда | Сочетание клавиш | Описание |
| --- | --- | --- | --- |
| ![Кнопка сброса](media/repl-toolbar-01-reset.png) | Сбросить | **CTRL**+**SHIFT**+**F10** | Сбрасывает сеанс работы с интерактивным окном, очищает все переменные и журнал. |
| ![Кнопка "Сбросить"](media/repl-toolbar-02-clear.png) | Clear | **CTRL**+**L** | Очищает выходные данные, которые отображаются в интерактивном окне; переменные сеанса и журнал остаются без изменений. |
| ![Кнопки работы с журналом](media/repl-toolbar-03-history.png) | Команда "Назад"<br/>Команда "Далее" | **СТРЕЛКА ВВЕРХ**, **СТРЕЛКА ВНИЗ**<br/>**ALT**+**СТРЕЛКА ВВЕРХ**, **ALT**+**СТРЕЛКА ВНИЗ** | Прокрутка журнала; для блоков с несколькими строками кода имеется определенная функциональность. См. раздел [Журнал](#history). |
| ![Кнопка "Загрузить рабочую область"](media/repl-toolbar-04-load-workspace.png) | Загрузить рабочую область | Н/Д | Загрузка сохраненной ранее рабочей области (см. раздел [Рабочие области и сеансы](#workspaces-and-sessions). |
| ![Кнопка "Сохранить рабочую область как"](media/repl-toolbar-05-save-workspace-as.png)| Сохранить рабочую область как | Н/Д | Сохранение текущего состояния сеанса в качестве рабочей области (см. раздел [Рабочие области и сеансы](#workspaces-and-sessions)). |
| ![Кнопка "Использовать скрипт R в качестве источника"](media/repl-toolbar-06-source-r-script.png) | Использовать скрипт R в качестве источника | **CTRL**+**SHIFT**+**S** | Вызов `source` с текущим активным скриптом R в редакторе Visual Studio, который выполняет код.  Эта кнопка доступна только в том случае, если R-файл открыт в редакторе Visual Studio. |
| ![Кнопка "Использовать скрипт R в качестве источника с эхо-выводом"](media/repl-toolbar-07-source-r-script-with-echo.png) | Использовать скрипт R в качестве источника с эхо-выводом | **CTRL**+**SHIFT**+**ВВОД** | Аналогична кнопке "Использовать скрипт R в качестве источника", только содержимое скрипта отображается в интерактивном окне. |
| ![Кнопка "Прервать R"](media/repl-toolbar-08-interrupt-r.png)| Прервать R | **ESC** | Остановка выполняемого кода в интерактивном окне, например цикла `while` на снимке экрана в начале этого раздела. |
| ![Кнопка "Присоединить отладчик"](media/repl-toolbar-09b-attach-debugger.png)| Присоединить отладчик | Н/Д | Также можно воспользоваться командой **Отладка** > **Подключить к интерактивному окну R**. |
| ![Кнопка "Задать расположение исходных файлов в качестве рабочего каталога"](media/repl-toolbar-10-set-working-directory-source.png)| Задать расположение исходных файлов в качестве рабочего каталога | **CTRL**+**SHIFT**+**E** | Задает расположение последнего загруженного в интерактивное окно исходного файла в качестве рабочего каталога (с помощью `source`). См. раздел [Рабочий каталог](#working-directory). |
| ![Кнопка "Задать расположение проекта в качестве рабочего каталога"](media/repl-toolbar-11-set-working-directory-to-project.png) | Задать расположение проекта в качестве рабочего каталога | **CTRL**+**SHIFT**+**P** | Задает корневой каталог текущего загруженного в Visual Studio проекта в качестве рабочего каталога. См. раздел [Рабочий каталог](#working-directory). |
| (Текстовое поле) | Выбор рабочего каталога | Н/Д | Поле прямого ввода для рабочего каталога. См. раздел [Рабочий каталог](#working-directory). |

## <a name="workspaces-and-sessions"></a>Рабочие области и сеансы

Выполнение кода в интерактивном окне создает контекст в текущем сеансе. Этот контекст состоит из глобальных переменных, определений функций, загрузок библиотек и т. д. В совокупности этот контекст именуется *рабочей областью*. Вы можете в любое время сохранять и загружать рабочие области.

При нажатии кнопки **Сохранить рабочую область как** или выборе команды **Инструменты R** > **Сеансы** > **Сохранить рабочую область как** предлагается выбрать расположение и имя файла (по умолчанию используется расширение *RDATA*).

Чтобы сохранить рабочую область с определенным именем файла (по умолчанию используется расширение *RDATA*), нажмите кнопку **Сохранить рабочую область** в REPL:

Чтобы загрузить сохраненную ранее рабочую область, нажмите кнопку **Загрузить рабочую область** или воспользуйтесь командой **Инструменты R** > **Сеанс** > **Загрузить рабочую область** и перейдите к файлу рабочей области.

Нажмите кнопку **Сбросить** или выберите команду **Инструменты R** > **Сеанс** > **Сбросить**, чтобы сбросить контекст сеанса. При использовании удаленного сеанса сброс также приводит к удалению профиля пользователя на удаленном компьютере и очистке всех файлов, хранящихся на нем. (См. раздел [Рабочие области](r-workspaces-in-visual-studio.md#directories-on-local-and-remote-computers).)

## <a name="working-directory"></a>Рабочий каталог

Разработчики обычно изменяют рабочий каталог во время интерактивного сеанса. С помощью различных команд, доступных на панели инструментов, меню **Инструменты R** > **Рабочий каталог** и контекстного меню проекта можно с легкостью задать в качестве рабочего каталога расположение исходного файла, расположение проекта или любое иное расположение. Это позволяет избежать ввода полного пути или слишком длинного относительного пути для ссылки на файлы.

## <a name="history"></a>Журнал

Каждая строка, вводимая в интерактивном окне, включая строки, отправленные из редактора, сохраняется в журнале REPL. Можно просмотреть журнал с помощью клавиш со стрелками вверх и вниз, как и в привычной командной строке.

Единственное отличие состоит в том, что если начать ввод в текущей строке, а затем нажать клавишу со стрелкой вверх, то текущая строка сохраняется в журнале даже в том случае, если она еще не выполнялась.

Такое же поведение журнала в интерактивном окне применяется к операторам других блоков кода со строками. При просмотре журнала с помощью кнопок со стрелками вниз и вверх многострочные блоки извлекаются целиком и отображаются как текущие записи. В этом случае клавиши со стрелками позволяют перемещаться по этому блоку кода построчно, пока не будет достигнут верх или низ блока. При нажатии клавиши со стрелкой вверх в верхней части блока извлекается предыдущий элемент в журнале; при нажатии клавиши со стрелкой вниз в самой нижней строке извлекается следующий элемент.

Такое поведение соответствует типичной ситуации повторного выполнения последнего элемента в журнале с помощью сочетания клавиш СТРЕЛКА ВВЕРХ+**ВВОД**, что позволяет естественным образом редактировать многострочный блок с помощью нажатия клавиши со стрелкой вверх для перехода к нему.

Чтобы избежать перехода в многострочные блоки кода, используйте кнопки на панели инструментов или сочетания клавиш **ALT**+**СТРЕЛКА ВВЕРХ** и **ALT**-**СТРЕЛКА ВНИЗ**, и тогда все такие блоки рассматриваются как одна строка.

Лучше всего, конечно, самостоятельно изучить эти возможности интерактивного окна на практике. В следующем примере кода предоставлено несколько подходящих одно- и многостроковых операторов. Для создания соответствующего журнала нужно скопировать и вставить каждый оператор по отдельности. (Также можно вставить код в отдельный файл кода, а затем отправить строки в интерактивное окно, нажав клавиши **CTRL**+**ВВОД**.)

```R
3 + 3

4 + 4

5 + 5

add <- function (x, y) {
  return (x + y)
}

sub <- function (x, y) {
  return (x - y)
}
```