---
title: Редактирование кода R
description: Visual Studio позволяет адаптировать возможности редактирования под код R, сохранив все функции и возможность использования расширений.
ms.date: 11/05/2018
ms.topic: conceptual
author: kraigb
ms.author: kraigb
manager: jillfra
ms.workload:
- data-science
ms.openlocfilehash: 7ecfd8f1cf50e94991ce2fd94ad94ac9815c92ca
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62938837"
---
# <a name="edit-r-code-in-visual-studio"></a>Редактирование кода R в Visual Studio

Инструменты R для Visual Studio (RTVS) позволяют адаптировать возможности редактирования в Visual Studio специально под код R, сохранив все функции и возможность использования расширений. (Например, если вы предпочитаете использовать настраиваемые сочетания клавиш VIM, можно установить бесплатное [расширение VsVim](https://marketplace.visualstudio.com/items?itemName=JaredParMSFT.VsVim), доступное Visual Studio Marketplace.)

В этой статье описаны не все функции. Дополнительные сведения см. в статьях об [IntelliSense](r-intellisense.md), [анализе кода](linting-r-code.md), [фрагментах кода](code-snippets-for-r.md) и [R Markdown](rmarkdown-with-r-in-visual-studio.md).

## <a name="syntax-highlighting"></a>Подсветка синтаксиса

Помимо расцветки различных частей кода, таких как строки, комментарии и ключевые слова, RTVS также выделяет и включает ссылки в комментариях.

![Цветовая раскраска синтаксических конструкций для кода R](media/editing-syntax-colors.png)

Для настройки шрифтов и определенных выделений цветом выберите команду **Сервис** > **Параметры**, перейдите в каталог **Среда** > **Шрифты и цвета**, измените параметры для элементов, связанных с R, в поле **Отображение элементов**:

![Параметры шрифтов и цвета для кода R](media/editing-syntax-colors-options.png)

Visual Studio также подчеркивает синтаксические ошибки в редакторе.

![Выделение синтаксической ошибки в коде R](media/editing-syntax-error.png)

Чтобы изменить это поведение, воспользуйтесь параметром **Дополнительно** > **Проверка синтаксиса** в разделе [Параметры редактора](#editor-options).

## <a name="edit-and-organize-code"></a>Редактирование и упорядочение кода

При вводе кода RTVS предлагает автоматическое завершение, как описано в разделе, посвященном [IntelliSense](r-intellisense.md). RTVS также выполняет автоматическое форматирование, такое как завершение фигурных и круглых скобок.

![Анимация встроенного форматирования](media/editing-inline-formatting.gif)

При вводе вызовов функций, имеющих множество параметров, зачастую требуется выровнять параметры, чтобы упростить чтение кода. RTVS запоминает отступ, заданный для параметров, и автоматически применяет этот отступ для последующих строк.

![Анимация автоматического отступа](media/editing-auto-indentation.gif)

Чтобы изменить это поведение, воспользуйтесь [параметрами редактора](#editor-options) в группе элементов **Табуляция**.

Сворачиваемые области кода позволяют временно скрыть часть кода в редакторе. Visual Studio автоматически создает различные области кода, как в случае с многострочными операторами, если только для параметра **Дополнительно** > **Структура** > **Структура кода** не установлено значение "Выкл.".

Для создания собственной области, заключите требуемый код в комментарии, которые заканчиваются на `---`. Элементы управления "+/–" слева позволяют сворачивать и разворачивать области кода.

![Создание сворачиваемой области кода с комментариями](media/editing-collapsible-regions.gif)

По умолчанию при нажатии клавиши **TAB** Visual Studio вставляет пробелы. Это поведение можно так же изменить, как описано в разделе [Параметры, текстовый редактор, табуляция](../ide/reference/options-text-editor-all-languages.md).

## <a name="code-navigation"></a>Навигация по коду

Элементы навигации по коду обеспечивают быстрый доступ к исходному коду программы R и его библиотек. Эти функции позволяют уделить основное внимание работе вместо того, чтобы заниматься ручным поиском по коду.

Команда **Перейти к определению** позволяет быстро перейти к определению функции или отобразить встроенный мини-редактор для считывания исходного кода функции библиотеки. Достаточно щелкнуть правой кнопкой мыши интересующую функцию и выбрать команду **Перейти к определению** или поместить курсор в функцию и нажать клавишу **F12**.

Эта команда открывает новое окно редактора, содержащее исходный код для функции. Для удобства курсор помещается в начало определения функции.

Команда **Показать определение**, доступная в контекстном меню или вызываемая с помощью клавиш **ALT**+**F12**, позволяет вставить прокручиваемую область, доступную только для чтения, в которой после вызова функции представлен исходный код функции:

![Анимация выполнения команды "Показать определение"](media/editing-peek-definition.gif)

## <a name="send-code-to-the-interactive-window"></a>Отправка кода в интерактивное окно

Многие разработчики предпочитают писать код в редакторе и затем отправляют его в [интерактивное окно](interactive-repl-for-r-in-visual-studio.md), чтобы сразу же протестировать его. Интерактивное окно также называется средой REPL (Read-Evaluate-Print-Loop, чтение-оценка-печать-цикл). При нажатии клавиш **CTRL**+**ВВОД** в редакторе R текущая строка кода отправляется в интерактивное окно, после чего курсор помещается на следующую строку. Затем с помощью клавиш **CTRL**+**ВВОД** можно приступить к эффективному пошаговому выполнению кода из редактора.

Можно также выбрать код и нажать клавиши **CTRL**+**ВВОД**, чтобы применить всю выбранную область. Можно также щелкнуть правой кнопкой мыши и выбрать команду **Выполнять в интерактивном режиме**.

## <a name="format-code"></a>Код формата

Автоматическое форматирование Visual Studio обеспечивает соответствие написанного кода, а также кода, вставленного в редактор, заданным настройкам форматирования. Также можно выбрать фрагмент кода, щелкнуть его правой кнопкой мыши и выбрать команду **Выбор формата** (или нажать клавиши **CTRL**+**K**,**F**), чтобы применить эти настройки. Например, если имеется определение функции, умещающееся в одной строке:

```R
f<-function  (a){  return(a + 1) }
```

Применение форматирования позволяет очистить его и привести к следующему виду:

```R
f <- function(a) { return(a + 1) }
```

Чтобы переформатировать весь файл с кодом, выберите **Правка** > **Дополнительно** > **Форматирование документа** или нажмите клавиши **CTRL**+**E**,**D**.

Автоматическое форматирование является отдельной операцией, которую можно отменить. Например, если вы вставили в редактор код вместе с параметрами его форматирования, выберите **Правка** > **Отменить** или один раз нажмите клавиши **CTRL**+**Z**, чтобы отменить форматирование; повторное выполнение команды **Отменить** отменяет ввод кода.

Параметры форматирования (включая отключение форматирования) задаются через меню **Сервис** > **Параметры** на вкладке **Текстовый редактор** > **R** > **Дополнительно**. Можно перейти прямо на эту страницу, воспользовавшись командой **Инструменты R** > **Параметры редактора** или щелкнув правой кнопкой мыши в редакторе и выбрав пункт **Параметры форматирования**. Дополнительные сведения см. в разделе [о параметрах редактора](#editor-options).

## <a name="inserting-roxygen-comments"></a>Вставка примечаний Roxygen

RTVS имеет ярлык для создания примечаний [Roxygen](https://cran.r-project.org/web/packages/roxygen2/index.html) с помощью имен параметров функции. Просто введите `###` в пустой строке над определением функции.

![Анимация вставки примечания Roxygen](media/editing-roxygen-comments.gif)

## <a name="editor-options"></a>Параметры редактора

Параметры редактора задаются с помощью команды **Сервис** > **Параметры** и выбора пункта **Текстовый редактор** > **R**, а также с помощью команд контекстного меню **Инструменты R** > **Параметры редактора**.

Параметры на вкладках **Общие**, **Полосы прокрутки** и **Табуляция** не являются специфичными для R, а скорее общими параметрами Visual Studio, доступными для всех языков, однако применяются они для каждого языка в отдельности. Дополнительные сведения см. в следующих статьях:

- ["Параметры", "Текстовый редактор", "Все языки"](../ide/reference/options-text-editor-all-languages.md)
- [Отслеживание кода путем настройки полосы прокрутки](../ide/how-to-track-your-code-by-customizing-the-scrollbar.md)
- ["Параметры", "Текстовый редактор", "Табуляция"](../ide/reference/options-text-editor-all-languages-tabs.md)

Параметры на вкладке **R** > **Дополнительно** относятся к RTVS:

| Группа | Параметр | Значение по умолчанию | Описание |
| --- | --- | --- | --- |
| Форматирование | Автоматическое форматирование | включить | Переформатирование кода при вводе. Не влияет на выполнение команд **Форматировать выделенный фрагмент** или **Форматировать документ**. |
| | Раскрытые скобки | Off | Помещение открывающей фигурной скобки в новую строку. |
| | Форматировать по операции вставки | включить | Применение форматирования при вставке. |
| | Форматировать область по } | включить | Форматирование области после ввода закрывающей фигурной скобки. |
| | Пробел после запятой | включить | Добавление пробела после запятых. |
| | Пробел после ключевого слова | включить | Добавление пробела после ключевых слов, таких как `if`, `while` и `repeat`. |
| | Пробел перед { | включить | Добавление пробела перед открывающей фигурной скобкой. |
| | Пробелы вокруг = | включить | Добавление пробелов вокруг знака равенства. |
| IntelliSense | Зафиксировать по клавише ВВОД | Off | Выбор варианта автоматического завершения после нажатия клавиши **ВВОД**. |
| | Зафиксировать по клавише ПРОБЕЛ | Off | Выбор варианта автоматического завершения после нажатия клавиши **ПРОБЕЛ**.|
| | Список завершения по первому знаку | включить | Отображение списка завершения при вводе первого знака. Если параметр отключен, список завершения можно отобразить, выбрав **Правка** > **IntelliSense** > **Список членов** (сочетание клавиш **CTRL**+**J**). |
| | Список завершения по клавише **TAB** | Off | Отображение списка вариантов завершения путем ввода одного или нескольких символов и нажатия клавиши **TAB**. |
| | Подбирать частично введенные имена аргументов | Off | При вводе имен аргументов в вызове функции в справке по сигнатуре отображается описание аргумента, который подходит лучше всего. |
| Интерактивное окно | Проверка синтаксиса в консоли R | Off | Применение проверки синтаксиса в интерактивном окне. В многострочных операторах проверка синтаксиса может работать неправильно. |
| структуризация | Структура кода | включить | Автоматически создает сворачиваемые области для таких фрагментов, как многострочные операторы. |
| Проверка синтаксиса | Показывать синтаксические ошибки | включить | Включение автоматической проверки синтаксиса кода. |
