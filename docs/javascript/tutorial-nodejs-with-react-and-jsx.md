---
title: Создание приложения Node.js и React
description: В этом учебнике вы создадите приложение с помощью инструментов Node.js для Visual Studio.
ms.custom: mvc
ms.date: 11/01/2018
ms.topic: tutorial
ms.devlang: javascript
author: mikejo5000
ms.author: mikejo
manager: jillfra
dev_langs:
- JavaScript
ms.workload:
- nodejs
ms.openlocfilehash: 1283b447f750c3485029085d2669215abbf65dfd
ms.sourcegitcommit: 08fc78516f1107b83f46e2401888df4868bb1e40
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65695981"
---
# <a name="tutorial-create-a-nodejs-and-react-app-in-visual-studio"></a>Учебник. Создание приложения Node.js и React в Visual Studio

В Visual Studio можно легко создать проект Node.js и использовать IntelliSense и другие встроенные функции, поддерживающие Node.js. В этом учебнике по Visual Studio вы создадите проект веб-приложения Node.js на основе шаблона Visual Studio. Затем вы создадите простое приложение с помощью React.

В этом руководстве вы узнаете, как:
> [!div class="checklist"]
> * Создание проекта Node.js
> * Добавление пакетов npm
> * Добавление кода React в приложение
> * Транскомпиляция JSX
> * Подключение отладчика

## <a name="before-you-begin"></a>Подготовка к работе

Ниже приведен краткий список вопросов и ответов, с помощью которого вы сможете ознакомиться с некоторыми основными понятиями.

### <a name="what-is-nodejs"></a>Что такое Node.js?

Node.js — это серверная среда выполнения JavaScript, выполняющая сценарии JavaScript на стороне сервера.

### <a name="what-is-npm"></a>Что такое npm?

npm — это диспетчер пакетов по умолчанию для Node.js. Диспетчер пакетов упрощает публикацию и совместное использование исходного кода библиотек Node.js. Он предназначен для упрощения установки, обновления и удаления библиотек.

### <a name="what-is-react"></a>Что такое React?

React — это интерфейсная платформа для создания пользовательского интерфейса.

### <a name="what-is-jsx"></a>Что такое JSX?

JSX является расширением синтаксиса JavaScript, обычно используемым с React для описания элементов пользовательского интерфейса. Код JSX необходимо преобразовать в обычный код JavaScript, прежде чем его можно будет запустить в браузере.

### <a name="what-is-webpack"></a>Что такое webpack?

webpack объединяет файлы JavaScript, чтобы их можно было запустить в браузере. Он может преобразовывать или упаковывать другие ресурсы и активы. Он часто используется, чтобы указать компилятору, например Babel или TypeScript, преобразовать код JSX или TypeScript в обычный код JavaScript.

## <a name="prerequisites"></a>Предварительные требования

* У вас должна быть установлена среда Visual Studio и должна иметься рабочая нагрузка "Разработка Node.js".

    ::: moniker range=">=vs-2019"
    Установите Visual Studio 2019 бесплатно со страницы  [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/downloads/) , если вы еще не сделали этого.
    ::: moniker-end
    ::: moniker range="vs-2017"
    Установите Visual Studio 2017 бесплатно со страницы  [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/downloads/) , если вы еще не сделали этого.
    ::: moniker-end

    Если вам нужно установить рабочую нагрузку, но вы уже используете Visual Studio, выберите пункт **Средства** > **Получить средства и компоненты...**, после чего запустится Visual Studio Installer. Выберите рабочую нагрузку **Разработка Node.js**, а затем элемент **Изменить**.

    ![Рабочая нагрузка Node.js в установщике Visual Studio](../ide/media/quickstart-nodejs-workload.png)

* У вас должна быть установлена среда выполнения Node.js.

    Этот учебник был протестирован с версией 8.11.2.

    Если она не установлена, установите версию LTS с веб-сайта [Node.js](https://nodejs.org/en/download/). Как правило, Visual Studio автоматически обнаруживает установленную среду выполнения Node.js. Если установленная среда выполнения не обнаружена, вы можете настроить проект так, чтобы он ссылался на установленную среду выполнения, на странице свойств (после создания проекта щелкните его узел правой кнопкой мыши и выберите пункт **Свойства**).

## <a name="create-a-project"></a>Создание проекта

Сначала создайте проект веб-приложения Node.js.

1. Запустите Visual Studio.

1. Создайте новый проект.

    ::: moniker range=">=vs-2019"
    Нажмите клавишу **ESC**, чтобы закрыть окно запуска. Нажмите **CTRL+Q**, чтобы открыть поле поиска, введите **Node.js** и выберите **Пустое веб-приложение Node.js** (JavaScript). В появившемся диалоговом окне выберите **Создать**.
    ::: moniker-end
    ::: moniker range="vs-2017"
    В верхней строке меню выберите **Файл** > **Создать** > **Проект**. В левой области диалогового окна **Новый проект** разверните узел **JavaScript** и выберите **Node.js**. В средней области выберите **Пустое веб-приложение Node.js**, введите **NodejsWebAppBlank** и нажмите кнопку **ОК**.
    ::: moniker-end
    Если шаблон проекта **Пустое веб-приложение Node.js** отсутствует, необходимо добавить рабочую нагрузку **Разработка Node.js**. Подробные инструкции см. в разделе [с предварительными требованиями](#prerequisites).

    Visual Studio создаст решение и откроет проект.

    ![Проект Node.js в обозревателе решений](../javascript/media/tutorial-nodejs-react-project-structure.png)

    (1) **Полужирным** шрифтом выделен ваш проект, имя которого вы указали в окне **Новый проект**. В файловой системе этот проект представлен файлом *NJSPROJ* в папке проекта. Вы можете задать свойства и переменные среды, связанные с проектом, щелкнув его правой кнопкой мыши и выбрав пункт **Свойства**. Вы можете одновременно использовать и другие средства разработки, так как файл проекта не вносит изменения в источник проекта Node.js.

    (2) На верхнем уровне находится решение, имя которого по умолчанию совпадает с именем проекта. Решение, представленное на диске файлом *SLN*, является контейнером для одного или нескольких связанных проектов.

    (3) В узле npm представлены все установленные пакеты npm. Вы можете щелкнуть узел npm правой кнопкой мыши, чтобы найти и установить пакеты npm с помощью диалогового окна. Кроме того, установить и обновить пакеты можно с помощью параметров, доступных в файле *package.json* и контекстном меню узла npm.

    (4) *package.json* — это файл, используемый npm для управления зависимостями и версиями пакетов для локально установленных пакетов. Дополнительные сведения для этого файла см. в разделе [Конфигурация package.json](../javascript/configure-packages-with-package-json.md)

    (5) Файлы проекта, такие как *server.js*, отображаются в узле проекта. *server.js* — это файл запуска проекта, поэтому он выделяется **полужирным** шрифтом. Задать файл запуска можно, щелкнув правой кнопкой мыши файл в проекте и выбрав **Задать как файл запуска Node.js**.

## <a name="add-npm-packages"></a>Добавление пакетов npm

Для правильной работы приложения требуется ряд модулей npm.

* react
* react-dom
* express
* path
* ts-loader
* typescript
* webpack
* webpack-cli

1. В обозревателе решений (правая область) щелкните правой кнопкой мыши узел **npm** в проекте и выберите пункт **Установить новые пакеты npm**.

    В диалоговом окне **Установка новых пакетов npm** можно выбрать для установки последнюю версию пакетов или указать версию. Если вы выбрали для установки текущую версию пакетов, но в дальнейшем возникают непредвиденные ошибки, может потребоваться установить определенные версии пакетов, которые указаны далее в этой статье.

1. В диалоговом окне **Установка новых пакетов npm** выполните поиск пакета react и щелкните **Установить пакет**, чтобы установить его.

    ![Установка пакетов npm](../javascript/media/tutorial-nodejs-react-install-packages.png)

    Выберите окно **Вывод**, чтобы увидеть ход установки пакета (выберите **npm** в поле **Показать выходные данные из**). После установки пакет появляется в узле **npm**.

    Файл *package.json* обновляется с использованием сведений о новых пакетах, включая их версию.

1. Вместо поочередного поиска и добавления остальных пакетов в пользовательском интерфейсе вставьте в файл *package.json* приведенный ниже код. Для этого добавьте раздел `dependencies` в следующий код:

    ```json
    "dependencies": {
      "express": "~4.16.4",
      "path": "~0.12.7",
      "react": "~16.6.0",
      "react-dom": "~16.6.0",
      "ts-loader": "~5.3.0",
      "typescript": "~3.1.5",
      "webpack": "~4.23.1",
      "webpack-cli": "~3.1.2"
    }
    ```

    Если в вашей версии пустого шаблона уже существует `dependencies`, просто замените его приведенным выше кодом JSON. Дополнительные сведения об использовании этого файла см. в разделе [Конфигурация package.json](../javascript/configure-packages-with-package-json.md)

1. Щелкните правой кнопкой мыши узел **npm** в проекте и выберите команду **Обновить пакеты npm**.

    В области внизу выберите окно **Вывод**, чтобы увидеть ход установки пакетов. Установка может занять несколько минут. Чтобы увидеть выходные данные, выберите **Npm** в поле **Показать выходные данные из** в окне **Вывод**.

    Ниже показаны модули npm, отображаемые в обозревателе решений после установки.

    ![Пакеты npm](../javascript/media/tutorial-nodejs-react-npm-modules.png)

    > [!NOTE]
    > Чтобы установить пакеты npm из командной строки, щелкните узел проекта правой кнопкой мыши и выберите пункт **Открыть командную строку здесь**. Используйте стандартные команды Node.js для установки пакетов.

## <a name="add-project-files"></a>Добавление файлов проекта

В рамках этой процедуры вы добавите в проект четыре новых файла.

* *app.tsx*
* *webpack-config.js*
* *index.html*
* *tsconfig.json*

Для этого простого приложения новые файлы проекта добавляются в корень проекта. (В большинстве приложений файлы, как правило, добавляются во вложенные папки, после чего ссылки в виде относительных путей изменяются соответствующим образом.)

1. В обозревателе решений щелкните правой кнопкой мыши проект **NodejsWebAppBlank** и выберите пункт **Добавить** > **Новый элемент**.

1. В диалоговом окне **Добавление нового элемента** выберите **JSX-файл TypeScript**, введите имя файла *app.tsx* и нажмите кнопку **ОК**.

1. Повторите эти действия, чтобы добавить файл *webpack-config.js*. Вместо файла TypeScript JSX выберите **файл JavaScript**.

1. Выполните эти же действия, чтобы добавить файл *index.html* в проект. Вместо файла JavaScript выберите **HTML-файл**.

1. Выполните эти же действия, чтобы добавить файл *tsconfig.json* в проект. Вместо файла JavaScript выберите **Файл конфигурации TypeScript JSON**.

## <a name="add-app-code"></a>Добавление кода приложения

1. Откройте файл *server.js* и замените его содержимое следующим кодом:

    ```javascript
    'use strict';
    var path = require('path');
    var express = require('express');

    var app = express();

    var staticPath = path.join(__dirname, '/');
    app.use(express.static(staticPath));

    // Allows you to set port in the project properties.
    app.set('port', process.env.PORT || 3000);

    var server = app.listen(app.get('port'), function() {
        console.log('listening');
    });
    ```

   В приведенном выше коде используется Express для запуска Node.js в качестве сервера веб-приложения. Этот код задает в качестве номера порта номер, настроенный в свойствах проекта (по умолчанию в свойствах настроен порт 1337). Чтобы открыть свойства проекта, в обозревателе решений щелкните проект правой кнопкой мыши и выберите пункт **Свойства**.

1. Откройте файл *app.tsx* и добавьте следующий код:

    ```javascript
    declare var require: any

    var React = require('react');
    var ReactDOM = require('react-dom');

    export class Hello extends React.Component {
        render() {
            return (
                <h1>Welcome to React!!</h1>
            );
        }
    }

    ReactDOM.render(<Hello />, document.getElementById('root'));
    ```

    В приведенном выше коде используется синтаксис JSX и React для вывода простого сообщения.

1. Откройте файл *index.html* и замените раздел **body** на следующий код:

    ```html
    <body>
        <div id="root"></div>
        <!-- scripts -->
        <script src="./dist/app-bundle.js"></script>
    </body>
    ```

    Эта HTML-страница загружает файл *app-bundle.js*, который содержит код JSX и React, транскомпилированный в обычный код JavaScript. Пока файл *app-bundle.js* пуст. В следующем разделе вы настроите параметры для транскомпиляции кода.

## <a name="configure-webpack-and-typescript-compiler-options"></a>Настройка параметров компилятора webpack и TypeScript

В предыдущих шагах вы добавили файл *webpack-config.js* в проект. Далее вы добавите код конфигурации webpack. Вы добавите простую конфигурацию webpack, в которой указываются входной файл (*app.tsx*) и выходной файл (*app-bundle.js*) для объединения и транскомпиляции кода JSX в обычный код JavaScript. Для транскомпиляции также настраиваются некоторые параметры компилятора TypeScript. Этот код представляет собой базовую конфигурацию, которая служит для ознакомления с работой webpack и компилятора TypeScript.

1. В обозревателе решений откройте файл *webpack-config.js* и добавьте приведенный ниже код.

    ```json
    module.exports = {
        devtool: 'source-map',
        entry: "./app.tsx",
        mode: "development",
        output: {
            filename: "./app-bundle.js"
        },
        resolve: {
            extensions: ['.Webpack.js', '.web.js', '.ts', '.js', '.jsx', '.tsx']
        },
        module: {
            rules: [
                {
                    test: /\.tsx$/,
                    exclude: /(node_modules|bower_components)/,
                    use: {
                        loader: 'ts-loader'
                    }
                }
            ]
        }
    }
    ```

    Код конфигурации webpack предписывает средству webpack использовать загрузчик TypeScript для транскомпиляции JSX.

1. Откройте файл *tsconfig.json* и замените код по умолчанию следующим кодом, который задает параметры компилятора TypeScript:

    ```json
    {
      "compilerOptions": {
        "noImplicitAny": false,
        "module": "commonjs",
        "noEmitOnError": true,
        "removeComments": false,
        "sourceMap": true,
        "target": "es5",
        "jsx": "react"
      },
      "exclude": [
        "node_modules"
      ],
      "files": [
        "app.tsx"
      ]
    }
    ```

    В качестве исходного файла указывается файл *app.tsx*.

## <a name="transpile-the-jsx"></a>Транскомпиляция JSX

1. В обозревателе решений щелкните узел проекта правой кнопкой мыши и выберите пункт **Открыть командную строку здесь**.

1. В командной строке введите следующую команду:

    `node_modules\.bin\webpack app.tsx --config webpack-config.js`

    В окне командной строки будут выведены результаты.

    ![Запуск webpack](../javascript/media/tutorial-nodejs-react-run-webpack.png)

    Если вместо приведенных выше выходных данных будут выведены ошибки, их необходимо будет устранить, чтобы приложение работало. Если ваши версии пакетов npm отличаются от используемых в этом учебнике, это может быть причиной ошибок. Один из способов устранить ошибки — использовать именно те версии, которые показаны в предыдущих шагах. Кроме того, если одна или несколько из этих версий пакетов стали нерекомендуемыми, из-за чего возникают ошибки, может потребоваться установить более поздние версии. Дополнительные сведения об использовании *package.json* для контроля версий пакетов npm см. в разделе [Конфигурация package.json](../javascript/configure-packages-with-package-json.md).

1. В обозревателе решений щелкните правой кнопкой мыши узел проекта и выберите пункты **Добавить** > **Существующая папка**, а затем папку *dist* и щелкните **Выбрать папку**.

    Среда Visual Studio добавит в проект папку *dist*, которая содержит файлы *app-bundle.js* и *app-bundle.js.map*.

1. Откройте файл *app-bundle.js*, чтобы просмотреть транскомпилированный код JavaScript.

1. Если будет предложено перезагрузить файлы, которые были изменены в других средствах, выберите вариант **Да, для всех**.

    ![Загрузка измененных файлов](../javascript/media/tutorial-nodejs-react-reload-files.png)

Каждый раз при внесении изменений в файл *app.tsx* необходимо повторно выполнять команду webpack.

## <a name="run-the-app"></a>Запуск приложения

1. Выберите Chrome в качестве целевого объекта отладки.

    ::: moniker range=">=vs-2019"
    ![Выбор Chrome в качестве целевого объекта отладки](../javascript/media/vs-2019/tutorial-nodejs-react-debug-target.png)
    ::: moniker-end
    ::: moniker range="vs-2017"
    ![Выбор Chrome в качестве целевого объекта отладки](../javascript/media/tutorial-nodejs-react-debug-target.png)
    ::: moniker-end

    Если Chrome установлен на вашем компьютере, но отсутствует в списке, выберите **Просмотреть с помощью** в раскрывающемся списке целевых объектов отладки, а затем установите Chrome в качестве целевого объекта отладки по умолчанию (выберите **По умолчанию**).

1. Чтобы запустить приложение, нажмите клавишу **F5** (**Отладка** > **Начать отладку**) или кнопку с зеленой стрелкой.

    Откроется окно консоли Node.js, в котором показан порт, через который отладчик ожидает передачи данных.

    Visual Studio запускает приложение с помощью файла запуска *server.js*.

    ![Запуск React в браузере](../javascript/media/tutorial-nodejs-react-running-react.png)

1. Закройте окно браузера.

1. Закройте окно консоли.

## <a name="set-a-breakpoint-and-run-the-app"></a>Установите точку останова и запустите приложение.

1. В файле *server.js* щелкните в поле слева от объявления `staticPath`, чтобы установить точку останова:

    ![Установка точки останова](../javascript/media/tutorial-nodejs-react-set-breakpoint.png)

    Точки останова — это один из самых простых и важных компонентов надежной отладки. Точка останова указывает, где Visual Studio следует приостановить выполнение кода, чтобы вы могли проверить значения переменных или поведение памяти либо выполнение ветви кода.

1. Чтобы запустить приложение, нажмите клавишу **F5** (**Отладка** > **Начать отладку**).

    Выполнение отладчика прервется в установленной точке останова (текущий оператор выделяется желтым цветом). Теперь вы можете изучить состояние приложения, наводя указатель мыши на переменные в текущей области и используя окна отладчика, такие как **Локальные** и **Контрольные значения**.

1. Чтобы продолжить выполнение приложения, нажмите клавишу **F5**.

1. Если вы хотите использовать инструменты разработчика Chrome, нажмите клавишу **F12**. С их помощью можно изучить модель DOM и взаимодействовать с приложением с помощью консоли JavaScript.

1. Закройте веб-браузер и консоль.

## <a name="set-and-hit-a-breakpoint-in-the-client-side-react-code"></a>Установка и срабатывание точки останова в коде React на стороне клиента

В предыдущем разделе вы подключили отладчик к коду Node.js на стороне сервера. Чтобы можно было подключить отладчик из Visual Studio и попадать в точки останова в коде React на стороне клиента, необходимо правильно настроить процесс. Ниже описывается один из способов.

1. Закройте все окна Chrome.

2. Щелкните правой кнопкой мыши кнопку **Пуск** Windows, выберите команду **Выполнить** и введите следующую команду:

    `chrome.exe --remote-debugging-port=9222`

    Chrome будет запущен в режиме отладки.

    ::: moniker range=">=vs-2019"

    > [!NOTE]
    > Можно также задать флаг `--remote-debugging-port` при запуске браузера, выбрав **Просмотреть с помощью...**  > из панели инструментов **Отладка**, затем выбрав **Добавить**, а затем установив соответствующий флаг в поле **Аргументы**. Используйте другое понятное для браузера имя, например **Chrome с отладкой**. Подробности см. в [заметках о выпуске](https://docs.microsoft.com/visualstudio/releases/2019/release-notes-preview#browser-cli-params-support).

    ::: moniker-end

3. Перейдите в Visual Studio и установите точку останова в коде файла *app-bundle.js* в функции `render()`, как показано на рисунке ниже.

    ![Установка точки останова](../javascript/media/tutorial-nodejs-react-set-breakpoint-client-code.png)

    Чтобы найти функцию `render()` в *app-bundle.js*, используйте комбинацию клавиш **CTRL**+**F** (**Правка** > **Найти и заменить** > **Быстрый поиск**).

4. Выбрав Chrome в качестве целевого объекта отладки в Visual Studio, нажмите клавиши **CTRL**+**F5** (**Отладка** > **Запуск без отладки**), чтобы запустить приложение в браузере.

    Приложение откроется в новой вкладке браузера.

5. Выберите **Отладка** > **Присоединение к процессу**.

6. В диалоговом окне **Присоединение к процессу** выберите в поле **Присоединить к** элемент **Код Webkit** и введите **chrome** в поле фильтра, чтобы отфильтровать результаты поиска.

7. Выберите процесс Chrome с соответствующим портом узла (1337 в этом примере) и нажмите кнопку **Присоединить**.

    ![Присоединение к процессу](../javascript/media/tutorial-nodejs-react-attach-to-process.png)

    Определить, что отладчик присоединился правильно, можно по открытию проводника DOM и консоли JavaScript в Visual Studio. Эти средства отладки аналогичны инструментам Chrome для разработчиков и средствам F12 для Microsoft Edge.

    > [!NOTE]
    > Если отладчик не присоединяется и появляется сообщение "Не удалось присоединиться к процессу. Операция недопустима в текущем состоянии", — перед запуском Chrome в режиме отладки закройте все экземпляры Chrome через диспетчер задач. Возможно, выполняются расширения Chrome и препятствуют переходу в режим полной отладки.

8. Так как код с точкой останова уже был выполнен, обновите страницу браузера, чтобы точка останова была достигнута еще раз.

    Когда отладчик приостановит выполнение, вы можете изучить состояние приложения, наводя указатель мыши на переменные и используя окна отладчика. Вы также можете выполнять пошаговую отладку кода (клавиши **F5**, **F10** и **F11**).

    Точка останова может быть достигнута в файле *app-bundle.js* или сопоставленном с ним месте в файле *app.tsx* в зависимости от среды и состояния браузера. В любом случае вы можете выполнять пошаговую отладку кода и просматривать переменные.

   * Если требуется приостановка выполнения кода в *app.tsx*, но вам не удается это сделать, используйте **присоединение к процессу**, чтобы подключить отладчик, как это описано в предыдущих этапах. Затем откройте динамически созданный файл *app.tsx* в обозревателе решений. Для этого откройте **Документы скриптов** > **app.tsx**, установите точку останова и обновите страницу в браузере (установите точку останова в строке кода, допускающей точки останова, например в операторе `return` или объявлении `var`).

       Либо, если необходимо прервать выполнение кода в файле *app.tsx*, но сделать это не удается, попробуйте использовать оператор `debugger;` в *app.tsx* или установите точки останова в инструментах разработчика Chrome.

   * Если требуется приостановка выполнения кода в файле *app-bundle.js*, но это сделать не удается, удалите файл соответствия источника *app-bundle.js.map*.

     > [!TIP]
     > После того как вы впервые присоединитесь к процессу с помощью этих инструкций, в дальнейшем можно присоединяться к нему в Visual Studio 2017 с помощью команды **Отладка** > **Повторно подключиться к процессу**.

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Развертывание приложения в службе приложений Linux](../javascript/publish-nodejs-app-azure.md)
