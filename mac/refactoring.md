---
title: Рефакторинг кода
description: Уточнение кода с помощью Visual Studio для Mac и быстрых действий.
author: jmatthiesen
ms.author: jomatthi
ms.date: 07/03/2020
ms.assetid: C7782BF3-016F-4B41-8A81-85FC540A1A8F
ms.custom: video
ms.openlocfilehash: 3892117e5c84a71f258d4e019105fca0a8cf9c5b
ms.sourcegitcommit: b1b747063ce0bba63ad2558fa521b823f952ab51
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2020
ms.locfileid: "96189242"
---
# <a name="refactoring"></a>Refactoring

Рефакторинг кода позволяет переупорядочить, реструктуризовать и уточнить существующий код без изменения его поведения.

Рефакторинг повышает работоспособность базы кода, делая ее более удобной, понятной и легкой в обслуживании как для вас или другого разработчика, так и для пользователя, обращающегося к такому коду.

Интеграция Visual Studio для Mac с Roslyn, платформой компилятора .NET с открытым кодом от корпорации Майкрософт, расширяет спектр операций рефакторинга.

## <a name="renaming"></a>Переименование

Команду рефакторинга *Переименовать* можно использовать для любого идентификатора кода (например, имени класса, имени свойства и т. д.), чтобы найти все экземпляры этого идентификатора и изменить их. Чтобы переименовать символ, щелкните его правой кнопкой мыши и выберите пункт **Переименовать...** или нажмите сочетание клавиш **CMD (⌘) + R**:

![Пункт меню "Переименовать"](media/refactoring-renaming1.png)

При этом выделяется как сам символ, так и все ссылки на него. Начав вводить новое имя, вы автоматически изменяете все ссылки в коде, а нажав клавишу **ВВОД**, можно зафиксировать изменения:

![Переименование и идентификатор](media/refactoring-renaming2.png)

## <a name="quick-actions-and-refactorings"></a>Быстрые действия и операции рефакторинга

Быстрые действия и операции рефакторинга позволяют легко создавать и изменять код, а также выполнять его рефакторинг одним действием.

Быстрые действия можно использовать для решения следующих задач:

* исправление кода при нарушениях правил анализатора кода;
* игнорирование нарушений правил анализа кода;
* применение рефакторинга (например, встраивание временной переменной);
* создание кода (например, представление локальной переменной).

Быстрые действия можно применять с помощью значков лампочки ![значок лампочки](media/quick-actions-light-bulb-icon.png) или отвертки ![значок отвертки](media/quick-actions-screwdriver-icon.png) или нажав **Параметр(⌥)** +**Ввод**, когда курсор находится на строке кода, для которой доступно действие. Лампочка, сигнализирующая об ошибке, ![значок лампочки ошибки](media/quick-actions-error-light-bulb-icon.png) отображается, если есть красная волнистая линия, указывающая на ошибку, и у Visual Studio есть решение этой ошибки.

Сторонние разработчики могут предоставить для любого языка пользовательскую диагностику и предложения, например в рамках SDK, и лампочки Visual Studio будут появляться на основе этих правил.

### <a name="quick-action-icons"></a>Значки быстрых действий
Значок, отображающийся при доступном быстром действии, указывает на тип доступного исправления или рефакторинга. Значок *отвертки* ![значок отвертки](media/quick-actions-screwdriver-icon.png) указывает, что доступны действия по изменению кода, но вам не обязательно их использовать. Значок *желтой лампочки* ![значок лампочки](media/quick-actions-light-bulb-icon.png) указывает, что доступны действия, которые *следует* сделать для улучшения кода. Значок *лампочки с ошибкой* ![значок лампочки с ошибкой](media/quick-actions-error-light-bulb-icon.png) указывает, что доступны действия для исправления ошибки в коде.

### <a name="to-see-a-light-bulb-or-screwdriver"></a>Отображение лампочки и отвертки

- Если доступно исправление, лампочки появляются сами при наведении указателя мыши на место ошибки.

   ![Лампочка с наведением указателя мыши](media/refactoring-lightbulb-hover.png)

- Лампочки и отвертки отображаются в левом поле редактора при перемещении курсора в строку кода, для которого доступно быстрое действие или рефакторинг.

- Нажмите **Параметр (⌥)** +**ВВОД** в любом месте строки, чтобы увидеть список доступных быстрых действий и рефакторингов.

![Отображение контекстных элементов](media/refactoring-context-action.png)

При наведении указателя мыши на любое из контекстных действий отображается предварительный просмотр всего того, что будет добавлено в код или удалено оттуда.

![Контекстные элементы при нажатии OPTION+ВВОД](media/refactoring-image2a.png)

Чтобы включить эти параметры, нужно выбрать *Включить анализ источника для открытых файлов* в разделе параметров **Visual Studio для Mac > Параметры > Текстовый редактор > Анализ источника**:

![Включение анализа источника](media/refactoring-options.png)

Существует более 100 возможных предлагаемых действий, которые можно включить или отключить, перейдя в раздел **Visual Studio для Mac > Параметры > Анализ источника > C# > Действия кода** и установив или сняв флажок рядом с ними:

![Действия анализа источника C#](media/refactoring-image3a.png)

### <a name="common-quick-actions"></a>Распространенные быстрые действия

Дополнительные сведения о распространенных быстрых действиях см. в статье [Распространенные быстрые действия](/visualstudio/ide/common-quick-actions).

## <a name="source-analysis"></a>Анализ источника

Анализ источника оперативно анализирует код, подчеркивая потенциальные ошибки и нарушения стиля, а также предоставляя автоматические исправления в виде контекстных действий.

Вы в любое время можете просмотреть все результаты анализа источника для любого файла на полосе прокрутки в правой части текстового редактора:

![Боковая панель исходного кода](media/refactoring-image4a.png)

Если щелкнуть расположенный сверху круг, можно выполнить итерации по каждому из предложений, начиная с наиболее серьезных проблем. При наведении указателя мыши на конкретный результат или строку отображается проблема, которую можно устранить с помощью контекстных действий.

![Элемент "Анализ источника"](media/refactoring-image5.png)

## <a name="related-video"></a>Связанные видео

> [!Video https://channel9.msdn.com/Shows/Visual-Studio-Toolbox/Visual-Studio-for-Mac-Refactoring-Code/player]

## <a name="see-also"></a>См. также

- [Быстрые действия (Visual Studio в Windows)](/visualstudio/ide/quick-actions)
- [Рефакторинг кода (Visual Studio в Windows)](/visualstudio/ide/refactoring-in-visual-studio)
